(self.webpackChunk=self.webpackChunk||[]).push([[184],{19824:function(e,t){"use strict";const r="undefined"!=typeof BigUint64Array,n=Symbol(),s=1024;function i(e,t){const r=new Uint32Array(e),n=new Uint16Array(e);var i=r[t+-4>>>2]>>>1,o=t>>>1;if(i<=s)return String.fromCharCode.apply(String,n.subarray(o,o+i));const a=[];do{const e=n[o+s-1],t=e>=55296&&e<56320?1023:s;a.push(String.fromCharCode.apply(String,n.subarray(o,o+=t))),i-=t}while(i>s);return a.join("")+String.fromCharCode.apply(String,n.subarray(o,o+i))}function o(e){const t={};function r(e,t){return e?i(e.buffer,t):"<yet unknown>"}const n=e.env=e.env||{};return n.abort=n.abort||function(e,s,i,o){const a=t.memory||n.memory;throw Error("abort: "+r(a,e)+" at "+r(a,s)+":"+i+":"+o)},n.trace=n.trace||function(e,s){const i=t.memory||n.memory;console.log("trace: "+r(i,e)+(s?" ":"")+Array.prototype.slice.call(arguments,2,2+s).join(", "))},e.Math=e.Math||Math,e.Date=e.Date||Date,t}function a(e,t){const n=t.exports,s=n.memory,o=n.table,a=n.__alloc,A=n.__retain,c=n.__rtti_base||-1;function l(e){const t=new Uint32Array(s.buffer);if((e>>>=0)>=t[c>>>2])throw Error("invalid id: "+e);return t[(c+4>>>2)+2*e]}function h(e){const t=new Uint32Array(s.buffer);if((e>>>=0)>=t[c>>>2])throw Error("invalid id: "+e);return t[(c+4>>>2)+2*e+1]}function d(e){return 31-Math.clz32(e>>>5&31)}function f(e,t,r){const n=s.buffer;if(r)switch(e){case 2:return new Float32Array(n);case 3:return new Float64Array(n)}else switch(e){case 0:return new(t?Int8Array:Uint8Array)(n);case 1:return new(t?Int16Array:Uint16Array)(n);case 2:return new(t?Int32Array:Uint32Array)(n);case 3:return new(t?BigInt64Array:BigUint64Array)(n)}throw Error("unsupported align: "+e)}function p(e){const t=new Uint32Array(s.buffer),r=t[e+-8>>>2],n=l(r);if(!(1&n))throw Error("not an array: "+r);const i=d(n);var o=t[e+4>>>2];const a=2&n?t[e+12>>>2]:t[o+-4>>>2]>>>i;return f(i,1024&n,2048&n).subarray(o>>>=i,o+a)}function g(e,t,r){return new e(y(e,t,r))}function y(e,t,r){const n=s.buffer,i=new Uint32Array(n),o=i[r+4>>>2];return new e(n,o,i[o+-4>>>2]>>>t)}return e.__allocString=function(e){const t=e.length,r=a(t<<1,1),n=new Uint16Array(s.buffer);for(var i=0,o=r>>>1;i<t;++i)n[o+i]=e.charCodeAt(i);return r},e.__getString=function(e){const t=s.buffer;if(1!==new Uint32Array(t)[e+-8>>>2])throw Error("not a string: "+e);return i(t,e)},e.__allocArray=function(e,t){const r=l(e);if(!(3&r))throw Error("not an array: "+e+" @ "+r);const n=d(r),i=t.length,o=a(i<<n,0),c=a(2&r?16:12,e),u=new Uint32Array(s.buffer);u[c+0>>>2]=A(o),u[c+4>>>2]=o,u[c+8>>>2]=i<<n,2&r&&(u[c+12>>>2]=i);const h=f(n,1024&r,2048&r);if(8192&r)for(let e=0;e<i;++e)h[(o>>>n)+e]=A(t[e]);else h.set(t,o>>>n);return c},e.__getArrayView=p,e.__getArray=function(e){const t=p(e),r=t.length,n=new Array(r);for(let e=0;e<r;e++)n[e]=t[e];return n},e.__getArrayBuffer=function(e){const t=s.buffer,r=new Uint32Array(t)[e+-4>>>2];return t.slice(e,e+r)},e.__getInt8Array=g.bind(null,Int8Array,0),e.__getInt8ArrayView=y.bind(null,Int8Array,0),e.__getUint8Array=g.bind(null,Uint8Array,0),e.__getUint8ArrayView=y.bind(null,Uint8Array,0),e.__getUint8ClampedArray=g.bind(null,Uint8ClampedArray,0),e.__getUint8ClampedArrayView=y.bind(null,Uint8ClampedArray,0),e.__getInt16Array=g.bind(null,Int16Array,1),e.__getInt16ArrayView=y.bind(null,Int16Array,1),e.__getUint16Array=g.bind(null,Uint16Array,1),e.__getUint16ArrayView=y.bind(null,Uint16Array,1),e.__getInt32Array=g.bind(null,Int32Array,2),e.__getInt32ArrayView=y.bind(null,Int32Array,2),e.__getUint32Array=g.bind(null,Uint32Array,2),e.__getUint32ArrayView=y.bind(null,Uint32Array,2),r&&(e.__getInt64Array=g.bind(null,BigInt64Array,3),e.__getInt64ArrayView=y.bind(null,BigInt64Array,3),e.__getUint64Array=g.bind(null,BigUint64Array,3),e.__getUint64ArrayView=y.bind(null,BigUint64Array,3)),e.__getFloat32Array=g.bind(null,Float32Array,2),e.__getFloat32ArrayView=y.bind(null,Float32Array,2),e.__getFloat64Array=g.bind(null,Float64Array,3),e.__getFloat64ArrayView=y.bind(null,Float64Array,3),e.__instanceof=function(e,t){const r=new Uint32Array(s.buffer);var n=r[e+-8>>>2];if(n<=r[c>>>2])do{if(n==t)return!0}while(n=h(n));return!1},e.memory=e.memory||s,e.table=e.table||o,u(n,e)}function A(e){return"undefined"!=typeof Response&&e instanceof Response}async function c(e,t){return A(e=await e)?l(e,t):a(o(t||(t={})),await WebAssembly.instantiate(e instanceof WebAssembly.Module?e:await WebAssembly.compile(e),t))}async function l(e,t){return WebAssembly.instantiateStreaming?a(o(t||(t={})),(await WebAssembly.instantiateStreaming(e,t)).instance):c(A(e=await e)?e.arrayBuffer():e,t)}function u(e,t){var r=t?Object.create(t):{},s=e.__argumentsLength?function(t){e.__argumentsLength.value=t}:e.__setArgumentsLength||e.__setargc||function(){};for(let t in e){if(!Object.prototype.hasOwnProperty.call(e,t))continue;const i=e[t];let o=t.split("."),a=r;for(;o.length>1;){let e=o.shift();Object.prototype.hasOwnProperty.call(a,e)||(a[e]={}),a=a[e]}let A=o[0],c=A.indexOf("#");if(c>=0){let r=A.substring(0,c),o=a[r];if(void 0===o||!o.prototype){let e=function(...t){return e.wrap(e.prototype.constructor(0,...t))};e.prototype={valueOf:function(){return this[n]}},e.wrap=function(t){return Object.create(e.prototype,{[n]:{value:t,writable:!1}})},o&&Object.getOwnPropertyNames(o).forEach((t=>Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t)))),a[r]=e}if(A=A.substring(c+1),a=a[r].prototype,/^(get|set):/.test(A)){if(!Object.prototype.hasOwnProperty.call(a,A=A.substring(4))){let r=e[t.replace("set:","get:")],s=e[t.replace("get:","set:")];Object.defineProperty(a,A,{get:function(){return r(this[n])},set:function(e){s(this[n],e)},enumerable:!0})}}else"constructor"===A?(a[A]=(...e)=>(s(e.length),i(...e))).original=i:(a[A]=function(...e){return s(e.length),i(this[n],...e)}).original=i}else/^(get|set):/.test(A)?Object.prototype.hasOwnProperty.call(a,A=A.substring(4))||Object.defineProperty(a,A,{get:e[t.replace("set:","get:")],set:e[t.replace("get:","set:")],enumerable:!0}):"function"==typeof i&&i!==s?(a[A]=(...e)=>(s(e.length),i(...e))).original=i:a[A]=i}return r}t.instantiate=c,t.instantiateSync=function(e,t){return a(o(t||(t={})),new WebAssembly.Instance(e instanceof WebAssembly.Module?e:new WebAssembly.Module(e),t))},t.instantiateStreaming=l,t.demangle=u},42450:function(e,t,r){"use strict";e.exports=r(10077)},10077:function(e,t,r){"use strict";var n=t;function s(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=r(88482),n.BufferWriter=r(95628),n.Reader=r(29958),n.BufferReader=r(73055),n.util=r(61436),n.rpc=r(13971),n.roots=r(59149),n.configure=s,s()},29958:function(e,t,r){"use strict";e.exports=A;var n,s=r(61436),i=s.LongBits,o=s.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function A(e){this.buf=e,this.pos=0,this.len=e.length}var c,l="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new A(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new A(e);throw Error("illegal buffer")},u=function(){return s.Buffer?function(e){return(A.create=function(e){return s.Buffer.isBuffer(e)?new n(e):l(e)})(e)}:l};function h(){var e=new i(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function d(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw a(this,8);return new i(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}A.create=u(),A.prototype._slice=s.Array.prototype.subarray||s.Array.prototype.slice,A.prototype.uint32=(c=4294967295,function(){if(c=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return c;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return c}),A.prototype.int32=function(){return 0|this.uint32()},A.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},A.prototype.bool=function(){return 0!==this.uint32()},A.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return d(this.buf,this.pos+=4)},A.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|d(this.buf,this.pos+=4)},A.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=s.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},A.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=s.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},A.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},A.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},A.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},A.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},A._configure=function(e){n=e,A.create=u(),n._configure();var t=s.Long?"toLong":"toNumber";s.merge(A.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},73055:function(e,t,r){"use strict";e.exports=i;var n=r(29958);(i.prototype=Object.create(n.prototype)).constructor=i;var s=r(61436);function i(e){n.call(this,e)}i._configure=function(){s.Buffer&&(i.prototype._slice=s.Buffer.prototype.slice)},i.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},i._configure()},59149:function(e){"use strict";e.exports={}},13971:function(e,t,r){"use strict";t.Service=r(98295)},98295:function(e,t,r){"use strict";e.exports=s;var n=r(61436);function s(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(s.prototype=Object.create(n.EventEmitter.prototype)).constructor=s,s.prototype.rpcCall=function e(t,r,s,i,o){if(!i)throw TypeError("request must be specified");var a=this;if(!o)return n.asPromise(e,a,t,r,s,i);if(a.rpcImpl)try{return a.rpcImpl(t,r[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,r){if(e)return a.emit("error",e,t),o(e);if(null!==r){if(!(r instanceof s))try{r=s[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return a.emit("error",e,t),o(e)}return a.emit("data",r,t),o(null,r)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){o(e)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},s.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},19961:function(e,t,r){"use strict";e.exports=s;var n=r(61436);function s(e,t){this.lo=e>>>0,this.hi=t>>>0}var i=s.zero=new s(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var o=s.zeroHash="\0\0\0\0\0\0\0\0";s.fromNumber=function(e){if(0===e)return i;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new s(r,n)},s.from=function(e){if("number"==typeof e)return s.fromNumber(e);if(n.isString(e)){if(!n.Long)return s.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new s(e.low>>>0,e.high>>>0):i},s.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},s.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;s.fromHash=function(e){return e===o?i:new s((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},s.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},s.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},s.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},s.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},61436:function(e,t,r){"use strict";var n=t;function s(e,t,r){for(var n=Object.keys(t),s=0;s<n.length;++s)void 0!==e[n[s]]&&r||(e[n[s]]=t[n[s]]);return e}function i(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&s(this,r)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}n.asPromise=r(34537),n.base64=r(97419),n.EventEmitter=r(19211),n.float=r(10945),n.inquire=r(67199),n.utf8=r(94997),n.pool=r(76662),n.LongBits=r(19961),n.isNode=Boolean(void 0!==r.g&&r.g&&r.g.process&&r.g.process.versions&&r.g.process.versions.node),n.global=n.isNode&&r.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var r=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},n.merge=s,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=i,n.ProtocolError=i("ProtocolError"),n.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},n.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},88482:function(e,t,r){"use strict";e.exports=u;var n,s=r(61436),i=s.LongBits,o=s.base64,a=s.utf8;function A(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function c(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function u(){this.len=0,this.head=new A(c,0,0),this.tail=this.head,this.states=null}var h=function(){return s.Buffer?function(){return(u.create=function(){return new n})()}:function(){return new u}};function d(e,t,r){t[r]=255&e}function f(e,t){this.len=e,this.next=void 0,this.val=t}function p(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function g(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}u.create=h(),u.alloc=function(e){return new s.Array(e)},s.Array!==Array&&(u.alloc=s.pool(u.alloc,s.Array.prototype.subarray)),u.prototype._push=function(e,t,r){return this.tail=this.tail.next=new A(e,t,r),this.len+=t,this},f.prototype=Object.create(A.prototype),f.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},u.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},u.prototype.int32=function(e){return e<0?this._push(p,10,i.fromNumber(e)):this.uint32(e)},u.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},u.prototype.uint64=function(e){var t=i.from(e);return this._push(p,t.length(),t)},u.prototype.int64=u.prototype.uint64,u.prototype.sint64=function(e){var t=i.from(e).zzEncode();return this._push(p,t.length(),t)},u.prototype.bool=function(e){return this._push(d,1,e?1:0)},u.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},u.prototype.sfixed32=u.prototype.fixed32,u.prototype.fixed64=function(e){var t=i.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},u.prototype.sfixed64=u.prototype.fixed64,u.prototype.float=function(e){return this._push(s.float.writeFloatLE,4,e)},u.prototype.double=function(e){return this._push(s.float.writeDoubleLE,8,e)};var y=s.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};u.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(d,1,0);if(s.isString(e)){var r=u.alloc(t=o.length(e));o.decode(e,r,0),e=r}return this.uint32(t)._push(y,t,e)},u.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(d,1,0)},u.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new A(c,0,0),this.len=0,this},u.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new A(c,0,0),this.len=0),this},u.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},u.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},u._configure=function(e){n=e,u.create=h(),n._configure()}},95628:function(e,t,r){"use strict";e.exports=i;var n=r(88482);(i.prototype=Object.create(n.prototype)).constructor=i;var s=r(61436);function i(){n.call(this)}function o(e,t,r){e.length<40?s.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}i._configure=function(){i.alloc=s._Buffer_allocUnsafe,i.writeBytesBuffer=s.Buffer&&s.Buffer.prototype instanceof Uint8Array&&"set"===s.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},i.prototype.bytes=function(e){s.isString(e)&&(e=s._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(i.writeBytesBuffer,t,e),this},i.prototype.string=function(e){var t=s.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},i._configure()},20238:function(e,t,r){"use strict";r.d(t,{dE:function(){return n.d}});var n=r(9279)},34537:function(e){"use strict";e.exports=function(e,t){var r=new Array(arguments.length-1),n=0,s=2,i=!0;for(;s<arguments.length;)r[n++]=arguments[s++];return new Promise((function(s,o){r[n]=function(e){if(i)if(i=!1,e)o(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];s.apply(null,t)}};try{e.apply(t||null,r)}catch(e){i&&(i=!1,o(e))}}))}},97419:function(e,t){"use strict";var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var n=new Array(64),s=new Array(123),i=0;i<64;)s[n[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;r.encode=function(e,t,r){for(var s,i=null,o=[],a=0,A=0;t<r;){var c=e[t++];switch(A){case 0:o[a++]=n[c>>2],s=(3&c)<<4,A=1;break;case 1:o[a++]=n[s|c>>4],s=(15&c)<<2,A=2;break;case 2:o[a++]=n[s|c>>6],o[a++]=n[63&c],A=0}a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0)}return A&&(o[a++]=n[s],o[a++]=61,1===A&&(o[a++]=61)),i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))};var o="invalid encoding";r.decode=function(e,t,r){for(var n,i=r,a=0,A=0;A<e.length;){var c=e.charCodeAt(A++);if(61===c&&a>1)break;if(void 0===(c=s[c]))throw Error(o);switch(a){case 0:n=c,a=1;break;case 1:t[r++]=n<<2|(48&c)>>4,n=c,a=2;break;case 2:t[r++]=(15&n)<<4|(60&c)>>2,n=c,a=3;break;case 3:t[r++]=(3&n)<<6|c,a=0}}if(1===a)throw Error(o);return r-i},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},19211:function(e){"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this}},10945:function(e){"use strict";function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=128===r[3];function s(e,n,s){t[0]=e,n[s]=r[0],n[s+1]=r[1],n[s+2]=r[2],n[s+3]=r[3]}function i(e,n,s){t[0]=e,n[s]=r[3],n[s+1]=r[2],n[s+2]=r[1],n[s+3]=r[0]}function o(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t[0]}function a(e,n){return r[3]=e[n],r[2]=e[n+1],r[1]=e[n+2],r[0]=e[n+3],t[0]}e.writeFloatLE=n?s:i,e.writeFloatBE=n?i:s,e.readFloatLE=n?o:a,e.readFloatBE=n?a:o}():function(){function t(e,t,r,n){var s=t<0?1:0;if(s&&(t=-t),0===t)e(1/t>0?0:2147483648,r,n);else if(isNaN(t))e(2143289344,r,n);else if(t>34028234663852886e22)e((s<<31|2139095040)>>>0,r,n);else if(t<11754943508222875e-54)e((s<<31|Math.round(t/1401298464324817e-60))>>>0,r,n);else{var i=Math.floor(Math.log(t)/Math.LN2);e((s<<31|i+127<<23|8388607&Math.round(t*Math.pow(2,-i)*8388608))>>>0,r,n)}}function o(e,t,r){var n=e(t,r),s=2*(n>>31)+1,i=n>>>23&255,o=8388607&n;return 255===i?o?NaN:s*(1/0):0===i?1401298464324817e-60*s*o:s*Math.pow(2,i-150)*(o+8388608)}e.writeFloatLE=t.bind(null,r),e.writeFloatBE=t.bind(null,n),e.readFloatLE=o.bind(null,s),e.readFloatBE=o.bind(null,i)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=128===r[7];function s(e,n,s){t[0]=e,n[s]=r[0],n[s+1]=r[1],n[s+2]=r[2],n[s+3]=r[3],n[s+4]=r[4],n[s+5]=r[5],n[s+6]=r[6],n[s+7]=r[7]}function i(e,n,s){t[0]=e,n[s]=r[7],n[s+1]=r[6],n[s+2]=r[5],n[s+3]=r[4],n[s+4]=r[3],n[s+5]=r[2],n[s+6]=r[1],n[s+7]=r[0]}function o(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],r[4]=e[n+4],r[5]=e[n+5],r[6]=e[n+6],r[7]=e[n+7],t[0]}function a(e,n){return r[7]=e[n],r[6]=e[n+1],r[5]=e[n+2],r[4]=e[n+3],r[3]=e[n+4],r[2]=e[n+5],r[1]=e[n+6],r[0]=e[n+7],t[0]}e.writeDoubleLE=n?s:i,e.writeDoubleBE=n?i:s,e.readDoubleLE=n?o:a,e.readDoubleBE=n?a:o}():function(){function t(e,t,r,n,s,i){var o=n<0?1:0;if(o&&(n=-n),0===n)e(0,s,i+t),e(1/n>0?0:2147483648,s,i+r);else if(isNaN(n))e(0,s,i+t),e(2146959360,s,i+r);else if(n>17976931348623157e292)e(0,s,i+t),e((o<<31|2146435072)>>>0,s,i+r);else{var a;if(n<22250738585072014e-324)e((a=n/5e-324)>>>0,s,i+t),e((o<<31|a/4294967296)>>>0,s,i+r);else{var A=Math.floor(Math.log(n)/Math.LN2);1024===A&&(A=1023),e(4503599627370496*(a=n*Math.pow(2,-A))>>>0,s,i+t),e((o<<31|A+1023<<20|1048576*a&1048575)>>>0,s,i+r)}}}function o(e,t,r,n,s){var i=e(n,s+t),o=e(n,s+r),a=2*(o>>31)+1,A=o>>>20&2047,c=4294967296*(1048575&o)+i;return 2047===A?c?NaN:a*(1/0):0===A?5e-324*a*c:a*Math.pow(2,A-1075)*(c+4503599627370496)}e.writeDoubleLE=t.bind(null,r,0,4),e.writeDoubleBE=t.bind(null,n,4,0),e.readDoubleLE=o.bind(null,s,0,4),e.readDoubleBE=o.bind(null,i,4,0)}(),e}function r(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function n(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function s(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function i(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},67199:function(module){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},76662:function(e){"use strict";e.exports=function(e,t,r){var n=r||8192,s=n>>>1,i=null,o=n;return function(r){if(r<1||r>s)return e(r);o+r>n&&(i=e(n),o=0);var a=t.call(i,o,o+=r);return 7&o&&(o=1+(7|o)),a}}},94997:function(e,t){"use strict";var r=t;r.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)(r=e.charCodeAt(n))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},r.read=function(e,t,r){if(r-t<1)return"";for(var n,s=null,i=[],o=0;t<r;)(n=e[t++])<128?i[o++]=n:n>191&&n<224?i[o++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,i[o++]=55296+(n>>10),i[o++]=56320+(1023&n)):i[o++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],o>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,i)),o=0);return s?(o&&s.push(String.fromCharCode.apply(String,i.slice(0,o))),s.join("")):String.fromCharCode.apply(String,i.slice(0,o))},r.write=function(e,t,r){for(var n,s,i=r,o=0;o<e.length;++o)(n=e.charCodeAt(o))<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296==(64512&n)&&56320==(64512&(s=e.charCodeAt(o+1)))?(n=65536+((1023&n)<<10)+(1023&s),++o,t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128);return r-i}},98099:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(97117);function s(e,t,r){return void 0===t&&(t=new Uint8Array(2)),void 0===r&&(r=0),t[r+0]=e>>>8,t[r+1]=e>>>0,t}function i(e,t,r){return void 0===t&&(t=new Uint8Array(2)),void 0===r&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t}function o(e,t){return void 0===t&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function a(e,t){return void 0===t&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}function A(e,t){return void 0===t&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}function c(e,t){return void 0===t&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}function l(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),t[r+0]=e>>>24,t[r+1]=e>>>16,t[r+2]=e>>>8,t[r+3]=e>>>0,t}function u(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24,t}function h(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),l(e/4294967296>>>0,t,r),l(e>>>0,t,r+4),t}function d(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),u(e>>>0,t,r),u(e/4294967296>>>0,t,r+4),t}t.readInt16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16},t.readUint16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])>>>0},t.readInt16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])<<16>>16},t.readUint16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])>>>0},t.writeUint16BE=s,t.writeInt16BE=s,t.writeUint16LE=i,t.writeInt16LE=i,t.readInt32BE=o,t.readUint32BE=a,t.readInt32LE=A,t.readUint32LE=c,t.writeUint32BE=l,t.writeInt32BE=l,t.writeUint32LE=u,t.writeInt32LE=u,t.readInt64BE=function(e,t){void 0===t&&(t=0);var r=o(e,t),n=o(e,t+4);return 4294967296*r+n-4294967296*(n>>31)},t.readUint64BE=function(e,t){return void 0===t&&(t=0),4294967296*a(e,t)+a(e,t+4)},t.readInt64LE=function(e,t){void 0===t&&(t=0);var r=A(e,t);return 4294967296*A(e,t+4)+r-4294967296*(r>>31)},t.readUint64LE=function(e,t){void 0===t&&(t=0);var r=c(e,t);return 4294967296*c(e,t+4)+r},t.writeUint64BE=h,t.writeInt64BE=h,t.writeUint64LE=d,t.writeInt64LE=d,t.readUintBE=function(e,t,r){if(void 0===r&&(r=0),e%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,s=1,i=e/8+r-1;i>=r;i--)n+=t[i]*s,s*=256;return n},t.readUintLE=function(e,t,r){if(void 0===r&&(r=0),e%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,s=1,i=r;i<r+e/8;i++)n+=t[i]*s,s*=256;return n},t.writeUintBE=function(e,t,r,s){if(void 0===r&&(r=new Uint8Array(e/8)),void 0===s&&(s=0),e%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!n.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var i=1,o=e/8+s-1;o>=s;o--)r[o]=t/i&255,i*=256;return r},t.writeUintLE=function(e,t,r,s){if(void 0===r&&(r=new Uint8Array(e/8)),void 0===s&&(s=0),e%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!n.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var i=1,o=s;o<s+e/8;o++)r[o]=t/i&255,i*=256;return r},t.readFloat32BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t)},t.readFloat32LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!0)},t.readFloat64BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t)},t.readFloat64LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!0)},t.writeFloat32BE=function(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(r,e),t},t.writeFloat32LE=function(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(r,e,!0),t},t.writeFloat64BE=function(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(r,e),t},t.writeFloat64LE=function(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(r,e,!0),t}},25439:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(98099),s=r(17309);function i(e,t,r){for(var s=1634760805,i=857760878,o=2036477234,a=1797285236,A=r[3]<<24|r[2]<<16|r[1]<<8|r[0],c=r[7]<<24|r[6]<<16|r[5]<<8|r[4],l=r[11]<<24|r[10]<<16|r[9]<<8|r[8],u=r[15]<<24|r[14]<<16|r[13]<<8|r[12],h=r[19]<<24|r[18]<<16|r[17]<<8|r[16],d=r[23]<<24|r[22]<<16|r[21]<<8|r[20],f=r[27]<<24|r[26]<<16|r[25]<<8|r[24],p=r[31]<<24|r[30]<<16|r[29]<<8|r[28],g=t[3]<<24|t[2]<<16|t[1]<<8|t[0],y=t[7]<<24|t[6]<<16|t[5]<<8|t[4],w=t[11]<<24|t[10]<<16|t[9]<<8|t[8],m=t[15]<<24|t[14]<<16|t[13]<<8|t[12],b=s,E=i,v=o,B=a,_=A,C=c,S=l,I=u,T=h,R=d,k=f,U=p,D=g,P=y,L=w,N=m,O=0;O<20;O+=2)_=(_^=T=T+(D=(D^=b=b+_|0)>>>16|D<<16)|0)>>>20|_<<12,C=(C^=R=R+(P=(P^=E=E+C|0)>>>16|P<<16)|0)>>>20|C<<12,S=(S^=k=k+(L=(L^=v=v+S|0)>>>16|L<<16)|0)>>>20|S<<12,I=(I^=U=U+(N=(N^=B=B+I|0)>>>16|N<<16)|0)>>>20|I<<12,S=(S^=k=k+(L=(L^=v=v+S|0)>>>24|L<<8)|0)>>>25|S<<7,I=(I^=U=U+(N=(N^=B=B+I|0)>>>24|N<<8)|0)>>>25|I<<7,C=(C^=R=R+(P=(P^=E=E+C|0)>>>24|P<<8)|0)>>>25|C<<7,_=(_^=T=T+(D=(D^=b=b+_|0)>>>24|D<<8)|0)>>>25|_<<7,C=(C^=k=k+(N=(N^=b=b+C|0)>>>16|N<<16)|0)>>>20|C<<12,S=(S^=U=U+(D=(D^=E=E+S|0)>>>16|D<<16)|0)>>>20|S<<12,I=(I^=T=T+(P=(P^=v=v+I|0)>>>16|P<<16)|0)>>>20|I<<12,_=(_^=R=R+(L=(L^=B=B+_|0)>>>16|L<<16)|0)>>>20|_<<12,I=(I^=T=T+(P=(P^=v=v+I|0)>>>24|P<<8)|0)>>>25|I<<7,_=(_^=R=R+(L=(L^=B=B+_|0)>>>24|L<<8)|0)>>>25|_<<7,S=(S^=U=U+(D=(D^=E=E+S|0)>>>24|D<<8)|0)>>>25|S<<7,C=(C^=k=k+(N=(N^=b=b+C|0)>>>24|N<<8)|0)>>>25|C<<7;n.writeUint32LE(b+s|0,e,0),n.writeUint32LE(E+i|0,e,4),n.writeUint32LE(v+o|0,e,8),n.writeUint32LE(B+a|0,e,12),n.writeUint32LE(_+A|0,e,16),n.writeUint32LE(C+c|0,e,20),n.writeUint32LE(S+l|0,e,24),n.writeUint32LE(I+u|0,e,28),n.writeUint32LE(T+h|0,e,32),n.writeUint32LE(R+d|0,e,36),n.writeUint32LE(k+f|0,e,40),n.writeUint32LE(U+p|0,e,44),n.writeUint32LE(D+g|0,e,48),n.writeUint32LE(P+y|0,e,52),n.writeUint32LE(L+w|0,e,56),n.writeUint32LE(N+m|0,e,60)}function o(e,t,r,n,o){if(void 0===o&&(o=0),32!==e.length)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var A,c;if(0===o){if(8!==t.length&&12!==t.length)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=(A=new Uint8Array(16)).length-t.length,A.set(t,c)}else{if(16!==t.length)throw new Error("ChaCha nonce with counter must be 16 bytes");A=t,c=o}for(var l=new Uint8Array(64),u=0;u<r.length;u+=64){i(l,A,e);for(var h=u;h<u+64&&h<r.length;h++)n[h]=r[h]^l[h-u];a(A,0,c)}return s.wipe(l),0===o&&s.wipe(A),n}function a(e,t,r){for(var n=1;r--;)n=n+(255&e[t])|0,e[t]=255&n,n>>>=8,t++;if(n>0)throw new Error("ChaCha: counter overflow")}t.streamXOR=o,t.stream=function(e,t,r,n){return void 0===n&&(n=0),s.wipe(r),o(e,t,r,r,n)}},15501:function(e,t,r){"use strict";var n=r(25439),s=r(63027),i=r(17309),o=r(98099),a=r(4153);t.Cv=32,t.WH=12,t.pg=16;var A=new Uint8Array(16),c=function(){function e(e){if(this.nonceLength=t.WH,this.tagLength=t.pg,e.length!==t.Cv)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return e.prototype.seal=function(e,t,r,s){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var o=new Uint8Array(16);o.set(e,o.length-e.length);var a=new Uint8Array(32);n.stream(this._key,o,a,4);var A,c=t.length+this.tagLength;if(s){if(s.length!==c)throw new Error("ChaCha20Poly1305: incorrect destination length");A=s}else A=new Uint8Array(c);return n.streamXOR(this._key,o,t,A,4),this._authenticate(A.subarray(A.length-this.tagLength,A.length),a,A.subarray(0,A.length-this.tagLength),r),i.wipe(o),A},e.prototype.open=function(e,t,r,s){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(t.length<this.tagLength)return null;var o=new Uint8Array(16);o.set(e,o.length-e.length);var A=new Uint8Array(32);n.stream(this._key,o,A,4);var c=new Uint8Array(this.tagLength);if(this._authenticate(c,A,t.subarray(0,t.length-this.tagLength),r),!a.equal(c,t.subarray(t.length-this.tagLength,t.length)))return null;var l,u=t.length-this.tagLength;if(s){if(s.length!==u)throw new Error("ChaCha20Poly1305: incorrect destination length");l=s}else l=new Uint8Array(u);return n.streamXOR(this._key,o,t.subarray(0,t.length-this.tagLength),l,4),i.wipe(o),l},e.prototype.clean=function(){return i.wipe(this._key),this},e.prototype._authenticate=function(e,t,r,n){var a=new s.Poly1305(t);n&&(a.update(n),n.length%16>0&&a.update(A.subarray(n.length%16))),a.update(r),r.length%16>0&&a.update(A.subarray(r.length%16));var c=new Uint8Array(8);n&&o.writeUint64LE(n.length,c),a.update(c),o.writeUint64LE(r.length,c),a.update(c);for(var l=a.digest(),u=0;u<l.length;u++)e[u]=l[u];a.clean(),i.wipe(l),i.wipe(c)},e}();t.OK=c},4153:function(e,t){"use strict";function r(e,t){if(e.length!==t.length)return 0;for(var r=0,n=0;n<e.length;n++)r|=e[n]^t[n];return 1&r-1>>>8}Object.defineProperty(t,"__esModule",{value:!0}),t.select=function(e,t,r){return~(e-1)&t|e-1&r},t.lessOrEqual=function(e,t){return(0|e)-(0|t)-1>>>31&1},t.compare=r,t.equal=function(e,t){return 0!==e.length&&0!==t.length&&0!==r(e,t)}},79984:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializableHash=function(e){return void 0!==e.saveState&&void 0!==e.restoreState&&void 0!==e.cleanSavedState}},512:function(e,t,r){"use strict";var n=r(25629),s=r(17309),i=function(){function e(e,t,r,s){void 0===r&&(r=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=s;var i=n.hmac(this._hash,r,t);this._hmac=new n.HMAC(e,i),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return e.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(0===e)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},e.prototype.expand=function(e){for(var t=new Uint8Array(e),r=0;r<t.length;r++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[r]=this._buffer[this._bufpos++];return t},e.prototype.clean=function(){this._hmac.clean(),s.wipe(this._buffer),s.wipe(this._counter),this._bufpos=0},e}();t.t=i},25629:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(79984),s=r(4153),i=r(17309),o=function(){function e(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var r=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(r).clean():r.set(t);for(var s=0;s<r.length;s++)r[s]^=54;this._inner.update(r);for(s=0;s<r.length;s++)r[s]^=106;this._outer.update(r),n.isSerializableHash(this._inner)&&n.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),i.wipe(r)}return e.prototype.reset=function(){if(!n.isSerializableHash(this._inner)||!n.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.clean=function(){n.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),n.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},e.prototype.update=function(e){return this._inner.update(e),this},e.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e.prototype.saveState=function(){if(!n.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},e.prototype.restoreState=function(e){if(!n.isSerializableHash(this._inner)||!n.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.cleanSavedState=function(e){if(!n.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},e}();t.HMAC=o,t.hmac=function(e,t,r){var n=new o(e,t);n.update(r);var s=n.digest();return n.clean(),s},t.equal=s.equal},97117:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mul=Math.imul||function(e,t){var r=65535&e,n=65535&t;return r*n+((e>>>16&65535)*n+r*(t>>>16&65535)<<16>>>0)|0},t.add=function(e,t){return e+t|0},t.sub=function(e,t){return e-t|0},t.rotl=function(e,t){return e<<t|e>>>32-t},t.rotr=function(e,t){return e<<32-t|e>>>t},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(e){return t.isInteger(e)&&e>=-t.MAX_SAFE_INTEGER&&e<=t.MAX_SAFE_INTEGER}},63027:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4153),s=r(17309);t.DIGEST_LENGTH=16;var i=function(){function e(e){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var r=e[0]|e[1]<<8;this._r[0]=8191&r;var n=e[2]|e[3]<<8;this._r[1]=8191&(r>>>13|n<<3);var s=e[4]|e[5]<<8;this._r[2]=7939&(n>>>10|s<<6);var i=e[6]|e[7]<<8;this._r[3]=8191&(s>>>7|i<<9);var o=e[8]|e[9]<<8;this._r[4]=255&(i>>>4|o<<12),this._r[5]=o>>>1&8190;var a=e[10]|e[11]<<8;this._r[6]=8191&(o>>>14|a<<2);var A=e[12]|e[13]<<8;this._r[7]=8065&(a>>>11|A<<5);var c=e[14]|e[15]<<8;this._r[8]=8191&(A>>>8|c<<8),this._r[9]=c>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return e.prototype._blocks=function(e,t,r){for(var n=this._fin?0:2048,s=this._h[0],i=this._h[1],o=this._h[2],a=this._h[3],A=this._h[4],c=this._h[5],l=this._h[6],u=this._h[7],h=this._h[8],d=this._h[9],f=this._r[0],p=this._r[1],g=this._r[2],y=this._r[3],w=this._r[4],m=this._r[5],b=this._r[6],E=this._r[7],v=this._r[8],B=this._r[9];r>=16;){var _=e[t+0]|e[t+1]<<8;s+=8191&_;var C=e[t+2]|e[t+3]<<8;i+=8191&(_>>>13|C<<3);var S=e[t+4]|e[t+5]<<8;o+=8191&(C>>>10|S<<6);var I=e[t+6]|e[t+7]<<8;a+=8191&(S>>>7|I<<9);var T=e[t+8]|e[t+9]<<8;A+=8191&(I>>>4|T<<12),c+=T>>>1&8191;var R=e[t+10]|e[t+11]<<8;l+=8191&(T>>>14|R<<2);var k=e[t+12]|e[t+13]<<8;u+=8191&(R>>>11|k<<5);var U=e[t+14]|e[t+15]<<8,D=0,P=D;P+=s*f,P+=i*(5*B),P+=o*(5*v),P+=a*(5*E),D=(P+=A*(5*b))>>>13,P&=8191,P+=c*(5*m),P+=l*(5*w),P+=u*(5*y),P+=(h+=8191&(k>>>8|U<<8))*(5*g);var L=D+=(P+=(d+=U>>>5|n)*(5*p))>>>13;L+=s*p,L+=i*f,L+=o*(5*B),L+=a*(5*v),D=(L+=A*(5*E))>>>13,L&=8191,L+=c*(5*b),L+=l*(5*m),L+=u*(5*w),L+=h*(5*y),D+=(L+=d*(5*g))>>>13,L&=8191;var N=D;N+=s*g,N+=i*p,N+=o*f,N+=a*(5*B),D=(N+=A*(5*v))>>>13,N&=8191,N+=c*(5*E),N+=l*(5*b),N+=u*(5*m),N+=h*(5*w);var O=D+=(N+=d*(5*y))>>>13;O+=s*y,O+=i*g,O+=o*p,O+=a*f,D=(O+=A*(5*B))>>>13,O&=8191,O+=c*(5*v),O+=l*(5*E),O+=u*(5*b),O+=h*(5*m);var F=D+=(O+=d*(5*w))>>>13;F+=s*w,F+=i*y,F+=o*g,F+=a*p,D=(F+=A*f)>>>13,F&=8191,F+=c*(5*B),F+=l*(5*v),F+=u*(5*E),F+=h*(5*b);var Q=D+=(F+=d*(5*m))>>>13;Q+=s*m,Q+=i*w,Q+=o*y,Q+=a*g,D=(Q+=A*p)>>>13,Q&=8191,Q+=c*f,Q+=l*(5*B),Q+=u*(5*v),Q+=h*(5*E);var x=D+=(Q+=d*(5*b))>>>13;x+=s*b,x+=i*m,x+=o*w,x+=a*y,D=(x+=A*g)>>>13,x&=8191,x+=c*p,x+=l*f,x+=u*(5*B),x+=h*(5*v);var M=D+=(x+=d*(5*E))>>>13;M+=s*E,M+=i*b,M+=o*m,M+=a*w,D=(M+=A*y)>>>13,M&=8191,M+=c*g,M+=l*p,M+=u*f,M+=h*(5*B);var H=D+=(M+=d*(5*v))>>>13;H+=s*v,H+=i*E,H+=o*b,H+=a*m,D=(H+=A*w)>>>13,H&=8191,H+=c*y,H+=l*g,H+=u*p,H+=h*f;var K=D+=(H+=d*(5*B))>>>13;K+=s*B,K+=i*v,K+=o*E,K+=a*b,D=(K+=A*m)>>>13,K&=8191,K+=c*w,K+=l*y,K+=u*g,K+=h*p,s=P=8191&(D=(D=((D+=(K+=d*f)>>>13)<<2)+D|0)+(P&=8191)|0),i=L+=D>>>=13,o=N&=8191,a=O&=8191,A=F&=8191,c=Q&=8191,l=x&=8191,u=M&=8191,h=H&=8191,d=K&=8191,t+=16,r-=16}this._h[0]=s,this._h[1]=i,this._h[2]=o,this._h[3]=a,this._h[4]=A,this._h[5]=c,this._h[6]=l,this._h[7]=u,this._h[8]=h,this._h[9]=d},e.prototype.finish=function(e,t){void 0===t&&(t=0);var r,n,s,i,o=new Uint16Array(10);if(this._leftover){for(i=this._leftover,this._buffer[i++]=1;i<16;i++)this._buffer[i]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(r=this._h[1]>>>13,this._h[1]&=8191,i=2;i<10;i++)this._h[i]+=r,r=this._h[i]>>>13,this._h[i]&=8191;for(this._h[0]+=5*r,r=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=r,r=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=r,o[0]=this._h[0]+5,r=o[0]>>>13,o[0]&=8191,i=1;i<10;i++)o[i]=this._h[i]+r,r=o[i]>>>13,o[i]&=8191;for(o[9]-=8192,n=(1^r)-1,i=0;i<10;i++)o[i]&=n;for(n=~n,i=0;i<10;i++)this._h[i]=this._h[i]&n|o[i];for(this._h[0]=65535&(this._h[0]|this._h[1]<<13),this._h[1]=65535&(this._h[1]>>>3|this._h[2]<<10),this._h[2]=65535&(this._h[2]>>>6|this._h[3]<<7),this._h[3]=65535&(this._h[3]>>>9|this._h[4]<<4),this._h[4]=65535&(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14),this._h[5]=65535&(this._h[6]>>>2|this._h[7]<<11),this._h[6]=65535&(this._h[7]>>>5|this._h[8]<<8),this._h[7]=65535&(this._h[8]>>>8|this._h[9]<<5),s=this._h[0]+this._pad[0],this._h[0]=65535&s,i=1;i<8;i++)s=(this._h[i]+this._pad[i]|0)+(s>>>16)|0,this._h[i]=65535&s;return e[t+0]=this._h[0]>>>0,e[t+1]=this._h[0]>>>8,e[t+2]=this._h[1]>>>0,e[t+3]=this._h[1]>>>8,e[t+4]=this._h[2]>>>0,e[t+5]=this._h[2]>>>8,e[t+6]=this._h[3]>>>0,e[t+7]=this._h[3]>>>8,e[t+8]=this._h[4]>>>0,e[t+9]=this._h[4]>>>8,e[t+10]=this._h[5]>>>0,e[t+11]=this._h[5]>>>8,e[t+12]=this._h[6]>>>0,e[t+13]=this._h[6]>>>8,e[t+14]=this._h[7]>>>0,e[t+15]=this._h[7]>>>8,this._finished=!0,this},e.prototype.update=function(e){var t,r=0,n=e.length;if(this._leftover){(t=16-this._leftover)>n&&(t=n);for(var s=0;s<t;s++)this._buffer[this._leftover+s]=e[r+s];if(n-=t,r+=t,this._leftover+=t,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(n>=16&&(t=n-n%16,this._blocks(e,r,t),r+=t,n-=t),n){for(s=0;s<n;s++)this._buffer[this._leftover+s]=e[r+s];this._leftover+=n}return this},e.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},e.prototype.clean=function(){return s.wipe(this._buffer),s.wipe(this._r),s.wipe(this._h),s.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},e}();t.Poly1305=i,t.oneTimeAuth=function(e,t){var r=new i(e);r.update(t);var n=r.digest();return r.clean(),n},t.equal=function(e,r){return e.length===t.DIGEST_LENGTH&&r.length===t.DIGEST_LENGTH&&n.equal(e,r)}},31416:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const n=r(46008),s=r(98099),i=r(17309);function o(e,r=t.defaultRandomSource){return r.randomBytes(e)}t.defaultRandomSource=new n.SystemRandomSource,t.randomBytes=o,t.randomUint32=function(e=t.defaultRandomSource){const r=o(4,e),n=(0,s.readUint32LE)(r);return(0,i.wipe)(r),n};const a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function A(e,r=a,n=t.defaultRandomSource){if(r.length<2)throw new Error("randomString charset is too short");if(r.length>256)throw new Error("randomString charset is too long");let s="";const A=r.length,c=256-256%A;for(;e>0;){const t=o(Math.ceil(256*e/c),n);for(let n=0;n<t.length&&e>0;n++){const i=t[n];i<c&&(s+=r.charAt(i%A),e--)}(0,i.wipe)(t)}return s}t.randomString=A,t.randomStringForEntropy=function(e,r=a,n=t.defaultRandomSource){return A(Math.ceil(e/(Math.log(r.length)/Math.LN2)),r,n)}},75455:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserRandomSource=void 0;t.BrowserRandomSource=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e="undefined"!=typeof self?self.crypto||self.msCrypto:null;e&&void 0!==e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let e=0;e<t.length;e+=65536)this._crypto.getRandomValues(t.subarray(e,e+Math.min(t.length-e,65536)));return t}}},58871:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeRandomSource=void 0;const n=r(17309);t.NodeRandomSource=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;{const e=r(35883);e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const r=new Uint8Array(e);for(let e=0;e<r.length;e++)r[e]=t[e];return(0,n.wipe)(t),r}}},46008:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SystemRandomSource=void 0;const n=r(75455),s=r(58871);t.SystemRandomSource=class{constructor(){return this.isAvailable=!1,this.name="",this._source=new n.BrowserRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Browser")):(this._source=new s.NodeRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Node")):void 0)}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}},73294:function(e,t,r){"use strict";var n=r(98099),s=r(17309);t.k=32,t.cn=64;var i=function(){function e(){this.digestLength=t.k,this.blockSize=t.cn,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return e.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},e.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},e.prototype.clean=function(){s.wipe(this._buffer),s.wipe(this._temp),this.reset()},e.prototype.update=function(e,t){if(void 0===t&&(t=e.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var r=0;if(this._bytesHashed+=t,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&t>0;)this._buffer[this._bufferLength++]=e[r++],t--;this._bufferLength===this.blockSize&&(a(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(t>=this.blockSize&&(r=a(this._temp,this._state,e,r,t),t%=this.blockSize);t>0;)this._buffer[this._bufferLength++]=e[r++],t--;return this},e.prototype.finish=function(e){if(!this._finished){var t=this._bytesHashed,r=this._bufferLength,s=t/536870912|0,i=t<<3,o=t%64<56?64:128;this._buffer[r]=128;for(var A=r+1;A<o-8;A++)this._buffer[A]=0;n.writeUint32BE(s,this._buffer,o-8),n.writeUint32BE(i,this._buffer,o-4),a(this._temp,this._state,this._buffer,0,o),this._finished=!0}for(A=0;A<this.digestLength/4;A++)n.writeUint32BE(this._state[A],e,4*A);return this},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},e.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},e.prototype.cleanSavedState=function(e){s.wipe(e.state),e.buffer&&s.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},e}();t.mE=i;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function a(e,t,r,s,i){for(;i>=64;){for(var a=t[0],A=t[1],c=t[2],l=t[3],u=t[4],h=t[5],d=t[6],f=t[7],p=0;p<16;p++){var g=s+4*p;e[p]=n.readUint32BE(r,g)}for(p=16;p<64;p++){var y=e[p-2],w=(y>>>17|y<<15)^(y>>>19|y<<13)^y>>>10,m=((y=e[p-15])>>>7|y<<25)^(y>>>18|y<<14)^y>>>3;e[p]=(w+e[p-7]|0)+(m+e[p-16]|0)}for(p=0;p<64;p++){w=(((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))+(u&h^~u&d)|0)+(f+(o[p]+e[p]|0)|0)|0,m=((a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10))+(a&A^a&c^A&c)|0;f=d,d=h,h=u,u=l+w|0,l=c,c=A,A=a,a=w+m|0}t[0]+=a,t[1]+=A,t[2]+=c,t[3]+=l,t[4]+=u,t[5]+=h,t[6]+=d,t[7]+=f,s+=64,i-=64}return s}t.vp=function(e){var t=new i;t.update(e);var r=t.digest();return t.clean(),r}},17309:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wipe=function(e){for(var t=0;t<e.length;t++)e[t]=0;return e}},57664:function(e,t,r){"use strict";t.gi=t.Au=t._w=t.KS=t.kz=void 0;const n=r(31416),s=r(17309);function i(e){const t=new Float64Array(16);if(e)for(let r=0;r<e.length;r++)t[r]=e[r];return t}t.kz=32,t.KS=32;const o=new Uint8Array(32);o[0]=9;const a=i([56129,1]);function A(e){let t=1;for(let r=0;r<16;r++){let n=e[r]+t+65535;t=Math.floor(n/65536),e[r]=n-65536*t}e[0]+=t-1+37*(t-1)}function c(e,t,r){const n=~(r-1);for(let r=0;r<16;r++){const s=n&(e[r]^t[r]);e[r]^=s,t[r]^=s}}function l(e,t,r){for(let n=0;n<16;n++)e[n]=t[n]+r[n]}function u(e,t,r){for(let n=0;n<16;n++)e[n]=t[n]-r[n]}function h(e,t,r){let n,s,i=0,o=0,a=0,A=0,c=0,l=0,u=0,h=0,d=0,f=0,p=0,g=0,y=0,w=0,m=0,b=0,E=0,v=0,B=0,_=0,C=0,S=0,I=0,T=0,R=0,k=0,U=0,D=0,P=0,L=0,N=0,O=r[0],F=r[1],Q=r[2],x=r[3],M=r[4],H=r[5],K=r[6],V=r[7],z=r[8],j=r[9],G=r[10],$=r[11],q=r[12],W=r[13],Y=r[14],X=r[15];n=t[0],i+=n*O,o+=n*F,a+=n*Q,A+=n*x,c+=n*M,l+=n*H,u+=n*K,h+=n*V,d+=n*z,f+=n*j,p+=n*G,g+=n*$,y+=n*q,w+=n*W,m+=n*Y,b+=n*X,n=t[1],o+=n*O,a+=n*F,A+=n*Q,c+=n*x,l+=n*M,u+=n*H,h+=n*K,d+=n*V,f+=n*z,p+=n*j,g+=n*G,y+=n*$,w+=n*q,m+=n*W,b+=n*Y,E+=n*X,n=t[2],a+=n*O,A+=n*F,c+=n*Q,l+=n*x,u+=n*M,h+=n*H,d+=n*K,f+=n*V,p+=n*z,g+=n*j,y+=n*G,w+=n*$,m+=n*q,b+=n*W,E+=n*Y,v+=n*X,n=t[3],A+=n*O,c+=n*F,l+=n*Q,u+=n*x,h+=n*M,d+=n*H,f+=n*K,p+=n*V,g+=n*z,y+=n*j,w+=n*G,m+=n*$,b+=n*q,E+=n*W,v+=n*Y,B+=n*X,n=t[4],c+=n*O,l+=n*F,u+=n*Q,h+=n*x,d+=n*M,f+=n*H,p+=n*K,g+=n*V,y+=n*z,w+=n*j,m+=n*G,b+=n*$,E+=n*q,v+=n*W,B+=n*Y,_+=n*X,n=t[5],l+=n*O,u+=n*F,h+=n*Q,d+=n*x,f+=n*M,p+=n*H,g+=n*K,y+=n*V,w+=n*z,m+=n*j,b+=n*G,E+=n*$,v+=n*q,B+=n*W,_+=n*Y,C+=n*X,n=t[6],u+=n*O,h+=n*F,d+=n*Q,f+=n*x,p+=n*M,g+=n*H,y+=n*K,w+=n*V,m+=n*z,b+=n*j,E+=n*G,v+=n*$,B+=n*q,_+=n*W,C+=n*Y,S+=n*X,n=t[7],h+=n*O,d+=n*F,f+=n*Q,p+=n*x,g+=n*M,y+=n*H,w+=n*K,m+=n*V,b+=n*z,E+=n*j,v+=n*G,B+=n*$,_+=n*q,C+=n*W,S+=n*Y,I+=n*X,n=t[8],d+=n*O,f+=n*F,p+=n*Q,g+=n*x,y+=n*M,w+=n*H,m+=n*K,b+=n*V,E+=n*z,v+=n*j,B+=n*G,_+=n*$,C+=n*q,S+=n*W,I+=n*Y,T+=n*X,n=t[9],f+=n*O,p+=n*F,g+=n*Q,y+=n*x,w+=n*M,m+=n*H,b+=n*K,E+=n*V,v+=n*z,B+=n*j,_+=n*G,C+=n*$,S+=n*q,I+=n*W,T+=n*Y,R+=n*X,n=t[10],p+=n*O,g+=n*F,y+=n*Q,w+=n*x,m+=n*M,b+=n*H,E+=n*K,v+=n*V,B+=n*z,_+=n*j,C+=n*G,S+=n*$,I+=n*q,T+=n*W,R+=n*Y,k+=n*X,n=t[11],g+=n*O,y+=n*F,w+=n*Q,m+=n*x,b+=n*M,E+=n*H,v+=n*K,B+=n*V,_+=n*z,C+=n*j,S+=n*G,I+=n*$,T+=n*q,R+=n*W,k+=n*Y,U+=n*X,n=t[12],y+=n*O,w+=n*F,m+=n*Q,b+=n*x,E+=n*M,v+=n*H,B+=n*K,_+=n*V,C+=n*z,S+=n*j,I+=n*G,T+=n*$,R+=n*q,k+=n*W,U+=n*Y,D+=n*X,n=t[13],w+=n*O,m+=n*F,b+=n*Q,E+=n*x,v+=n*M,B+=n*H,_+=n*K,C+=n*V,S+=n*z,I+=n*j,T+=n*G,R+=n*$,k+=n*q,U+=n*W,D+=n*Y,P+=n*X,n=t[14],m+=n*O,b+=n*F,E+=n*Q,v+=n*x,B+=n*M,_+=n*H,C+=n*K,S+=n*V,I+=n*z,T+=n*j,R+=n*G,k+=n*$,U+=n*q,D+=n*W,P+=n*Y,L+=n*X,n=t[15],b+=n*O,E+=n*F,v+=n*Q,B+=n*x,_+=n*M,C+=n*H,S+=n*K,I+=n*V,T+=n*z,R+=n*j,k+=n*G,U+=n*$,D+=n*q,P+=n*W,L+=n*Y,N+=n*X,i+=38*E,o+=38*v,a+=38*B,A+=38*_,c+=38*C,l+=38*S,u+=38*I,h+=38*T,d+=38*R,f+=38*k,p+=38*U,g+=38*D,y+=38*P,w+=38*L,m+=38*N,s=1,n=i+s+65535,s=Math.floor(n/65536),i=n-65536*s,n=o+s+65535,s=Math.floor(n/65536),o=n-65536*s,n=a+s+65535,s=Math.floor(n/65536),a=n-65536*s,n=A+s+65535,s=Math.floor(n/65536),A=n-65536*s,n=c+s+65535,s=Math.floor(n/65536),c=n-65536*s,n=l+s+65535,s=Math.floor(n/65536),l=n-65536*s,n=u+s+65535,s=Math.floor(n/65536),u=n-65536*s,n=h+s+65535,s=Math.floor(n/65536),h=n-65536*s,n=d+s+65535,s=Math.floor(n/65536),d=n-65536*s,n=f+s+65535,s=Math.floor(n/65536),f=n-65536*s,n=p+s+65535,s=Math.floor(n/65536),p=n-65536*s,n=g+s+65535,s=Math.floor(n/65536),g=n-65536*s,n=y+s+65535,s=Math.floor(n/65536),y=n-65536*s,n=w+s+65535,s=Math.floor(n/65536),w=n-65536*s,n=m+s+65535,s=Math.floor(n/65536),m=n-65536*s,n=b+s+65535,s=Math.floor(n/65536),b=n-65536*s,i+=s-1+37*(s-1),s=1,n=i+s+65535,s=Math.floor(n/65536),i=n-65536*s,n=o+s+65535,s=Math.floor(n/65536),o=n-65536*s,n=a+s+65535,s=Math.floor(n/65536),a=n-65536*s,n=A+s+65535,s=Math.floor(n/65536),A=n-65536*s,n=c+s+65535,s=Math.floor(n/65536),c=n-65536*s,n=l+s+65535,s=Math.floor(n/65536),l=n-65536*s,n=u+s+65535,s=Math.floor(n/65536),u=n-65536*s,n=h+s+65535,s=Math.floor(n/65536),h=n-65536*s,n=d+s+65535,s=Math.floor(n/65536),d=n-65536*s,n=f+s+65535,s=Math.floor(n/65536),f=n-65536*s,n=p+s+65535,s=Math.floor(n/65536),p=n-65536*s,n=g+s+65535,s=Math.floor(n/65536),g=n-65536*s,n=y+s+65535,s=Math.floor(n/65536),y=n-65536*s,n=w+s+65535,s=Math.floor(n/65536),w=n-65536*s,n=m+s+65535,s=Math.floor(n/65536),m=n-65536*s,n=b+s+65535,s=Math.floor(n/65536),b=n-65536*s,i+=s-1+37*(s-1),e[0]=i,e[1]=o,e[2]=a,e[3]=A,e[4]=c,e[5]=l,e[6]=u,e[7]=h,e[8]=d,e[9]=f,e[10]=p,e[11]=g,e[12]=y,e[13]=w,e[14]=m,e[15]=b}function d(e,t){h(e,t,t)}function f(e,t){const r=new Uint8Array(32),n=new Float64Array(80),s=i(),o=i(),f=i(),p=i(),g=i(),y=i();for(let t=0;t<31;t++)r[t]=e[t];r[31]=127&e[31]|64,r[0]&=248,function(e,t){for(let r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}(n,t);for(let e=0;e<16;e++)o[e]=n[e];s[0]=p[0]=1;for(let e=254;e>=0;--e){const t=r[e>>>3]>>>(7&e)&1;c(s,o,t),c(f,p,t),l(g,s,f),u(s,s,f),l(f,o,p),u(o,o,p),d(p,g),d(y,s),h(s,f,s),h(f,o,g),l(g,s,f),u(s,s,f),d(o,s),u(f,p,y),h(s,f,a),l(s,s,p),h(f,f,s),h(s,p,y),h(p,o,n),d(o,g),c(s,o,t),c(f,p,t)}for(let e=0;e<16;e++)n[e+16]=s[e],n[e+32]=f[e],n[e+48]=o[e],n[e+64]=p[e];const w=n.subarray(32),m=n.subarray(16);!function(e,t){const r=i();for(let e=0;e<16;e++)r[e]=t[e];for(let e=253;e>=0;e--)d(r,r),2!==e&&4!==e&&h(r,r,t);for(let t=0;t<16;t++)e[t]=r[t]}(w,w),h(m,m,w);const b=new Uint8Array(32);return function(e,t){const r=i(),n=i();for(let e=0;e<16;e++)n[e]=t[e];A(n),A(n),A(n);for(let e=0;e<2;e++){r[0]=n[0]-65517;for(let e=1;e<15;e++)r[e]=n[e]-65535-(r[e-1]>>16&1),r[e-1]&=65535;r[15]=n[15]-32767-(r[14]>>16&1);const e=r[15]>>16&1;r[14]&=65535,c(n,r,1-e)}for(let t=0;t<16;t++)e[2*t]=255&n[t],e[2*t+1]=n[t]>>8}(b,m),b}function p(e){return f(e,o)}function g(e){if(e.length!==t.KS)throw new Error(`x25519: seed must be ${t.KS} bytes`);const r=new Uint8Array(e);return{publicKey:p(r),secretKey:r}}t._w=g,t.Au=function(e){const t=(0,n.randomBytes)(32,e),r=g(t);return(0,s.wipe)(t),r},t.gi=function(e,r,n=!1){if(e.length!==t.kz)throw new Error("X25519: incorrect secret key length");if(r.length!==t.kz)throw new Error("X25519: incorrect public key length");const s=f(e,r);if(n){let e=0;for(let t=0;t<s.length;t++)e|=s[t];if(0===e)throw new Error("X25519: invalid shared key")}return s}},32660:function(e,t,r){var n,s=r(34155);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var n=0,s=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(s=n))})),t.splice(s,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==s&&"env"in s&&(e={NODE_ENV:"production",PUBLIC_PATH:"./"}.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(n=!1,function(){n||(n=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||function(){},e.exports=r(64911)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},64911:function(e,t,r){var n=r(861).default;e.exports=function(e){function t(e){var r,n,i,o=null;function a(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];if(a.enabled){var i=a,o=Number(new Date),A=o-(r||o);i.diff=A,i.prev=r,i.curr=o,r=o,n[0]=t.coerce(n[0]),"string"!=typeof n[0]&&n.unshift("%O");var c=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(function(e,r){if("%%"===e)return"%";c++;var s=t.formatters[r];if("function"==typeof s){var o=n[c];e=s.call(i,o),n.splice(c,1),c--}return e})),t.formatArgs.call(i,n);var l=i.log||t.log;l.apply(i,n)}}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=s,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==o?o:(n!==t.namespaces&&(n=t.namespaces,i=t.enabled(e)),i)},set:function(e){o=e}}),"function"==typeof t.init&&t.init(a),a}function s(e,r){var n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){var e=[].concat(n(t.names.map(i)),n(t.skips.map(i).map((function(e){return"-"+e})))).join(",");return t.enable(""),e},t.enable=function(e){var r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),s=n.length;for(r=0;r<s;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(57824),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((function(r){t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var r=0,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},63573:function(e,t){"use strict";const r=Math.exp;e.exports=function(e){if("number"!=typeof e)throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let t,n,s=0,i=0,o=0,a={};return a.push=function(a,A){if(n){const c=1-r(-(a-n)/e),l=A-t;t=c*A+(1-c)*t,s=(1-c)*(s+l*(c*l)),i=Math.sqrt(s),o=t+c*l}else t=A;n=a},a.movingAverage=function(){return t},a.variance=function(){return s},a.deviation=function(){return i},a.forecast=function(){return o},a}},19464:function(e,t,r){"use strict";const{fromCallback:n}=r(16957),s=r(94473),{getCallback:i,getOptions:o}=r(92520),a=Symbol("promise"),A=Symbol("status"),c=Symbol("operations"),l=Symbol("finishClose"),u=Symbol("closeCallbacks");t.AbstractChainedBatch=class{constructor(e){if("object"!=typeof e||null===e){throw new TypeError(`The first argument must be an abstract-level database, received ${null===e?"null":typeof e}`)}this[c]=[],this[u]=[],this[A]="open",this[l]=this[l].bind(this),this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get length(){return this[c].length}put(e,t,r){if("open"!==this[A])throw new s("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const n=this.db._checkKey(e)||this.db._checkValue(t);if(n)throw n;const i=r&&null!=r.sublevel?r.sublevel:this.db,o=r,a=i.keyEncoding(r&&r.keyEncoding),l=i.valueEncoding(r&&r.valueEncoding),u=a.format;r={...r,keyEncoding:u,valueEncoding:l.format},i!==this.db&&(r.sublevel=null);const h=i.prefixKey(a.encode(e),u),d=l.encode(t);return this._put(h,d,r),this[c].push({...o,type:"put",key:e,value:t}),this}_put(e,t,r){}del(e,t){if("open"!==this[A])throw new s("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const r=this.db._checkKey(e);if(r)throw r;const n=t&&null!=t.sublevel?t.sublevel:this.db,i=t,o=n.keyEncoding(t&&t.keyEncoding),a=o.format;return t={...t,keyEncoding:a},n!==this.db&&(t.sublevel=null),this._del(n.prefixKey(o.encode(e),a),t),this[c].push({...i,type:"del",key:e}),this}_del(e,t){}clear(){if("open"!==this[A])throw new s("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[c]=[],this}_clear(){}write(e,t){return t=i(e,t),t=n(t,a),e=o(e),"open"!==this[A]?this.nextTick(t,new s("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):0===this.length?this.close(t):(this[A]="writing",this._write(e,(e=>{this[A]="closing",this[u].push((()=>t(e))),e||this.db.emit("batch",this[c]),this._close(this[l])}))),t[a]}_write(e,t){}close(e){return e=n(e,a),"closing"===this[A]?this[u].push(e):"closed"===this[A]?this.nextTick(e):(this[u].push(e),"writing"!==this[A]&&(this[A]="closing",this._close(this[l]))),e[a]}_close(e){this.nextTick(e)}[l](){this[A]="closed",this.db.detachResource(this);const e=this[u];this[u]=[];for(const t of e)t()}}},33961:function(e,t,r){"use strict";const{fromCallback:n}=r(16957),s=r(94473),{getOptions:i,getCallback:o}=r(92520),a=Symbol("promise"),A=Symbol("callback"),c=Symbol("working"),l=Symbol("handleOne"),u=Symbol("handleMany"),h=Symbol("autoClose"),d=Symbol("finishWork"),f=Symbol("returnMany"),p=Symbol("closing"),g=Symbol("handleClose"),y=Symbol("closed"),w=Symbol("closeCallbacks"),m=Symbol("keyEncoding"),b=Symbol("valueEncoding"),E=Symbol("abortOnClose"),v=Symbol("legacy"),B=Symbol("keys"),_=Symbol("values"),C=Symbol("limit"),S=Symbol("count"),I=Object.freeze({}),T=()=>{};let R=!1;class k{constructor(e,t,r){if("object"!=typeof e||null===e){throw new TypeError(`The first argument must be an abstract-level database, received ${null===e?"null":typeof e}`)}if("object"!=typeof t||null===t)throw new TypeError("The second argument must be an options object");this[y]=!1,this[w]=[],this[c]=!1,this[p]=!1,this[h]=!1,this[A]=null,this[l]=this[l].bind(this),this[u]=this[u].bind(this),this[g]=this[g].bind(this),this[m]=t[m],this[b]=t[b],this[v]=r,this[C]=Number.isInteger(t.limit)&&t.limit>=0?t.limit:1/0,this[S]=0,this[E]=!!t.abortOnClose,this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get count(){return this[S]}get limit(){return this[C]}next(e){let t;if(void 0===e)t=new Promise(((t,r)=>{e=(e,n,s)=>{e?r(e):this[v]?void 0===n&&void 0===s?t():t([n,s]):t(n)}}));else if("function"!=typeof e)throw new TypeError("Callback must be a function");return this[p]?this.nextTick(e,new s("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[c]?this.nextTick(e,new s("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[c]=!0,this[A]=e,this[S]>=this[C]?this.nextTick(this[l],null):this._next(this[l])),t}_next(e){this.nextTick(e)}nextv(e,t,r){return r=o(t,r),r=n(r,a),t=i(t,I),Number.isInteger(e)?(this[p]?this.nextTick(r,new s("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[c]?this.nextTick(r,new s("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(e<1&&(e=1),this[C]<1/0&&(e=Math.min(e,this[C]-this[S])),this[c]=!0,this[A]=r,e<=0?this.nextTick(this[u],null,[]):this._nextv(e,t,this[u])),r[a]):(this.nextTick(r,new TypeError("The first argument 'size' must be an integer")),r[a])}_nextv(e,t,r){const n=[],s=(t,i,o)=>t?r(t):(this[v]?void 0===i&&void 0===o:void 0===i)?r(null,n):(n.push(this[v]?[i,o]:i),void(n.length===e?r(null,n):this._next(s)));this._next(s)}all(e,t){return t=o(e,t),t=n(t,a),e=i(e,I),this[p]?this.nextTick(t,new s("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[c]?this.nextTick(t,new s("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[c]=!0,this[A]=t,this[h]=!0,this[S]>=this[C]?this.nextTick(this[u],null,[]):this._all(e,this[u])),t[a]}_all(e,t){let r=this[S];const n=[],s=()=>{const e=this[C]<1/0?Math.min(1e3,this[C]-r):1e3;e<=0?this.nextTick(t,null,n):this._nextv(e,I,i)},i=(e,i)=>{e?t(e):0===i.length?t(null,n):(n.push.apply(n,i),r+=i.length,s())};s()}[d](){const e=this[A];return this[E]&&null===e?T:(this[c]=!1,this[A]=null,this[p]&&this._close(this[g]),e)}[f](e,t,r){this[h]?this.close(e.bind(null,t,r)):e(t,r)}seek(e,t){if(t=i(t,I),this[p]);else{if(this[c])throw new s("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const r=this.db.keyEncoding(t.keyEncoding||this[m]),n=r.format;t.keyEncoding!==n&&(t={...t,keyEncoding:n});const s=this.db.prefixKey(r.encode(e),n);this._seek(s,t)}}}_seek(e,t){throw new s("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(e){if(e=n(e,a),this[y])this.nextTick(e);else if(this[p])this[w].push(e);else if(this[p]=!0,this[w].push(e),this[c]){if(this[E]){this[d]()(new s("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))}}else this._close(this[g]);return e[a]}_close(e){this.nextTick(e)}[g](){this[y]=!0,this.db.detachResource(this);const e=this[w];this[w]=[];for(const t of e)t()}async*[Symbol.asyncIterator](){try{let e;for(;void 0!==(e=await this.next());)yield e}finally{this[y]||await this.close()}}}class U extends k{constructor(e,t){super(e,t,!0),this[B]=!1!==t.keys,this[_]=!1!==t.values}[l](e,t,r){const n=this[d]();if(e)return n(e);try{t=this[B]&&void 0!==t?this[m].decode(t):void 0,r=this[_]&&void 0!==r?this[b].decode(r):void 0}catch(e){return n(new D("entry",e))}void 0===t&&void 0===r||this[S]++,n(null,t,r)}[u](e,t){const r=this[d]();if(e)return this[f](r,e);try{for(const e of t){const t=e[0],r=e[1];e[0]=this[B]&&void 0!==t?this[m].decode(t):void 0,e[1]=this[_]&&void 0!==r?this[b].decode(r):void 0}}catch(e){return this[f](r,new D("entries",e))}this[S]+=t.length,this[f](r,null,t)}end(e){return R||"undefined"==typeof console||(R=!0,console.warn(new s("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(e)}}class D extends s{constructor(e,t){super(`Iterator could not decode ${e}`,{code:"LEVEL_DECODE_ERROR",cause:t})}}for(const e of["_ended property","_nexting property","_end method"])Object.defineProperty(U.prototype,e.split(" ")[0],{get(){throw new s(`The ${e} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new s(`The ${e} has been removed`,{code:"LEVEL_LEGACY"})}});U.keyEncoding=m,U.valueEncoding=b,t.AbstractIterator=U,t.AbstractKeyIterator=class extends k{constructor(e,t){super(e,t,!1)}[l](e,t){const r=this[d]();if(e)return r(e);try{t=void 0!==t?this[m].decode(t):void 0}catch(e){return r(new D("key",e))}void 0!==t&&this[S]++,r(null,t)}[u](e,t){const r=this[d]();if(e)return this[f](r,e);try{for(let e=0;e<t.length;e++){const r=t[e];t[e]=void 0!==r?this[m].decode(r):void 0}}catch(e){return this[f](r,new D("keys",e))}this[S]+=t.length,this[f](r,null,t)}},t.AbstractValueIterator=class extends k{constructor(e,t){super(e,t,!1)}[l](e,t){const r=this[d]();if(e)return r(e);try{t=void 0!==t?this[b].decode(t):void 0}catch(e){return r(new D("value",e))}void 0!==t&&this[S]++,r(null,t)}[u](e,t){const r=this[d]();if(e)return this[f](r,e);try{for(let e=0;e<t.length;e++){const r=t[e];t[e]=void 0!==r?this[b].decode(r):void 0}}catch(e){return this[f](r,new D("values",e))}this[S]+=t.length,this[f](r,null,t)}}},69071:function(e,t,r){"use strict";const{supports:n}=r(51675),{Transcoder:s}=r(58499),{EventEmitter:i}=r(17187),{fromCallback:o}=r(16957),a=r(94473),{AbstractIterator:A}=r(33961),{DefaultKeyIterator:c,DefaultValueIterator:l}=r(95429),{DeferredIterator:u,DeferredKeyIterator:h,DeferredValueIterator:d}=r(30593),{DefaultChainedBatch:f}=r(4765),{getCallback:p,getOptions:g}=r(92520),y=r(70056),w=Symbol("promise"),m=Symbol("landed"),b=Symbol("resources"),E=Symbol("closeResources"),v=Symbol("operations"),B=Symbol("undefer"),_=Symbol("deferOpen"),C=Symbol("options"),S=Symbol("status"),I=Symbol("defaultOptions"),T=Symbol("transcoder"),R=Symbol("keyEncoding"),k=Symbol("valueEncoding"),U=()=>{};class D extends i{constructor(e,t){if(super(),"object"!=typeof e||null===e)throw new TypeError("The first argument 'manifest' must be an object");t=g(t);const{keyEncoding:r,valueEncoding:i,passive:o,...a}=t;this[b]=new Set,this[v]=[],this[_]=!0,this[C]=a,this[S]="opening",this.supports=n(e,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:!1!==e.snapshots,permanence:!1!==e.permanence,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:e.encodings||{},events:Object.assign({},e.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[T]=new s(N(this)),this[R]=this[T].encoding(r||"utf8"),this[k]=this[T].encoding(i||"utf8");for(const e of this[T].encodings())this.supports.encodings[e.commonName]||(this.supports.encodings[e.commonName]=!0);this[I]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[R].commonName,valueEncoding:this[k].commonName}),key:Object.freeze({keyEncoding:this[R].commonName})},this.nextTick((()=>{this[_]&&this.open({passive:!1},U)}))}get status(){return this[S]}keyEncoding(e){return this[T].encoding(null!=e?e:this[R])}valueEncoding(e){return this[T].encoding(null!=e?e:this[k])}open(e,t){t=p(e,t),t=o(t,w),(e={...this[C],...g(e)}).createIfMissing=!1!==e.createIfMissing,e.errorIfExists=!!e.errorIfExists;const r=e=>{"closing"===this[S]||"opening"===this[S]?this.once(m,e?()=>r(e):r):"open"!==this[S]?t(new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:e})):t()};return e.passive?"opening"===this[S]?this.once(m,r):this.nextTick(r):"closed"===this[S]||this[_]?(this[_]=!1,this[S]="opening",this.emit("opening"),this._open(e,(e=>{if(e)return this[S]="closed",this[E]((()=>{this.emit(m),r(e)})),void this[B]();this[S]="open",this[B](),this.emit(m),"open"===this[S]&&this.emit("open"),"open"===this[S]&&this.emit("ready"),r()}))):"open"===this[S]?this.nextTick(r):this.once(m,(()=>this.open(e,t))),t[w]}_open(e,t){this.nextTick(t)}close(e){e=o(e,w);const t=r=>{"opening"===this[S]||"closing"===this[S]?this.once(m,r?t(r):t):"closed"!==this[S]?e(new a("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:r})):e()};if("open"===this[S]){this[S]="closing",this.emit("closing");const e=e=>{this[S]="open",this[B](),this.emit(m),t(e)};this[E]((()=>{this._close((r=>{if(r)return e(r);this[S]="closed",this[B](),this.emit(m),"closed"===this[S]&&this.emit("closed"),t()}))}))}else"closed"===this[S]?this.nextTick(t):this.once(m,(()=>this.close(e)));return e[w]}[E](e){if(0===this[b].size)return this.nextTick(e);let t=this[b].size,r=!0;const n=()=>{0==--t&&(r?this.nextTick(e):e())};for(const e of this[b])e.close(n);r=!1,this[b].clear()}_close(e){this.nextTick(e)}get(e,t,r){if(r=p(t,r),r=o(r,w),t=g(t,this[I].entry),"opening"===this[S])return this.defer((()=>this.get(e,t,r))),r[w];if(L(this,r))return r[w];const n=this._checkKey(e);if(n)return this.nextTick(r,n),r[w];const s=this.keyEncoding(t.keyEncoding),i=this.valueEncoding(t.valueEncoding),A=s.format,c=i.format;return t.keyEncoding===A&&t.valueEncoding===c||(t=Object.assign({},t,{keyEncoding:A,valueEncoding:c})),this._get(this.prefixKey(s.encode(e),A),t,((e,t)=>{if(e)return("LEVEL_NOT_FOUND"===e.code||e.notFound||/NotFound/i.test(e))&&(e.code||(e.code="LEVEL_NOT_FOUND"),e.notFound||(e.notFound=!0),e.status||(e.status=404)),r(e);try{t=i.decode(t)}catch(e){return r(new a("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:e}))}r(null,t)})),r[w]}_get(e,t,r){this.nextTick(r,new Error("NotFound"))}getMany(e,t,r){if(r=p(t,r),r=o(r,w),t=g(t,this[I].entry),"opening"===this[S])return this.defer((()=>this.getMany(e,t,r))),r[w];if(L(this,r))return r[w];if(!Array.isArray(e))return this.nextTick(r,new TypeError("The first argument 'keys' must be an array")),r[w];if(0===e.length)return this.nextTick(r,null,[]),r[w];const n=this.keyEncoding(t.keyEncoding),s=this.valueEncoding(t.valueEncoding),i=n.format,A=s.format;t.keyEncoding===i&&t.valueEncoding===A||(t=Object.assign({},t,{keyEncoding:i,valueEncoding:A}));const c=new Array(e.length);for(let t=0;t<e.length;t++){const s=e[t],o=this._checkKey(s);if(o)return this.nextTick(r,o),r[w];c[t]=this.prefixKey(n.encode(s),i)}return this._getMany(c,t,((e,t)=>{if(e)return r(e);try{for(let e=0;e<t.length;e++)void 0!==t[e]&&(t[e]=s.decode(t[e]))}catch(e){return r(new a(`Could not decode one or more of ${t.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:e}))}r(null,t)})),r[w]}_getMany(e,t,r){this.nextTick(r,null,new Array(e.length).fill(void 0))}put(e,t,r,n){if(n=p(r,n),n=o(n,w),r=g(r,this[I].entry),"opening"===this[S])return this.defer((()=>this.put(e,t,r,n))),n[w];if(L(this,n))return n[w];const s=this._checkKey(e)||this._checkValue(t);if(s)return this.nextTick(n,s),n[w];const i=this.keyEncoding(r.keyEncoding),a=this.valueEncoding(r.valueEncoding),A=i.format,c=a.format;r.keyEncoding===A&&r.valueEncoding===c||(r=Object.assign({},r,{keyEncoding:A,valueEncoding:c}));const l=this.prefixKey(i.encode(e),A),u=a.encode(t);return this._put(l,u,r,(r=>{if(r)return n(r);this.emit("put",e,t),n()})),n[w]}_put(e,t,r,n){this.nextTick(n)}del(e,t,r){if(r=p(t,r),r=o(r,w),t=g(t,this[I].key),"opening"===this[S])return this.defer((()=>this.del(e,t,r))),r[w];if(L(this,r))return r[w];const n=this._checkKey(e);if(n)return this.nextTick(r,n),r[w];const s=this.keyEncoding(t.keyEncoding),i=s.format;return t.keyEncoding!==i&&(t=Object.assign({},t,{keyEncoding:i})),this._del(this.prefixKey(s.encode(e),i),t,(t=>{if(t)return r(t);this.emit("del",e),r()})),r[w]}_del(e,t,r){this.nextTick(r)}batch(e,t,r){if(!arguments.length){if("opening"===this[S])return new f(this);if("open"!==this[S])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(r="function"==typeof e?e:p(t,r),r=o(r,w),t=g(t,this[I].empty),"opening"===this[S])return this.defer((()=>this.batch(e,t,r))),r[w];if(L(this,r))return r[w];if(!Array.isArray(e))return this.nextTick(r,new TypeError("The first argument 'operations' must be an array")),r[w];if(0===e.length)return this.nextTick(r),r[w];const n=new Array(e.length),{keyEncoding:s,valueEncoding:i,...A}=t;for(let t=0;t<e.length;t++){if("object"!=typeof e[t]||null===e[t])return this.nextTick(r,new TypeError("A batch operation must be an object")),r[w];const o=Object.assign({},e[t]);if("put"!==o.type&&"del"!==o.type)return this.nextTick(r,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),r[w];const a=this._checkKey(o.key);if(a)return this.nextTick(r,a),r[w];const A=null!=o.sublevel?o.sublevel:this,c=A.keyEncoding(o.keyEncoding||s),l=c.format;if(o.key=A.prefixKey(c.encode(o.key),l),o.keyEncoding=l,"put"===o.type){const e=this._checkValue(o.value);if(e)return this.nextTick(r,e),r[w];const t=A.valueEncoding(o.valueEncoding||i);o.value=t.encode(o.value),o.valueEncoding=t.format}A!==this&&(o.sublevel=null),n[t]=o}return this._batch(n,A,(t=>{if(t)return r(t);this.emit("batch",e),r()})),r[w]}_batch(e,t,r){this.nextTick(r)}sublevel(e,t){return this._sublevel(e,P.defaults(t))}_sublevel(e,t){return new P(this,e,t)}prefixKey(e,t){return e}clear(e,t){if(t=p(e,t),t=o(t,w),e=g(e,this[I].empty),"opening"===this[S])return this.defer((()=>this.clear(e,t))),t[w];if(L(this,t))return t[w];const r=e,n=this.keyEncoding(e.keyEncoding);return(e=y(e,n)).keyEncoding=n.format,0===e.limit?this.nextTick(t):this._clear(e,(e=>{if(e)return t(e);this.emit("clear",r),t()})),t[w]}_clear(e,t){this.nextTick(t)}iterator(e){const t=this.keyEncoding(e&&e.keyEncoding),r=this.valueEncoding(e&&e.valueEncoding);if((e=y(e,t)).keys=!1!==e.keys,e.values=!1!==e.values,e[A.keyEncoding]=t,e[A.valueEncoding]=r,e.keyEncoding=t.format,e.valueEncoding=r.format,"opening"===this[S])return new u(this,e);if("open"!==this[S])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(e)}_iterator(e){return new A(this,e)}keys(e){const t=this.keyEncoding(e&&e.keyEncoding),r=this.valueEncoding(e&&e.valueEncoding);if((e=y(e,t))[A.keyEncoding]=t,e[A.valueEncoding]=r,e.keyEncoding=t.format,e.valueEncoding=r.format,"opening"===this[S])return new h(this,e);if("open"!==this[S])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(e)}_keys(e){return new c(this,e)}values(e){const t=this.keyEncoding(e&&e.keyEncoding),r=this.valueEncoding(e&&e.valueEncoding);if((e=y(e,t))[A.keyEncoding]=t,e[A.valueEncoding]=r,e.keyEncoding=t.format,e.valueEncoding=r.format,"opening"===this[S])return new d(this,e);if("open"!==this[S])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(e)}_values(e){return new l(this,e)}defer(e){if("function"!=typeof e)throw new TypeError("The first argument must be a function");this[v].push(e)}[B](){if(0===this[v].length)return;const e=this[v];this[v]=[];for(const t of e)t()}attachResource(e){if("object"!=typeof e||null===e||"function"!=typeof e.close)throw new TypeError("The first argument must be a resource object");this[b].add(e)}detachResource(e){this[b].delete(e)}_chainedBatch(){return new f(this)}_checkKey(e){if(null==e)return new a("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(e){if(null==e)return new a("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}}D.prototype.nextTick=r(56909);const{AbstractSublevel:P}=r(59650)({AbstractLevel:D});t.AbstractLevel=D,t.AbstractSublevel=P;const L=function(e,t){return"open"!==e[S]&&(e.nextTick(t,new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0)},N=function(e){return Object.keys(e.supports.encodings).filter((t=>!!e.supports.encodings[t]))}},50875:function(e,t,r){"use strict";t.AbstractLevel=r(69071).AbstractLevel,t.AbstractSublevel=r(69071).AbstractSublevel,t.AbstractIterator=r(33961).AbstractIterator,t.AbstractKeyIterator=r(33961).AbstractKeyIterator,t.AbstractValueIterator=r(33961).AbstractValueIterator,t.AbstractChainedBatch=r(19464).AbstractChainedBatch},82970:function(e,t,r){"use strict";const{AbstractIterator:n,AbstractKeyIterator:s,AbstractValueIterator:i}=r(33961),o=Symbol("unfix"),a=Symbol("iterator"),A=Symbol("handleOne"),c=Symbol("handleMany"),l=Symbol("callback");class u extends n{constructor(e,t,r,n){super(e,t),this[a]=r,this[o]=n,this[A]=this[A].bind(this),this[c]=this[c].bind(this),this[l]=null}[A](e,t,r){const n=this[l];if(e)return n(e);void 0!==t&&(t=this[o](t)),n(e,t,r)}[c](e,t){const r=this[l];if(e)return r(e);for(const e of t){const t=e[0];void 0!==t&&(e[0]=this[o](t))}r(e,t)}}class h extends s{constructor(e,t,r,n){super(e,t),this[a]=r,this[o]=n,this[A]=this[A].bind(this),this[c]=this[c].bind(this),this[l]=null}[A](e,t){const r=this[l];if(e)return r(e);void 0!==t&&(t=this[o](t)),r(e,t)}[c](e,t){const r=this[l];if(e)return r(e);for(let e=0;e<t.length;e++){const r=t[e];void 0!==r&&(t[e]=this[o](r))}r(e,t)}}class d extends i{constructor(e,t,r){super(e,t),this[a]=r}}for(const e of[u,h])e.prototype._next=function(e){this[l]=e,this[a].next(this[A])},e.prototype._nextv=function(e,t,r){this[l]=r,this[a].nextv(e,t,this[c])},e.prototype._all=function(e,t){this[l]=t,this[a].all(e,this[c])};for(const e of[d])e.prototype._next=function(e){this[a].next(e)},e.prototype._nextv=function(e,t,r){this[a].nextv(e,t,r)},e.prototype._all=function(e,t){this[a].all(e,t)};for(const e of[u,h,d])e.prototype._seek=function(e,t){this[a].seek(e,t)},e.prototype._close=function(e){this[a].close(e)};t.AbstractSublevelIterator=u,t.AbstractSublevelKeyIterator=h,t.AbstractSublevelValueIterator=d},59650:function(e,t,r){"use strict";const n=r(94473),{Buffer:s}=r(96451)||{},{AbstractSublevelIterator:i,AbstractSublevelKeyIterator:o,AbstractSublevelValueIterator:a}=r(82970),A=Symbol("prefix"),c=Symbol("upperBound"),l=Symbol("prefixRange"),u=Symbol("parent"),h=Symbol("unfix"),d=new TextEncoder,f={separator:"!"};e.exports=function({AbstractLevel:e}){class t extends e{static defaults(e){if("string"==typeof e)throw new n("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(e&&e.open)throw new n("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return null==e?f:e.separator?e:{...e,separator:"!"}}constructor(e,r,s){const{separator:i,manifest:o,...a}=t.defaults(s);r=m(r,i);const l=i.charCodeAt(0)+1,f=e[u]||e;if(!d.encode(r).every((e=>e>l&&e<127)))throw new n(`Prefix must use bytes > ${l} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(p(f,o),a);const g=(e.prefix||"")+i+r+i,b=g.slice(0,-1)+String.fromCharCode(l);this[u]=f,this[A]=new y(g),this[c]=new y(b),this[h]=new w,this.nextTick=f.nextTick}prefixKey(e,t){if("utf8"===t)return this[A].utf8+e;if(0===e.byteLength)return this[A][t];if("view"===t){const t=this[A].view,r=new Uint8Array(t.byteLength+e.byteLength);return r.set(t,0),r.set(e,t.byteLength),r}{const t=this[A].buffer;return s.concat([t,e],t.byteLength+e.byteLength)}}[l](e,t){void 0!==e.gte?e.gte=this.prefixKey(e.gte,t):void 0!==e.gt?e.gt=this.prefixKey(e.gt,t):e.gte=this[A][t],void 0!==e.lte?e.lte=this.prefixKey(e.lte,t):void 0!==e.lt?e.lt=this.prefixKey(e.lt,t):e.lte=this[c][t]}get prefix(){return this[A].utf8}get db(){return this[u]}_open(e,t){this[u].open({passive:!0},t)}_put(e,t,r,n){this[u].put(e,t,r,n)}_get(e,t,r){this[u].get(e,t,r)}_getMany(e,t,r){this[u].getMany(e,t,r)}_del(e,t,r){this[u].del(e,t,r)}_batch(e,t,r){this[u].batch(e,t,r)}_clear(e,t){this[l](e,e.keyEncoding),this[u].clear(e,t)}_iterator(e){this[l](e,e.keyEncoding);const t=this[u].iterator(e),r=this[h].get(this[A].utf8.length,e.keyEncoding);return new i(this,e,t,r)}_keys(e){this[l](e,e.keyEncoding);const t=this[u].keys(e),r=this[h].get(this[A].utf8.length,e.keyEncoding);return new o(this,e,t,r)}_values(e){this[l](e,e.keyEncoding);const t=this[u].values(e);return new a(this,e,t)}}return{AbstractSublevel:t}};const p=function(e,t){return{...e.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...t,encodings:{utf8:g(e,"utf8"),buffer:g(e,"buffer"),view:g(e,"view")}}},g=function(e,t){return!!e.supports.encodings[t]&&e.keyEncoding(t).name===t};class y{constructor(e){this.utf8=e,this.view=d.encode(e),this.buffer=s?s.from(this.view.buffer,0,this.view.byteLength):{}}}class w{constructor(){this.cache=new Map}get(e,t){let r=this.cache.get(t);return void 0===r&&(r="view"===t?function(e,t){return t.subarray(e)}.bind(null,e):function(e,t){return t.slice(e)}.bind(null,e),this.cache.set(t,r)),r}}const m=function(e,t){let r=0,n=e.length;for(;r<n&&e[r]===t;)r++;for(;n>r&&e[n-1]===t;)n--;return e.slice(r,n)}},92520:function(e,t){"use strict";t.getCallback=function(e,t){return"function"==typeof e?e:t},t.getOptions=function(e,t){return"object"==typeof e&&null!==e?e:void 0!==t?t:{}}},4765:function(e,t,r){"use strict";const{AbstractChainedBatch:n}=r(19464),s=r(94473),i=Symbol("encoded");t.DefaultChainedBatch=class extends n{constructor(e){super(e),this[i]=[]}_put(e,t,r){this[i].push({...r,type:"put",key:e,value:t})}_del(e,t){this[i].push({...t,type:"del",key:e})}_clear(){this[i]=[]}_write(e,t){"opening"===this.db.status?this.db.defer((()=>this._write(e,t))):"open"===this.db.status?0===this[i].length?this.nextTick(t):this.db._batch(this[i],e,t):this.nextTick(t,new s("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}}},95429:function(e,t,r){"use strict";const{AbstractKeyIterator:n,AbstractValueIterator:s}=r(33961),i=Symbol("iterator"),o=Symbol("callback"),a=Symbol("handleOne"),A=Symbol("handleMany");class c extends n{constructor(e,t){super(e,t),this[i]=e.iterator({...t,keys:!0,values:!1}),this[a]=this[a].bind(this),this[A]=this[A].bind(this)}}class l extends s{constructor(e,t){super(e,t),this[i]=e.iterator({...t,keys:!1,values:!0}),this[a]=this[a].bind(this),this[A]=this[A].bind(this)}}for(const e of[c,l]){const t=e===c,r=t?e=>e[0]:e=>e[1];e.prototype._next=function(e){this[o]=e,this[i].next(this[a])},e.prototype[a]=function(e,r,n){const s=this[o];e?s(e):s(null,t?r:n)},e.prototype._nextv=function(e,t,r){this[o]=r,this[i].nextv(e,t,this[A])},e.prototype._all=function(e,t){this[o]=t,this[i].all(e,this[A])},e.prototype[A]=function(e,t){const n=this[o];e?n(e):n(null,t.map(r))},e.prototype._seek=function(e,t){this[i].seek(e,t)},e.prototype._close=function(e){this[i].close(e)}}t.DefaultKeyIterator=c,t.DefaultValueIterator=l},30593:function(e,t,r){"use strict";const{AbstractIterator:n,AbstractKeyIterator:s,AbstractValueIterator:i}=r(33961),o=r(94473),a=Symbol("nut"),A=Symbol("undefer"),c=Symbol("factory");class l extends n{constructor(e,t){super(e,t),this[a]=null,this[c]=()=>e.iterator(t),this.db.defer((()=>this[A]()))}}class u extends s{constructor(e,t){super(e,t),this[a]=null,this[c]=()=>e.keys(t),this.db.defer((()=>this[A]()))}}class h extends i{constructor(e,t){super(e,t),this[a]=null,this[c]=()=>e.values(t),this.db.defer((()=>this[A]()))}}for(const e of[l,u,h])e.prototype[A]=function(){"open"===this.db.status&&(this[a]=this[c]())},e.prototype._next=function(e){null!==this[a]?this[a].next(e):"opening"===this.db.status?this.db.defer((()=>this._next(e))):this.nextTick(e,new o("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},e.prototype._nextv=function(e,t,r){null!==this[a]?this[a].nextv(e,t,r):"opening"===this.db.status?this.db.defer((()=>this._nextv(e,t,r))):this.nextTick(r,new o("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},e.prototype._all=function(e,t){null!==this[a]?this[a].all(t):"opening"===this.db.status?this.db.defer((()=>this._all(e,t))):this.nextTick(t,new o("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},e.prototype._seek=function(e,t){null!==this[a]?this[a]._seek(e,t):"opening"===this.db.status&&this.db.defer((()=>this._seek(e,t)))},e.prototype._close=function(e){null!==this[a]?this[a].close(e):"opening"===this.db.status?this.db.defer((()=>this._close(e))):this.nextTick(e)};t.DeferredIterator=l,t.DeferredKeyIterator=u,t.DeferredValueIterator=h},56909:function(e,t,r){"use strict";const n=r(54375);e.exports=function(e,...t){0===t.length?n(e):n((()=>e(...t)))}},70056:function(e,t,r){"use strict";const n=r(94473),s=Object.prototype.hasOwnProperty,i=new Set(["lt","lte","gt","gte"]);e.exports=function(e,t){const r={};for(const o in e)if(s.call(e,o)&&"keyEncoding"!==o&&"valueEncoding"!==o){if("start"===o||"end"===o)throw new n(`The legacy range option '${o}' has been removed`,{code:"LEVEL_LEGACY"});if("encoding"===o)throw new n("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});i.has(o)?r[o]=t.encode(e[o]):r[o]=e[o]}return r.reverse=!!r.reverse,r.limit=Number.isInteger(r.limit)&&r.limit>=0?r.limit:-1,r}},96451:function(e,t,r){"use strict";const n=r(79742),s=r(80645),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=A,t.SlowBuffer=function(e){+e!=e&&(e=0);return A.alloc(+e)},t.INSPECT_MAX_BYTES=50;const o=2147483647;function a(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,A.prototype),t}function A(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return c(e,t,r)}function c(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!A.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|p(e,t);let n=a(r);const s=n.write(e,t);s!==r&&(n=n.slice(0,s));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(W(e,Uint8Array)){const t=new Uint8Array(e);return d(t.buffer,t.byteOffset,t.byteLength)}return h(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(W(e,ArrayBuffer)||e&&W(e.buffer,ArrayBuffer))return d(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(W(e,SharedArrayBuffer)||e&&W(e.buffer,SharedArrayBuffer)))return d(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return A.from(n,t,r);const s=function(e){if(A.isBuffer(e)){const t=0|f(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||Y(e.length)?a(0):h(e);if("Buffer"===e.type&&Array.isArray(e.data))return h(e.data)}(e);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return A.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return l(e),a(e<0?0:0|f(e))}function h(e){const t=e.length<0?0:0|f(e.length),r=a(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function d(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,A.prototype),n}function f(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function p(e,t){if(A.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||W(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let s=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return $(e).length;default:if(s)return n?-1:G(e).length;t=(""+t).toLowerCase(),s=!0}}function g(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,r);case"utf8":case"utf-8":return S(this,t,r);case"ascii":return T(this,t,r);case"latin1":case"binary":return R(this,t,r);case"base64":return C(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function w(e,t,r,n,s){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Y(r=+r)&&(r=s?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(s)return-1;r=e.length-1}else if(r<0){if(!s)return-1;r=0}if("string"==typeof t&&(t=A.from(t,n)),A.isBuffer(t))return 0===t.length?-1:m(e,t,r,n,s);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):m(e,[t],r,n,s);throw new TypeError("val must be string, number or Buffer")}function m(e,t,r,n,s){let i,o=1,a=e.length,A=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,a/=2,A/=2,r/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(s){let n=-1;for(i=r;i<a;i++)if(c(e,i)===c(t,-1===n?0:i-n)){if(-1===n&&(n=i),i-n+1===A)return n*o}else-1!==n&&(i-=i-n),n=-1}else for(r+A>a&&(r=a-A),i=r;i>=0;i--){let r=!0;for(let n=0;n<A;n++)if(c(e,i+n)!==c(t,n)){r=!1;break}if(r)return i}return-1}function b(e,t,r,n){r=Number(r)||0;const s=e.length-r;n?(n=Number(n))>s&&(n=s):n=s;const i=t.length;let o;for(n>i/2&&(n=i/2),o=0;o<n;++o){const n=parseInt(t.substr(2*o,2),16);if(Y(n))return o;e[r+o]=n}return o}function E(e,t,r,n){return q(G(t,e.length-r),e,r,n)}function v(e,t,r,n){return q(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function B(e,t,r,n){return q($(t),e,r,n)}function _(e,t,r,n){return q(function(e,t){let r,n,s;const i=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)r=e.charCodeAt(o),n=r>>8,s=r%256,i.push(s),i.push(n);return i}(t,e.length-r),e,r,n)}function C(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function S(e,t,r){r=Math.min(e.length,r);const n=[];let s=t;for(;s<r;){const t=e[s];let i=null,o=t>239?4:t>223?3:t>191?2:1;if(s+o<=r){let r,n,a,A;switch(o){case 1:t<128&&(i=t);break;case 2:r=e[s+1],128==(192&r)&&(A=(31&t)<<6|63&r,A>127&&(i=A));break;case 3:r=e[s+1],n=e[s+2],128==(192&r)&&128==(192&n)&&(A=(15&t)<<12|(63&r)<<6|63&n,A>2047&&(A<55296||A>57343)&&(i=A));break;case 4:r=e[s+1],n=e[s+2],a=e[s+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(A=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a,A>65535&&A<1114112&&(i=A))}}null===i?(i=65533,o=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),s+=o}return function(e){const t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=I));return r}(n)}t.kMaxLength=o,A.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),A.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(A.prototype,"parent",{enumerable:!0,get:function(){if(A.isBuffer(this))return this.buffer}}),Object.defineProperty(A.prototype,"offset",{enumerable:!0,get:function(){if(A.isBuffer(this))return this.byteOffset}}),A.poolSize=8192,A.from=function(e,t,r){return c(e,t,r)},Object.setPrototypeOf(A.prototype,Uint8Array.prototype),Object.setPrototypeOf(A,Uint8Array),A.alloc=function(e,t,r){return function(e,t,r){return l(e),e<=0?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)}(e,t,r)},A.allocUnsafe=function(e){return u(e)},A.allocUnsafeSlow=function(e){return u(e)},A.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==A.prototype},A.compare=function(e,t){if(W(e,Uint8Array)&&(e=A.from(e,e.offset,e.byteLength)),W(t,Uint8Array)&&(t=A.from(t,t.offset,t.byteLength)),!A.isBuffer(e)||!A.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let s=0,i=Math.min(r,n);s<i;++s)if(e[s]!==t[s]){r=e[s],n=t[s];break}return r<n?-1:n<r?1:0},A.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},A.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return A.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=A.allocUnsafe(t);let s=0;for(r=0;r<e.length;++r){let t=e[r];if(W(t,Uint8Array))s+t.length>n.length?(A.isBuffer(t)||(t=A.from(t)),t.copy(n,s)):Uint8Array.prototype.set.call(n,t,s);else{if(!A.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,s)}s+=t.length}return n},A.byteLength=p,A.prototype._isBuffer=!0,A.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},A.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},A.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},A.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?S(this,0,e):g.apply(this,arguments)},A.prototype.toLocaleString=A.prototype.toString,A.prototype.equals=function(e){if(!A.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===A.compare(this,e)},A.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},i&&(A.prototype[i]=A.prototype.inspect),A.prototype.compare=function(e,t,r,n,s){if(W(e,Uint8Array)&&(e=A.from(e,e.offset,e.byteLength)),!A.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===s&&(s=this.length),t<0||r>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&t>=r)return 0;if(n>=s)return-1;if(t>=r)return 1;if(this===e)return 0;let i=(s>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0);const a=Math.min(i,o),c=this.slice(n,s),l=e.slice(t,r);for(let e=0;e<a;++e)if(c[e]!==l[e]){i=c[e],o=l[e];break}return i<o?-1:o<i?1:0},A.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},A.prototype.indexOf=function(e,t,r){return w(this,e,t,r,!0)},A.prototype.lastIndexOf=function(e,t,r){return w(this,e,t,r,!1)},A.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const s=this.length-t;if((void 0===r||r>s)&&(r=s),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let i=!1;for(;;)switch(n){case"hex":return b(this,e,t,r);case"utf8":case"utf-8":return E(this,e,t,r);case"ascii":case"latin1":case"binary":return v(this,e,t,r);case"base64":return B(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},A.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const I=4096;function T(e,t,r){let n="";r=Math.min(e.length,r);for(let s=t;s<r;++s)n+=String.fromCharCode(127&e[s]);return n}function R(e,t,r){let n="";r=Math.min(e.length,r);for(let s=t;s<r;++s)n+=String.fromCharCode(e[s]);return n}function k(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let s="";for(let n=t;n<r;++n)s+=X[e[n]];return s}function U(e,t,r){const n=e.slice(t,r);let s="";for(let e=0;e<n.length-1;e+=2)s+=String.fromCharCode(n[e]+256*n[e+1]);return s}function D(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,r,n,s,i){if(!A.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>s||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function L(e,t,r,n,s){K(t,n,s,e,r,7);let i=Number(t&BigInt(4294967295));e[r++]=i,i>>=8,e[r++]=i,i>>=8,e[r++]=i,i>>=8,e[r++]=i;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,r}function N(e,t,r,n,s){K(t,n,s,e,r,7);let i=Number(t&BigInt(4294967295));e[r+7]=i,i>>=8,e[r+6]=i,i>>=8,e[r+5]=i,i>>=8,e[r+4]=i;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,o>>=8,e[r+2]=o,o>>=8,e[r+1]=o,o>>=8,e[r]=o,r+8}function O(e,t,r,n,s,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function F(e,t,r,n,i){return t=+t,r>>>=0,i||O(e,0,r,4),s.write(e,t,r,n,23,4),r+4}function Q(e,t,r,n,i){return t=+t,r>>>=0,i||O(e,0,r,8),s.write(e,t,r,n,52,8),r+8}A.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,A.prototype),n},A.prototype.readUintLE=A.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e],s=1,i=0;for(;++i<t&&(s*=256);)n+=this[e+i]*s;return n},A.prototype.readUintBE=A.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e+--t],s=1;for(;t>0&&(s*=256);)n+=this[e+--t]*s;return n},A.prototype.readUint8=A.prototype.readUInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),this[e]},A.prototype.readUint16LE=A.prototype.readUInt16LE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]|this[e+1]<<8},A.prototype.readUint16BE=A.prototype.readUInt16BE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]<<8|this[e+1]},A.prototype.readUint32LE=A.prototype.readUInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},A.prototype.readUint32BE=A.prototype.readUInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},A.prototype.readBigUInt64LE=J((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||z(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,s=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))})),A.prototype.readBigUInt64BE=J((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||z(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],s=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(s)})),A.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e],s=1,i=0;for(;++i<t&&(s*=256);)n+=this[e+i]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*t)),n},A.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=t,s=1,i=this[e+--n];for(;n>0&&(s*=256);)i+=this[e+--n]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*t)),i},A.prototype.readInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},A.prototype.readInt16LE=function(e,t){e>>>=0,t||D(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},A.prototype.readInt16BE=function(e,t){e>>>=0,t||D(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},A.prototype.readInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},A.prototype.readInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},A.prototype.readBigInt64LE=J((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||z(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),A.prototype.readBigInt64BE=J((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||z(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),A.prototype.readFloatLE=function(e,t){return e>>>=0,t||D(e,4,this.length),s.read(this,e,!0,23,4)},A.prototype.readFloatBE=function(e,t){return e>>>=0,t||D(e,4,this.length),s.read(this,e,!1,23,4)},A.prototype.readDoubleLE=function(e,t){return e>>>=0,t||D(e,8,this.length),s.read(this,e,!0,52,8)},A.prototype.readDoubleBE=function(e,t){return e>>>=0,t||D(e,8,this.length),s.read(this,e,!1,52,8)},A.prototype.writeUintLE=A.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){P(this,e,t,r,Math.pow(2,8*r)-1,0)}let s=1,i=0;for(this[t]=255&e;++i<r&&(s*=256);)this[t+i]=e/s&255;return t+r},A.prototype.writeUintBE=A.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){P(this,e,t,r,Math.pow(2,8*r)-1,0)}let s=r-1,i=1;for(this[t+s]=255&e;--s>=0&&(i*=256);)this[t+s]=e/i&255;return t+r},A.prototype.writeUint8=A.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,1,255,0),this[t]=255&e,t+1},A.prototype.writeUint16LE=A.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},A.prototype.writeUint16BE=A.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},A.prototype.writeUint32LE=A.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},A.prototype.writeUint32BE=A.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},A.prototype.writeBigUInt64LE=J((function(e,t=0){return L(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),A.prototype.writeBigUInt64BE=J((function(e,t=0){return N(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),A.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);P(this,e,t,r,n-1,-n)}let s=0,i=1,o=0;for(this[t]=255&e;++s<r&&(i*=256);)e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=(e/i>>0)-o&255;return t+r},A.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);P(this,e,t,r,n-1,-n)}let s=r-1,i=1,o=0;for(this[t+s]=255&e;--s>=0&&(i*=256);)e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=(e/i>>0)-o&255;return t+r},A.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},A.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},A.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},A.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},A.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},A.prototype.writeBigInt64LE=J((function(e,t=0){return L(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),A.prototype.writeBigInt64BE=J((function(e,t=0){return N(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),A.prototype.writeFloatLE=function(e,t,r){return F(this,e,t,!0,r)},A.prototype.writeFloatBE=function(e,t,r){return F(this,e,t,!1,r)},A.prototype.writeDoubleLE=function(e,t,r){return Q(this,e,t,!0,r)},A.prototype.writeDoubleBE=function(e,t,r){return Q(this,e,t,!1,r)},A.prototype.copy=function(e,t,r,n){if(!A.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const s=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),s},A.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!A.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let s;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(s=t;s<r;++s)this[s]=e;else{const i=A.isBuffer(e)?e:A.from(e,n),o=i.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<r-t;++s)this[s+t]=i[s%o]}return this};const x={};function M(e,t,r){x[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function H(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function K(e,t,r,n,s,i){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let s;throw s=i>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(i+1)}${n}`:`>= -(2${n} ** ${8*(i+1)-1}${n}) and < 2 ** ${8*(i+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new x.ERR_OUT_OF_RANGE("value",s,e)}!function(e,t,r){V(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||z(t,e.length-(r+1))}(n,s,i)}function V(e,t){if("number"!=typeof e)throw new x.ERR_INVALID_ARG_TYPE(t,"number",e)}function z(e,t,r){if(Math.floor(e)!==e)throw V(e,r),new x.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new x.ERR_BUFFER_OUT_OF_BOUNDS;throw new x.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}M("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),M("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),M("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,s=r;return Number.isInteger(r)&&Math.abs(r)>2**32?s=H(String(r)):"bigint"==typeof r&&(s=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(s=H(s)),s+="n"),n+=` It must be ${t}. Received ${s}`,n}),RangeError);const j=/[^+/0-9A-Za-z-_]/g;function G(e,t){let r;t=t||1/0;const n=e.length;let s=null;const i=[];for(let o=0;o<n;++o){if(r=e.charCodeAt(o),r>55295&&r<57344){if(!s){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&i.push(239,191,189);continue}s=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),s=r;continue}r=65536+(s-55296<<10|r-56320)}else s&&(t-=3)>-1&&i.push(239,191,189);if(s=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function $(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(j,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function q(e,t,r,n){let s;for(s=0;s<n&&!(s+r>=t.length||s>=e.length);++s)t[s+r]=e[s];return s}function W(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Y(e){return e!=e}const X=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let s=0;s<16;++s)t[n+s]=e[r]+e[s]}return t}();function J(e){return"undefined"==typeof BigInt?Z:e}function Z(){throw new Error("BigInt not supported")}},96159:function(e,t,r){"use strict";var n;r.d(t,{M2:function(){return o},Tm:function(){return a},l$:function(){return i}});var s=r(62435);const{isValidElement:i}=n||(n=r.t(s,2));function o(e){return e&&i(e)&&e.type===s.Fragment}function a(e,t){return function(e,t,r){return i(e)?s.cloneElement(e,"function"==typeof r?r(e.props||{}):r):t}(e,e,t)}},76260:function(e,t,r){"use strict";r.d(t,{ZP:function(){return De}});var n=r(94184),s=r.n(n),i=r(98423),o=r(62435),a=r(42550),A=r(5110),c=r(53124),l=r(96159),u=r(67968);const h=e=>{const{componentCls:t,colorPrimary:r}=e;return{[t]:{position:"absolute",background:"transparent",pointerEvents:"none",boxSizing:"border-box",color:`var(--wave-color, ${r})`,boxShadow:"0 0 0 0 currentcolor",opacity:.2,"&.wave-motion-appear":{transition:[`box-shadow 0.4s ${e.motionEaseOutCirc}`,`opacity 2s ${e.motionEaseOutCirc}`].join(","),"&-active":{boxShadow:"0 0 0 6px currentcolor",opacity:0}}}}};var d,f=(0,u.Z)("Wave",(e=>[h(e)])),p=r(62874),g=r(75164),y=r(74165),w=r(15861),m=r(71002),b=r(1413),E=r(61254),v=r.t(E,2),B=(0,b.Z)({},v),_=B.version,C=B.render,S=B.unmountComponentAtNode;try{Number((_||"").split(".")[0])>=18&&(d=B.createRoot)}catch(e){}function I(e){var t=B.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;t&&"object"===(0,m.Z)(t)&&(t.usingClientEntryPoint=e)}var T="__rc_react_root__";function R(e,t){d?function(e,t){I(!0);var r=t[T]||d(t);I(!1),r.render(e),t[T]=r}(e,t):function(e,t){C(e,t)}(e,t)}function k(e){return U.apply(this,arguments)}function U(){return(U=(0,w.Z)((0,y.Z)().mark((function e(t){return(0,y.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve().then((function(){var e;null===(e=t[T])||void 0===e||e.unmount(),delete t[T]})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){S(e)}function P(){return(P=(0,w.Z)((0,y.Z)().mark((function e(t){return(0,y.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===d){e.next=2;break}return e.abrupt("return",k(t));case 2:D(t);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e){return e&&"#fff"!==e&&"#ffffff"!==e&&"rgb(255, 255, 255)"!==e&&"rgba(255, 255, 255, 1)"!==e&&function(e){const t=(e||"").match(/rgba?\((\d*), (\d*), (\d*)(, [\d.]*)?\)/);return!(t&&t[1]&&t[2]&&t[3]&&t[1]===t[2]&&t[2]===t[3])}(e)&&!/rgba\((?:\d*, ){3}0\)/.test(e)&&"transparent"!==e}function N(e){return Number.isNaN(e)?0:e}const O=e=>{const{className:t,target:r}=e,n=o.useRef(null),[i,a]=o.useState(null),[A,c]=o.useState([]),[l,u]=o.useState(0),[h,d]=o.useState(0),[f,y]=o.useState(0),[w,m]=o.useState(0),[b,E]=o.useState(!1),v={left:l,top:h,width:f,height:w,borderRadius:A.map((e=>`${e}px`)).join(" ")};function B(){const e=getComputedStyle(r);a(function(e){const{borderTopColor:t,borderColor:r,backgroundColor:n}=getComputedStyle(e);return L(t)?t:L(r)?r:L(n)?n:null}(r));const t="static"===e.position,{borderLeftWidth:n,borderTopWidth:s}=e;u(t?r.offsetLeft:N(-parseFloat(n))),d(t?r.offsetTop:N(-parseFloat(s))),y(r.offsetWidth),m(r.offsetHeight);const{borderTopLeftRadius:i,borderTopRightRadius:o,borderBottomLeftRadius:A,borderBottomRightRadius:l}=e;c([i,o,l,A].map((e=>N(parseFloat(e)))))}return i&&(v["--wave-color"]=i),o.useEffect((()=>{if(r){const e=(0,g.Z)((()=>{B(),E(!0)}));let t;return"undefined"!=typeof ResizeObserver&&(t=new ResizeObserver(B),t.observe(r)),()=>{g.Z.cancel(e),null==t||t.disconnect()}}}),[]),b?o.createElement(p.Z,{visible:!0,motionAppear:!0,motionName:"wave-motion",motionDeadline:5e3,onAppearEnd:(e,t)=>{var r;if(t.deadline||"opacity"===t.propertyName){const e=null===(r=n.current)||void 0===r?void 0:r.parentElement;(function(e){return P.apply(this,arguments)})(e).then((()=>{var t;null===(t=e.parentElement)||void 0===t||t.removeChild(e)}))}return!1}},(e=>{let{className:r}=e;return o.createElement("div",{ref:n,className:s()(t,r),style:v})})):null};function F(e,t){return function(){!function(e,t){const r=document.createElement("div");r.style.position="absolute",r.style.left="0px",r.style.top="0px",null==e||e.insertBefore(r,null==e?void 0:e.firstChild),R(o.createElement(O,{target:e,className:t}),r)}(e.current,t)}}var Q=e=>{const{children:t,disabled:r}=e,{getPrefixCls:n}=(0,o.useContext)(c.E_),i=(0,o.useRef)(null),u=n("wave"),[,h]=f(u),d=F(i,s()(u,h));if(o.useEffect((()=>{const e=i.current;if(!e||1!==e.nodeType||r)return;const t=t=>{"INPUT"===t.target.tagName||!(0,A.Z)(t.target)||!e.getAttribute||e.getAttribute("disabled")||e.disabled||e.className.includes("disabled")||e.className.includes("-leave")||d()};return e.addEventListener("click",t,!0),()=>{e.removeEventListener("click",t,!0)}}),[r]),!o.isValidElement(t))return null!=t?t:null;const p=(0,a.Yr)(t)?(0,a.sQ)(t.ref,i):i;return(0,l.Tm)(t,{ref:p})},x=r(98866),M=r(97647),H=r(4173),K=r(21823),V=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r};const z=o.createContext(void 0);var j=e=>{const{getPrefixCls:t,direction:r}=o.useContext(c.E_),{prefixCls:n,size:i,className:a}=e,A=V(e,["prefixCls","size","className"]),l=t("btn-group",n),[,,u]=(0,K.dQ)();let h="";switch(i){case"large":h="lg";break;case"small":h="sm"}const d=s()(l,{[`${l}-${h}`]:h,[`${l}-rtl`]:"rtl"===r},a,u);return o.createElement(z.Provider,{value:i},o.createElement("div",Object.assign({},A,{className:d})))};const G=/^[\u4e00-\u9fa5]{2}$/,$=G.test.bind(G);function q(e){return"text"===e||"link"===e}function W(e,t){let r=!1;const n=[];return o.Children.forEach(e,(e=>{const t=typeof e,s="string"===t||"number"===t;if(r&&s){const t=n.length-1,r=n[t];n[t]=`${r}${e}`}else n.push(e);r=s})),o.Children.map(n,(e=>function(e,t){if(null==e)return;const r=t?" ":"";return"string"!=typeof e&&"number"!=typeof e&&"string"==typeof e.type&&$(e.props.children)?(0,l.Tm)(e,{children:e.props.children.split("").join(r)}):"string"==typeof e?$(e)?o.createElement("span",null,e.split("").join(r)):o.createElement("span",null,e):(0,l.M2)(e)?o.createElement("span",null,e):e}(e,t)))}var Y=r(22508);const X=()=>({width:0,opacity:0,transform:"scale(0)"}),J=e=>({width:e.scrollWidth,opacity:1,transform:"scale(1)"});var Z=e=>{let{prefixCls:t,loading:r,existIcon:n}=e;const s=!!r;return n?o.createElement("span",{className:`${t}-loading-icon`},o.createElement(Y.Z,null)):o.createElement(p.Z,{visible:s,motionName:`${t}-loading-icon-motion`,removeOnLeave:!0,onAppearStart:X,onAppearActive:J,onEnterStart:X,onEnterActive:J,onLeaveStart:J,onLeaveActive:X},((e,r)=>{let{className:n,style:s}=e;return o.createElement("span",{className:`${t}-loading-icon`,style:s,ref:r},o.createElement(Y.Z,{className:n}))}))},ee=r(45503);const te=(e,t)=>({[`> span, > ${e}`]:{"&:not(:last-child)":{[`&, & > ${e}`]:{"&:not(:disabled)":{borderInlineEndColor:t}}},"&:not(:first-child)":{[`&, & > ${e}`]:{"&:not(:disabled)":{borderInlineStartColor:t}}}}});var re=e=>{const{componentCls:t,fontSize:r,lineWidth:n,colorPrimaryHover:s,colorErrorHover:i}=e;return{[`${t}-group`]:[{position:"relative",display:"inline-flex",[`> span, > ${t}`]:{"&:not(:last-child)":{[`&, & > ${t}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},"&:not(:first-child)":{marginInlineStart:-n,[`&, & > ${t}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}},[t]:{position:"relative",zIndex:1,"&:hover,\n          &:focus,\n          &:active":{zIndex:2},"&[disabled]":{zIndex:0}},[`${t}-icon-only`]:{fontSize:r}},te(`${t}-primary`,s),te(`${t}-danger`,i)]}},ne=r(14747),se=r(80110);function ie(e,t){return{[`&-item:not(${t}-last-item)`]:{marginBottom:-e.lineWidth},"&-item":{"&:hover,&:focus,&:active":{zIndex:2},"&[disabled]":{zIndex:0}}}}function oe(e){const t=`${e.componentCls}-compact-vertical`;return{[t]:Object.assign(Object.assign({},ie(e,t)),(r=e.componentCls,n=t,{[`&-item:not(${n}-first-item):not(${n}-last-item)`]:{borderRadius:0},[`&-item${n}-first-item:not(${n}-last-item)`]:{[`&, &${r}-sm, &${r}-lg`]:{borderEndEndRadius:0,borderEndStartRadius:0}},[`&-item${n}-last-item:not(${n}-first-item)`]:{[`&, &${r}-sm, &${r}-lg`]:{borderStartStartRadius:0,borderStartEndRadius:0}}}))};var r,n}const ae=e=>{const{componentCls:t,iconCls:r}=e;return{[t]:{outline:"none",position:"relative",display:"inline-block",fontWeight:400,whiteSpace:"nowrap",textAlign:"center",backgroundImage:"none",backgroundColor:"transparent",border:`${e.lineWidth}px ${e.lineType} transparent`,cursor:"pointer",transition:`all ${e.motionDurationMid} ${e.motionEaseInOut}`,userSelect:"none",touchAction:"manipulation",lineHeight:e.lineHeight,color:e.colorText,"> span":{display:"inline-block"},[`> ${r} + span, > span + ${r}`]:{marginInlineStart:e.marginXS},"> a":{color:"currentColor"},"&:not(:disabled)":Object.assign({},(0,ne.Qy)(e)),[`&-icon-only${t}-compact-item`]:{flex:"none"},[`&-compact-item${t}-primary`]:{[`&:not([disabled]) + ${t}-compact-item${t}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:-e.lineWidth,insetInlineStart:-e.lineWidth,display:"inline-block",width:e.lineWidth,height:`calc(100% + ${2*e.lineWidth}px)`,backgroundColor:e.colorPrimaryHover,content:'""'}}},"&-compact-vertical-item":{[`&${t}-primary`]:{[`&:not([disabled]) + ${t}-compact-vertical-item${t}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:-e.lineWidth,insetInlineStart:-e.lineWidth,display:"inline-block",width:`calc(100% + ${2*e.lineWidth}px)`,height:e.lineWidth,backgroundColor:e.colorPrimaryHover,content:'""'}}}}}}},Ae=(e,t)=>({"&:not(:disabled)":{"&:hover":e,"&:active":t}}),ce=e=>({minWidth:e.controlHeight,paddingInlineStart:0,paddingInlineEnd:0,borderRadius:"50%"}),le=e=>({borderRadius:e.controlHeight,paddingInlineStart:e.controlHeight/2,paddingInlineEnd:e.controlHeight/2}),ue=e=>({cursor:"not-allowed",borderColor:e.colorBorder,color:e.colorTextDisabled,backgroundColor:e.colorBgContainerDisabled,boxShadow:"none"}),he=(e,t,r,n,s,i,o)=>({[`&${e}-background-ghost`]:Object.assign(Object.assign({color:t||void 0,backgroundColor:"transparent",borderColor:r||void 0,boxShadow:"none"},Ae(Object.assign({backgroundColor:"transparent"},i),Object.assign({backgroundColor:"transparent"},o))),{"&:disabled":{cursor:"not-allowed",color:n||void 0,borderColor:s||void 0}})}),de=e=>({"&:disabled":Object.assign({},ue(e))}),fe=e=>Object.assign({},de(e)),pe=e=>({"&:disabled":{cursor:"not-allowed",color:e.colorTextDisabled}}),ge=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},fe(e)),{backgroundColor:e.colorBgContainer,borderColor:e.colorBorder,boxShadow:`0 ${e.controlOutlineWidth}px 0 ${e.controlTmpOutline}`}),Ae({color:e.colorPrimaryHover,borderColor:e.colorPrimaryHover},{color:e.colorPrimaryActive,borderColor:e.colorPrimaryActive})),he(e.componentCls,e.colorBgContainer,e.colorBgContainer,e.colorTextDisabled,e.colorBorder)),{[`&${e.componentCls}-dangerous`]:Object.assign(Object.assign(Object.assign({color:e.colorError,borderColor:e.colorError},Ae({color:e.colorErrorHover,borderColor:e.colorErrorBorderHover},{color:e.colorErrorActive,borderColor:e.colorErrorActive})),he(e.componentCls,e.colorError,e.colorError,e.colorTextDisabled,e.colorBorder)),de(e))}),ye=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},fe(e)),{color:e.colorTextLightSolid,backgroundColor:e.colorPrimary,boxShadow:`0 ${e.controlOutlineWidth}px 0 ${e.controlOutline}`}),Ae({color:e.colorTextLightSolid,backgroundColor:e.colorPrimaryHover},{color:e.colorTextLightSolid,backgroundColor:e.colorPrimaryActive})),he(e.componentCls,e.colorPrimary,e.colorPrimary,e.colorTextDisabled,e.colorBorder,{color:e.colorPrimaryHover,borderColor:e.colorPrimaryHover},{color:e.colorPrimaryActive,borderColor:e.colorPrimaryActive})),{[`&${e.componentCls}-dangerous`]:Object.assign(Object.assign(Object.assign({backgroundColor:e.colorError,boxShadow:`0 ${e.controlOutlineWidth}px 0 ${e.colorErrorOutline}`},Ae({backgroundColor:e.colorErrorHover},{backgroundColor:e.colorErrorActive})),he(e.componentCls,e.colorError,e.colorError,e.colorTextDisabled,e.colorBorder,{color:e.colorErrorHover,borderColor:e.colorErrorHover},{color:e.colorErrorActive,borderColor:e.colorErrorActive})),de(e))}),we=e=>Object.assign(Object.assign({},ge(e)),{borderStyle:"dashed"}),me=e=>Object.assign(Object.assign(Object.assign({color:e.colorLink},Ae({color:e.colorLinkHover},{color:e.colorLinkActive})),pe(e)),{[`&${e.componentCls}-dangerous`]:Object.assign(Object.assign({color:e.colorError},Ae({color:e.colorErrorHover},{color:e.colorErrorActive})),pe(e))}),be=e=>Object.assign(Object.assign(Object.assign({},Ae({color:e.colorText,backgroundColor:e.colorBgTextHover},{color:e.colorText,backgroundColor:e.colorBgTextActive})),pe(e)),{[`&${e.componentCls}-dangerous`]:Object.assign(Object.assign({color:e.colorError},pe(e)),Ae({color:e.colorErrorHover,backgroundColor:e.colorErrorBg},{color:e.colorErrorHover,backgroundColor:e.colorErrorBg}))}),Ee=e=>Object.assign(Object.assign({},ue(e)),{[`&${e.componentCls}:hover`]:Object.assign({},ue(e))}),ve=e=>{const{componentCls:t}=e;return{[`${t}-default`]:ge(e),[`${t}-primary`]:ye(e),[`${t}-dashed`]:we(e),[`${t}-link`]:me(e),[`${t}-text`]:be(e),[`${t}-disabled`]:Ee(e)}},Be=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const{componentCls:r,iconCls:n,controlHeight:s,fontSize:i,lineHeight:o,lineWidth:a,borderRadius:A,buttonPaddingHorizontal:c}=e,l=Math.max(0,(s-i*o)/2-a),u=c-a,h=`${r}-icon-only`;return[{[`${r}${t}`]:{fontSize:i,height:s,padding:`${l}px ${u}px`,borderRadius:A,[`&${h}`]:{width:s,paddingInlineStart:0,paddingInlineEnd:0,[`&${r}-round`]:{width:"auto"},"> span":{transform:"scale(1.143)"}},[`&${r}-loading`]:{opacity:e.opacityLoading,cursor:"default"},[`${r}-loading-icon`]:{transition:`width ${e.motionDurationSlow} ${e.motionEaseInOut}, opacity ${e.motionDurationSlow} ${e.motionEaseInOut}`},[`&:not(${h}) ${r}-loading-icon > ${n}`]:{marginInlineEnd:e.marginXS}}},{[`${r}${r}-circle${t}`]:ce(e)},{[`${r}${r}-round${t}`]:le(e)}]},_e=e=>Be(e),Ce=e=>{const t=(0,ee.TS)(e,{controlHeight:e.controlHeightSM,padding:e.paddingXS,buttonPaddingHorizontal:8,borderRadius:e.borderRadiusSM});return Be(t,`${e.componentCls}-sm`)},Se=e=>{const t=(0,ee.TS)(e,{controlHeight:e.controlHeightLG,fontSize:e.fontSizeLG,borderRadius:e.borderRadiusLG});return Be(t,`${e.componentCls}-lg`)},Ie=e=>{const{componentCls:t}=e;return{[t]:{[`&${t}-block`]:{width:"100%"}}}};var Te=(0,u.Z)("Button",(e=>{const{controlTmpOutline:t,paddingContentHorizontal:r}=e,n=(0,ee.TS)(e,{colorOutlineDefault:t,buttonPaddingHorizontal:r});return[ae(n),Ce(n),_e(n),Se(n),Ie(n),ve(n),re(n),(0,se.c)(e,{focus:!1}),oe(e)]})),Re=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r};const ke=(e,t)=>{const{loading:r=!1,prefixCls:n,type:a="default",danger:A,shape:l="default",size:u,disabled:h,className:d,children:f,icon:p,ghost:g=!1,block:y=!1,htmlType:w="button"}=e,m=Re(e,["loading","prefixCls","type","danger","shape","size","disabled","className","children","icon","ghost","block","htmlType"]),{getPrefixCls:b,autoInsertSpaceInButton:E,direction:v}=o.useContext(c.E_),B=b("btn",n),[_,C]=Te(B),S=o.useContext(M.Z),I=o.useContext(x.Z),T=null!=h?h:I,R=o.useContext(z),[k,U]=o.useState(!!r),[D,P]=o.useState(!1),L=t||o.createRef(),N=()=>1===o.Children.count(f)&&!p&&!q(a),O="boolean"==typeof r?r:(null==r?void 0:r.delay)||!0;o.useEffect((()=>{let e=null;return"number"==typeof O?e=window.setTimeout((()=>{e=null,U(O)}),O):U(O),function(){e&&(window.clearTimeout(e),e=null)}}),[O]),o.useEffect((()=>{if(!L||!L.current||!1===E)return;const e=L.current.textContent;N()&&$(e)?D||P(!0):D&&P(!1)}),[L]);const F=t=>{const{onClick:r}=e;k||T?t.preventDefault():null==r||r(t)},K=!1!==E,{compactSize:V,compactItemClassnames:j}=(0,H.ri)(B,v),G=V||R||u||S,Y=G&&{large:"lg",small:"sm",middle:void 0}[G]||"",X=k?"loading":p,J=(0,i.Z)(m,["navigate"]),ee=void 0!==J.href&&T,te=s()(B,C,{[`${B}-${l}`]:"default"!==l&&l,[`${B}-${a}`]:a,[`${B}-${Y}`]:Y,[`${B}-icon-only`]:!f&&0!==f&&!!X,[`${B}-background-ghost`]:g&&!q(a),[`${B}-loading`]:k,[`${B}-two-chinese-chars`]:D&&K&&!k,[`${B}-block`]:y,[`${B}-dangerous`]:!!A,[`${B}-rtl`]:"rtl"===v,[`${B}-disabled`]:ee},j,d),re=p&&!k?p:o.createElement(Z,{existIcon:!!p,prefixCls:B,loading:!!k}),ne=f||0===f?W(f,N()&&K):null;if(void 0!==J.href)return _(o.createElement("a",Object.assign({},J,{className:te,onClick:F,ref:L}),re,ne));let se=o.createElement("button",Object.assign({},m,{type:w,className:te,onClick:F,disabled:T,ref:L}),re,ne);return q(a)||(se=o.createElement(Q,{disabled:!!k},se)),_(se)},Ue=o.forwardRef(ke);Ue.Group=j,Ue.__ANT_BUTTON=!0;var De=Ue},32044:function(e){function t(e){const t=new globalThis.AbortController;function r(){t.abort();for(const t of e)t&&t.removeEventListener&&t.removeEventListener("abort",r)}for(const t of e)if(t&&t.addEventListener){if(t.aborted){r();break}t.addEventListener("abort",r)}return t.signal}e.exports=t,e.exports.anySignal=t},11708:function(e,t,r){"use strict";const{AbstractLevel:n}=r(50875),s=r(94473),i=r(29967),{fromCallback:o}=r(16957),{Iterator:a}=r(8212),A=r(89687),c=r(89968),l=r(21217),u="level-js-",h=Symbol("idb"),d=Symbol("namePrefix"),f=Symbol("location"),p=Symbol("version"),g=Symbol("store"),y=Symbol("onComplete"),w=Symbol("promise");class m extends n{constructor(e,t,r){if("function"==typeof t||"function"==typeof r)throw new s("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});const{prefix:n,version:i,...o}=t||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},o),"string"!=typeof e)throw new Error("constructor requires a location string argument");this[f]=e,this[d]=null==n?u:n,this[p]=parseInt(i||1,10),this[h]=null}get location(){return this[f]}get namePrefix(){return this[d]}get version(){return this[p]}get db(){return this[h]}get type(){return"browser-level"}_open(e,t){const r=indexedDB.open(this[d]+this[f],this[p]);r.onerror=function(){t(r.error||new Error("unknown error"))},r.onsuccess=()=>{this[h]=r.result,t()},r.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(this[f])||t.createObjectStore(this[f])}}[g](e){return this[h].transaction([this[f]],e).objectStore(this[f])}[y](e,t){const r=e.transaction;r.onabort=function(){t(r.error||new Error("aborted by user"))},r.oncomplete=function(){t(null,e.result)}}_get(e,t,r){const n=this[g]("readonly");let i;try{i=n.get(e)}catch(e){return this.nextTick(r,e)}this[y](i,(function(e,t){return e?r(e):void 0===t?r(new s("Entry not found",{code:"LEVEL_NOT_FOUND"})):void r(null,A(t))}))}_getMany(e,t,r){const n=this[g]("readonly"),s=e.map((e=>t=>{let r;try{r=n.get(e)}catch(e){return t(e)}r.onsuccess=()=>{const e=r.result;t(null,void 0===e?e:A(e))},r.onerror=e=>{e.stopPropagation(),t(r.error)}}));i(s,16,r)}_del(e,t,r){const n=this[g]("readwrite");let s;try{s=n.delete(e)}catch(e){return this.nextTick(r,e)}this[y](s,r)}_put(e,t,r,n){const s=this[g]("readwrite");let i;try{i=s.put(t,e)}catch(e){return this.nextTick(n,e)}this[y](i,n)}_iterator(e){return new a(this,this[f],e)}_batch(e,t,r){const n=this[g]("readwrite"),s=n.transaction;let i,o=0;s.onabort=function(){r(i||s.error||new Error("aborted by user"))},s.oncomplete=function(){r()},function t(){const r=e[o++],a=r.key;let A;try{A="del"===r.type?n.delete(a):n.put(r.value,a)}catch(e){return i=e,void s.abort()}o<e.length?A.onsuccess=t:"function"==typeof s.commit&&s.commit()}()}_clear(e,t){let r,n;try{r=l(e)}catch(e){return this.nextTick(t)}if(e.limit>=0)return c(this,this[f],r,e,t);try{const e=this[g]("readwrite");n=r?e.delete(r):e.clear()}catch(e){return this.nextTick(t,e)}this[y](n,t)}_close(e){this[h].close(),this.nextTick(e)}}m.destroy=function(e,t,r){"function"==typeof t&&(r=t,t=u),r=o(r,w);const n=indexedDB.deleteDatabase(t+e);return n.onsuccess=function(){r()},n.onerror=function(e){r(e)},r[w]},t.BrowserLevel=m},8212:function(e,t,r){"use strict";const{AbstractIterator:n}=r(50875),s=r(21217),i=r(89687),o=Symbol("cache"),a=Symbol("finished"),A=Symbol("options"),c=Symbol("currentOptions"),l=Symbol("position"),u=Symbol("location"),h=Symbol("first"),d={};function f(e){"function"==typeof e.commit&&e.commit()}t.Iterator=class extends n{constructor(e,t,r){super(e,r),this[o]=[],this[a]=0===this.limit,this[A]=r,this[c]={...r},this[l]=void 0,this[u]=t,this[h]=!0}_nextv(e,t,r){if(this[h]=!1,this[a])return this.nextTick(r,null,[]);if(this[o].length>0)return e=Math.min(e,this[o].length),this.nextTick(r,null,this[o].splice(0,e));let n;void 0!==this[l]&&(this[A].reverse?(this[c].lt=this[l],this[c].lte=void 0):(this[c].gt=this[l],this[c].gte=void 0));try{n=s(this[c])}catch(e){return this[a]=!0,this.nextTick(r,null,[])}const d=this.db.db.transaction([this[u]],"readonly"),p=d.objectStore(this[u]),g=[];if(this[A].reverse){p[!this[A].values&&p.openKeyCursor?"openKeyCursor":"openCursor"](n,"prev").onsuccess=t=>{const r=t.target.result;if(r){const{key:t,value:n}=r;this[l]=t,g.push([this[A].keys&&void 0!==t?i(t):void 0,this[A].values&&void 0!==n?i(n):void 0]),g.length<e?r.continue():f(d)}else this[a]=!0}}else{let t,r;const s=()=>{if(void 0===t||void 0===r)return;const n=Math.max(t.length,r.length);0===n||e===1/0?this[a]=!0:this[l]=t[n-1],g.length=n;for(let e=0;e<n;e++){const n=t[e],s=r[e];g[e]=[this[A].keys&&void 0!==n?i(n):void 0,this[A].values&&void 0!==s?i(s):void 0]}f(d)};this[A].keys||e<1/0?p.getAllKeys(n,e<1/0?e:void 0).onsuccess=e=>{t=e.target.result,s()}:(t=[],this.nextTick(s)),this[A].values?p.getAll(n,e<1/0?e:void 0).onsuccess=e=>{r=e.target.result,s()}:(r=[],this.nextTick(s))}d.onabort=()=>{r(d.error||new Error("aborted by user")),r=null},d.oncomplete=()=>{r(null,g),r=null}}_next(e){if(this[o].length>0){const[t,r]=this[o].shift();this.nextTick(e,null,t,r)}else if(this[a])this.nextTick(e);else{let t=Math.min(100,this.limit-this.count);this[h]&&(this[h]=!1,t=1),this._nextv(t,d,((t,r)=>{if(t)return e(t);this[o]=r,this._next(e)}))}}_all(e,t){this[h]=!1;const r=this[o].splice(0,this[o].length),n=this.limit-this.count-r.length;if(n<=0)return this.nextTick(t,null,r);this._nextv(n,d,((e,n)=>{if(e)return t(e);r.length>0&&(n=r.concat(n)),t(null,n)}))}_seek(e,t){let r;this[h]=!0,this[o]=[],this[a]=!1,this[l]=void 0,this[c]={...this[A]};try{r=s(this[A])}catch(e){return void(this[a]=!0)}null===r||r.includes(e)?this[A].reverse?this[c].lte=e:this[c].gte=e:this[a]=!0}}},89968:function(e){"use strict";e.exports=function(e,t,r,n,s){if(0===n.limit)return e.nextTick(s);const i=e.db.transaction([t],"readwrite"),o=i.objectStore(t);let a=0;i.oncomplete=function(){s()},i.onabort=function(){s(i.error||new Error("aborted by user"))};const A=o.openKeyCursor?"openKeyCursor":"openCursor",c=n.reverse?"prev":"next";o[A](r,c).onsuccess=function(e){const t=e.target.result;t&&(o.delete(t.key).onsuccess=function(){(n.limit<=0||++a<n.limit)&&t.continue()})}}},89687:function(e){"use strict";const t=new TextEncoder;e.exports=function(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):t.encode(e)}},21217:function(e){"use strict";e.exports=function(e){const t=void 0!==e.gte?e.gte:void 0!==e.gt?e.gt:void 0,r=void 0!==e.lte?e.lte:void 0!==e.lt?e.lt:void 0,n=void 0===e.gte,s=void 0===e.lte;return void 0!==t&&void 0!==r?IDBKeyRange.bound(t,r,n,s):void 0!==t?IDBKeyRange.lowerBound(t,n):void 0!==r?IDBKeyRange.upperBound(r,s):null}},79830:function(e){"use strict";e.exports=function(e,t){if("string"==typeof e)return o(e);if("number"==typeof e)return i(e,t);return null},e.exports.format=i,e.exports.parse=o;var t=/\B(?=(\d{3})+(?!\d))/g,r=/(?:\.0*|(\.[^0]+)0+)$/,n={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},s=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function i(e,s){if(!Number.isFinite(e))return null;var i=Math.abs(e),o=s&&s.thousandsSeparator||"",a=s&&s.unitSeparator||"",A=s&&void 0!==s.decimalPlaces?s.decimalPlaces:2,c=Boolean(s&&s.fixedDecimals),l=s&&s.unit||"";l&&n[l.toLowerCase()]||(l=i>=n.pb?"PB":i>=n.tb?"TB":i>=n.gb?"GB":i>=n.mb?"MB":i>=n.kb?"KB":"B");var u=(e/n[l.toLowerCase()]).toFixed(A);return c||(u=u.replace(r,"$1")),o&&(u=u.split(".").map((function(e,r){return 0===r?e.replace(t,o):e})).join(".")),u+a+l}function o(e){if("number"==typeof e&&!isNaN(e))return e;if("string"!=typeof e)return null;var t,r=s.exec(e),i="b";return r?(t=parseFloat(r[1]),i=r[4].toLowerCase()):(t=parseInt(e,10),i="b"),isNaN(t)?null:Math.floor(n[i]*t)}},16957:function(e,t,r){"use strict";var n=r(90886);t.fromCallback=function(e,t){if(void 0===e){var r=new Promise((function(t,r){e=function(e,n){e?r(e):t(n)}}));e[void 0!==t?t:"promise"]=r}else if("function"!=typeof e)throw new TypeError("Callback must be a function");return e},t.fromPromise=function(e,t){if(void 0===t)return e;e.then((function(e){n((()=>t(null,e)))})).catch((function(e){n((()=>t(e)))}))}},90886:function(e){e.exports="function"==typeof queueMicrotask?queueMicrotask:e=>Promise.resolve().then(e)},20640:function(e,t,r){"use strict";var n=r(11742),s={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var r,i,o,a,A,c,l=!1;t||(t={}),r=t.debug||!1;try{if(o=n(),a=document.createRange(),A=document.getSelection(),(c=document.createElement("span")).textContent=e,c.ariaHidden="true",c.style.all="unset",c.style.position="fixed",c.style.top=0,c.style.clip="rect(0, 0, 0, 0)",c.style.whiteSpace="pre",c.style.webkitUserSelect="text",c.style.MozUserSelect="text",c.style.msUserSelect="text",c.style.userSelect="text",c.addEventListener("copy",(function(n){if(n.stopPropagation(),t.format)if(n.preventDefault(),void 0===n.clipboardData){r&&console.warn("unable to use e.clipboardData"),r&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var i=s[t.format]||s.default;window.clipboardData.setData(i,e)}else n.clipboardData.clearData(),n.clipboardData.setData(t.format,e);t.onCopy&&(n.preventDefault(),t.onCopy(n.clipboardData))})),document.body.appendChild(c),a.selectNodeContents(c),A.addRange(a),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");l=!0}catch(n){r&&console.error("unable to copy using execCommand: ",n),r&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),l=!0}catch(n){r&&console.error("unable to copy using clipboardData: ",n),r&&console.error("falling back to prompt"),i=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(i,e)}}finally{A&&("function"==typeof A.removeRange?A.removeRange(a):A.removeAllRanges()),c&&document.body.removeChild(c),o()}return l}},27484:function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,r=36e5,n="millisecond",s="second",i="minute",o="hour",a="day",A="week",c="month",l="quarter",u="year",h="date",d="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||t[0])+"]"}},y=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},w={s:y,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),s=r%60;return(t<=0?"+":"-")+y(n,2,"0")+":"+y(s,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var n=12*(r.year()-t.year())+(r.month()-t.month()),s=t.clone().add(n,c),i=r-s<0,o=t.clone().add(n+(i?-1:1),c);return+(-(n+(r-s)/(i?s-o:o-s))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:u,w:A,d:a,D:h,h:o,m:i,s:s,ms:n,Q:l}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},m="en",b={};b[m]=g;var E=function(e){return e instanceof C},v=function e(t,r,n){var s;if(!t)return m;if("string"==typeof t){var i=t.toLowerCase();b[i]&&(s=i),r&&(b[i]=r,s=i);var o=t.split("-");if(!s&&o.length>1)return e(o[0])}else{var a=t.name;b[a]=t,s=a}return!n&&s&&(m=s),s||!n&&m},B=function(e,t){if(E(e))return e.clone();var r="object"==typeof t?t:{};return r.date=e,r.args=arguments,new C(r)},_=w;_.l=v,_.i=E,_.w=function(e,t){return B(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var C=function(){function g(e){this.$L=v(e.locale,null,!0),this.parse(e)}var y=g.prototype;return y.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(_.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(f);if(n){var s=n[2]-1||0,i=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],s,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)):new Date(n[1],s,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},y.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},y.$utils=function(){return _},y.isValid=function(){return!(this.$d.toString()===d)},y.isSame=function(e,t){var r=B(e);return this.startOf(t)<=r&&r<=this.endOf(t)},y.isAfter=function(e,t){return B(e)<this.startOf(t)},y.isBefore=function(e,t){return this.endOf(t)<B(e)},y.$g=function(e,t,r){return _.u(e)?this[t]:this.set(r,e)},y.unix=function(){return Math.floor(this.valueOf()/1e3)},y.valueOf=function(){return this.$d.getTime()},y.startOf=function(e,t){var r=this,n=!!_.u(t)||t,l=_.p(e),d=function(e,t){var s=_.w(r.$u?Date.UTC(r.$y,t,e):new Date(r.$y,t,e),r);return n?s:s.endOf(a)},f=function(e,t){return _.w(r.toDate()[e].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(t)),r)},p=this.$W,g=this.$M,y=this.$D,w="set"+(this.$u?"UTC":"");switch(l){case u:return n?d(1,0):d(31,11);case c:return n?d(1,g):d(0,g+1);case A:var m=this.$locale().weekStart||0,b=(p<m?p+7:p)-m;return d(n?y-b:y+(6-b),g);case a:case h:return f(w+"Hours",0);case o:return f(w+"Minutes",1);case i:return f(w+"Seconds",2);case s:return f(w+"Milliseconds",3);default:return this.clone()}},y.endOf=function(e){return this.startOf(e,!1)},y.$set=function(e,t){var r,A=_.p(e),l="set"+(this.$u?"UTC":""),d=(r={},r[a]=l+"Date",r[h]=l+"Date",r[c]=l+"Month",r[u]=l+"FullYear",r[o]=l+"Hours",r[i]=l+"Minutes",r[s]=l+"Seconds",r[n]=l+"Milliseconds",r)[A],f=A===a?this.$D+(t-this.$W):t;if(A===c||A===u){var p=this.clone().set(h,1);p.$d[d](f),p.init(),this.$d=p.set(h,Math.min(this.$D,p.daysInMonth())).$d}else d&&this.$d[d](f);return this.init(),this},y.set=function(e,t){return this.clone().$set(e,t)},y.get=function(e){return this[_.p(e)]()},y.add=function(n,l){var h,d=this;n=Number(n);var f=_.p(l),p=function(e){var t=B(d);return _.w(t.date(t.date()+Math.round(e*n)),d)};if(f===c)return this.set(c,this.$M+n);if(f===u)return this.set(u,this.$y+n);if(f===a)return p(1);if(f===A)return p(7);var g=(h={},h[i]=t,h[o]=r,h[s]=e,h)[f]||1,y=this.$d.getTime()+n*g;return _.w(y,this)},y.subtract=function(e,t){return this.add(-1*e,t)},y.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return r.invalidDate||d;var n=e||"YYYY-MM-DDTHH:mm:ssZ",s=_.z(this),i=this.$H,o=this.$m,a=this.$M,A=r.weekdays,c=r.months,l=function(e,r,s,i){return e&&(e[r]||e(t,n))||s[r].slice(0,i)},u=function(e){return _.s(i%12||12,e,"0")},h=r.meridiem||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n},f={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:_.s(a+1,2,"0"),MMM:l(r.monthsShort,a,c,3),MMMM:l(c,a),D:this.$D,DD:_.s(this.$D,2,"0"),d:String(this.$W),dd:l(r.weekdaysMin,this.$W,A,2),ddd:l(r.weekdaysShort,this.$W,A,3),dddd:A[this.$W],H:String(i),HH:_.s(i,2,"0"),h:u(1),hh:u(2),a:h(i,o,!0),A:h(i,o,!1),m:String(o),mm:_.s(o,2,"0"),s:String(this.$s),ss:_.s(this.$s,2,"0"),SSS:_.s(this.$ms,3,"0"),Z:s};return n.replace(p,(function(e,t){return t||f[e]||s.replace(":","")}))},y.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},y.diff=function(n,h,d){var f,p=_.p(h),g=B(n),y=(g.utcOffset()-this.utcOffset())*t,w=this-g,m=_.m(this,g);return m=(f={},f[u]=m/12,f[c]=m,f[l]=m/3,f[A]=(w-y)/6048e5,f[a]=(w-y)/864e5,f[o]=w/r,f[i]=w/t,f[s]=w/e,f)[p]||w,d?m:_.a(m)},y.daysInMonth=function(){return this.endOf(c).$D},y.$locale=function(){return b[this.$L]},y.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),n=v(e,t,!0);return n&&(r.$L=n),r},y.clone=function(){return _.w(this.$d,this)},y.toDate=function(){return new Date(this.valueOf())},y.toJSON=function(){return this.isValid()?this.toISOString():null},y.toISOString=function(){return this.$d.toISOString()},y.toString=function(){return this.$d.toUTCString()},g}(),S=C.prototype;return B.prototype=S,[["$ms",n],["$s",s],["$m",i],["$H",o],["$W",a],["$M",c],["$y",u],["$D",h]].forEach((function(e){S[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),B.extend=function(e,t){return e.$i||(e(t,C,B),e.$i=!0),B},B.locale=v,B.isDayjs=E,B.unix=function(e){return B(1e3*e)},B.en=b[m],B.Ls=b,B.p={},B}()},65780:function(e){"use strict";const t=()=>{const e=new Error("Delay aborted");return e.name="AbortError",e},r=({clearTimeout:e,setTimeout:r,willResolve:n})=>(s,{value:i,signal:o}={})=>{if(o&&o.aborted)return Promise.reject(t());let a,A,c;const l=e||clearTimeout,u=()=>{l(a),c(t())},h=new Promise(((e,t)=>{A=()=>{o&&o.removeEventListener("abort",u),n?e(i):t(i)},c=t,a=(r||setTimeout)(A,s)}));return o&&o.addEventListener("abort",u,{once:!0}),h.clear=()=>{l(a),a=null,A()},h},n=e=>{const t=r({...e,willResolve:!0});return t.reject=r({...e,willResolve:!1}),t.range=(e,r,n)=>t(((e,t)=>Math.floor(Math.random()*(t-e+1)+e))(e,r),n),t},s=n();s.createWithTimers=n,e.exports=s,e.exports.default=s},45001:function(e){"use strict";function t(e,t){t=t||{};this._head=0,this._tail=0,this._capacity=t.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(e)&&this._fromArray(e)}t.prototype.peekAt=function(e){var t=e;if(t===(0|t)){var r=this.size();if(!(t>=r||t<-r))return t<0&&(t+=r),t=this._head+t&this._capacityMask,this._list[t]}},t.prototype.get=function(e){return this.peekAt(e)},t.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]},t.prototype.peekFront=function(){return this.peek()},t.prototype.peekBack=function(){return this.peekAt(-1)},Object.defineProperty(t.prototype,"length",{get:function(){return this.size()}}),t.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},t.prototype.unshift=function(e){if(void 0===e)return this.size();var t=this._list.length;return this._head=this._head-1+t&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},t.prototype.shift=function(){var e=this._head;if(e!==this._tail){var t=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),t}},t.prototype.push=function(e){if(void 0===e)return this.size();var t=this._tail;return this._list[t]=e,this._tail=t+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},t.prototype.pop=function(){var e=this._tail;if(e!==this._head){var t=this._list.length;this._tail=e-1+t&this._capacityMask;var r=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=t>>>2&&this._shrinkArray(),r}},t.prototype.removeOne=function(e){var t=e;if(t===(0|t)&&this._head!==this._tail){var r=this.size(),n=this._list.length;if(!(t>=r||t<-r)){t<0&&(t+=r),t=this._head+t&this._capacityMask;var s,i=this._list[t];if(e<r/2){for(s=e;s>0;s--)this._list[t]=this._list[t=t-1+n&this._capacityMask];this._list[t]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(s=r-1-e;s>0;s--)this._list[t]=this._list[t=t+1+n&this._capacityMask];this._list[t]=void 0,this._tail=this._tail-1+n&this._capacityMask}return i}}},t.prototype.remove=function(e,t){var r,n=e,s=t;if(n===(0|n)&&this._head!==this._tail){var i=this.size(),o=this._list.length;if(!(n>=i||n<-i||t<1)){if(n<0&&(n+=i),1===t||!t)return(r=new Array(1))[0]=this.removeOne(n),r;if(0===n&&n+t>=i)return r=this.toArray(),this.clear(),r;var a;for(n+t>i&&(t=i-n),r=new Array(t),a=0;a<t;a++)r[a]=this._list[this._head+n+a&this._capacityMask];if(n=this._head+n&this._capacityMask,e+t===i){for(this._tail=this._tail-t+o&this._capacityMask,a=t;a>0;a--)this._list[n=n+1+o&this._capacityMask]=void 0;return r}if(0===e){for(this._head=this._head+t+o&this._capacityMask,a=t-1;a>0;a--)this._list[n=n+1+o&this._capacityMask]=void 0;return r}if(n<i/2){for(this._head=this._head+e+t+o&this._capacityMask,a=e;a>0;a--)this.unshift(this._list[n=n-1+o&this._capacityMask]);for(n=this._head-1+o&this._capacityMask;s>0;)this._list[n=n-1+o&this._capacityMask]=void 0,s--;e<0&&(this._tail=n)}else{for(this._tail=n,n=n+t+o&this._capacityMask,a=i-(t+e);a>0;a--)this.push(this._list[n++]);for(n=this._tail;s>0;)this._list[n=n+1+o&this._capacityMask]=void 0,s--}return this._head<2&&this._tail>1e4&&this._tail<=o>>>2&&this._shrinkArray(),r}}},t.prototype.splice=function(e,t){var r=e;if(r===(0|r)){var n=this.size();if(r<0&&(r+=n),!(r>n)){if(arguments.length>2){var s,i,o,a=arguments.length,A=this._list.length,c=2;if(!n||r<n/2){for(i=new Array(r),s=0;s<r;s++)i[s]=this._list[this._head+s&this._capacityMask];for(0===t?(o=[],r>0&&(this._head=this._head+r+A&this._capacityMask)):(o=this.remove(r,t),this._head=this._head+r+A&this._capacityMask);a>c;)this.unshift(arguments[--a]);for(s=r;s>0;s--)this.unshift(i[s-1])}else{var l=(i=new Array(n-(r+t))).length;for(s=0;s<l;s++)i[s]=this._list[this._head+r+t+s&this._capacityMask];for(0===t?(o=[],r!=n&&(this._tail=this._head+r+A&this._capacityMask)):(o=this.remove(r,t),this._tail=this._tail-l+A&this._capacityMask);c<a;)this.push(arguments[c++]);for(s=0;s<l;s++)this.push(i[s])}return o}return this.remove(r,t)}}},t.prototype.clear=function(){this._head=0,this._tail=0},t.prototype.isEmpty=function(){return this._head===this._tail},t.prototype.toArray=function(){return this._copyArray(!1)},t.prototype._fromArray=function(e){for(var t=0;t<e.length;t++)this.push(e[t])},t.prototype._copyArray=function(e){var t,r=[],n=this._list,s=n.length;if(e||this._head>this._tail){for(t=this._head;t<s;t++)r.push(n[t]);for(t=0;t<this._tail;t++)r.push(n[t])}else for(t=this._head;t<this._tail;t++)r.push(n[t]);return r},t.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1},t.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1},e.exports=t},26905:function(e){e.exports=function(e,t,r,n,s){for(t=t.split?t.split("."):t,n=0;n<t.length;n++)e=e?e[t[n]]:s;return e===s?r:e}},32114:function(e){"use strict";function t(e,t){for(const r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}e.exports=function(e,r,n){if(!e||"string"==typeof e)throw new TypeError("Please pass an Error to err-code");n||(n={}),"object"==typeof r&&(n=r,r=""),r&&(n.code=r);try{return t(e,n)}catch(r){n.message=e.message,n.stack=e.stack;const s=function(){};s.prototype=Object.create(Object.getPrototypeOf(e));return t(new s,n)}}},90507:function(e,t,r){"use strict";const n=r(8231);t.zN=n.EventIterator,n.EventIterator},8231:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(e){if(this.isStopped)return;const t={value:e,done:!1};if(this.pullQueue.length){const e=this.pullQueue.shift();e&&e.resolve(t)}else this.pushQueue.push(Promise.resolve(t)),void 0!==this.highWaterMark&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(const e of this.pullQueue)e.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(const t of this.pullQueue)t.reject(e);this.pullQueue.length=0}else{const t=Promise.reject(e);t.catch((()=>{})),this.pushQueue.push(t)}}remove(){Promise.resolve().then((()=>{this.removeCallback&&this.removeCallback()}))}[Symbol.asyncIterator](){return{next:e=>{const t=this.pushQueue.shift();return t?(void 0!==this.lowWaterMark&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),t):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise(((e,t)=>{this.pullQueue.push({resolve:e,reject:t})}))},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}}class n{constructor(e,{highWaterMark:t=100,lowWaterMark:n=1}={}){const s=new r;s.highWaterMark=t,s.lowWaterMark=n,s.removeCallback=e({push:e=>s.push(e),stop:()=>s.stop(),fail:e=>s.fail(e),on:(e,t)=>{s.eventHandlers[e]=t}})||(()=>{}),this[Symbol.asyncIterator]=()=>s[Symbol.asyncIterator](),Object.freeze(this)}}t.EventIterator=n,t.default=n},26729:function(e){"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function s(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function i(e,t,n,i,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new s(n,i||e,o),A=r?r+t:t;return e._events[A]?e._events[A].fn?e._events[A]=[e._events[A],a]:e._events[A].push(a):(e._events[A]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,s=[];if(0===this._eventsCount)return s;for(n in e=this._events)t.call(e,n)&&s.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(e)):s},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var s=0,i=n.length,o=new Array(i);s<i;s++)o[s]=n[s].fn;return o},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,s,i,o){var a=r?r+e:e;if(!this._events[a])return!1;var A,c,l=this._events[a],u=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),u){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,s),!0;case 5:return l.fn.call(l.context,t,n,s,i),!0;case 6:return l.fn.call(l.context,t,n,s,i,o),!0}for(c=1,A=new Array(u-1);c<u;c++)A[c-1]=arguments[c];l.fn.apply(l.context,A)}else{var h,d=l.length;for(c=0;c<d;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),u){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,n);break;case 4:l[c].fn.call(l[c].context,t,n,s);break;default:if(!A)for(h=1,A=new Array(u-1);h<u;h++)A[h-1]=arguments[h];l[c].fn.apply(l[c].context,A)}}return!0},a.prototype.on=function(e,t,r){return i(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return i(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,s){var i=r?r+e:e;if(!this._events[i])return this;if(!t)return o(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||s&&!a.once||n&&a.context!==n||o(this,i);else{for(var A=0,c=[],l=a.length;A<l;A++)(a[A].fn!==t||s&&!a[A].once||n&&a[A].context!==n)&&c.push(a[A]);c.length?this._events[i]=1===c.length?c[0]:c:o(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&o(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},3975:function(e){e.exports=class{constructor(e){if(!(e>0)||0!=(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return void 0===this.buffer[this.btm]}}},91607:function(e,t,r){const n=r(3975);e.exports=class{constructor(e){this.hwm=e||16,this.head=new n(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){const t=this.head;this.head=t.next=new n(2*this.head.buffer.length),this.head.push(e)}}shift(){const e=this.tail.shift();if(void 0===e&&this.tail.next){const e=this.tail.next;return this.tail.next=null,this.tail=e,this.tail.shift()}return e}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}},96132:function(e,t){"use strict";function r(e,t=r.BASE){const n=e.length;for(let r=0;r<n;r++)t^=e.charCodeAt(r),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}Object.defineProperty(t,"__esModule",{value:!0}),r.BASE=2166136261,t.default=r,e.exports=r},70248:function(e){e.exports=function(e){if(!e)throw Error("hashlru must have a max value, of type number, greater than 0");var t=0,r=Object.create(null),n=Object.create(null);function s(s,i){r[s]=i,++t>=e&&(t=0,n=r,r=Object.create(null))}return{has:function(e){return void 0!==r[e]||void 0!==n[e]},remove:function(e){void 0!==r[e]&&(r[e]=void 0),void 0!==n[e]&&(n[e]=void 0)},get:function(e){var t=r[e];return void 0!==t?t:void 0!==(t=n[e])?(s(e,t),t):void 0},set:function(e,t){void 0!==r[e]?r[e]=t:s(e,t)},clear:function(){r=Object.create(null),n=Object.create(null)}}}},61120:function(e){e.exports=function(){"use strict";var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};function t(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},r.apply(this,arguments)};function n(e,t,r,n){function s(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,i){function o(e){try{A(n.next(e))}catch(e){i(e)}}function a(e){try{A(n.throw(e))}catch(e){i(e)}}function A(e){e.done?r(e.value):s(e.value).then(o,a)}A((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return A([e,t])}}function A(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}function i(e,t,r){if(r||2===arguments.length)for(var n,s=0,i=t.length;s<i;s++)!n&&s in t||(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||t)}for(var o=function(){function e(e,t,r,n){this.left=e,this.top=t,this.width=r,this.height=n}return e.prototype.add=function(t,r,n,s){return new e(this.left+t,this.top+r,this.width+n,this.height+s)},e.fromClientRect=function(t,r){return new e(r.left+t.windowBounds.left,r.top+t.windowBounds.top,r.width,r.height)},e.fromDOMRectList=function(t,r){var n=Array.from(r).find((function(e){return 0!==e.width}));return n?new e(n.left+t.windowBounds.left,n.top+t.windowBounds.top,n.width,n.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e}(),a=function(e,t){return o.fromClientRect(e,t.getBoundingClientRect())},A=function(e){var t=e.body,r=e.documentElement;if(!t||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(t.scrollWidth,r.scrollWidth),Math.max(t.offsetWidth,r.offsetWidth),Math.max(t.clientWidth,r.clientWidth)),s=Math.max(Math.max(t.scrollHeight,r.scrollHeight),Math.max(t.offsetHeight,r.offsetHeight),Math.max(t.clientHeight,r.clientHeight));return new o(0,0,n,s)},c=function(e){for(var t=[],r=0,n=e.length;r<n;){var s=e.charCodeAt(r++);if(s>=55296&&s<=56319&&r<n){var i=e.charCodeAt(r++);56320==(64512&i)?t.push(((1023&s)<<10)+(1023&i)+65536):(t.push(s),r--)}else t.push(s)}return t},l=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],s=-1,i="";++s<r;){var o=e[s];o<=65535?n.push(o):(o-=65536,n.push(55296+(o>>10),o%1024+56320)),(s+1===r||n.length>16384)&&(i+=String.fromCharCode.apply(String,n),n.length=0)}return i},u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h="undefined"==typeof Uint8Array?[]:new Uint8Array(256),d=0;d<u.length;d++)h[u.charCodeAt(d)]=d;for(var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p="undefined"==typeof Uint8Array?[]:new Uint8Array(256),g=0;g<f.length;g++)p[f.charCodeAt(g)]=g;for(var y=function(e){var t,r,n,s,i,o=.75*e.length,a=e.length,A=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var c="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(o):new Array(o),l=Array.isArray(c)?c:new Uint8Array(c);for(t=0;t<a;t+=4)r=p[e.charCodeAt(t)],n=p[e.charCodeAt(t+1)],s=p[e.charCodeAt(t+2)],i=p[e.charCodeAt(t+3)],l[A++]=r<<2|n>>4,l[A++]=(15&n)<<4|s>>2,l[A++]=(3&s)<<6|63&i;return c},w=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},m=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},b=5,E=11,v=2,B=65536>>b,_=(1<<b)-1,C=B+(1024>>b)+32,S=65536>>E,I=(1<<E-b)-1,T=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},R=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},k=function(e,t){var r=y(e),n=Array.isArray(r)?m(r):new Uint32Array(r),s=Array.isArray(r)?w(r):new Uint16Array(r),i=24,o=T(s,i/2,n[4]/2),a=2===n[5]?T(s,(i+n[4])/2):R(n,Math.ceil((i+n[4])/4));return new U(n[0],n[1],n[2],n[3],o,a)},U=function(){function e(e,t,r,n,s,i){this.initialValue=e,this.errorValue=t,this.highStart=r,this.highValueIndex=n,this.index=s,this.data=i}return e.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=((t=this.index[e>>b])<<v)+(e&_),this.data[t];if(e<=65535)return t=((t=this.index[B+(e-55296>>b)])<<v)+(e&_),this.data[t];if(e<this.highStart)return t=C-S+(e>>E),t=this.index[t],t+=e>>b&I,t=((t=this.index[t])<<v)+(e&_),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",P="undefined"==typeof Uint8Array?[]:new Uint8Array(256),L=0;L<D.length;L++)P[D.charCodeAt(L)]=L;var N=50,O=1,F=2,Q=3,x=4,M=5,H=7,K=8,V=9,z=10,j=11,G=12,$=13,q=14,W=15,Y=16,X=17,J=18,Z=19,ee=20,te=21,re=22,ne=23,se=24,ie=25,oe=26,ae=27,Ae=28,ce=29,le=30,ue=31,he=32,de=33,fe=34,pe=35,ge=36,ye=37,we=38,me=39,be=40,Ee=41,ve=42,Be=43,_e=[9001,65288],Ce="!",Se="",Ie="",Te=k("KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA=="),Re=[le,ge],ke=[O,F,Q,M],Ue=[z,K],De=[ae,oe],Pe=ke.concat(Ue),Le=[we,me,be,fe,pe],Ne=[W,$],Oe=function(e,t){void 0===t&&(t="strict");var r=[],n=[],s=[];return e.forEach((function(e,i){var o=Te.get(e);if(o>N?(s.push(!0),o-=N):s.push(!1),-1!==["normal","auto","loose"].indexOf(t)&&-1!==[8208,8211,12316,12448].indexOf(e))return n.push(i),r.push(Y);if(o===x||o===j){if(0===i)return n.push(i),r.push(le);var a=r[i-1];return-1===Pe.indexOf(a)?(n.push(n[i-1]),r.push(a)):(n.push(i),r.push(le))}return n.push(i),o===ue?r.push("strict"===t?te:ye):o===ve||o===ce?r.push(le):o===Be?e>=131072&&e<=196605||e>=196608&&e<=262141?r.push(ye):r.push(le):void r.push(o)})),[n,r,s]},Fe=function(e,t,r,n){var s=n[r];if(Array.isArray(e)?-1!==e.indexOf(s):e===s)for(var i=r;i<=n.length;){if((A=n[++i])===t)return!0;if(A!==z)break}if(s===z)for(i=r;i>0;){var o=n[--i];if(Array.isArray(e)?-1!==e.indexOf(o):e===o)for(var a=r;a<=n.length;){var A;if((A=n[++a])===t)return!0;if(A!==z)break}if(o!==z)break}return!1},Qe=function(e,t){for(var r=e;r>=0;){var n=t[r];if(n!==z)return n;r--}return 0},xe=function(e,t,r,n,s){if(0===r[n])return Se;var i=n-1;if(Array.isArray(s)&&!0===s[i])return Se;var o=i-1,a=i+1,A=t[i],c=o>=0?t[o]:0,l=t[a];if(A===F&&l===Q)return Se;if(-1!==ke.indexOf(A))return Ce;if(-1!==ke.indexOf(l))return Se;if(-1!==Ue.indexOf(l))return Se;if(Qe(i,t)===K)return Ie;if(Te.get(e[i])===j)return Se;if((A===he||A===de)&&Te.get(e[a])===j)return Se;if(A===H||l===H)return Se;if(A===V)return Se;if(-1===[z,$,W].indexOf(A)&&l===V)return Se;if(-1!==[X,J,Z,se,Ae].indexOf(l))return Se;if(Qe(i,t)===re)return Se;if(Fe(ne,re,i,t))return Se;if(Fe([X,J],te,i,t))return Se;if(Fe(G,G,i,t))return Se;if(A===z)return Ie;if(A===ne||l===ne)return Se;if(l===Y||A===Y)return Ie;if(-1!==[$,W,te].indexOf(l)||A===q)return Se;if(c===ge&&-1!==Ne.indexOf(A))return Se;if(A===Ae&&l===ge)return Se;if(l===ee)return Se;if(-1!==Re.indexOf(l)&&A===ie||-1!==Re.indexOf(A)&&l===ie)return Se;if(A===ae&&-1!==[ye,he,de].indexOf(l)||-1!==[ye,he,de].indexOf(A)&&l===oe)return Se;if(-1!==Re.indexOf(A)&&-1!==De.indexOf(l)||-1!==De.indexOf(A)&&-1!==Re.indexOf(l))return Se;if(-1!==[ae,oe].indexOf(A)&&(l===ie||-1!==[re,W].indexOf(l)&&t[a+1]===ie)||-1!==[re,W].indexOf(A)&&l===ie||A===ie&&-1!==[ie,Ae,se].indexOf(l))return Se;if(-1!==[ie,Ae,se,X,J].indexOf(l))for(var u=i;u>=0;){if((h=t[u])===ie)return Se;if(-1===[Ae,se].indexOf(h))break;u--}if(-1!==[ae,oe].indexOf(l))for(u=-1!==[X,J].indexOf(A)?o:i;u>=0;){var h;if((h=t[u])===ie)return Se;if(-1===[Ae,se].indexOf(h))break;u--}if(we===A&&-1!==[we,me,fe,pe].indexOf(l)||-1!==[me,fe].indexOf(A)&&-1!==[me,be].indexOf(l)||-1!==[be,pe].indexOf(A)&&l===be)return Se;if(-1!==Le.indexOf(A)&&-1!==[ee,oe].indexOf(l)||-1!==Le.indexOf(l)&&A===ae)return Se;if(-1!==Re.indexOf(A)&&-1!==Re.indexOf(l))return Se;if(A===se&&-1!==Re.indexOf(l))return Se;if(-1!==Re.concat(ie).indexOf(A)&&l===re&&-1===_e.indexOf(e[a])||-1!==Re.concat(ie).indexOf(l)&&A===J)return Se;if(A===Ee&&l===Ee){for(var d=r[i],f=1;d>0&&t[--d]===Ee;)f++;if(f%2!=0)return Se}return A===he&&l===de?Se:Ie},Me=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var r=Oe(e,t.lineBreak),n=r[0],s=r[1],i=r[2];"break-all"!==t.wordBreak&&"break-word"!==t.wordBreak||(s=s.map((function(e){return-1!==[ie,le,ve].indexOf(e)?ye:e})));var o="keep-all"===t.wordBreak?i.map((function(t,r){return t&&e[r]>=19968&&e[r]<=40959})):void 0;return[n,s,o]},He=function(){function e(e,t,r,n){this.codePoints=e,this.required=t===Ce,this.start=r,this.end=n}return e.prototype.slice=function(){return l.apply(void 0,this.codePoints.slice(this.start,this.end))},e}(),Ke=function(e,t){var r=c(e),n=Me(r,t),s=n[0],i=n[1],o=n[2],a=r.length,A=0,l=0;return{next:function(){if(l>=a)return{done:!0,value:null};for(var e=Se;l<a&&(e=xe(r,i,s,++l,o))===Se;);if(e!==Se||l===a){var t=new He(r,e,A,l);return A=l,{value:t,done:!1}}return{done:!0,value:null}}}},Ve=1,ze=2,je=4,Ge=8,$e=10,qe=47,We=92,Ye=9,Xe=32,Je=34,Ze=61,et=35,tt=36,rt=37,nt=39,st=40,it=41,ot=95,at=45,At=33,ct=60,lt=62,ut=64,ht=91,dt=93,ft=61,pt=123,gt=63,yt=125,wt=124,mt=126,bt=128,Et=65533,vt=42,Bt=43,_t=44,Ct=58,St=59,It=46,Tt=0,Rt=8,kt=11,Ut=14,Dt=31,Pt=127,Lt=-1,Nt=48,Ot=97,Ft=101,Qt=102,xt=117,Mt=122,Ht=65,Kt=69,Vt=70,zt=85,jt=90,Gt=function(e){return e>=Nt&&e<=57},$t=function(e){return e>=55296&&e<=57343},qt=function(e){return Gt(e)||e>=Ht&&e<=Vt||e>=Ot&&e<=Qt},Wt=function(e){return e>=Ot&&e<=Mt},Yt=function(e){return e>=Ht&&e<=jt},Xt=function(e){return Wt(e)||Yt(e)},Jt=function(e){return e>=bt},Zt=function(e){return e===$e||e===Ye||e===Xe},er=function(e){return Xt(e)||Jt(e)||e===ot},tr=function(e){return er(e)||Gt(e)||e===at},rr=function(e){return e>=Tt&&e<=Rt||e===kt||e>=Ut&&e<=Dt||e===Pt},nr=function(e,t){return e===We&&t!==$e},sr=function(e,t,r){return e===at?er(t)||nr(t,r):!!er(e)||!(e!==We||!nr(e,t))},ir=function(e,t,r){return e===Bt||e===at?!!Gt(t)||t===It&&Gt(r):Gt(e===It?t:e)},or=function(e){var t=0,r=1;e[t]!==Bt&&e[t]!==at||(e[t]===at&&(r=-1),t++);for(var n=[];Gt(e[t]);)n.push(e[t++]);var s=n.length?parseInt(l.apply(void 0,n),10):0;e[t]===It&&t++;for(var i=[];Gt(e[t]);)i.push(e[t++]);var o=i.length,a=o?parseInt(l.apply(void 0,i),10):0;e[t]!==Kt&&e[t]!==Ft||t++;var A=1;e[t]!==Bt&&e[t]!==at||(e[t]===at&&(A=-1),t++);for(var c=[];Gt(e[t]);)c.push(e[t++]);var u=c.length?parseInt(l.apply(void 0,c),10):0;return r*(s+a*Math.pow(10,-o))*Math.pow(10,A*u)},ar={type:2},Ar={type:3},cr={type:4},lr={type:13},ur={type:8},hr={type:21},dr={type:9},fr={type:10},pr={type:11},gr={type:12},yr={type:14},wr={type:23},mr={type:1},br={type:25},Er={type:24},vr={type:26},Br={type:27},_r={type:28},Cr={type:29},Sr={type:31},Ir={type:32},Tr=function(){function e(){this._value=[]}return e.prototype.write=function(e){this._value=this._value.concat(c(e))},e.prototype.read=function(){for(var e=[],t=this.consumeToken();t!==Ir;)e.push(t),t=this.consumeToken();return e},e.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case Je:return this.consumeStringToken(Je);case et:var t=this.peekCodePoint(0),r=this.peekCodePoint(1),n=this.peekCodePoint(2);if(tr(t)||nr(r,n)){var s=sr(t,r,n)?ze:Ve;return{type:5,value:this.consumeName(),flags:s}}break;case tt:if(this.peekCodePoint(0)===Ze)return this.consumeCodePoint(),lr;break;case nt:return this.consumeStringToken(nt);case st:return ar;case it:return Ar;case vt:if(this.peekCodePoint(0)===Ze)return this.consumeCodePoint(),yr;break;case Bt:if(ir(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case _t:return cr;case at:var i=e,o=this.peekCodePoint(0),a=this.peekCodePoint(1);if(ir(i,o,a))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(sr(i,o,a))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(o===at&&a===lt)return this.consumeCodePoint(),this.consumeCodePoint(),Er;break;case It:if(ir(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case qe:if(this.peekCodePoint(0)===vt)for(this.consumeCodePoint();;){var A=this.consumeCodePoint();if(A===vt&&(A=this.consumeCodePoint())===qe)return this.consumeToken();if(A===Lt)return this.consumeToken()}break;case Ct:return vr;case St:return Br;case ct:if(this.peekCodePoint(0)===At&&this.peekCodePoint(1)===at&&this.peekCodePoint(2)===at)return this.consumeCodePoint(),this.consumeCodePoint(),br;break;case ut:var c=this.peekCodePoint(0),u=this.peekCodePoint(1),h=this.peekCodePoint(2);if(sr(c,u,h))return{type:7,value:this.consumeName()};break;case ht:return _r;case We:if(nr(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case dt:return Cr;case ft:if(this.peekCodePoint(0)===Ze)return this.consumeCodePoint(),ur;break;case pt:return pr;case yt:return gr;case xt:case zt:var d=this.peekCodePoint(0),f=this.peekCodePoint(1);return d!==Bt||!qt(f)&&f!==gt||(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case wt:if(this.peekCodePoint(0)===Ze)return this.consumeCodePoint(),dr;if(this.peekCodePoint(0)===wt)return this.consumeCodePoint(),hr;break;case mt:if(this.peekCodePoint(0)===Ze)return this.consumeCodePoint(),fr;break;case Lt:return Ir}return Zt(e)?(this.consumeWhiteSpace(),Sr):Gt(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):er(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:l(e)}},e.prototype.consumeCodePoint=function(){var e=this._value.shift();return void 0===e?-1:e},e.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},e.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},e.prototype.consumeUnicodeRangeToken=function(){for(var e=[],t=this.consumeCodePoint();qt(t)&&e.length<6;)e.push(t),t=this.consumeCodePoint();for(var r=!1;t===gt&&e.length<6;)e.push(t),t=this.consumeCodePoint(),r=!0;if(r)return{type:30,start:parseInt(l.apply(void 0,e.map((function(e){return e===gt?Nt:e}))),16),end:parseInt(l.apply(void 0,e.map((function(e){return e===gt?Vt:e}))),16)};var n=parseInt(l.apply(void 0,e),16);if(this.peekCodePoint(0)===at&&qt(this.peekCodePoint(1))){this.consumeCodePoint(),t=this.consumeCodePoint();for(var s=[];qt(t)&&s.length<6;)s.push(t),t=this.consumeCodePoint();return{type:30,start:n,end:parseInt(l.apply(void 0,s),16)}}return{type:30,start:n,end:n}},e.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return"url"===e.toLowerCase()&&this.peekCodePoint(0)===st?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===st?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},e.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Lt)return{type:22,value:""};var t=this.peekCodePoint(0);if(t===nt||t===Je){var r=this.consumeStringToken(this.consumeCodePoint());return 0===r.type&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Lt||this.peekCodePoint(0)===it)?(this.consumeCodePoint(),{type:22,value:r.value}):(this.consumeBadUrlRemnants(),wr)}for(;;){var n=this.consumeCodePoint();if(n===Lt||n===it)return{type:22,value:l.apply(void 0,e)};if(Zt(n))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Lt||this.peekCodePoint(0)===it?(this.consumeCodePoint(),{type:22,value:l.apply(void 0,e)}):(this.consumeBadUrlRemnants(),wr);if(n===Je||n===nt||n===st||rr(n))return this.consumeBadUrlRemnants(),wr;if(n===We){if(!nr(n,this.peekCodePoint(0)))return this.consumeBadUrlRemnants(),wr;e.push(this.consumeEscapedCodePoint())}else e.push(n)}},e.prototype.consumeWhiteSpace=function(){for(;Zt(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===it||e===Lt)return;nr(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(e){for(var t=5e4,r="";e>0;){var n=Math.min(t,e);r+=l.apply(void 0,this._value.splice(0,n)),e-=n}return this._value.shift(),r},e.prototype.consumeStringToken=function(e){for(var t="",r=0;;){var n=this._value[r];if(n===Lt||void 0===n||n===e)return{type:0,value:t+=this.consumeStringSlice(r)};if(n===$e)return this._value.splice(0,r),mr;if(n===We){var s=this._value[r+1];s!==Lt&&void 0!==s&&(s===$e?(t+=this.consumeStringSlice(r),r=-1,this._value.shift()):nr(n,s)&&(t+=this.consumeStringSlice(r),t+=l(this.consumeEscapedCodePoint()),r=-1))}r++}},e.prototype.consumeNumber=function(){var e=[],t=je,r=this.peekCodePoint(0);for(r!==Bt&&r!==at||e.push(this.consumeCodePoint());Gt(this.peekCodePoint(0));)e.push(this.consumeCodePoint());r=this.peekCodePoint(0);var n=this.peekCodePoint(1);if(r===It&&Gt(n))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=Ge;Gt(this.peekCodePoint(0));)e.push(this.consumeCodePoint());r=this.peekCodePoint(0),n=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((r===Kt||r===Ft)&&((n===Bt||n===at)&&Gt(s)||Gt(n)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=Ge;Gt(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[or(e),t]},e.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),t=e[0],r=e[1],n=this.peekCodePoint(0),s=this.peekCodePoint(1),i=this.peekCodePoint(2);return sr(n,s,i)?{type:15,number:t,flags:r,unit:this.consumeName()}:n===rt?(this.consumeCodePoint(),{type:16,number:t,flags:r}):{type:17,number:t,flags:r}},e.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(qt(e)){for(var t=l(e);qt(this.peekCodePoint(0))&&t.length<6;)t+=l(this.consumeCodePoint());Zt(this.peekCodePoint(0))&&this.consumeCodePoint();var r=parseInt(t,16);return 0===r||$t(r)||r>1114111?Et:r}return e===Lt?Et:e},e.prototype.consumeName=function(){for(var e="";;){var t=this.consumeCodePoint();if(tr(t))e+=l(t);else{if(!nr(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),e;e+=l(this.consumeEscapedCodePoint())}}},e}(),Rr=function(){function e(e){this._tokens=e}return e.create=function(t){var r=new Tr;return r.write(t),new e(r.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var e=this.consumeToken();31===e.type;)e=this.consumeToken();if(32===e.type)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var t=this.consumeComponentValue();do{e=this.consumeToken()}while(31===e.type);if(32===e.type)return t;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var e=[];;){var t=this.consumeComponentValue();if(32===t.type)return e;e.push(t),e.push()}},e.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},e.prototype.consumeSimpleBlock=function(e){for(var t={type:e,values:[]},r=this.consumeToken();;){if(32===r.type||Qr(r,e))return t;this.reconsumeToken(r),t.values.push(this.consumeComponentValue()),r=this.consumeToken()}},e.prototype.consumeFunction=function(e){for(var t={name:e.value,values:[],type:18};;){var r=this.consumeToken();if(32===r.type||3===r.type)return t;this.reconsumeToken(r),t.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var e=this._tokens.shift();return void 0===e?Ir:e},e.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},e}(),kr=function(e){return 15===e.type},Ur=function(e){return 17===e.type},Dr=function(e){return 20===e.type},Pr=function(e){return 0===e.type},Lr=function(e,t){return Dr(e)&&e.value===t},Nr=function(e){return 31!==e.type},Or=function(e){return 31!==e.type&&4!==e.type},Fr=function(e){var t=[],r=[];return e.forEach((function(e){if(4===e.type){if(0===r.length)throw new Error("Error parsing function args, zero tokens for arg");return t.push(r),void(r=[])}31!==e.type&&r.push(e)})),r.length&&t.push(r),t},Qr=function(e,t){return 11===t&&12===e.type||28===t&&29===e.type||2===t&&3===e.type},xr=function(e){return 17===e.type||15===e.type},Mr=function(e){return 16===e.type||xr(e)},Hr=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},Kr={type:17,number:0,flags:je},Vr={type:16,number:50,flags:je},zr={type:16,number:100,flags:je},jr=function(e,t,r){var n=e[0],s=e[1];return[Gr(n,t),Gr(void 0!==s?s:n,r)]},Gr=function(e,t){if(16===e.type)return e.number/100*t;if(kr(e))switch(e.unit){case"rem":case"em":return 16*e.number;default:return e.number}return e.number},$r="deg",qr="grad",Wr="rad",Yr="turn",Xr={name:"angle",parse:function(e,t){if(15===t.type)switch(t.unit){case $r:return Math.PI*t.number/180;case qr:return Math.PI/200*t.number;case Wr:return t.number;case Yr:return 2*Math.PI*t.number}throw new Error("Unsupported angle type")}},Jr=function(e){return 15===e.type&&(e.unit===$r||e.unit===qr||e.unit===Wr||e.unit===Yr)},Zr=function(e){switch(e.filter(Dr).map((function(e){return e.value})).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Kr,Kr];case"to top":case"bottom":return en(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Kr,zr];case"to right":case"left":return en(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[zr,zr];case"to bottom":case"top":return en(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[zr,Kr];case"to left":case"right":return en(270)}return 0},en=function(e){return Math.PI*e/180},tn={name:"color",parse:function(e,t){if(18===t.type){var r=ln[t.name];if(void 0===r)throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return r(e,t.values)}if(5===t.type){if(3===t.value.length){var n=t.value.substring(0,1),s=t.value.substring(1,2),i=t.value.substring(2,3);return sn(parseInt(n+n,16),parseInt(s+s,16),parseInt(i+i,16),1)}if(4===t.value.length){n=t.value.substring(0,1),s=t.value.substring(1,2),i=t.value.substring(2,3);var o=t.value.substring(3,4);return sn(parseInt(n+n,16),parseInt(s+s,16),parseInt(i+i,16),parseInt(o+o,16)/255)}if(6===t.value.length)return n=t.value.substring(0,2),s=t.value.substring(2,4),i=t.value.substring(4,6),sn(parseInt(n,16),parseInt(s,16),parseInt(i,16),1);if(8===t.value.length)return n=t.value.substring(0,2),s=t.value.substring(2,4),i=t.value.substring(4,6),o=t.value.substring(6,8),sn(parseInt(n,16),parseInt(s,16),parseInt(i,16),parseInt(o,16)/255)}if(20===t.type){var a=hn[t.value.toUpperCase()];if(void 0!==a)return a}return hn.TRANSPARENT}},rn=function(e){return 0==(255&e)},nn=function(e){var t=255&e,r=255&e>>8,n=255&e>>16,s=255&e>>24;return t<255?"rgba("+s+","+n+","+r+","+t/255+")":"rgb("+s+","+n+","+r+")"},sn=function(e,t,r,n){return(e<<24|t<<16|r<<8|Math.round(255*n)<<0)>>>0},on=function(e,t){if(17===e.type)return e.number;if(16===e.type){var r=3===t?1:255;return 3===t?e.number/100*r:Math.round(e.number/100*r)}return 0},an=function(e,t){var r=t.filter(Or);if(3===r.length){var n=r.map(on),s=n[0],i=n[1],o=n[2];return sn(s,i,o,1)}if(4===r.length){var a=r.map(on),A=(s=a[0],i=a[1],o=a[2],a[3]);return sn(s,i,o,A)}return 0};function An(e,t,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(t-e)*r*6+e:r<.5?t:r<2/3?6*(t-e)*(2/3-r)+e:e}var cn=function(e,t){var r=t.filter(Or),n=r[0],s=r[1],i=r[2],o=r[3],a=(17===n.type?en(n.number):Xr.parse(e,n))/(2*Math.PI),A=Mr(s)?s.number/100:0,c=Mr(i)?i.number/100:0,l=void 0!==o&&Mr(o)?Gr(o,1):1;if(0===A)return sn(255*c,255*c,255*c,1);var u=c<=.5?c*(A+1):c+A-c*A,h=2*c-u,d=An(h,u,a+1/3),f=An(h,u,a),p=An(h,u,a-1/3);return sn(255*d,255*f,255*p,l)},ln={hsl:cn,hsla:cn,rgb:an,rgba:an},un=function(e,t){return tn.parse(e,Rr.create(t).parseComponentValue())},hn={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},dn={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map((function(e){if(Dr(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0}))}},fn={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},pn=function(e,t){var r=tn.parse(e,t[0]),n=t[1];return n&&Mr(n)?{color:r,stop:n}:{color:r,stop:null}},gn=function(e,t){var r=e[0],n=e[e.length-1];null===r.stop&&(r.stop=Kr),null===n.stop&&(n.stop=zr);for(var s=[],i=0,o=0;o<e.length;o++){var a=e[o].stop;if(null!==a){var A=Gr(a,t);A>i?s.push(A):s.push(i),i=A}else s.push(null)}var c=null;for(o=0;o<s.length;o++){var l=s[o];if(null===l)null===c&&(c=o);else if(null!==c){for(var u=o-c,h=(l-s[c-1])/(u+1),d=1;d<=u;d++)s[c+d-1]=h*d;c=null}}return e.map((function(e,r){return{color:e.color,stop:Math.max(Math.min(1,s[r]/t),0)}}))},yn=function(e,t,r){var n=t/2,s=r/2,i=Gr(e[0],t)-n,o=s-Gr(e[1],r);return(Math.atan2(o,i)+2*Math.PI)%(2*Math.PI)},wn=function(e,t,r){var n="number"==typeof e?e:yn(e,t,r),s=Math.abs(t*Math.sin(n))+Math.abs(r*Math.cos(n)),i=t/2,o=r/2,a=s/2,A=Math.sin(n-Math.PI/2)*a,c=Math.cos(n-Math.PI/2)*a;return[s,i-c,i+c,o-A,o+A]},mn=function(e,t){return Math.sqrt(e*e+t*t)},bn=function(e,t,r,n,s){return[[0,0],[0,t],[e,0],[e,t]].reduce((function(e,t){var i=t[0],o=t[1],a=mn(r-i,n-o);return(s?a<e.optimumDistance:a>e.optimumDistance)?{optimumCorner:t,optimumDistance:a}:e}),{optimumDistance:s?1/0:-1/0,optimumCorner:null}).optimumCorner},En=function(e,t,r,n,s){var i=0,o=0;switch(e.size){case 0:0===e.shape?i=o=Math.min(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-s)):1===e.shape&&(i=Math.min(Math.abs(t),Math.abs(t-n)),o=Math.min(Math.abs(r),Math.abs(r-s)));break;case 2:if(0===e.shape)i=o=Math.min(mn(t,r),mn(t,r-s),mn(t-n,r),mn(t-n,r-s));else if(1===e.shape){var a=Math.min(Math.abs(r),Math.abs(r-s))/Math.min(Math.abs(t),Math.abs(t-n)),A=bn(n,s,t,r,!0),c=A[0],l=A[1];o=a*(i=mn(c-t,(l-r)/a))}break;case 1:0===e.shape?i=o=Math.max(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-s)):1===e.shape&&(i=Math.max(Math.abs(t),Math.abs(t-n)),o=Math.max(Math.abs(r),Math.abs(r-s)));break;case 3:if(0===e.shape)i=o=Math.max(mn(t,r),mn(t,r-s),mn(t-n,r),mn(t-n,r-s));else if(1===e.shape){a=Math.max(Math.abs(r),Math.abs(r-s))/Math.max(Math.abs(t),Math.abs(t-n));var u=bn(n,s,t,r,!1);c=u[0],l=u[1],o=a*(i=mn(c-t,(l-r)/a))}}return Array.isArray(e.size)&&(i=Gr(e.size[0],n),o=2===e.size.length?Gr(e.size[1],s):i),[i,o]},vn=function(e,t){var r=en(180),n=[];return Fr(t).forEach((function(t,s){if(0===s){var i=t[0];if(20===i.type&&-1!==["top","left","right","bottom"].indexOf(i.value))return void(r=Zr(t));if(Jr(i))return void(r=(Xr.parse(e,i)+en(270))%en(360))}var o=pn(e,t);n.push(o)})),{angle:r,stops:n,type:1}},Bn="closest-side",_n="farthest-side",Cn="closest-corner",Sn="farthest-corner",In="circle",Tn="ellipse",Rn="cover",kn="contain",Un=function(e,t){var r=0,n=3,s=[],i=[];return Fr(t).forEach((function(t,o){var a=!0;if(0===o?a=t.reduce((function(e,t){if(Dr(t))switch(t.value){case"center":return i.push(Vr),!1;case"top":case"left":return i.push(Kr),!1;case"right":case"bottom":return i.push(zr),!1}else if(Mr(t)||xr(t))return i.push(t),!1;return e}),a):1===o&&(a=t.reduce((function(e,t){if(Dr(t))switch(t.value){case In:return r=0,!1;case Tn:return r=1,!1;case kn:case Bn:return n=0,!1;case _n:return n=1,!1;case Cn:return n=2,!1;case Rn:case Sn:return n=3,!1}else if(xr(t)||Mr(t))return Array.isArray(n)||(n=[]),n.push(t),!1;return e}),a)),a){var A=pn(e,t);s.push(A)}})),{size:n,shape:r,stops:s,position:i,type:2}},Dn=function(e){return 1===e.type},Pn=function(e){return 2===e.type},Ln={name:"image",parse:function(e,t){if(22===t.type){var r={url:t.value,type:0};return e.cache.addImage(t.value),r}if(18===t.type){var n=Fn[t.name];if(void 0===n)throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return n(e,t.values)}throw new Error("Unsupported image type "+t.type)}};function Nn(e){return!(20===e.type&&"none"===e.value||18===e.type&&!Fn[e.name])}var On,Fn={"linear-gradient":function(e,t){var r=en(180),n=[];return Fr(t).forEach((function(t,s){if(0===s){var i=t[0];if(20===i.type&&"to"===i.value)return void(r=Zr(t));if(Jr(i))return void(r=Xr.parse(e,i))}var o=pn(e,t);n.push(o)})),{angle:r,stops:n,type:1}},"-moz-linear-gradient":vn,"-ms-linear-gradient":vn,"-o-linear-gradient":vn,"-webkit-linear-gradient":vn,"radial-gradient":function(e,t){var r=0,n=3,s=[],i=[];return Fr(t).forEach((function(t,o){var a=!0;if(0===o){var A=!1;a=t.reduce((function(e,t){if(A)if(Dr(t))switch(t.value){case"center":return i.push(Vr),e;case"top":case"left":return i.push(Kr),e;case"right":case"bottom":return i.push(zr),e}else(Mr(t)||xr(t))&&i.push(t);else if(Dr(t))switch(t.value){case In:return r=0,!1;case Tn:return r=1,!1;case"at":return A=!0,!1;case Bn:return n=0,!1;case Rn:case _n:return n=1,!1;case kn:case Cn:return n=2,!1;case Sn:return n=3,!1}else if(xr(t)||Mr(t))return Array.isArray(n)||(n=[]),n.push(t),!1;return e}),a)}if(a){var c=pn(e,t);s.push(c)}})),{size:n,shape:r,stops:s,position:i,type:2}},"-moz-radial-gradient":Un,"-ms-radial-gradient":Un,"-o-radial-gradient":Un,"-webkit-radial-gradient":Un,"-webkit-gradient":function(e,t){var r=en(180),n=[],s=1,i=0,o=3,a=[];return Fr(t).forEach((function(t,r){var i=t[0];if(0===r){if(Dr(i)&&"linear"===i.value)return void(s=1);if(Dr(i)&&"radial"===i.value)return void(s=2)}if(18===i.type)if("from"===i.name){var o=tn.parse(e,i.values[0]);n.push({stop:Kr,color:o})}else if("to"===i.name)o=tn.parse(e,i.values[0]),n.push({stop:zr,color:o});else if("color-stop"===i.name){var a=i.values.filter(Or);if(2===a.length){o=tn.parse(e,a[1]);var A=a[0];Ur(A)&&n.push({stop:{type:16,number:100*A.number,flags:A.flags},color:o})}}})),1===s?{angle:(r+en(180))%en(360),stops:n,type:s}:{size:o,shape:i,stops:n,position:a,type:s}}},Qn={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(0===t.length)return[];var r=t[0];return 20===r.type&&"none"===r.value?[]:t.filter((function(e){return Or(e)&&Nn(e)})).map((function(t){return Ln.parse(e,t)}))}},xn={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map((function(e){if(Dr(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0}))}},Mn={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,t){return Fr(t).map((function(e){return e.filter(Mr)})).map(Hr)}},Hn={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,t){return Fr(t).map((function(e){return e.filter(Dr).map((function(e){return e.value})).join(" ")})).map(Kn)}},Kn=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;default:return 0}};!function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"}(On||(On={}));var Vn,zn={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,t){return Fr(t).map((function(e){return e.filter(jn)}))}},jn=function(e){return Dr(e)||Mr(e)},Gn=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},$n=Gn("top"),qn=Gn("right"),Wn=Gn("bottom"),Yn=Gn("left"),Xn=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:1,parse:function(e,t){return Hr(t.filter(Mr))}}},Jn=Xn("top-left"),Zn=Xn("top-right"),es=Xn("bottom-right"),ts=Xn("bottom-left"),rs=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,t){switch(t){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},ns=rs("top"),ss=rs("right"),is=rs("bottom"),os=rs("left"),as=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return kr(t)?t.number:0}}},As=as("top"),cs=as("right"),ls=as("bottom"),us=as("left"),hs={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},ds={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,t){return"rtl"===t?1:0}},fs={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,t){return t.filter(Dr).reduce((function(e,t){return e|ps(t.value)}),0)}},ps=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},gs={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},ys={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,t){return 20===t.type&&"normal"===t.value?0:17===t.type||15===t.type?t.number:0}};!function(e){e.NORMAL="normal",e.STRICT="strict"}(Vn||(Vn={}));var ws,ms={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){return"strict"===t?Vn.STRICT:Vn.NORMAL}},bs={name:"line-height",initialValue:"normal",prefix:!1,type:4},Es=function(e,t){return Dr(e)&&"normal"===e.value?1.2*t:17===e.type?t*e.number:Mr(e)?Gr(e,t):t},vs={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,t){return 20===t.type&&"none"===t.value?null:Ln.parse(e,t)}},Bs={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,t){return"inside"===t?0:1}},_s={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;default:return-1}}},Cs=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:4}},Ss=Cs("top"),Is=Cs("right"),Ts=Cs("bottom"),Rs=Cs("left"),ks={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,t){return t.filter(Dr).map((function(e){switch(e.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;default:return 0}}))}},Us={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){return"break-word"===t?"break-word":"normal"}},Ds=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},Ps=Ds("top"),Ls=Ds("right"),Ns=Ds("bottom"),Os=Ds("left"),Fs={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,t){switch(t){case"right":return 2;case"center":case"justify":return 1;default:return 0}}},Qs={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},xs={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return 1===t.length&&Lr(t[0],"none")?[]:Fr(t).map((function(t){for(var r={color:hn.TRANSPARENT,offsetX:Kr,offsetY:Kr,blur:Kr},n=0,s=0;s<t.length;s++){var i=t[s];xr(i)?(0===n?r.offsetX=i:1===n?r.offsetY=i:r.blur=i,n++):r.color=tn.parse(e,i)}return r}))}},Ms={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},Hs={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,t){if(20===t.type&&"none"===t.value)return null;if(18===t.type){var r=Ks[t.name];if(void 0===r)throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return r(t.values)}return null}},Ks={matrix:function(e){var t=e.filter((function(e){return 17===e.type})).map((function(e){return e.number}));return 6===t.length?t:null},matrix3d:function(e){var t=e.filter((function(e){return 17===e.type})).map((function(e){return e.number})),r=t[0],n=t[1];t[2],t[3];var s=t[4],i=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var o=t[12],a=t[13];return t[14],t[15],16===t.length?[r,n,s,i,o,a]:null}},Vs={type:16,number:50,flags:je},zs=[Vs,Vs],js={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,t){var r=t.filter(Mr);return 2!==r.length?zs:[r[0],r[1]]}},Gs={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"hidden":return 1;case"collapse":return 2;default:return 0}}};!function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"}(ws||(ws={}));for(var $s={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-all":return ws.BREAK_ALL;case"keep-all":return ws.KEEP_ALL;default:return ws.NORMAL}}},qs={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,t){if(20===t.type)return{auto:!0,order:0};if(Ur(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},Ws={name:"time",parse:function(e,t){if(15===t.type)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},Ys={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,t){return Ur(t)?t.number:1}},Xs={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Js={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,t){return t.filter(Dr).map((function(e){switch(e.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0})).filter((function(e){return 0!==e}))}},Zs={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,t){var r=[],n=[];return t.forEach((function(e){switch(e.type){case 20:case 0:r.push(e.value);break;case 17:r.push(e.number.toString());break;case 4:n.push(r.join(" ")),r.length=0}})),r.length&&n.push(r.join(" ")),n.map((function(e){return-1===e.indexOf(" ")?e:"'"+e+"'"}))}},ei={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},ti={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,t){return Ur(t)?t.number:Dr(t)&&"bold"===t.value?700:400}},ri={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.filter(Dr).map((function(e){return e.value}))}},ni={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";default:return"normal"}}},si=function(e,t){return 0!=(e&t)},ii={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(0===t.length)return[];var r=t[0];return 20===r.type&&"none"===r.value?[]:t}},oi={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(0===t.length)return null;var r=t[0];if(20===r.type&&"none"===r.value)return null;for(var n=[],s=t.filter(Nr),i=0;i<s.length;i++){var o=s[i],a=s[i+1];if(20===o.type){var A=a&&Ur(a)?a.number:1;n.push({counter:o.value,increment:A})}}return n}},ai={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(0===t.length)return[];for(var r=[],n=t.filter(Nr),s=0;s<n.length;s++){var i=n[s],o=n[s+1];if(Dr(i)&&"none"!==i.value){var a=o&&Ur(o)?o.number:0;r.push({counter:i.value,reset:a})}}return r}},Ai={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,t){return t.filter(kr).map((function(t){return Ws.parse(e,t)}))}},ci={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(0===t.length)return null;var r=t[0];if(20===r.type&&"none"===r.value)return null;var n=[],s=t.filter(Pr);if(s.length%2!=0)return null;for(var i=0;i<s.length;i+=2){var o=s[i].value,a=s[i+1].value;n.push({open:o,close:a})}return n}},li=function(e,t,r){if(!e)return"";var n=e[Math.min(t,e.length-1)];return n?r?n.open:n.close:""},ui={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return 1===t.length&&Lr(t[0],"none")?[]:Fr(t).map((function(t){for(var r={color:255,offsetX:Kr,offsetY:Kr,blur:Kr,spread:Kr,inset:!1},n=0,s=0;s<t.length;s++){var i=t[s];Lr(i,"inset")?r.inset=!0:xr(i)?(0===n?r.offsetX=i:1===n?r.offsetY=i:2===n?r.blur=i:r.spread=i,n++):r.color=tn.parse(e,i)}return r}))}},hi={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,t){var r=[0,1,2],n=[];return t.filter(Dr).forEach((function(e){switch(e.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2)}})),r.forEach((function(e){-1===n.indexOf(e)&&n.push(e)})),n}},di={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},fi={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return kr(t)?t.number:0}},pi=function(){function e(e,t){var r,n;this.animationDuration=wi(e,Ai,t.animationDuration),this.backgroundClip=wi(e,dn,t.backgroundClip),this.backgroundColor=wi(e,fn,t.backgroundColor),this.backgroundImage=wi(e,Qn,t.backgroundImage),this.backgroundOrigin=wi(e,xn,t.backgroundOrigin),this.backgroundPosition=wi(e,Mn,t.backgroundPosition),this.backgroundRepeat=wi(e,Hn,t.backgroundRepeat),this.backgroundSize=wi(e,zn,t.backgroundSize),this.borderTopColor=wi(e,$n,t.borderTopColor),this.borderRightColor=wi(e,qn,t.borderRightColor),this.borderBottomColor=wi(e,Wn,t.borderBottomColor),this.borderLeftColor=wi(e,Yn,t.borderLeftColor),this.borderTopLeftRadius=wi(e,Jn,t.borderTopLeftRadius),this.borderTopRightRadius=wi(e,Zn,t.borderTopRightRadius),this.borderBottomRightRadius=wi(e,es,t.borderBottomRightRadius),this.borderBottomLeftRadius=wi(e,ts,t.borderBottomLeftRadius),this.borderTopStyle=wi(e,ns,t.borderTopStyle),this.borderRightStyle=wi(e,ss,t.borderRightStyle),this.borderBottomStyle=wi(e,is,t.borderBottomStyle),this.borderLeftStyle=wi(e,os,t.borderLeftStyle),this.borderTopWidth=wi(e,As,t.borderTopWidth),this.borderRightWidth=wi(e,cs,t.borderRightWidth),this.borderBottomWidth=wi(e,ls,t.borderBottomWidth),this.borderLeftWidth=wi(e,us,t.borderLeftWidth),this.boxShadow=wi(e,ui,t.boxShadow),this.color=wi(e,hs,t.color),this.direction=wi(e,ds,t.direction),this.display=wi(e,fs,t.display),this.float=wi(e,gs,t.cssFloat),this.fontFamily=wi(e,Zs,t.fontFamily),this.fontSize=wi(e,ei,t.fontSize),this.fontStyle=wi(e,ni,t.fontStyle),this.fontVariant=wi(e,ri,t.fontVariant),this.fontWeight=wi(e,ti,t.fontWeight),this.letterSpacing=wi(e,ys,t.letterSpacing),this.lineBreak=wi(e,ms,t.lineBreak),this.lineHeight=wi(e,bs,t.lineHeight),this.listStyleImage=wi(e,vs,t.listStyleImage),this.listStylePosition=wi(e,Bs,t.listStylePosition),this.listStyleType=wi(e,_s,t.listStyleType),this.marginTop=wi(e,Ss,t.marginTop),this.marginRight=wi(e,Is,t.marginRight),this.marginBottom=wi(e,Ts,t.marginBottom),this.marginLeft=wi(e,Rs,t.marginLeft),this.opacity=wi(e,Ys,t.opacity);var s=wi(e,ks,t.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=wi(e,Us,t.overflowWrap),this.paddingTop=wi(e,Ps,t.paddingTop),this.paddingRight=wi(e,Ls,t.paddingRight),this.paddingBottom=wi(e,Ns,t.paddingBottom),this.paddingLeft=wi(e,Os,t.paddingLeft),this.paintOrder=wi(e,hi,t.paintOrder),this.position=wi(e,Qs,t.position),this.textAlign=wi(e,Fs,t.textAlign),this.textDecorationColor=wi(e,Xs,null!==(r=t.textDecorationColor)&&void 0!==r?r:t.color),this.textDecorationLine=wi(e,Js,null!==(n=t.textDecorationLine)&&void 0!==n?n:t.textDecoration),this.textShadow=wi(e,xs,t.textShadow),this.textTransform=wi(e,Ms,t.textTransform),this.transform=wi(e,Hs,t.transform),this.transformOrigin=wi(e,js,t.transformOrigin),this.visibility=wi(e,Gs,t.visibility),this.webkitTextStrokeColor=wi(e,di,t.webkitTextStrokeColor),this.webkitTextStrokeWidth=wi(e,fi,t.webkitTextStrokeWidth),this.wordBreak=wi(e,$s,t.wordBreak),this.zIndex=wi(e,qs,t.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&0===this.visibility},e.prototype.isTransparent=function(){return rn(this.backgroundColor)},e.prototype.isTransformed=function(){return null!==this.transform},e.prototype.isPositioned=function(){return 0!==this.position},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return 0!==this.float},e.prototype.isInlineLevel=function(){return si(this.display,4)||si(this.display,33554432)||si(this.display,268435456)||si(this.display,536870912)||si(this.display,67108864)||si(this.display,134217728)},e}(),gi=function(){function e(e,t){this.content=wi(e,ii,t.content),this.quotes=wi(e,ci,t.quotes)}return e}(),yi=function(){function e(e,t){this.counterIncrement=wi(e,oi,t.counterIncrement),this.counterReset=wi(e,ai,t.counterReset)}return e}(),wi=function(e,t,r){var n=new Tr,s=null!=r?r.toString():t.initialValue;n.write(s);var i=new Rr(n.read());switch(t.type){case 2:var o=i.parseComponentValue();return t.parse(e,Dr(o)?o.value:t.initialValue);case 0:return t.parse(e,i.parseComponentValue());case 1:return t.parse(e,i.parseComponentValues());case 4:return i.parseComponentValue();case 3:switch(t.format){case"angle":return Xr.parse(e,i.parseComponentValue());case"color":return tn.parse(e,i.parseComponentValue());case"image":return Ln.parse(e,i.parseComponentValue());case"length":var a=i.parseComponentValue();return xr(a)?a:Kr;case"length-percentage":var A=i.parseComponentValue();return Mr(A)?A:Kr;case"time":return Ws.parse(e,i.parseComponentValue())}}},mi="data-html2canvas-debug",bi=function(e){switch(e.getAttribute(mi)){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Ei=function(e,t){var r=bi(e);return 1===r||t===r},vi=function(){function e(e,t){this.context=e,this.textNodes=[],this.elements=[],this.flags=0,Ei(t,3),this.styles=new pi(e,window.getComputedStyle(t,null)),la(t)&&(this.styles.animationDuration.some((function(e){return e>0}))&&(t.style.animationDuration="0s"),null!==this.styles.transform&&(t.style.transform="none")),this.bounds=a(this.context,t),Ei(t,4)&&(this.flags|=16)}return e}(),Bi="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",_i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ci="undefined"==typeof Uint8Array?[]:new Uint8Array(256),Si=0;Si<_i.length;Si++)Ci[_i.charCodeAt(Si)]=Si;for(var Ii=function(e){var t,r,n,s,i,o=.75*e.length,a=e.length,A=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var c="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(o):new Array(o),l=Array.isArray(c)?c:new Uint8Array(c);for(t=0;t<a;t+=4)r=Ci[e.charCodeAt(t)],n=Ci[e.charCodeAt(t+1)],s=Ci[e.charCodeAt(t+2)],i=Ci[e.charCodeAt(t+3)],l[A++]=r<<2|n>>4,l[A++]=(15&n)<<4|s>>2,l[A++]=(3&s)<<6|63&i;return c},Ti=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},Ri=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},ki=5,Ui=11,Di=2,Pi=65536>>ki,Li=(1<<ki)-1,Ni=Pi+(1024>>ki)+32,Oi=65536>>Ui,Fi=(1<<Ui-ki)-1,Qi=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},xi=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},Mi=function(e,t){var r=Ii(e),n=Array.isArray(r)?Ri(r):new Uint32Array(r),s=Array.isArray(r)?Ti(r):new Uint16Array(r),i=24,o=Qi(s,i/2,n[4]/2),a=2===n[5]?Qi(s,(i+n[4])/2):xi(n,Math.ceil((i+n[4])/4));return new Hi(n[0],n[1],n[2],n[3],o,a)},Hi=function(){function e(e,t,r,n,s,i){this.initialValue=e,this.errorValue=t,this.highStart=r,this.highValueIndex=n,this.index=s,this.data=i}return e.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=((t=this.index[e>>ki])<<Di)+(e&Li),this.data[t];if(e<=65535)return t=((t=this.index[Pi+(e-55296>>ki)])<<Di)+(e&Li),this.data[t];if(e<this.highStart)return t=Ni-Oi+(e>>Ui),t=this.index[t],t+=e>>ki&Fi,t=((t=this.index[t])<<Di)+(e&Li),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),Ki="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Vi="undefined"==typeof Uint8Array?[]:new Uint8Array(256),zi=0;zi<Ki.length;zi++)Vi[Ki.charCodeAt(zi)]=zi;var ji,Gi=1,$i=2,qi=3,Wi=4,Yi=5,Xi=7,Ji=8,Zi=9,eo=10,to=11,ro=12,no=13,so=14,io=15,oo=function(e){for(var t=[],r=0,n=e.length;r<n;){var s=e.charCodeAt(r++);if(s>=55296&&s<=56319&&r<n){var i=e.charCodeAt(r++);56320==(64512&i)?t.push(((1023&s)<<10)+(1023&i)+65536):(t.push(s),r--)}else t.push(s)}return t},ao=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],s=-1,i="";++s<r;){var o=e[s];o<=65535?n.push(o):(o-=65536,n.push(55296+(o>>10),o%1024+56320)),(s+1===r||n.length>16384)&&(i+=String.fromCharCode.apply(String,n),n.length=0)}return i},Ao=Mi(Bi),co="",lo="",uo=function(e){return Ao.get(e)},ho=function(e,t,r){var n=r-2,s=t[n],i=t[r-1],o=t[r];if(i===$i&&o===qi)return co;if(i===$i||i===qi||i===Wi)return lo;if(o===$i||o===qi||o===Wi)return lo;if(i===Ji&&-1!==[Ji,Zi,to,ro].indexOf(o))return co;if(!(i!==to&&i!==Zi||o!==Zi&&o!==eo))return co;if((i===ro||i===eo)&&o===eo)return co;if(o===no||o===Yi)return co;if(o===Xi)return co;if(i===Gi)return co;if(i===no&&o===so){for(;s===Yi;)s=t[--n];if(s===so)return co}if(i===io&&o===io){for(var a=0;s===io;)a++,s=t[--n];if(a%2==0)return co}return lo},fo=function(e){var t=oo(e),r=t.length,n=0,s=0,i=t.map(uo);return{next:function(){if(n>=r)return{done:!0,value:null};for(var e=co;n<r&&(e=ho(t,i,++n))===co;);if(e!==co||n===r){var o=ao.apply(null,t.slice(s,n));return s=n,{value:o,done:!1}}return{done:!0,value:null}}}},po=function(e){for(var t,r=fo(e),n=[];!(t=r.next()).done;)t.value&&n.push(t.value.slice());return n},go=function(e){var t=123;if(e.createRange){var r=e.createRange();if(r.getBoundingClientRect){var n=e.createElement("boundtest");n.style.height=t+"px",n.style.display="block",e.body.appendChild(n),r.selectNode(n);var s=r.getBoundingClientRect(),i=Math.round(s.height);if(e.body.removeChild(n),i===t)return!0}}return!1},yo=function(e){var t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);var r=e.createRange();t.innerHTML="function"==typeof"".repeat?"&#128104;".repeat(10):"";var n=t.firstChild,s=c(n.data).map((function(e){return l(e)})),i=0,o={},a=s.every((function(e,t){r.setStart(n,i),r.setEnd(n,i+e.length);var s=r.getBoundingClientRect();i+=e.length;var a=s.x>o.x||s.y>o.y;return o=s,0===t||a}));return e.body.removeChild(t),a},wo=function(){return void 0!==(new Image).crossOrigin},mo=function(){return"string"==typeof(new XMLHttpRequest).responseType},bo=function(e){var t=new Image,r=e.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0),r.toDataURL()}catch(e){return!1}return!0},Eo=function(e){return 0===e[0]&&255===e[1]&&0===e[2]&&255===e[3]},vo=function(e){var t=e.createElement("canvas"),r=100;t.width=r,t.height=r;var n=t.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var s=new Image,i=t.toDataURL();s.src=i;var o=Bo(r,r,0,0,s);return n.fillStyle="red",n.fillRect(0,0,r,r),_o(o).then((function(t){n.drawImage(t,0,0);var s=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var o=e.createElement("div");return o.style.backgroundImage="url("+i+")",o.style.height=r+"px",Eo(s)?_o(Bo(r,r,0,0,o)):Promise.reject(!1)})).then((function(e){return n.drawImage(e,0,0),Eo(n.getImageData(0,0,r,r).data)})).catch((function(){return!1}))},Bo=function(e,t,r,n,s){var i="http://www.w3.org/2000/svg",o=document.createElementNS(i,"svg"),a=document.createElementNS(i,"foreignObject");return o.setAttributeNS(null,"width",e.toString()),o.setAttributeNS(null,"height",t.toString()),a.setAttributeNS(null,"width","100%"),a.setAttributeNS(null,"height","100%"),a.setAttributeNS(null,"x",r.toString()),a.setAttributeNS(null,"y",n.toString()),a.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(a),a.appendChild(s),o},_o=function(e){return new Promise((function(t,r){var n=new Image;n.onload=function(){return t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(e))}))},Co={get SUPPORT_RANGE_BOUNDS(){var e=go(document);return Object.defineProperty(Co,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=Co.SUPPORT_RANGE_BOUNDS&&yo(document);return Object.defineProperty(Co,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=bo(document);return Object.defineProperty(Co,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e="function"==typeof Array.from&&"function"==typeof window.fetch?vo(document):Promise.resolve(!1);return Object.defineProperty(Co,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=wo();return Object.defineProperty(Co,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e=mo();return Object.defineProperty(Co,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Co,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!("undefined"==typeof Intl||!Intl.Segmenter);return Object.defineProperty(Co,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},So=function(){function e(e,t){this.text=e,this.bounds=t}return e}(),Io=function(e,t,r,n){var s=Do(t,r),i=[],a=0;return s.forEach((function(t){if(r.textDecorationLine.length||t.trim().length>0)if(Co.SUPPORT_RANGE_BOUNDS){var s=Ro(n,a,t.length).getClientRects();if(s.length>1){var A=ko(t),c=0;A.forEach((function(t){i.push(new So(t,o.fromDOMRectList(e,Ro(n,c+a,t.length).getClientRects()))),c+=t.length}))}else i.push(new So(t,o.fromDOMRectList(e,s)))}else{var l=n.splitText(t.length);i.push(new So(t,To(e,n))),n=l}else Co.SUPPORT_RANGE_BOUNDS||(n=n.splitText(t.length));a+=t.length})),i},To=function(e,t){var r=t.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(t.cloneNode(!0));var s=t.parentNode;if(s){s.replaceChild(n,t);var i=a(e,n);return n.firstChild&&s.replaceChild(n.firstChild,n),i}}return o.EMPTY},Ro=function(e,t,r){var n=e.ownerDocument;if(!n)throw new Error("Node has no owner document");var s=n.createRange();return s.setStart(e,t),s.setEnd(e,t+r),s},ko=function(e){if(Co.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map((function(e){return e.segment}))}return po(e)},Uo=function(e,t){if(Co.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(e)).map((function(e){return e.segment}))}return Lo(e,t)},Do=function(e,t){return 0!==t.letterSpacing?ko(e):Uo(e,t)},Po=[32,160,4961,65792,65793,4153,4241],Lo=function(e,t){for(var r,n=Ke(e,{lineBreak:t.lineBreak,wordBreak:"break-word"===t.overflowWrap?"break-word":t.wordBreak}),s=[],i=function(){if(r.value){var e=r.value.slice(),t=c(e),n="";t.forEach((function(e){-1===Po.indexOf(e)?n+=l(e):(n.length&&s.push(n),s.push(l(e)),n="")})),n.length&&s.push(n)}};!(r=n.next()).done;)i();return s},No=function(){function e(e,t,r){this.text=Oo(t.data,r.textTransform),this.textBounds=Io(e,this.text,r,t)}return e}(),Oo=function(e,t){switch(t){case 1:return e.toLowerCase();case 3:return e.replace(Fo,Qo);case 2:return e.toUpperCase();default:return e}},Fo=/(^|\s|:|-|\(|\))([a-z])/g,Qo=function(e,t,r){return e.length>0?t+r.toUpperCase():e},xo=function(e){function r(t,r){var n=e.call(this,t,r)||this;return n.src=r.currentSrc||r.src,n.intrinsicWidth=r.naturalWidth,n.intrinsicHeight=r.naturalHeight,n.context.cache.addImage(n.src),n}return t(r,e),r}(vi),Mo=function(e){function r(t,r){var n=e.call(this,t,r)||this;return n.canvas=r,n.intrinsicWidth=r.width,n.intrinsicHeight=r.height,n}return t(r,e),r}(vi),Ho=function(e){function r(t,r){var n=e.call(this,t,r)||this,s=new XMLSerializer,i=a(t,r);return r.setAttribute("width",i.width+"px"),r.setAttribute("height",i.height+"px"),n.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(r)),n.intrinsicWidth=r.width.baseVal.value,n.intrinsicHeight=r.height.baseVal.value,n.context.cache.addImage(n.svg),n}return t(r,e),r}(vi),Ko=function(e){function r(t,r){var n=e.call(this,t,r)||this;return n.value=r.value,n}return t(r,e),r}(vi),Vo=function(e){function r(t,r){var n=e.call(this,t,r)||this;return n.start=r.start,n.reversed="boolean"==typeof r.reversed&&!0===r.reversed,n}return t(r,e),r}(vi),zo=[{type:15,flags:0,unit:"px",number:3}],jo=[{type:16,flags:0,number:50}],Go=function(e){return e.width>e.height?new o(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new o(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e},$o=function(e){var t=e.type===Yo?new Array(e.value.length+1).join(""):e.value;return 0===t.length?e.placeholder||"":t},qo="checkbox",Wo="radio",Yo="password",Xo=707406591,Jo=function(e){function r(t,r){var n=e.call(this,t,r)||this;switch(n.type=r.type.toLowerCase(),n.checked=r.checked,n.value=$o(r),n.type!==qo&&n.type!==Wo||(n.styles.backgroundColor=3739148031,n.styles.borderTopColor=n.styles.borderRightColor=n.styles.borderBottomColor=n.styles.borderLeftColor=2779096575,n.styles.borderTopWidth=n.styles.borderRightWidth=n.styles.borderBottomWidth=n.styles.borderLeftWidth=1,n.styles.borderTopStyle=n.styles.borderRightStyle=n.styles.borderBottomStyle=n.styles.borderLeftStyle=1,n.styles.backgroundClip=[0],n.styles.backgroundOrigin=[0],n.bounds=Go(n.bounds)),n.type){case qo:n.styles.borderTopRightRadius=n.styles.borderTopLeftRadius=n.styles.borderBottomRightRadius=n.styles.borderBottomLeftRadius=zo;break;case Wo:n.styles.borderTopRightRadius=n.styles.borderTopLeftRadius=n.styles.borderBottomRightRadius=n.styles.borderBottomLeftRadius=jo}return n}return t(r,e),r}(vi),Zo=function(e){function r(t,r){var n=e.call(this,t,r)||this,s=r.options[r.selectedIndex||0];return n.value=s&&s.text||"",n}return t(r,e),r}(vi),ea=function(e){function r(t,r){var n=e.call(this,t,r)||this;return n.value=r.value,n}return t(r,e),r}(vi),ta=function(e){function r(t,r){var n=e.call(this,t,r)||this;n.src=r.src,n.width=parseInt(r.width,10)||0,n.height=parseInt(r.height,10)||0,n.backgroundColor=n.styles.backgroundColor;try{if(r.contentWindow&&r.contentWindow.document&&r.contentWindow.document.documentElement){n.tree=ia(t,r.contentWindow.document.documentElement);var s=r.contentWindow.document.documentElement?un(t,getComputedStyle(r.contentWindow.document.documentElement).backgroundColor):hn.TRANSPARENT,i=r.contentWindow.document.body?un(t,getComputedStyle(r.contentWindow.document.body).backgroundColor):hn.TRANSPARENT;n.backgroundColor=rn(s)?rn(i)?n.styles.backgroundColor:i:s}}catch(e){}return n}return t(r,e),r}(vi),ra=["OL","UL","MENU"],na=function(e,t,r,n){for(var s=t.firstChild,i=void 0;s;s=i)if(i=s.nextSibling,Aa(s)&&s.data.trim().length>0)r.textNodes.push(new No(e,s,r.styles));else if(ca(s))if(Sa(s)&&s.assignedNodes)s.assignedNodes().forEach((function(t){return na(e,t,r,n)}));else{var o=sa(e,s);o.styles.isVisible()&&(oa(s,o,n)?o.flags|=4:aa(o.styles)&&(o.flags|=2),-1!==ra.indexOf(s.tagName)&&(o.flags|=8),r.elements.push(o),s.slot,s.shadowRoot?na(e,s.shadowRoot,o,n):_a(s)||ga(s)||Ca(s)||na(e,s,o,n))}},sa=function(e,t){return ba(t)?new xo(e,t):wa(t)?new Mo(e,t):ga(t)?new Ho(e,t):ha(t)?new Ko(e,t):da(t)?new Vo(e,t):fa(t)?new Jo(e,t):Ca(t)?new Zo(e,t):_a(t)?new ea(e,t):Ea(t)?new ta(e,t):new vi(e,t)},ia=function(e,t){var r=sa(e,t);return r.flags|=4,na(e,t,r,r),r},oa=function(e,t,r){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||ya(e)&&r.styles.isTransparent()},aa=function(e){return e.isPositioned()||e.isFloating()},Aa=function(e){return e.nodeType===Node.TEXT_NODE},ca=function(e){return e.nodeType===Node.ELEMENT_NODE},la=function(e){return ca(e)&&void 0!==e.style&&!ua(e)},ua=function(e){return"object"==typeof e.className},ha=function(e){return"LI"===e.tagName},da=function(e){return"OL"===e.tagName},fa=function(e){return"INPUT"===e.tagName},pa=function(e){return"HTML"===e.tagName},ga=function(e){return"svg"===e.tagName},ya=function(e){return"BODY"===e.tagName},wa=function(e){return"CANVAS"===e.tagName},ma=function(e){return"VIDEO"===e.tagName},ba=function(e){return"IMG"===e.tagName},Ea=function(e){return"IFRAME"===e.tagName},va=function(e){return"STYLE"===e.tagName},Ba=function(e){return"SCRIPT"===e.tagName},_a=function(e){return"TEXTAREA"===e.tagName},Ca=function(e){return"SELECT"===e.tagName},Sa=function(e){return"SLOT"===e.tagName},Ia=function(e){return e.tagName.indexOf("-")>0},Ta=function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(e){var t=this.counters[e];return t&&t.length?t[t.length-1]:1},e.prototype.getCounterValues=function(e){var t=this.counters[e];return t||[]},e.prototype.pop=function(e){var t=this;e.forEach((function(e){return t.counters[e].pop()}))},e.prototype.parse=function(e){var t=this,r=e.counterIncrement,n=e.counterReset,s=!0;null!==r&&r.forEach((function(e){var r=t.counters[e.counter];r&&0!==e.increment&&(s=!1,r.length||r.push(1),r[Math.max(0,r.length-1)]+=e.increment)}));var i=[];return s&&n.forEach((function(e){var r=t.counters[e.counter];i.push(e.counter),r||(r=t.counters[e.counter]=[]),r.push(e.reset)})),i},e}(),Ra={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},ka={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Ua={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Da={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Pa=function(e,t,r,n,s,i){return e<t||e>r?Ga(e,s,i.length>0):n.integers.reduce((function(t,r,s){for(;e>=r;)e-=r,t+=n.values[s];return t}),"")+i},La=function(e,t,r,n){var s="";do{r||e--,s=n(e)+s,e/=t}while(e*t>=t);return s},Na=function(e,t,r,n,s){var i=r-t+1;return(e<0?"-":"")+(La(Math.abs(e),i,n,(function(e){return l(Math.floor(e%i)+t)}))+s)},Oa=function(e,t,r){void 0===r&&(r=". ");var n=t.length;return La(Math.abs(e),n,!1,(function(e){return t[Math.floor(e%n)]}))+r},Fa=1,Qa=2,xa=4,Ma=8,Ha=function(e,t,r,n,s,i){if(e<-9999||e>9999)return Ga(e,4,s.length>0);var o=Math.abs(e),a=s;if(0===o)return t[0]+a;for(var A=0;o>0&&A<=4;A++){var c=o%10;0===c&&si(i,Fa)&&""!==a?a=t[c]+a:c>1||1===c&&0===A||1===c&&1===A&&si(i,Qa)||1===c&&1===A&&si(i,xa)&&e>100||1===c&&A>1&&si(i,Ma)?a=t[c]+(A>0?r[A-1]:"")+a:1===c&&A>0&&(a=r[A-1]+a),o=Math.floor(o/10)}return(e<0?n:"")+a},Ka="",Va="",za="",ja="",Ga=function(e,t,r){var n=r?". ":"",s=r?"":"",i=r?", ":"",o=r?" ":"";switch(t){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var a=Na(e,48,57,!0,n);return a.length<4?"0"+a:a;case 4:return Oa(e,"",s);case 6:return Pa(e,1,3999,Ra,3,n).toLowerCase();case 7:return Pa(e,1,3999,Ra,3,n);case 8:return Na(e,945,969,!1,n);case 9:return Na(e,97,122,!1,n);case 10:return Na(e,65,90,!1,n);case 11:return Na(e,1632,1641,!0,n);case 12:case 49:return Pa(e,1,9999,ka,3,n);case 35:return Pa(e,1,9999,ka,3,n).toLowerCase();case 13:return Na(e,2534,2543,!0,n);case 14:case 30:return Na(e,6112,6121,!0,n);case 15:return Oa(e,"",s);case 16:return Oa(e,"",s);case 17:case 48:return Ha(e,"",Ka,"",s,Qa|xa|Ma);case 47:return Ha(e,"",Va,"",s,Fa|Qa|xa|Ma);case 42:return Ha(e,"",Ka,"",s,Qa|xa|Ma);case 41:return Ha(e,"",Va,"",s,Fa|Qa|xa|Ma);case 26:return Ha(e,"","",za,s,0);case 25:return Ha(e,"","",za,s,Fa|Qa|xa);case 31:return Ha(e,"","",ja,i,Fa|Qa|xa);case 33:return Ha(e,"","",ja,i,0);case 32:return Ha(e,"","",ja,i,Fa|Qa|xa);case 18:return Na(e,2406,2415,!0,n);case 20:return Pa(e,1,19999,Da,3,n);case 21:return Na(e,2790,2799,!0,n);case 22:return Na(e,2662,2671,!0,n);case 22:return Pa(e,1,10999,Ua,3,n);case 23:return Oa(e,"");case 24:return Oa(e,"");case 27:return Na(e,3302,3311,!0,n);case 28:return Oa(e,"",s);case 29:return Oa(e,"",s);case 34:return Na(e,3792,3801,!0,n);case 37:return Na(e,6160,6169,!0,n);case 38:return Na(e,4160,4169,!0,n);case 39:return Na(e,2918,2927,!0,n);case 40:return Na(e,1776,1785,!0,n);case 43:return Na(e,3046,3055,!0,n);case 44:return Na(e,3174,3183,!0,n);case 45:return Na(e,3664,3673,!0,n);case 46:return Na(e,3872,3881,!0,n);default:return Na(e,48,57,!0,n)}},$a="data-html2canvas-ignore",qa=function(){function e(e,t,r){if(this.context=e,this.options=r,this.scrolledElements=[],this.referenceElement=t,this.counters=new Ta,this.quoteDepth=0,!t.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(t.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(e,t){var r=this,i=Ya(e,t);if(!i.contentWindow)return Promise.reject("Unable to find iframe window");var o=e.defaultView.pageXOffset,a=e.defaultView.pageYOffset,A=i.contentWindow,c=A.document,l=Za(i).then((function(){return n(r,void 0,void 0,(function(){var e,r;return s(this,(function(n){switch(n.label){case 0:return this.scrolledElements.forEach(sA),A&&(A.scrollTo(t.left,t.top),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||A.scrollY===t.top&&A.scrollX===t.left||(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(A.scrollX-t.left,A.scrollY-t.top,0,0))),e=this.options.onclone,void 0===(r=this.clonedReferenceElement)?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:n.sent(),n.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,Ja(c)]:[3,4];case 3:n.sent(),n.label=4;case 4:return"function"==typeof e?[2,Promise.resolve().then((function(){return e(c,r)})).then((function(){return i}))]:[2,i]}}))}))}));return c.open(),c.write(rA(document.doctype)+"<html></html>"),nA(this.referenceElement.ownerDocument,o,a),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),l},e.prototype.createElementClone=function(e){if(Ei(e,2),wa(e))return this.createCanvasClone(e);if(ma(e))return this.createVideoClone(e);if(va(e))return this.createStyleClone(e);var t=e.cloneNode(!1);return ba(t)&&(ba(e)&&e.currentSrc&&e.currentSrc!==e.src&&(t.src=e.currentSrc,t.srcset=""),"lazy"===t.loading&&(t.loading="eager")),Ia(t)?this.createCustomElementClone(t):t},e.prototype.createCustomElementClone=function(e){var t=document.createElement("html2canvascustomelement");return tA(e.style,t),t},e.prototype.createStyleClone=function(e){try{var t=e.sheet;if(t&&t.cssRules){var r=[].slice.call(t.cssRules,0).reduce((function(e,t){return t&&"string"==typeof t.cssText?e+t.cssText:e}),""),n=e.cloneNode(!1);return n.textContent=r,n}}catch(e){if(this.context.logger.error("Unable to access cssRules property",e),"SecurityError"!==e.name)throw e}return e.cloneNode(!1)},e.prototype.createCanvasClone=function(e){var t;if(this.options.inlineImages&&e.ownerDocument){var r=e.ownerDocument.createElement("img");try{return r.src=e.toDataURL(),r}catch(t){this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var n=e.cloneNode(!1);try{n.width=e.width,n.height=e.height;var s=e.getContext("2d"),i=n.getContext("2d");if(i)if(!this.options.allowTaint&&s)i.putImageData(s.getImageData(0,0,e.width,e.height),0,0);else{var o=null!==(t=e.getContext("webgl2"))&&void 0!==t?t:e.getContext("webgl");if(o){var a=o.getContextAttributes();!1===(null==a?void 0:a.preserveDrawingBuffer)&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}i.drawImage(e,0,0)}return n}catch(t){this.context.logger.info("Unable to clone canvas as it is tainted",e)}return n},e.prototype.createVideoClone=function(e){var t=e.ownerDocument.createElement("canvas");t.width=e.offsetWidth,t.height=e.offsetHeight;var r=t.getContext("2d");try{return r&&(r.drawImage(e,0,0,t.width,t.height),this.options.allowTaint||r.getImageData(0,0,t.width,t.height)),t}catch(t){this.context.logger.info("Unable to clone video as it is tainted",e)}var n=e.ownerDocument.createElement("canvas");return n.width=e.offsetWidth,n.height=e.offsetHeight,n},e.prototype.appendChildNode=function(e,t,r){ca(t)&&(Ba(t)||t.hasAttribute($a)||"function"==typeof this.options.ignoreElements&&this.options.ignoreElements(t))||this.options.copyStyles&&ca(t)&&va(t)||e.appendChild(this.cloneNode(t,r))},e.prototype.cloneChildNodes=function(e,t,r){for(var n=this,s=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;s;s=s.nextSibling)if(ca(s)&&Sa(s)&&"function"==typeof s.assignedNodes){var i=s.assignedNodes();i.length&&i.forEach((function(e){return n.appendChildNode(t,e,r)}))}else this.appendChildNode(t,s,r)},e.prototype.cloneNode=function(e,t){if(Aa(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var r=e.ownerDocument.defaultView;if(r&&ca(e)&&(la(e)||ua(e))){var n=this.createElementClone(e);n.style.transitionProperty="none";var s=r.getComputedStyle(e),i=r.getComputedStyle(e,":before"),o=r.getComputedStyle(e,":after");this.referenceElement===e&&la(n)&&(this.clonedReferenceElement=n),ya(n)&&lA(n);var a=this.counters.parse(new yi(this.context,s)),A=this.resolvePseudoContent(e,n,i,ji.BEFORE);Ia(e)&&(t=!0),ma(e)||this.cloneChildNodes(e,n,t),A&&n.insertBefore(A,n.firstChild);var c=this.resolvePseudoContent(e,n,o,ji.AFTER);return c&&n.appendChild(c),this.counters.pop(a),(s&&(this.options.copyStyles||ua(e))&&!Ea(e)||t)&&tA(s,n),0===e.scrollTop&&0===e.scrollLeft||this.scrolledElements.push([n,e.scrollLeft,e.scrollTop]),(_a(e)||Ca(e))&&(_a(n)||Ca(n))&&(n.value=e.value),n}return e.cloneNode(!1)},e.prototype.resolvePseudoContent=function(e,t,r,n){var s=this;if(r){var i=r.content,o=t.ownerDocument;if(o&&i&&"none"!==i&&"-moz-alt-content"!==i&&"none"!==r.display){this.counters.parse(new yi(this.context,r));var a=new gi(this.context,r),A=o.createElement("html2canvaspseudoelement");tA(r,A),a.content.forEach((function(t){if(0===t.type)A.appendChild(o.createTextNode(t.value));else if(22===t.type){var r=o.createElement("img");r.src=t.value,r.style.opacity="1",A.appendChild(r)}else if(18===t.type){if("attr"===t.name){var n=t.values.filter(Dr);n.length&&A.appendChild(o.createTextNode(e.getAttribute(n[0].value)||""))}else if("counter"===t.name){var i=t.values.filter(Or),c=i[0],l=i[1];if(c&&Dr(c)){var u=s.counters.getCounterValue(c.value),h=l&&Dr(l)?_s.parse(s.context,l.value):3;A.appendChild(o.createTextNode(Ga(u,h,!1)))}}else if("counters"===t.name){var d=t.values.filter(Or),f=(c=d[0],d[1]);if(l=d[2],c&&Dr(c)){var p=s.counters.getCounterValues(c.value),g=l&&Dr(l)?_s.parse(s.context,l.value):3,y=f&&0===f.type?f.value:"",w=p.map((function(e){return Ga(e,g,!1)})).join(y);A.appendChild(o.createTextNode(w))}}}else if(20===t.type)switch(t.value){case"open-quote":A.appendChild(o.createTextNode(li(a.quotes,s.quoteDepth++,!0)));break;case"close-quote":A.appendChild(o.createTextNode(li(a.quotes,--s.quoteDepth,!1)));break;default:A.appendChild(o.createTextNode(t.value))}})),A.className=aA+" "+AA;var c=n===ji.BEFORE?" "+aA:" "+AA;return ua(t)?t.className.baseValue+=c:t.className+=c,A}}},e.destroy=function(e){return!!e.parentNode&&(e.parentNode.removeChild(e),!0)},e}();!function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"}(ji||(ji={}));var Wa,Ya=function(e,t){var r=e.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=t.width.toString(),r.height=t.height.toString(),r.scrolling="no",r.setAttribute($a,"true"),e.body.appendChild(r),r},Xa=function(e){return new Promise((function(t){e.complete?t():e.src?(e.onload=t,e.onerror=t):t()}))},Ja=function(e){return Promise.all([].slice.call(e.images,0).map(Xa))},Za=function(e){return new Promise((function(t,r){var n=e.contentWindow;if(!n)return r("No window assigned for iframe");var s=n.document;n.onload=e.onload=function(){n.onload=e.onload=null;var r=setInterval((function(){s.body.childNodes.length>0&&"complete"===s.readyState&&(clearInterval(r),t(e))}),50)}}))},eA=["all","d","content"],tA=function(e,t){for(var r=e.length-1;r>=0;r--){var n=e.item(r);-1===eA.indexOf(n)&&t.style.setProperty(n,e.getPropertyValue(n))}return t},rA=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},nA=function(e,t,r){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||r!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,r)},sA=function(e){var t=e[0],r=e[1],n=e[2];t.scrollLeft=r,t.scrollTop=n},iA=":before",oA=":after",aA="___html2canvas___pseudoelement_before",AA="___html2canvas___pseudoelement_after",cA='{\n    content: "" !important;\n    display: none !important;\n}',lA=function(e){uA(e,"."+aA+iA+cA+"\n         ."+AA+oA+cA)},uA=function(e,t){var r=e.ownerDocument;if(r){var n=r.createElement("style");n.textContent=t,e.appendChild(n)}},hA=function(){function e(){}return e.getOrigin=function(t){var r=e._link;return r?(r.href=t,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e._origin="about:blank",e}(),dA=function(){function e(e,t){this.context=e,this._options=t,this._cache={}}return e.prototype.addImage=function(e){var t=Promise.resolve();return this.has(e)?t:bA(e)||yA(e)?((this._cache[e]=this.loadImage(e)).catch((function(){})),t):t},e.prototype.match=function(e){return this._cache[e]},e.prototype.loadImage=function(e){return n(this,void 0,void 0,(function(){var t,r,n,i,o=this;return s(this,(function(s){switch(s.label){case 0:return t=hA.isSameOrigin(e),r=!wA(e)&&!0===this._options.useCORS&&Co.SUPPORT_CORS_IMAGES&&!t,n=!wA(e)&&!t&&!bA(e)&&"string"==typeof this._options.proxy&&Co.SUPPORT_CORS_XHR&&!r,t||!1!==this._options.allowTaint||wA(e)||bA(e)||n||r?(i=e,n?[4,this.proxy(i)]:[3,2]):[2];case 1:i=s.sent(),s.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise((function(e,t){var n=new Image;n.onload=function(){return e(n)},n.onerror=t,(mA(i)||r)&&(n.crossOrigin="anonymous"),n.src=i,!0===n.complete&&setTimeout((function(){return e(n)}),500),o._options.imageTimeout>0&&setTimeout((function(){return t("Timed out ("+o._options.imageTimeout+"ms) loading image")}),o._options.imageTimeout)}))];case 3:return[2,s.sent()]}}))}))},e.prototype.has=function(e){return void 0!==this._cache[e]},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(e){var t=this,r=this._options.proxy;if(!r)throw new Error("No proxy defined");var n=e.substring(0,256);return new Promise((function(s,i){var o=Co.SUPPORT_RESPONSE_TYPE?"blob":"text",a=new XMLHttpRequest;a.onload=function(){if(200===a.status)if("text"===o)s(a.response);else{var e=new FileReader;e.addEventListener("load",(function(){return s(e.result)}),!1),e.addEventListener("error",(function(e){return i(e)}),!1),e.readAsDataURL(a.response)}else i("Failed to proxy resource "+n+" with status code "+a.status)},a.onerror=i;var A=r.indexOf("?")>-1?"&":"?";if(a.open("GET",""+r+A+"url="+encodeURIComponent(e)+"&responseType="+o),"text"!==o&&a instanceof XMLHttpRequest&&(a.responseType=o),t._options.imageTimeout){var c=t._options.imageTimeout;a.timeout=c,a.ontimeout=function(){return i("Timed out ("+c+"ms) proxying "+n)}}a.send()}))},e}(),fA=/^data:image\/svg\+xml/i,pA=/^data:image\/.*;base64,/i,gA=/^data:image\/.*/i,yA=function(e){return Co.SUPPORT_SVG_DRAWING||!EA(e)},wA=function(e){return gA.test(e)},mA=function(e){return pA.test(e)},bA=function(e){return"blob"===e.substr(0,4)},EA=function(e){return"svg"===e.substr(-3).toLowerCase()||fA.test(e)},vA=function(){function e(e,t){this.type=0,this.x=e,this.y=t}return e.prototype.add=function(t,r){return new e(this.x+t,this.y+r)},e}(),BA=function(e,t,r){return new vA(e.x+(t.x-e.x)*r,e.y+(t.y-e.y)*r)},_A=function(){function e(e,t,r,n){this.type=1,this.start=e,this.startControl=t,this.endControl=r,this.end=n}return e.prototype.subdivide=function(t,r){var n=BA(this.start,this.startControl,t),s=BA(this.startControl,this.endControl,t),i=BA(this.endControl,this.end,t),o=BA(n,s,t),a=BA(s,i,t),A=BA(o,a,t);return r?new e(this.start,n,o,A):new e(A,a,i,this.end)},e.prototype.add=function(t,r){return new e(this.start.add(t,r),this.startControl.add(t,r),this.endControl.add(t,r),this.end.add(t,r))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e}(),CA=function(e){return 1===e.type},SA=function(){function e(e){var t=e.styles,r=e.bounds,n=jr(t.borderTopLeftRadius,r.width,r.height),s=n[0],i=n[1],o=jr(t.borderTopRightRadius,r.width,r.height),a=o[0],A=o[1],c=jr(t.borderBottomRightRadius,r.width,r.height),l=c[0],u=c[1],h=jr(t.borderBottomLeftRadius,r.width,r.height),d=h[0],f=h[1],p=[];p.push((s+a)/r.width),p.push((d+l)/r.width),p.push((i+f)/r.height),p.push((A+u)/r.height);var g=Math.max.apply(Math,p);g>1&&(s/=g,i/=g,a/=g,A/=g,l/=g,u/=g,d/=g,f/=g);var y=r.width-a,w=r.height-u,m=r.width-l,b=r.height-f,E=t.borderTopWidth,v=t.borderRightWidth,B=t.borderBottomWidth,_=t.borderLeftWidth,C=Gr(t.paddingTop,e.bounds.width),S=Gr(t.paddingRight,e.bounds.width),I=Gr(t.paddingBottom,e.bounds.width),T=Gr(t.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||i>0?IA(r.left+_/3,r.top+E/3,s-_/3,i-E/3,Wa.TOP_LEFT):new vA(r.left+_/3,r.top+E/3),this.topRightBorderDoubleOuterBox=s>0||i>0?IA(r.left+y,r.top+E/3,a-v/3,A-E/3,Wa.TOP_RIGHT):new vA(r.left+r.width-v/3,r.top+E/3),this.bottomRightBorderDoubleOuterBox=l>0||u>0?IA(r.left+m,r.top+w,l-v/3,u-B/3,Wa.BOTTOM_RIGHT):new vA(r.left+r.width-v/3,r.top+r.height-B/3),this.bottomLeftBorderDoubleOuterBox=d>0||f>0?IA(r.left+_/3,r.top+b,d-_/3,f-B/3,Wa.BOTTOM_LEFT):new vA(r.left+_/3,r.top+r.height-B/3),this.topLeftBorderDoubleInnerBox=s>0||i>0?IA(r.left+2*_/3,r.top+2*E/3,s-2*_/3,i-2*E/3,Wa.TOP_LEFT):new vA(r.left+2*_/3,r.top+2*E/3),this.topRightBorderDoubleInnerBox=s>0||i>0?IA(r.left+y,r.top+2*E/3,a-2*v/3,A-2*E/3,Wa.TOP_RIGHT):new vA(r.left+r.width-2*v/3,r.top+2*E/3),this.bottomRightBorderDoubleInnerBox=l>0||u>0?IA(r.left+m,r.top+w,l-2*v/3,u-2*B/3,Wa.BOTTOM_RIGHT):new vA(r.left+r.width-2*v/3,r.top+r.height-2*B/3),this.bottomLeftBorderDoubleInnerBox=d>0||f>0?IA(r.left+2*_/3,r.top+b,d-2*_/3,f-2*B/3,Wa.BOTTOM_LEFT):new vA(r.left+2*_/3,r.top+r.height-2*B/3),this.topLeftBorderStroke=s>0||i>0?IA(r.left+_/2,r.top+E/2,s-_/2,i-E/2,Wa.TOP_LEFT):new vA(r.left+_/2,r.top+E/2),this.topRightBorderStroke=s>0||i>0?IA(r.left+y,r.top+E/2,a-v/2,A-E/2,Wa.TOP_RIGHT):new vA(r.left+r.width-v/2,r.top+E/2),this.bottomRightBorderStroke=l>0||u>0?IA(r.left+m,r.top+w,l-v/2,u-B/2,Wa.BOTTOM_RIGHT):new vA(r.left+r.width-v/2,r.top+r.height-B/2),this.bottomLeftBorderStroke=d>0||f>0?IA(r.left+_/2,r.top+b,d-_/2,f-B/2,Wa.BOTTOM_LEFT):new vA(r.left+_/2,r.top+r.height-B/2),this.topLeftBorderBox=s>0||i>0?IA(r.left,r.top,s,i,Wa.TOP_LEFT):new vA(r.left,r.top),this.topRightBorderBox=a>0||A>0?IA(r.left+y,r.top,a,A,Wa.TOP_RIGHT):new vA(r.left+r.width,r.top),this.bottomRightBorderBox=l>0||u>0?IA(r.left+m,r.top+w,l,u,Wa.BOTTOM_RIGHT):new vA(r.left+r.width,r.top+r.height),this.bottomLeftBorderBox=d>0||f>0?IA(r.left,r.top+b,d,f,Wa.BOTTOM_LEFT):new vA(r.left,r.top+r.height),this.topLeftPaddingBox=s>0||i>0?IA(r.left+_,r.top+E,Math.max(0,s-_),Math.max(0,i-E),Wa.TOP_LEFT):new vA(r.left+_,r.top+E),this.topRightPaddingBox=a>0||A>0?IA(r.left+Math.min(y,r.width-v),r.top+E,y>r.width+v?0:Math.max(0,a-v),Math.max(0,A-E),Wa.TOP_RIGHT):new vA(r.left+r.width-v,r.top+E),this.bottomRightPaddingBox=l>0||u>0?IA(r.left+Math.min(m,r.width-_),r.top+Math.min(w,r.height-B),Math.max(0,l-v),Math.max(0,u-B),Wa.BOTTOM_RIGHT):new vA(r.left+r.width-v,r.top+r.height-B),this.bottomLeftPaddingBox=d>0||f>0?IA(r.left+_,r.top+Math.min(b,r.height-B),Math.max(0,d-_),Math.max(0,f-B),Wa.BOTTOM_LEFT):new vA(r.left+_,r.top+r.height-B),this.topLeftContentBox=s>0||i>0?IA(r.left+_+T,r.top+E+C,Math.max(0,s-(_+T)),Math.max(0,i-(E+C)),Wa.TOP_LEFT):new vA(r.left+_+T,r.top+E+C),this.topRightContentBox=a>0||A>0?IA(r.left+Math.min(y,r.width+_+T),r.top+E+C,y>r.width+_+T?0:a-_+T,A-(E+C),Wa.TOP_RIGHT):new vA(r.left+r.width-(v+S),r.top+E+C),this.bottomRightContentBox=l>0||u>0?IA(r.left+Math.min(m,r.width-(_+T)),r.top+Math.min(w,r.height+E+C),Math.max(0,l-(v+S)),u-(B+I),Wa.BOTTOM_RIGHT):new vA(r.left+r.width-(v+S),r.top+r.height-(B+I)),this.bottomLeftContentBox=d>0||f>0?IA(r.left+_+T,r.top+b,Math.max(0,d-(_+T)),f-(B+I),Wa.BOTTOM_LEFT):new vA(r.left+_+T,r.top+r.height-(B+I))}return e}();!function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"}(Wa||(Wa={}));var IA=function(e,t,r,n,s){var i=(Math.sqrt(2)-1)/3*4,o=r*i,a=n*i,A=e+r,c=t+n;switch(s){case Wa.TOP_LEFT:return new _A(new vA(e,c),new vA(e,c-a),new vA(A-o,t),new vA(A,t));case Wa.TOP_RIGHT:return new _A(new vA(e,t),new vA(e+o,t),new vA(A,c-a),new vA(A,c));case Wa.BOTTOM_RIGHT:return new _A(new vA(A,t),new vA(A,t+a),new vA(e+o,c),new vA(e,c));case Wa.BOTTOM_LEFT:default:return new _A(new vA(A,c),new vA(A-o,c),new vA(e,t+a),new vA(e,t))}},TA=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},RA=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},kA=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},UA=function(){function e(e,t,r){this.offsetX=e,this.offsetY=t,this.matrix=r,this.type=0,this.target=6}return e}(),DA=function(){function e(e,t){this.path=e,this.target=t,this.type=1}return e}(),PA=function(){function e(e){this.opacity=e,this.type=2,this.target=6}return e}(),LA=function(e){return 0===e.type},NA=function(e){return 1===e.type},OA=function(e){return 2===e.type},FA=function(e,t){return e.length===t.length&&e.some((function(e,r){return e===t[r]}))},QA=function(e,t,r,n,s){return e.map((function(e,i){switch(i){case 0:return e.add(t,r);case 1:return e.add(t+n,r);case 2:return e.add(t+n,r+s);case 3:return e.add(t,r+s)}return e}))},xA=function(){function e(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return e}(),MA=function(){function e(e,t){if(this.container=e,this.parent=t,this.effects=[],this.curves=new SA(this.container),this.container.styles.opacity<1&&this.effects.push(new PA(this.container.styles.opacity)),null!==this.container.styles.transform){var r=this.container.bounds.left+this.container.styles.transformOrigin[0].number,n=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new UA(r,n,s))}if(0!==this.container.styles.overflowX){var i=TA(this.curves),o=kA(this.curves);FA(i,o)?this.effects.push(new DA(i,6)):(this.effects.push(new DA(i,2)),this.effects.push(new DA(o,4)))}}return e.prototype.getEffects=function(e){for(var t=-1===[2,3].indexOf(this.container.styles.position),r=this.parent,n=this.effects.slice(0);r;){var s=r.effects.filter((function(e){return!NA(e)}));if(t||0!==r.container.styles.position||!r.parent){if(n.unshift.apply(n,s),t=-1===[2,3].indexOf(r.container.styles.position),0!==r.container.styles.overflowX){var i=TA(r.curves),o=kA(r.curves);FA(i,o)||n.unshift(new DA(o,6))}}else n.unshift.apply(n,s);r=r.parent}return n.filter((function(t){return si(t.target,e)}))},e}(),HA=function(e,t,r,n){e.container.elements.forEach((function(s){var i=si(s.flags,4),o=si(s.flags,2),a=new MA(s,e);si(s.styles.display,2048)&&n.push(a);var A=si(s.flags,8)?[]:n;if(i||o){var c=i||s.styles.isPositioned()?r:t,l=new xA(a);if(s.styles.isPositioned()||s.styles.opacity<1||s.styles.isTransformed()){var u=s.styles.zIndex.order;if(u<0){var h=0;c.negativeZIndex.some((function(e,t){return u>e.element.container.styles.zIndex.order?(h=t,!1):h>0})),c.negativeZIndex.splice(h,0,l)}else if(u>0){var d=0;c.positiveZIndex.some((function(e,t){return u>=e.element.container.styles.zIndex.order?(d=t+1,!1):d>0})),c.positiveZIndex.splice(d,0,l)}else c.zeroOrAutoZIndexOrTransformedOrOpacity.push(l)}else s.styles.isFloating()?c.nonPositionedFloats.push(l):c.nonPositionedInlineLevel.push(l);HA(a,l,i?l:r,A)}else s.styles.isInlineLevel()?t.inlineLevel.push(a):t.nonInlineLevel.push(a),HA(a,t,r,A);si(s.flags,8)&&KA(s,A)}))},KA=function(e,t){for(var r=e instanceof Vo?e.start:1,n=e instanceof Vo&&e.reversed,s=0;s<t.length;s++){var i=t[s];i.container instanceof Ko&&"number"==typeof i.container.value&&0!==i.container.value&&(r=i.container.value),i.listValue=Ga(r,i.container.styles.listStyleType,!0),r+=n?-1:1}},VA=function(e){var t=new MA(e,null),r=new xA(t),n=[];return HA(t,r,r,n),KA(t.container,n),r},zA=function(e,t){switch(t){case 0:return WA(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return WA(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return WA(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);default:return WA(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},jA=function(e,t){switch(t){case 0:return WA(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return WA(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return WA(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);default:return WA(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},GA=function(e,t){switch(t){case 0:return WA(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return WA(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return WA(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);default:return WA(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},$A=function(e,t){switch(t){case 0:return qA(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return qA(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return qA(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);default:return qA(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},qA=function(e,t){var r=[];return CA(e)?r.push(e.subdivide(.5,!1)):r.push(e),CA(t)?r.push(t.subdivide(.5,!0)):r.push(t),r},WA=function(e,t,r,n){var s=[];return CA(e)?s.push(e.subdivide(.5,!1)):s.push(e),CA(r)?s.push(r.subdivide(.5,!0)):s.push(r),CA(n)?s.push(n.subdivide(.5,!0).reverse()):s.push(n),CA(t)?s.push(t.subdivide(.5,!1).reverse()):s.push(t),s},YA=function(e){var t=e.bounds,r=e.styles;return t.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},XA=function(e){var t=e.styles,r=e.bounds,n=Gr(t.paddingLeft,r.width),s=Gr(t.paddingRight,r.width),i=Gr(t.paddingTop,r.width),o=Gr(t.paddingBottom,r.width);return r.add(n+t.borderLeftWidth,i+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+n+s),-(t.borderTopWidth+t.borderBottomWidth+i+o))},JA=function(e,t){return 0===e?t.bounds:2===e?XA(t):YA(t)},ZA=function(e,t){return 0===e?t.bounds:2===e?XA(t):YA(t)},ec=function(e,t,r){var n=JA(sc(e.styles.backgroundOrigin,t),e),s=ZA(sc(e.styles.backgroundClip,t),e),i=nc(sc(e.styles.backgroundSize,t),r,n),o=i[0],a=i[1],A=jr(sc(e.styles.backgroundPosition,t),n.width-o,n.height-a);return[ic(sc(e.styles.backgroundRepeat,t),A,i,n,s),Math.round(n.left+A[0]),Math.round(n.top+A[1]),o,a]},tc=function(e){return Dr(e)&&e.value===On.AUTO},rc=function(e){return"number"==typeof e},nc=function(e,t,r){var n=t[0],s=t[1],i=t[2],o=e[0],a=e[1];if(!o)return[0,0];if(Mr(o)&&a&&Mr(a))return[Gr(o,r.width),Gr(a,r.height)];var A=rc(i);if(Dr(o)&&(o.value===On.CONTAIN||o.value===On.COVER))return rc(i)?r.width/r.height<i!=(o.value===On.COVER)?[r.width,r.width/i]:[r.height*i,r.height]:[r.width,r.height];var c=rc(n),l=rc(s),u=c||l;if(tc(o)&&(!a||tc(a)))return c&&l?[n,s]:A||u?u&&A?[c?n:s*i,l?s:n/i]:[c?n:r.width,l?s:r.height]:[r.width,r.height];if(A){var h=0,d=0;return Mr(o)?h=Gr(o,r.width):Mr(a)&&(d=Gr(a,r.height)),tc(o)?h=d*i:a&&!tc(a)||(d=h/i),[h,d]}var f=null,p=null;if(Mr(o)?f=Gr(o,r.width):a&&Mr(a)&&(p=Gr(a,r.height)),null===f||a&&!tc(a)||(p=c&&l?f/n*s:r.height),null!==p&&tc(o)&&(f=c&&l?p/s*n:r.width),null!==f&&null!==p)return[f,p];throw new Error("Unable to calculate background-size for element")},sc=function(e,t){var r=e[t];return void 0===r?e[0]:r},ic=function(e,t,r,n,s){var i=t[0],o=t[1],a=r[0],A=r[1];switch(e){case 2:return[new vA(Math.round(n.left),Math.round(n.top+o)),new vA(Math.round(n.left+n.width),Math.round(n.top+o)),new vA(Math.round(n.left+n.width),Math.round(A+n.top+o)),new vA(Math.round(n.left),Math.round(A+n.top+o))];case 3:return[new vA(Math.round(n.left+i),Math.round(n.top)),new vA(Math.round(n.left+i+a),Math.round(n.top)),new vA(Math.round(n.left+i+a),Math.round(n.height+n.top)),new vA(Math.round(n.left+i),Math.round(n.height+n.top))];case 1:return[new vA(Math.round(n.left+i),Math.round(n.top+o)),new vA(Math.round(n.left+i+a),Math.round(n.top+o)),new vA(Math.round(n.left+i+a),Math.round(n.top+o+A)),new vA(Math.round(n.left+i),Math.round(n.top+o+A))];default:return[new vA(Math.round(s.left),Math.round(s.top)),new vA(Math.round(s.left+s.width),Math.round(s.top)),new vA(Math.round(s.left+s.width),Math.round(s.height+s.top)),new vA(Math.round(s.left),Math.round(s.height+s.top))]}},oc="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",ac="Hidden Text",Ac=function(){function e(e){this._data={},this._document=e}return e.prototype.parseMetrics=function(e,t){var r=this._document.createElement("div"),n=this._document.createElement("img"),s=this._document.createElement("span"),i=this._document.body;r.style.visibility="hidden",r.style.fontFamily=e,r.style.fontSize=t,r.style.margin="0",r.style.padding="0",r.style.whiteSpace="nowrap",i.appendChild(r),n.src=oc,n.width=1,n.height=1,n.style.margin="0",n.style.padding="0",n.style.verticalAlign="baseline",s.style.fontFamily=e,s.style.fontSize=t,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(ac)),r.appendChild(s),r.appendChild(n);var o=n.offsetTop-s.offsetTop+2;r.removeChild(s),r.appendChild(this._document.createTextNode(ac)),r.style.lineHeight="normal",n.style.verticalAlign="super";var a=n.offsetTop-r.offsetTop+2;return i.removeChild(r),{baseline:o,middle:a}},e.prototype.getMetrics=function(e,t){var r=e+" "+t;return void 0===this._data[r]&&(this._data[r]=this.parseMetrics(e,t)),this._data[r]},e}(),cc=function(){function e(e,t){this.context=e,this.options=t}return e}(),lc=1e4,uc=function(e){function r(t,r){var n=e.call(this,t,r)||this;return n._activeEffects=[],n.canvas=r.canvas?r.canvas:document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),r.canvas||(n.canvas.width=Math.floor(r.width*r.scale),n.canvas.height=Math.floor(r.height*r.scale),n.canvas.style.width=r.width+"px",n.canvas.style.height=r.height+"px"),n.fontMetrics=new Ac(document),n.ctx.scale(n.options.scale,n.options.scale),n.ctx.translate(-r.x,-r.y),n.ctx.textBaseline="bottom",n._activeEffects=[],n.context.logger.debug("Canvas renderer initialized ("+r.width+"x"+r.height+") with scale "+r.scale),n}return t(r,e),r.prototype.applyEffects=function(e){for(var t=this;this._activeEffects.length;)this.popEffect();e.forEach((function(e){return t.applyEffect(e)}))},r.prototype.applyEffect=function(e){this.ctx.save(),OA(e)&&(this.ctx.globalAlpha=e.opacity),LA(e)&&(this.ctx.translate(e.offsetX,e.offsetY),this.ctx.transform(e.matrix[0],e.matrix[1],e.matrix[2],e.matrix[3],e.matrix[4],e.matrix[5]),this.ctx.translate(-e.offsetX,-e.offsetY)),NA(e)&&(this.path(e.path),this.ctx.clip()),this._activeEffects.push(e)},r.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},r.prototype.renderStack=function(e){return n(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return e.element.container.styles.isVisible()?[4,this.renderStackContent(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},r.prototype.renderNode=function(e){return n(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return si(e.container.flags,16),e.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(e)]:[3,3];case 1:return t.sent(),[4,this.renderNodeContent(e)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},r.prototype.renderTextWithLetterSpacing=function(e,t,r){var n=this;0===t?this.ctx.fillText(e.text,e.bounds.left,e.bounds.top+r):ko(e.text).reduce((function(t,s){return n.ctx.fillText(s,t,e.bounds.top+r),t+n.ctx.measureText(s).width}),e.bounds.left)},r.prototype.createFontStyle=function(e){var t=e.fontVariant.filter((function(e){return"normal"===e||"small-caps"===e})).join(""),r=gc(e.fontFamily).join(", "),n=kr(e.fontSize)?""+e.fontSize.number+e.fontSize.unit:e.fontSize.number+"px";return[[e.fontStyle,t,e.fontWeight,n,r].join(" "),r,n]},r.prototype.renderTextNode=function(e,t){return n(this,void 0,void 0,(function(){var r,n,i,o,a,A,c,l,u=this;return s(this,(function(s){return r=this.createFontStyle(t),n=r[0],i=r[1],o=r[2],this.ctx.font=n,this.ctx.direction=1===t.direction?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",a=this.fontMetrics.getMetrics(i,o),A=a.baseline,c=a.middle,l=t.paintOrder,e.textBounds.forEach((function(e){l.forEach((function(r){switch(r){case 0:u.ctx.fillStyle=nn(t.color),u.renderTextWithLetterSpacing(e,t.letterSpacing,A);var n=t.textShadow;n.length&&e.text.trim().length&&(n.slice(0).reverse().forEach((function(r){u.ctx.shadowColor=nn(r.color),u.ctx.shadowOffsetX=r.offsetX.number*u.options.scale,u.ctx.shadowOffsetY=r.offsetY.number*u.options.scale,u.ctx.shadowBlur=r.blur.number,u.renderTextWithLetterSpacing(e,t.letterSpacing,A)})),u.ctx.shadowColor="",u.ctx.shadowOffsetX=0,u.ctx.shadowOffsetY=0,u.ctx.shadowBlur=0),t.textDecorationLine.length&&(u.ctx.fillStyle=nn(t.textDecorationColor||t.color),t.textDecorationLine.forEach((function(t){switch(t){case 1:u.ctx.fillRect(e.bounds.left,Math.round(e.bounds.top+A),e.bounds.width,1);break;case 2:u.ctx.fillRect(e.bounds.left,Math.round(e.bounds.top),e.bounds.width,1);break;case 3:u.ctx.fillRect(e.bounds.left,Math.ceil(e.bounds.top+c),e.bounds.width,1)}})));break;case 1:t.webkitTextStrokeWidth&&e.text.trim().length&&(u.ctx.strokeStyle=nn(t.webkitTextStrokeColor),u.ctx.lineWidth=t.webkitTextStrokeWidth,u.ctx.lineJoin=window.chrome?"miter":"round",u.ctx.strokeText(e.text,e.bounds.left,e.bounds.top+A)),u.ctx.strokeStyle="",u.ctx.lineWidth=0,u.ctx.lineJoin="miter"}}))})),[2]}))}))},r.prototype.renderReplacedElement=function(e,t,r){if(r&&e.intrinsicWidth>0&&e.intrinsicHeight>0){var n=XA(e),s=kA(t);this.path(s),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(r,0,0,e.intrinsicWidth,e.intrinsicHeight,n.left,n.top,n.width,n.height),this.ctx.restore()}},r.prototype.renderNodeContent=function(e){return n(this,void 0,void 0,(function(){var t,n,i,a,A,c,l,u,h,d,f,p,g,y,w,m,b,E;return s(this,(function(s){switch(s.label){case 0:this.applyEffects(e.getEffects(4)),t=e.container,n=e.curves,i=t.styles,a=0,A=t.textNodes,s.label=1;case 1:return a<A.length?(c=A[a],[4,this.renderTextNode(c,i)]):[3,4];case 2:s.sent(),s.label=3;case 3:return a++,[3,1];case 4:if(!(t instanceof xo))return[3,8];s.label=5;case 5:return s.trys.push([5,7,,8]),[4,this.context.cache.match(t.src)];case 6:return w=s.sent(),this.renderReplacedElement(t,n,w),[3,8];case 7:return s.sent(),this.context.logger.error("Error loading image "+t.src),[3,8];case 8:if(t instanceof Mo&&this.renderReplacedElement(t,n,t.canvas),!(t instanceof Ho))return[3,12];s.label=9;case 9:return s.trys.push([9,11,,12]),[4,this.context.cache.match(t.svg)];case 10:return w=s.sent(),this.renderReplacedElement(t,n,w),[3,12];case 11:return s.sent(),this.context.logger.error("Error loading svg "+t.svg.substring(0,255)),[3,12];case 12:return t instanceof ta&&t.tree?[4,new r(this.context,{scale:this.options.scale,backgroundColor:t.backgroundColor,x:0,y:0,width:t.width,height:t.height}).render(t.tree)]:[3,14];case 13:l=s.sent(),t.width&&t.height&&this.ctx.drawImage(l,0,0,t.width,t.height,t.bounds.left,t.bounds.top,t.bounds.width,t.bounds.height),s.label=14;case 14:if(t instanceof Jo&&(u=Math.min(t.bounds.width,t.bounds.height),t.type===qo?t.checked&&(this.ctx.save(),this.path([new vA(t.bounds.left+.39363*u,t.bounds.top+.79*u),new vA(t.bounds.left+.16*u,t.bounds.top+.5549*u),new vA(t.bounds.left+.27347*u,t.bounds.top+.44071*u),new vA(t.bounds.left+.39694*u,t.bounds.top+.5649*u),new vA(t.bounds.left+.72983*u,t.bounds.top+.23*u),new vA(t.bounds.left+.84*u,t.bounds.top+.34085*u),new vA(t.bounds.left+.39363*u,t.bounds.top+.79*u)]),this.ctx.fillStyle=nn(Xo),this.ctx.fill(),this.ctx.restore()):t.type===Wo&&t.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(t.bounds.left+u/2,t.bounds.top+u/2,u/4,0,2*Math.PI,!0),this.ctx.fillStyle=nn(Xo),this.ctx.fill(),this.ctx.restore())),hc(t)&&t.value.length){switch(h=this.createFontStyle(i),b=h[0],d=h[1],f=this.fontMetrics.getMetrics(b,d).baseline,this.ctx.font=b,this.ctx.fillStyle=nn(i.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=fc(t.styles.textAlign),E=XA(t),p=0,t.styles.textAlign){case 1:p+=E.width/2;break;case 2:p+=E.width}g=E.add(p,0,0,-E.height/2+1),this.ctx.save(),this.path([new vA(E.left,E.top),new vA(E.left+E.width,E.top),new vA(E.left+E.width,E.top+E.height),new vA(E.left,E.top+E.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new So(t.value,g),i.letterSpacing,f),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!si(t.styles.display,2048))return[3,20];if(null===t.styles.listStyleImage)return[3,19];if(0!==(y=t.styles.listStyleImage).type)return[3,18];w=void 0,m=y.url,s.label=15;case 15:return s.trys.push([15,17,,18]),[4,this.context.cache.match(m)];case 16:return w=s.sent(),this.ctx.drawImage(w,t.bounds.left-(w.width+10),t.bounds.top),[3,18];case 17:return s.sent(),this.context.logger.error("Error loading list-style-image "+m),[3,18];case 18:return[3,20];case 19:e.listValue&&-1!==t.styles.listStyleType&&(b=this.createFontStyle(i)[0],this.ctx.font=b,this.ctx.fillStyle=nn(i.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",E=new o(t.bounds.left,t.bounds.top+Gr(t.styles.paddingTop,t.bounds.width),t.bounds.width,Es(i.lineHeight,i.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new So(e.listValue,E),i.letterSpacing,Es(i.lineHeight,i.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),s.label=20;case 20:return[2]}}))}))},r.prototype.renderStackContent=function(e){return n(this,void 0,void 0,(function(){var t,r,n,i,o,a,A,c,l,u,h,d,f,p,g;return s(this,(function(s){switch(s.label){case 0:return si(e.element.container.flags,16),[4,this.renderNodeBackgroundAndBorders(e.element)];case 1:s.sent(),t=0,r=e.negativeZIndex,s.label=2;case 2:return t<r.length?(g=r[t],[4,this.renderStack(g)]):[3,5];case 3:s.sent(),s.label=4;case 4:return t++,[3,2];case 5:return[4,this.renderNodeContent(e.element)];case 6:s.sent(),n=0,i=e.nonInlineLevel,s.label=7;case 7:return n<i.length?(g=i[n],[4,this.renderNode(g)]):[3,10];case 8:s.sent(),s.label=9;case 9:return n++,[3,7];case 10:o=0,a=e.nonPositionedFloats,s.label=11;case 11:return o<a.length?(g=a[o],[4,this.renderStack(g)]):[3,14];case 12:s.sent(),s.label=13;case 13:return o++,[3,11];case 14:A=0,c=e.nonPositionedInlineLevel,s.label=15;case 15:return A<c.length?(g=c[A],[4,this.renderStack(g)]):[3,18];case 16:s.sent(),s.label=17;case 17:return A++,[3,15];case 18:l=0,u=e.inlineLevel,s.label=19;case 19:return l<u.length?(g=u[l],[4,this.renderNode(g)]):[3,22];case 20:s.sent(),s.label=21;case 21:return l++,[3,19];case 22:h=0,d=e.zeroOrAutoZIndexOrTransformedOrOpacity,s.label=23;case 23:return h<d.length?(g=d[h],[4,this.renderStack(g)]):[3,26];case 24:s.sent(),s.label=25;case 25:return h++,[3,23];case 26:f=0,p=e.positiveZIndex,s.label=27;case 27:return f<p.length?(g=p[f],[4,this.renderStack(g)]):[3,30];case 28:s.sent(),s.label=29;case 29:return f++,[3,27];case 30:return[2]}}))}))},r.prototype.mask=function(e){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(e.slice(0).reverse()),this.ctx.closePath()},r.prototype.path=function(e){this.ctx.beginPath(),this.formatPath(e),this.ctx.closePath()},r.prototype.formatPath=function(e){var t=this;e.forEach((function(e,r){var n=CA(e)?e.start:e;0===r?t.ctx.moveTo(n.x,n.y):t.ctx.lineTo(n.x,n.y),CA(e)&&t.ctx.bezierCurveTo(e.startControl.x,e.startControl.y,e.endControl.x,e.endControl.y,e.end.x,e.end.y)}))},r.prototype.renderRepeat=function(e,t,r,n){this.path(e),this.ctx.fillStyle=t,this.ctx.translate(r,n),this.ctx.fill(),this.ctx.translate(-r,-n)},r.prototype.resizeImage=function(e,t,r){var n;if(e.width===t&&e.height===r)return e;var s=(null!==(n=this.canvas.ownerDocument)&&void 0!==n?n:document).createElement("canvas");return s.width=Math.max(1,t),s.height=Math.max(1,r),s.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t,r),s},r.prototype.renderBackgroundImage=function(e){return n(this,void 0,void 0,(function(){var t,r,n,i,o,a;return s(this,(function(A){switch(A.label){case 0:t=e.styles.backgroundImage.length-1,r=function(r){var i,o,a,A,c,l,u,h,d,f,p,g,y,w,m,b,E,v,B,_,C,S,I,T,R,k,U,D,P,L,N;return s(this,(function(s){switch(s.label){case 0:if(0!==r.type)return[3,5];i=void 0,o=r.url,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,n.context.cache.match(o)];case 2:return i=s.sent(),[3,4];case 3:return s.sent(),n.context.logger.error("Error loading background-image "+o),[3,4];case 4:return i&&(a=ec(e,t,[i.width,i.height,i.width/i.height]),b=a[0],S=a[1],I=a[2],B=a[3],_=a[4],w=n.ctx.createPattern(n.resizeImage(i,B,_),"repeat"),n.renderRepeat(b,w,S,I)),[3,6];case 5:Dn(r)?(A=ec(e,t,[null,null,null]),b=A[0],S=A[1],I=A[2],B=A[3],_=A[4],c=wn(r.angle,B,_),l=c[0],u=c[1],h=c[2],d=c[3],f=c[4],(p=document.createElement("canvas")).width=B,p.height=_,g=p.getContext("2d"),y=g.createLinearGradient(u,d,h,f),gn(r.stops,l).forEach((function(e){return y.addColorStop(e.stop,nn(e.color))})),g.fillStyle=y,g.fillRect(0,0,B,_),B>0&&_>0&&(w=n.ctx.createPattern(p,"repeat"),n.renderRepeat(b,w,S,I))):Pn(r)&&(m=ec(e,t,[null,null,null]),b=m[0],E=m[1],v=m[2],B=m[3],_=m[4],C=0===r.position.length?[Vr]:r.position,S=Gr(C[0],B),I=Gr(C[C.length-1],_),T=En(r,S,I,B,_),R=T[0],k=T[1],R>0&&k>0&&(U=n.ctx.createRadialGradient(E+S,v+I,0,E+S,v+I,R),gn(r.stops,2*R).forEach((function(e){return U.addColorStop(e.stop,nn(e.color))})),n.path(b),n.ctx.fillStyle=U,R!==k?(D=e.bounds.left+.5*e.bounds.width,P=e.bounds.top+.5*e.bounds.height,N=1/(L=k/R),n.ctx.save(),n.ctx.translate(D,P),n.ctx.transform(1,0,0,L,0,0),n.ctx.translate(-D,-P),n.ctx.fillRect(E,N*(v-P)+P,B,_*N),n.ctx.restore()):n.ctx.fill())),s.label=6;case 6:return t--,[2]}}))},n=this,i=0,o=e.styles.backgroundImage.slice(0).reverse(),A.label=1;case 1:return i<o.length?(a=o[i],[5,r(a)]):[3,4];case 2:A.sent(),A.label=3;case 3:return i++,[3,1];case 4:return[2]}}))}))},r.prototype.renderSolidBorder=function(e,t,r){return n(this,void 0,void 0,(function(){return s(this,(function(n){return this.path(zA(r,t)),this.ctx.fillStyle=nn(e),this.ctx.fill(),[2]}))}))},r.prototype.renderDoubleBorder=function(e,t,r,i){return n(this,void 0,void 0,(function(){var n,o;return s(this,(function(s){switch(s.label){case 0:return t<3?[4,this.renderSolidBorder(e,r,i)]:[3,2];case 1:return s.sent(),[2];case 2:return n=jA(i,r),this.path(n),this.ctx.fillStyle=nn(e),this.ctx.fill(),o=GA(i,r),this.path(o),this.ctx.fill(),[2]}}))}))},r.prototype.renderNodeBackgroundAndBorders=function(e){return n(this,void 0,void 0,(function(){var t,r,n,i,o,a,A,c,l=this;return s(this,(function(s){switch(s.label){case 0:return this.applyEffects(e.getEffects(2)),t=e.container.styles,r=!rn(t.backgroundColor)||t.backgroundImage.length,n=[{style:t.borderTopStyle,color:t.borderTopColor,width:t.borderTopWidth},{style:t.borderRightStyle,color:t.borderRightColor,width:t.borderRightWidth},{style:t.borderBottomStyle,color:t.borderBottomColor,width:t.borderBottomWidth},{style:t.borderLeftStyle,color:t.borderLeftColor,width:t.borderLeftWidth}],i=dc(sc(t.backgroundClip,0),e.curves),r||t.boxShadow.length?(this.ctx.save(),this.path(i),this.ctx.clip(),rn(t.backgroundColor)||(this.ctx.fillStyle=nn(t.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(e.container)]):[3,2];case 1:s.sent(),this.ctx.restore(),t.boxShadow.slice(0).reverse().forEach((function(t){l.ctx.save();var r=TA(e.curves),n=t.inset?0:lc,s=QA(r,-n+(t.inset?1:-1)*t.spread.number,(t.inset?1:-1)*t.spread.number,t.spread.number*(t.inset?-2:2),t.spread.number*(t.inset?-2:2));t.inset?(l.path(r),l.ctx.clip(),l.mask(s)):(l.mask(r),l.ctx.clip(),l.path(s)),l.ctx.shadowOffsetX=t.offsetX.number+n,l.ctx.shadowOffsetY=t.offsetY.number,l.ctx.shadowColor=nn(t.color),l.ctx.shadowBlur=t.blur.number,l.ctx.fillStyle=t.inset?nn(t.color):"rgba(0,0,0,1)",l.ctx.fill(),l.ctx.restore()})),s.label=2;case 2:o=0,a=0,A=n,s.label=3;case 3:return a<A.length?0!==(c=A[a]).style&&!rn(c.color)&&c.width>0?2!==c.style?[3,5]:[4,this.renderDashedDottedBorder(c.color,c.width,o,e.curves,2)]:[3,11]:[3,13];case 4:return s.sent(),[3,11];case 5:return 3!==c.style?[3,7]:[4,this.renderDashedDottedBorder(c.color,c.width,o,e.curves,3)];case 6:return s.sent(),[3,11];case 7:return 4!==c.style?[3,9]:[4,this.renderDoubleBorder(c.color,c.width,o,e.curves)];case 8:return s.sent(),[3,11];case 9:return[4,this.renderSolidBorder(c.color,o,e.curves)];case 10:s.sent(),s.label=11;case 11:o++,s.label=12;case 12:return a++,[3,3];case 13:return[2]}}))}))},r.prototype.renderDashedDottedBorder=function(e,t,r,i,o){return n(this,void 0,void 0,(function(){var n,a,A,c,l,u,h,d,f,p,g,y,w,m,b,E;return s(this,(function(s){return this.ctx.save(),n=$A(i,r),a=zA(i,r),2===o&&(this.path(a),this.ctx.clip()),CA(a[0])?(A=a[0].start.x,c=a[0].start.y):(A=a[0].x,c=a[0].y),CA(a[1])?(l=a[1].end.x,u=a[1].end.y):(l=a[1].x,u=a[1].y),h=0===r||2===r?Math.abs(A-l):Math.abs(c-u),this.ctx.beginPath(),3===o?this.formatPath(n):this.formatPath(a.slice(0,2)),d=t<3?3*t:2*t,f=t<3?2*t:t,3===o&&(d=t,f=t),p=!0,h<=2*d?p=!1:h<=2*d+f?(d*=g=h/(2*d+f),f*=g):(y=Math.floor((h+f)/(d+f)),w=(h-y*d)/(y-1),f=(m=(h-(y+1)*d)/y)<=0||Math.abs(f-w)<Math.abs(f-m)?w:m),p&&(3===o?this.ctx.setLineDash([0,d+f]):this.ctx.setLineDash([d,f])),3===o?(this.ctx.lineCap="round",this.ctx.lineWidth=t):this.ctx.lineWidth=2*t+1.1,this.ctx.strokeStyle=nn(e),this.ctx.stroke(),this.ctx.setLineDash([]),2===o&&(CA(a[0])&&(b=a[3],E=a[0],this.ctx.beginPath(),this.formatPath([new vA(b.end.x,b.end.y),new vA(E.start.x,E.start.y)]),this.ctx.stroke()),CA(a[1])&&(b=a[1],E=a[2],this.ctx.beginPath(),this.formatPath([new vA(b.end.x,b.end.y),new vA(E.start.x,E.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]}))}))},r.prototype.render=function(e){return n(this,void 0,void 0,(function(){var t;return s(this,(function(r){switch(r.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=nn(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),t=VA(e),[4,this.renderStack(t)];case 1:return r.sent(),this.applyEffects([]),[2,this.canvas]}}))}))},r}(cc),hc=function(e){return e instanceof ea||e instanceof Zo||e instanceof Jo&&e.type!==Wo&&e.type!==qo},dc=function(e,t){switch(e){case 0:return TA(t);case 2:return RA(t);default:return kA(t)}},fc=function(e){switch(e){case 1:return"center";case 2:return"right";default:return"left"}},pc=["-apple-system","system-ui"],gc=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter((function(e){return-1===pc.indexOf(e)})):e},yc=function(e){function r(t,r){var n=e.call(this,t,r)||this;return n.canvas=r.canvas?r.canvas:document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),n.options=r,n.canvas.width=Math.floor(r.width*r.scale),n.canvas.height=Math.floor(r.height*r.scale),n.canvas.style.width=r.width+"px",n.canvas.style.height=r.height+"px",n.ctx.scale(n.options.scale,n.options.scale),n.ctx.translate(-r.x,-r.y),n.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+r.width+"x"+r.height+" at "+r.x+","+r.y+") with scale "+r.scale),n}return t(r,e),r.prototype.render=function(e){return n(this,void 0,void 0,(function(){var t,r;return s(this,(function(n){switch(n.label){case 0:return t=Bo(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,e),[4,wc(t)];case 1:return r=n.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=nn(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(r,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}}))}))},r}(cc),wc=function(e){return new Promise((function(t,r){var n=new Image;n.onload=function(){t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(e))}))},mc=function(){function e(e){var t=e.id,r=e.enabled;this.id=t,this.enabled=r,this.start=Date.now()}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.debug?console.debug.apply(console,i([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&"undefined"!=typeof window&&window.console&&"function"==typeof console.info&&console.info.apply(console,i([this.id,this.getTime()+"ms"],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.warn?console.warn.apply(console,i([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.error?console.error.apply(console,i([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},e.instances={},e}(),bc=function(){function e(t,r){var n;this.windowBounds=r,this.instanceName="#"+e.instanceCount++,this.logger=new mc({id:this.instanceName,enabled:t.logging}),this.cache=null!==(n=t.cache)&&void 0!==n?n:new dA(this,t)}return e.instanceCount=1,e}(),Ec=function(e,t){return void 0===t&&(t={}),vc(e,t)};"undefined"!=typeof window&&hA.setContext(window);var vc=function(e,t){return n(void 0,void 0,void 0,(function(){var n,i,c,l,u,h,d,f,p,g,y,w,m,b,E,v,B,_,C,S,I,T,R,k,U,D,P,L,N,O,F,Q,x,M,H,K,V,z;return s(this,(function(s){switch(s.label){case 0:if(!e||"object"!=typeof e)return[2,Promise.reject("Invalid element provided as first argument")];if(!(n=e.ownerDocument))throw new Error("Element is not attached to a Document");if(!(i=n.defaultView))throw new Error("Document is not attached to a Window");return c={allowTaint:null!==(T=t.allowTaint)&&void 0!==T&&T,imageTimeout:null!==(R=t.imageTimeout)&&void 0!==R?R:15e3,proxy:t.proxy,useCORS:null!==(k=t.useCORS)&&void 0!==k&&k},l=r({logging:null===(U=t.logging)||void 0===U||U,cache:t.cache},c),u={windowWidth:null!==(D=t.windowWidth)&&void 0!==D?D:i.innerWidth,windowHeight:null!==(P=t.windowHeight)&&void 0!==P?P:i.innerHeight,scrollX:null!==(L=t.scrollX)&&void 0!==L?L:i.pageXOffset,scrollY:null!==(N=t.scrollY)&&void 0!==N?N:i.pageYOffset},h=new o(u.scrollX,u.scrollY,u.windowWidth,u.windowHeight),d=new bc(l,h),f=null!==(O=t.foreignObjectRendering)&&void 0!==O&&O,p={allowTaint:null!==(F=t.allowTaint)&&void 0!==F&&F,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:f,copyStyles:f},d.logger.debug("Starting document clone with size "+h.width+"x"+h.height+" scrolled to "+-h.left+","+-h.top),g=new qa(d,e,p),(y=g.clonedReferenceElement)?[4,g.toIFrame(n,h)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return w=s.sent(),m=ya(y)||pa(y)?A(y.ownerDocument):a(d,y),b=m.width,E=m.height,v=m.left,B=m.top,_=Bc(d,y,t.backgroundColor),C={canvas:t.canvas,backgroundColor:_,scale:null!==(x=null!==(Q=t.scale)&&void 0!==Q?Q:i.devicePixelRatio)&&void 0!==x?x:1,x:(null!==(M=t.x)&&void 0!==M?M:0)+v,y:(null!==(H=t.y)&&void 0!==H?H:0)+B,width:null!==(K=t.width)&&void 0!==K?K:Math.ceil(b),height:null!==(V=t.height)&&void 0!==V?V:Math.ceil(E)},f?(d.logger.debug("Document cloned, using foreign object rendering"),[4,new yc(d,C).render(y)]):[3,3];case 2:return S=s.sent(),[3,5];case 3:return d.logger.debug("Document cloned, element located at "+v+","+B+" with size "+b+"x"+E+" using computed rendering"),d.logger.debug("Starting DOM parsing"),I=ia(d,y),_===I.styles.backgroundColor&&(I.styles.backgroundColor=hn.TRANSPARENT),d.logger.debug("Starting renderer for element at "+C.x+","+C.y+" with size "+C.width+"x"+C.height),[4,new uc(d,C).render(I)];case 4:S=s.sent(),s.label=5;case 5:return(null===(z=t.removeContainer)||void 0===z||z)&&(qa.destroy(w)||d.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),d.logger.debug("Finished rendering"),[2,S]}}))}))},Bc=function(e,t,r){var n=t.ownerDocument,s=n.documentElement?un(e,getComputedStyle(n.documentElement).backgroundColor):hn.TRANSPARENT,i=n.body?un(e,getComputedStyle(n.body).backgroundColor):hn.TRANSPARENT,o="string"==typeof r?un(e,r):null===r?hn.TRANSPARENT:4294967295;return t===n.documentElement?rn(s)?rn(i)?o:i:s:o};return Ec}()},56512:function(e){!function(t){"use strict";const r="(0?\\d+|0x[a-f0-9]+)",n={fourOctet:new RegExp(`^${r}\\.${r}\\.${r}\\.${r}$`,"i"),threeOctet:new RegExp(`^${r}\\.${r}\\.${r}$`,"i"),twoOctet:new RegExp(`^${r}\\.${r}$`,"i"),longValue:new RegExp(`^${r}$`,"i")},s=new RegExp("^0[0-7]+$","i"),i=new RegExp("^0x[a-f0-9]+$","i"),o="%[0-9a-z]{1,}",a="(?:[0-9a-f]+::?)+",A={zoneIndex:new RegExp(o,"i"),native:new RegExp(`^(::)?(${a})?([0-9a-f]+)?(::)?(${o})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${r}\\.${r}\\.${r}\\.${r}(${o})?)$`,"i"),transitional:new RegExp(`^((?:${a})|(?:::)(?:${a})?)${r}\\.${r}\\.${r}\\.${r}(${o})?$`,"i")};function c(e,t){if(e.indexOf("::")!==e.lastIndexOf("::"))return null;let r,n,s=0,i=-1,o=(e.match(A.zoneIndex)||[])[0];for(o&&(o=o.substring(1),e=e.replace(/%.+$/,""));(i=e.indexOf(":",i+1))>=0;)s++;if("::"===e.substr(0,2)&&s--,"::"===e.substr(-2,2)&&s--,s>t)return null;for(n=t-s,r=":";n--;)r+="0:";return":"===(e=e.replace("::",r))[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),{parts:t=function(){const t=e.split(":"),r=[];for(let e=0;e<t.length;e++)r.push(parseInt(t[e],16));return r}(),zoneId:o}}function l(e,t,r,n){if(e.length!==t.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let s,i=0;for(;n>0;){if(s=r-n,s<0&&(s=0),e[i]>>s!=t[i]>>s)return!1;n-=r,i+=1}return!0}function u(e){if(i.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(s.test(e))return parseInt(e,8);throw new Error(`ipaddr: cannot parse ${e} as octal`)}return parseInt(e,10)}function h(e,t){for(;e.length<t;)e=`0${e}`;return e}const d={};d.IPv4=function(){function e(e){if(4!==e.length)throw new Error("ipaddr: ipv4 octet count should be 4");let t,r;for(t=0;t<e.length;t++)if(r=e[t],!(0<=r&&r<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){let r;if(void 0===t&&(r=e,e=r[0],t=r[1]),"ipv4"!==e.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return l(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const r={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let n,s,i;for(n=3;n>=0;n-=1){if(s=this.octets[n],!(s in r))return null;if(i=r[s],t&&0!==i)return null;8!==i&&(t=!0),e+=i}return 32-e},e.prototype.range=function(){return d.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return d.IPv6.parse(`::ffff:${this.toString()}`)},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),d.IPv4.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),r=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),s=[];let i=0;for(;i<4;)s.push(parseInt(r[i],10)|255^parseInt(n[i],10)),i++;return new this(s)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},d.IPv4.isIPv4=function(e){return null!==this.parser(e)},d.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(e){return!1}},d.IPv4.isValidFourPartDecimal=function(e){return!(!d.IPv4.isValid(e)||!e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},d.IPv4.networkAddressFromCIDR=function(e){let t,r,n,s,i;try{for(t=this.parseCIDR(e),n=t[0].toByteArray(),i=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),s=[],r=0;r<4;)s.push(parseInt(n[r],10)&parseInt(i[r],10)),r++;return new this(s)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},d.IPv4.parse=function(e){const t=this.parser(e);if(null===t)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},d.IPv4.parseCIDR=function(e){let t;if(t=e.match(/^(.+)\/(\d+)$/)){const e=parseInt(t[2]);if(e>=0&&e<=32){const r=[this.parse(t[1]),e];return Object.defineProperty(r,"toString",{value:function(){return this.join("/")}}),r}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},d.IPv4.parser=function(e){let t,r,s;if(t=e.match(n.fourOctet))return function(){const e=t.slice(1,6),n=[];for(let t=0;t<e.length;t++)r=e[t],n.push(u(r));return n}();if(t=e.match(n.longValue)){if(s=u(t[1]),s>4294967295||s<0)throw new Error("ipaddr: address outside defined range");return function(){const e=[];let t;for(t=0;t<=24;t+=8)e.push(s>>t&255);return e}().reverse()}return(t=e.match(n.twoOctet))?function(){const e=t.slice(1,4),r=[];if(s=u(e[1]),s>16777215||s<0)throw new Error("ipaddr: address outside defined range");return r.push(u(e[0])),r.push(s>>16&255),r.push(s>>8&255),r.push(255&s),r}():(t=e.match(n.threeOctet))?function(){const e=t.slice(1,5),r=[];if(s=u(e[2]),s>65535||s<0)throw new Error("ipaddr: address outside defined range");return r.push(u(e[0])),r.push(u(e[1])),r.push(s>>8&255),r.push(255&s),r}():null},d.IPv4.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>32)throw new Error("ipaddr: invalid IPv4 prefix length");const t=[0,0,0,0];let r=0;const n=Math.floor(e/8);for(;r<n;)t[r]=255,r++;return n<4&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},d.IPv6=function(){function e(e,t){let r,n;if(16===e.length)for(this.parts=[],r=0;r<=14;r+=2)this.parts.push(e[r]<<8|e[r+1]);else{if(8!==e.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=e}for(r=0;r<this.parts.length;r++)if(n=this.parts[r],!(0<=n&&n<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],reserved:[[new e([8193,3512,0,0,0,0,0,0]),32]]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){let r;if(void 0===t&&(r=e,e=r[0],t=r[1]),"ipv6"!==e.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return l(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const r={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let n,s;for(let i=7;i>=0;i-=1){if(n=this.parts[i],!(n in r))return null;if(s=r[n],t&&0!==s)return null;16!==s&&(t=!0),e+=s}return 128-e},e.prototype.range=function(){return d.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){let e;const t=[],r=this.parts;for(let n=0;n<r.length;n++)e=r[n],t.push(e>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(h(this.parts[t].toString(16),4));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const e=this.parts.slice(-2),t=e[0],r=e[1];return new d.IPv4([t>>8,255&t,r>>8,255&r])},e.prototype.toNormalizedString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toRFC5952String=function(){const e=/((^|:)(0(:|$)){2,})/g,t=this.toNormalizedString();let r,n=0,s=-1;for(;r=e.exec(t);)r[0].length>s&&(n=r.index,s=r[0].length);return s<0?t:`${t.substring(0,n)}::${t.substring(n+s)}`},e.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},e}(),d.IPv6.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),r=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),s=[];let i=0;for(;i<16;)s.push(parseInt(r[i],10)|255^parseInt(n[i],10)),i++;return new this(s)}catch(e){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${e})`)}},d.IPv6.isIPv6=function(e){return null!==this.parser(e)},d.IPv6.isValid=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{const t=this.parser(e);return new this(t.parts,t.zoneId),!0}catch(e){return!1}},d.IPv6.networkAddressFromCIDR=function(e){let t,r,n,s,i;try{for(t=this.parseCIDR(e),n=t[0].toByteArray(),i=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),s=[],r=0;r<16;)s.push(parseInt(n[r],10)&parseInt(i[r],10)),r++;return new this(s)}catch(e){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${e})`)}},d.IPv6.parse=function(e){const t=this.parser(e);if(null===t.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},d.IPv6.parseCIDR=function(e){let t,r,n;if((r=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(r[2]),t>=0&&t<=128))return n=[this.parse(r[1]),t],Object.defineProperty(n,"toString",{value:function(){return this.join("/")}}),n;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},d.IPv6.parser=function(e){let t,r,n,s,i,o;if(n=e.match(A.deprecatedTransitional))return this.parser(`::ffff:${n[1]}`);if(A.native.test(e))return c(e,8);if((n=e.match(A.transitional))&&(o=n[6]||"",t=c(n[1].slice(0,-1)+o,6),t.parts)){for(i=[parseInt(n[2]),parseInt(n[3]),parseInt(n[4]),parseInt(n[5])],r=0;r<i.length;r++)if(s=i[r],!(0<=s&&s<=255))return null;return t.parts.push(i[0]<<8|i[1]),t.parts.push(i[2]<<8|i[3]),{parts:t.parts,zoneId:t.zoneId}}return null},d.IPv6.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>128)throw new Error("ipaddr: invalid IPv6 prefix length");const t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let r=0;const n=Math.floor(e/8);for(;r<n;)t[r]=255,r++;return n<16&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},d.fromByteArray=function(e){const t=e.length;if(4===t)return new d.IPv4(e);if(16===t)return new d.IPv6(e);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},d.isValid=function(e){return d.IPv6.isValid(e)||d.IPv4.isValid(e)},d.parse=function(e){if(d.IPv6.isValid(e))return d.IPv6.parse(e);if(d.IPv4.isValid(e))return d.IPv4.parse(e);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},d.parseCIDR=function(e){try{return d.IPv6.parseCIDR(e)}catch(t){try{return d.IPv4.parseCIDR(e)}catch(e){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},d.process=function(e){const t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},d.subnetMatch=function(e,t,r){let n,s,i,o;for(s in null==r&&(r="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,s))for(i=t[s],!i[0]||i[0]instanceof Array||(i=[i]),n=0;n<i.length;n++)if(o=i[n],e.kind()===o[0].kind()&&e.match.apply(e,o))return s;return r},e.exports?e.exports=d:t.ipaddr=d}(this)},74449:function(e){"use strict";e.exports=async function*(e,t={}){const r=e.getReader();try{for(;;){const e=await r.read();if(e.done)return;yield e.value}}finally{!0!==t.preventCancel&&r.cancel(),r.releaseLock()}}},46851:function(e){"use strict";e.exports=async e=>{const t=[];for await(const r of e)t.push(r);return t}},42413:function(e,t,r){"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?e.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:e.exports={default:r(73563).default,Headers:r(73563).Headers,Request:r(73563).Request,Response:r(73563).Response}},73563:function(e,t,r){"use strict";var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==r.g)return r.g;throw new Error("unable to locate global object")}();e.exports=t=n.fetch,n.fetch&&(t.default=n.fetch.bind(n)),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response},106:function(e,t,r){"use strict";var n=r(34155);const s=r(59134),i="object"==typeof window&&"object"==typeof document&&9===document.nodeType,o=s(),a=i&&!o,A=o&&!i,c=o&&i,l=void 0!==n&&void 0!==n.release&&"node"===n.release.name&&!o,u="function"==typeof importScripts&&"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,h=void 0!==n&&!1,d="undefined"!=typeof navigator&&"ReactNative"===navigator.product;e.exports={isTest:h,isElectron:o,isElectronMain:A,isElectronRenderer:c,isNode:l,isBrowser:a,isWebWorker:u,isEnvWithDom:i,isReactNative:d}},38688:function(e,t,r){"use strict";e.exports=r(42413)},46953:function(e,t,r){"use strict";const n=r(67137);async function*s(e,t){const r=new n,s=await r.get(e,t);yield*s.iterator()}e.exports=(e,t)=>({path:decodeURIComponent(new URL(e).pathname.split("/").pop()||""),content:s(e,t)})},67137:function(e,t,r){"use strict";const{fetch:n,Request:s,Headers:i}=r(50730),{TimeoutError:o,HTTPError:a}=r(44171),A=r(70942).bind({ignoreUndefined:!0}),{URL:c,URLSearchParams:l}=r(17745),u=r(32044),h=r(74449),{isBrowser:d,isWebWorker:f}=r(106),p=r(46851),g={throwHttpErrors:!0,credentials:"same-origin"};class y{constructor(e={}){this.opts=A(g,e)}async fetch(e,t={}){const r=A(this.opts,t),g=new i(r.headers);if("string"!=typeof e&&!(e instanceof c||e instanceof s))throw new TypeError("`resource` must be a string, URL, or Request");const y=new c(e.toString(),r.base),{searchParams:b,transformSearchParams:E,json:v}=r;b&&(y.search="function"==typeof E?E(new l(r.searchParams)):new l(r.searchParams)),v&&(r.body=JSON.stringify(r.json),g.set("content-type","application/json"));const B=new AbortController,_=u([B.signal,r.signal]);null!=globalThis.ReadableStream&&r.body instanceof globalThis.ReadableStream&&(d||f)&&(r.body=new Blob(await p(h(r.body))));const C=await((e,t,r)=>{if(void 0===t)return e;const n=Date.now(),s=()=>Date.now()-n>=t;return new Promise(((n,i)=>{const a=setTimeout((()=>{s()&&(i(new o),r.abort())}),t),A=e=>t=>{clearTimeout(a),s()?i(new o):e(t)};e.then(A(n),A(i))}))})(n(y.toString(),{...r,signal:_,timeout:void 0,headers:g,duplex:"half"}),r.timeout,B);if(!C.ok&&r.throwHttpErrors)throw r.handleError&&await r.handleError(C),new a(C);return C.iterator=async function*(){yield*m(C.body)},C.ndjson=async function*(){for await(const e of w(C.iterator()))t.transform?yield t.transform(e):yield e},C}post(e,t={}){return this.fetch(e,{...t,method:"POST"})}get(e,t={}){return this.fetch(e,{...t,method:"GET"})}put(e,t={}){return this.fetch(e,{...t,method:"PUT"})}delete(e,t={}){return this.fetch(e,{...t,method:"DELETE"})}options(e,t={}){return this.fetch(e,{...t,method:"OPTIONS"})}}const w=async function*(e){const t=new TextDecoder;let r="";for await(const n of e){r+=t.decode(n,{stream:!0});const e=r.split(/\r?\n/);for(let t=0;t<e.length-1;t++){const r=e[t].trim();r.length>0&&(yield JSON.parse(r))}r=e[e.length-1]}r+=t.decode(),r=r.trim(),0!==r.length&&(yield JSON.parse(r))},m=e=>{if(b(e))return e;if(v(e)){const t=e[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:t.next.bind(t),return(r){return e.destroy(),"function"==typeof t.return?t.return():Promise.resolve({done:!0,value:r})}}}}}if(E(e)){const t=e.getReader();return async function*(){try{for(;;){const{done:e,value:r}=await t.read();if(e)return;r&&(yield r)}}finally{t.releaseLock()}}()}throw new TypeError("Body can't be converted to AsyncIterable")},b=e=>"object"==typeof e&&null!==e&&"function"==typeof e[Symbol.asyncIterator],E=e=>e&&"function"==typeof e.getReader,v=e=>Object.prototype.hasOwnProperty.call(e,"readable")&&Object.prototype.hasOwnProperty.call(e,"writable");y.HTTPError=a,y.TimeoutError=o,y.streamToAsyncIterator=m,y.post=(e,t)=>new y(t).post(e,t),y.get=(e,t)=>new y(t).get(e,t),y.put=(e,t)=>new y(t).put(e,t),y.delete=(e,t)=>new y(t).delete(e,t),y.options=(e,t)=>new y(t).options(e,t),e.exports=y},44171:function(e,t){"use strict";class r extends Error{constructor(e="Request timed out"){super(e),this.name="TimeoutError"}}t.TimeoutError=r;class n extends Error{constructor(e="The operation was aborted."){super(e),this.name="AbortError"}}t.AbortError=n;class s extends Error{constructor(e){super(e.statusText),this.name="HTTPError",this.response=e}}t.HTTPError=s},50730:function(e,t,r){"use strict";const{TimeoutError:n,AbortError:s}=r(44171),{Response:i,Request:o,Headers:a,default:A}=r(38688),c=A,l=e=>{const t=new a;for(const r of e.trim().split(/[\r\n]+/)){const e=r.indexOf(": ");e>0&&t.set(r.slice(0,e),r.slice(e+1))}return t};class u extends i{constructor(e,t,r){super(t,r),Object.defineProperty(this,"url",{value:e})}}e.exports={fetch:(e,t={})=>null!=t.onUploadProgress?((e,t={})=>{const r=new XMLHttpRequest;r.open(t.method||"GET",e.toString(),!0);const{timeout:o,headers:A}=t;if(o&&o>0&&o<1/0&&(r.timeout=o),null!=t.overrideMimeType&&r.overrideMimeType(t.overrideMimeType),A)for(const[e,t]of new a(A))r.setRequestHeader(e,t);return t.signal&&(t.signal.onabort=()=>r.abort()),t.onUploadProgress&&(r.upload.onprogress=t.onUploadProgress),r.responseType="arraybuffer",new Promise(((e,o)=>{const a=t=>{switch(t.type){case"error":e(i.error());break;case"load":e(new u(r.responseURL,r.response,{status:r.status,statusText:r.statusText,headers:l(r.getAllResponseHeaders())}));break;case"timeout":o(new n);break;case"abort":o(new s)}};r.onerror=a,r.onload=a,r.ontimeout=a,r.onabort=a,r.send(t.body)}))})(e,t):c(e,t),Request:o,Headers:a}},82734:function(e){"use strict";var t=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i;e.exports=function(e,r){if(null==r&&(r=!1),e.length<2)return!1;if(e.length>255)return!1;var n=e[e.length-1];if(r){if("."!==n)return!1}else if("."===n)return!1;return t.test(e)}},59134:function(e,t,r){var n=r(34155);e.exports=function(){return"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||(!(void 0===n||"object"!=typeof n.versions||!n.versions.electron)||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}},71993:function(e){"use strict";e.exports={RTLD_LAZY:1,RTLD_NOW:2,RTLD_GLOBAL:256,RTLD_LOCAL:0,RTLD_DEEPBIND:8,E2BIG:7,EACCES:13,EADDRINUSE:98,EADDRNOTAVAIL:99,EAFNOSUPPORT:97,EAGAIN:11,EALREADY:114,EBADF:9,EBADMSG:74,EBUSY:16,ECANCELED:125,ECHILD:10,ECONNABORTED:103,ECONNREFUSED:111,ECONNRESET:104,EDEADLK:35,EDESTADDRREQ:89,EDOM:33,EDQUOT:122,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:113,EIDRM:43,EILSEQ:84,EINPROGRESS:115,EINTR:4,EINVAL:22,EIO:5,EISCONN:106,EISDIR:21,ELOOP:40,EMFILE:24,EMLINK:31,EMSGSIZE:90,EMULTIHOP:72,ENAMETOOLONG:36,ENETDOWN:100,ENETRESET:102,ENETUNREACH:101,ENFILE:23,ENOBUFS:105,ENODATA:61,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:37,ENOLINK:67,ENOMEM:12,ENOMSG:42,ENOPROTOOPT:92,ENOSPC:28,ENOSR:63,ENOSTR:60,ENOSYS:38,ENOTCONN:107,ENOTDIR:20,ENOTEMPTY:39,ENOTSOCK:88,ENOTSUP:95,ENOTTY:25,ENXIO:6,EOPNOTSUPP:95,EOVERFLOW:75,EPERM:1,EPIPE:32,EPROTO:71,EPROTONOSUPPORT:93,EPROTOTYPE:91,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:116,ETIME:62,ETIMEDOUT:110,ETXTBSY:26,EWOULDBLOCK:11,EXDEV:18,PRIORITY_LOW:19,PRIORITY_BELOW_NORMAL:10,PRIORITY_NORMAL:0,PRIORITY_ABOVE_NORMAL:-7,PRIORITY_HIGH:-14,PRIORITY_HIGHEST:-20,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:7,SIGFPE:8,SIGKILL:9,SIGUSR1:10,SIGSEGV:11,SIGUSR2:12,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:17,SIGSTKFLT:16,SIGCONT:18,SIGSTOP:19,SIGTSTP:20,SIGTTIN:21,SIGTTOU:22,SIGURG:23,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:29,SIGPOLL:29,SIGPWR:30,SIGSYS:31,SIGUNUSED:31,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:64,O_EXCL:128,UV_FS_O_FILEMAP:0,O_NOCTTY:256,O_TRUNC:512,O_APPEND:1024,O_DIRECTORY:65536,O_NOATIME:262144,O_NOFOLLOW:131072,O_SYNC:1052672,O_DSYNC:4096,O_DIRECT:16384,O_NONBLOCK:2048,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4,OPENSSL_VERSION_NUMBER:269488335,SSL_OP_ALL:2147485780,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_RSA:1,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_EC:2048,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_PSS_SALTLEN_AUTO:-2,defaultCoreCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA",TLS1_VERSION:769,TLS1_1_VERSION:770,TLS1_2_VERSION:771,TLS1_3_VERSION:772,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},1914:function(e){"use strict";const t=65536;e.exports=function(e){const r=new Uint8Array(e);let n=0;if(e>0)if(e>t)for(;n<e;)n+t>e?(crypto.getRandomValues(r.subarray(n,n+(e-n))),n+=e-n):(crypto.getRandomValues(r.subarray(n,n+t)),n+=t);else crypto.getRandomValues(r);return r}},17745:function(e,t,r){"use strict";const{URLWithLegacySupport:n,format:s,URLSearchParams:i,defaultBase:o}=r(82049),a=r(15939);e.exports={URL:n,URLSearchParams:i,format:s,relative:a,defaultBase:o}},15939:function(e,t,r){"use strict";const{URLWithLegacySupport:n,format:s}=r(82049);e.exports=(e,t={},r={},i)=>{let o,a=t.protocol?t.protocol.replace(":",""):"http";a=(r[a]||i||a)+":";try{o=new n(e)}catch(e){o={}}const A=Object.assign({},t,{protocol:a||o.protocol,host:t.host||o.host});return new n(e,s(A)).toString()}},82049:function(e){"use strict";const t="undefined"!=typeof navigator&&"ReactNative"===navigator.product;const r=self.URL,n=t?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:"";e.exports={URLWithLegacySupport:class{constructor(e="",t=n){this.super=new r(e,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return r.createObjectURL(e)}static revokeObjectURL(e){r.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}},URLSearchParams:self.URLSearchParams,defaultBase:n,format:function(e){if("string"==typeof e){return new r(e).toString()}if(!(e instanceof r)){const t=e.username&&e.password?`${e.username}:${e.password}@`:"",r=e.auth?e.auth+"@":"",n=e.port?":"+e.port:"",s=e.protocol?e.protocol+"//":"",i=e.host||"",o=e.hostname||"",a=e.search||(e.query?"?"+e.query:""),A=e.hash||"",c=e.pathname||"";return`${s}${t||r}${i||o+n}${e.path||c+a}${A}`}}}},99507:function(e,t,r){"use strict";const n=r(61798),{EventEmitter:s}=r(17187);function i(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0,n=e.length;r<n;++r)if(e[r]!==t[r])return!1;return!0}function o(e,t){if(!(t instanceof Uint8Array))throw new TypeError(e+" is not a Uint8Array")}class a extends s{constructor(e={}){super(),this.localNodeId=e.localNodeId||n(20),this.numberOfNodesPerKBucket=e.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=e.numberOfNodesToPing||3,this.distance=e.distance||a.distance,this.arbiter=e.arbiter||a.arbiter,this.metadata=Object.assign({},e.metadata),o("option.localNodeId as parameter 1",this.localNodeId),this.root={contacts:[],dontSplit:!1,left:null,right:null}}static arbiter(e,t){return e.vectorClock>t.vectorClock?e:t}static distance(e,t){let r=0,n=0;const s=Math.min(e.length,t.length),i=Math.max(e.length,t.length);for(;n<s;++n)r=256*r+(e[n]^t[n]);for(;n<i;++n)r=256*r+255;return r}add(e){o("contact.id",(e||{}).id);let t=0,r=this.root;for(;null===r.contacts;)r=this._determineNode(r,e.id,t++);const n=this._indexOf(r,e.id);return n>=0?(this._update(r,n,e),this):r.contacts.length<this.numberOfNodesPerKBucket?(r.contacts.push(e),this.emit("added",e),this):r.dontSplit?(this.emit("ping",r.contacts.slice(0,this.numberOfNodesToPing),e),this):(this._split(r,t),this.add(e))}closest(e,t=1/0){if(o("id",e),!Number.isInteger(t)&&t!==1/0||t<=0)throw new TypeError("n is not positive number");let r=[];for(let n=[this.root],s=0;n.length>0&&r.length<t;){const t=n.pop();if(null===t.contacts){const r=this._determineNode(t,e,s++);n.push(t.left===r?t.right:t.left),n.push(r)}else r=r.concat(t.contacts)}return r.map((t=>[this.distance(t.id,e),t])).sort(((e,t)=>e[0]-t[0])).slice(0,t).map((e=>e[1]))}count(){let e=0;for(const t=[this.root];t.length>0;){const r=t.pop();null===r.contacts?t.push(r.right,r.left):e+=r.contacts.length}return e}_determineNode(e,t,r){const n=r>>3,s=r%8;if(t.length<=n&&0!==s)return e.left;return t[n]&1<<7-s?e.right:e.left}get(e){o("id",e);let t=0,r=this.root;for(;null===r.contacts;)r=this._determineNode(r,e,t++);const n=this._indexOf(r,e);return n>=0?r.contacts[n]:null}_indexOf(e,t){for(let r=0;r<e.contacts.length;++r)if(i(e.contacts[r].id,t))return r;return-1}remove(e){o("the id as parameter 1",e);let t=0,r=this.root;for(;null===r.contacts;)r=this._determineNode(r,e,t++);const n=this._indexOf(r,e);if(n>=0){const e=r.contacts.splice(n,1)[0];this.emit("removed",e)}return this}_split(e,t){e.left={contacts:[],dontSplit:!1,left:null,right:null},e.right={contacts:[],dontSplit:!1,left:null,right:null};for(const r of e.contacts)this._determineNode(e,r.id,t).contacts.push(r);e.contacts=null;const r=this._determineNode(e,this.localNodeId,t);(e.left===r?e.right:e.left).dontSplit=!0}toArray(){let e=[];for(const t=[this.root];t.length>0;){const r=t.pop();null===r.contacts?t.push(r.right,r.left):e=e.concat(r.contacts)}return e}*toIterable(){for(const e=[this.root];e.length>0;){const t=e.pop();null===t.contacts?e.push(t.right,t.left):yield*t.contacts}}_update(e,t,r){if(!i(e.contacts[t].id,r.id))throw new Error("wrong index for _update");const n=e.contacts[t],s=this.arbiter(n,r);s===n&&n!==r||(e.contacts.splice(t,1),e.contacts.push(s),this.emit("updated",n,s))}}e.exports=a},51675:function(e,t){"use strict";t.supports=function(...e){const t=e.reduce(((e,t)=>Object.assign(e,t)),{});return Object.assign(t,{snapshots:t.snapshots||!1,permanence:t.permanence||!1,seek:t.seek||!1,clear:t.clear||!1,getMany:t.getMany||!1,keyIterator:t.keyIterator||!1,valueIterator:t.valueIterator||!1,iteratorNextv:t.iteratorNextv||!1,iteratorAll:t.iteratorAll||!1,status:t.status||!1,createIfMissing:t.createIfMissing||!1,errorIfExists:t.errorIfExists||!1,deferredOpen:t.deferredOpen||!1,promises:t.promises||!1,streams:t.streams||!1,encodings:Object.assign({},t.encodings),events:Object.assign({},t.events),additionalMethods:Object.assign({},t.additionalMethods)})}},58499:function(e,t,r){"use strict";const n=r(94473),s=r(8002),{Encoding:i}=r(8266),{BufferFormat:o,ViewFormat:a,UTF8Format:A}=r(82376),c=Symbol("formats"),l=Symbol("encodings"),u=new Set(["buffer","view","utf8"]);t.Transcoder=class{constructor(e){if(!Array.isArray(e))throw new TypeError("The first argument 'formats' must be an array");if(!e.every((e=>u.has(e))))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'");this[l]=new Map,this[c]=new Set(e);for(const e in s)try{this.encoding(e)}catch(e){if("LEVEL_ENCODING_NOT_SUPPORTED"!==e.code)throw e}}encodings(){return Array.from(new Set(this[l].values()))}encoding(e){let t=this[l].get(e);if(void 0===t){if("string"==typeof e&&""!==e){if(t=d[e],!t)throw new n(`Encoding '${e}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if("object"!=typeof e||null===e)throw new TypeError("First argument 'encoding' must be a string or object");t=function(e){if(e instanceof i)return e;const t="type"in e&&"string"==typeof e.type?e.type:void 0,r=e.name||t||"anonymous-"+f++;switch(function(e){return"format"in e&&void 0!==e.format?e.format:"buffer"in e&&"boolean"==typeof e.buffer?e.buffer?"buffer":"utf8":"code"in e&&Number.isInteger(e.code)?"view":"buffer"}(e)){case"view":return new a({...e,name:r});case"utf8":return new A({...e,name:r});case"buffer":return new o({...e,name:r});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}(e)}const{name:r,format:s}=t;if(!this[c].has(s))if(this[c].has("view"))t=t.createViewTranscoder();else if(this[c].has("buffer"))t=t.createBufferTranscoder();else{if(!this[c].has("utf8"))throw new n(`Encoding '${r}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});t=t.createUTF8Transcoder()}for(const n of[e,r,t.name,t.commonName])this[l].set(n,t)}return t}};const h={binary:s.buffer,"utf-8":s.utf8},d={...s,...h};let f=0},8266:function(e,t,r){"use strict";const n=r(94473),s=new Set(["buffer","view","utf8"]);t.Encoding=class{constructor(e){if(this.encode=e.encode||this.encode,this.decode=e.decode||this.decode,this.name=e.name||this.name,this.format=e.format||this.format,"function"!=typeof this.encode)throw new TypeError("The 'encode' property must be a function");if("function"!=typeof this.decode)throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),"string"!=typeof this.name||""===this.name)throw new TypeError("The 'name' property must be a string");if("string"!=typeof this.format||!s.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");e.createViewTranscoder&&(this.createViewTranscoder=e.createViewTranscoder),e.createBufferTranscoder&&(this.createBufferTranscoder=e.createBufferTranscoder),e.createUTF8Transcoder&&(this.createUTF8Transcoder=e.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new n(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new n(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new n(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}}},8002:function(e,t,r){"use strict";const{Buffer:n}=r(35275)||{Buffer:{isBuffer:()=>!1}},{textEncoder:s,textDecoder:i}=r(85850)(),{BufferFormat:o,ViewFormat:a,UTF8Format:A}=r(82376),c=e=>e;t.utf8=new A({encode:function(e){return n.isBuffer(e)?e.toString("utf8"):ArrayBuffer.isView(e)?i.decode(e):String(e)},decode:c,name:"utf8",createViewTranscoder(){return new a({encode:function(e){return ArrayBuffer.isView(e)?e:s.encode(e)},decode:function(e){return i.decode(e)},name:`${this.name}+view`})},createBufferTranscoder(){return new o({encode:function(e){return n.isBuffer(e)?e:ArrayBuffer.isView(e)?n.from(e.buffer,e.byteOffset,e.byteLength):n.from(String(e),"utf8")},decode:function(e){return e.toString("utf8")},name:`${this.name}+buffer`})}}),t.json=new A({encode:JSON.stringify,decode:JSON.parse,name:"json"}),t.buffer=new o({encode:function(e){return n.isBuffer(e)?e:ArrayBuffer.isView(e)?n.from(e.buffer,e.byteOffset,e.byteLength):n.from(String(e),"utf8")},decode:c,name:"buffer",createViewTranscoder(){return new a({encode:function(e){return ArrayBuffer.isView(e)?e:n.from(String(e),"utf8")},decode:function(e){return n.from(e.buffer,e.byteOffset,e.byteLength)},name:`${this.name}+view`})}}),t.view=new a({encode:function(e){return ArrayBuffer.isView(e)?e:s.encode(e)},decode:c,name:"view",createBufferTranscoder(){return new o({encode:function(e){return n.isBuffer(e)?e:ArrayBuffer.isView(e)?n.from(e.buffer,e.byteOffset,e.byteLength):n.from(String(e),"utf8")},decode:c,name:`${this.name}+buffer`})}}),t.hex=new o({encode:function(e){return n.isBuffer(e)?e:n.from(String(e),"hex")},decode:function(e){return e.toString("hex")},name:"hex"}),t.base64=new o({encode:function(e){return n.isBuffer(e)?e:n.from(String(e),"base64")},decode:function(e){return e.toString("base64")},name:"base64"})},82376:function(e,t,r){"use strict";const{Buffer:n}=r(35275)||{},{Encoding:s}=r(8266),i=r(85850);class o extends s{constructor(e){super({...e,format:"buffer"})}createViewTranscoder(){return new a({encode:this.encode,decode:e=>this.decode(n.from(e.buffer,e.byteOffset,e.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}}class a extends s{constructor(e){super({...e,format:"view"})}createBufferTranscoder(){return new o({encode:e=>{const t=this.encode(e);return n.from(t.buffer,t.byteOffset,t.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}}t.BufferFormat=o,t.ViewFormat=a,t.UTF8Format=class extends s{constructor(e){super({...e,format:"utf8"})}createBufferTranscoder(){return new o({encode:e=>n.from(this.encode(e),"utf8"),decode:e=>this.decode(e.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:e,textDecoder:t}=i();return new a({encode:t=>e.encode(this.encode(t)),decode:e=>this.decode(t.decode(e)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}}},85850:function(e){"use strict";let t=null;e.exports=function(){return null===t&&(t={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),t}},35275:function(e,t,r){"use strict";const n=r(79742),s=r(80645),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=A,t.SlowBuffer=function(e){+e!=e&&(e=0);return A.alloc(+e)},t.INSPECT_MAX_BYTES=50;const o=2147483647;function a(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,A.prototype),t}function A(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return c(e,t,r)}function c(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!A.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|p(e,t);let n=a(r);const s=n.write(e,t);s!==r&&(n=n.slice(0,s));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(W(e,Uint8Array)){const t=new Uint8Array(e);return d(t.buffer,t.byteOffset,t.byteLength)}return h(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(W(e,ArrayBuffer)||e&&W(e.buffer,ArrayBuffer))return d(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(W(e,SharedArrayBuffer)||e&&W(e.buffer,SharedArrayBuffer)))return d(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return A.from(n,t,r);const s=function(e){if(A.isBuffer(e)){const t=0|f(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||Y(e.length)?a(0):h(e);if("Buffer"===e.type&&Array.isArray(e.data))return h(e.data)}(e);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return A.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return l(e),a(e<0?0:0|f(e))}function h(e){const t=e.length<0?0:0|f(e.length),r=a(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function d(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,A.prototype),n}function f(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function p(e,t){if(A.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||W(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let s=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return $(e).length;default:if(s)return n?-1:G(e).length;t=(""+t).toLowerCase(),s=!0}}function g(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,r);case"utf8":case"utf-8":return S(this,t,r);case"ascii":return T(this,t,r);case"latin1":case"binary":return R(this,t,r);case"base64":return C(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function w(e,t,r,n,s){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Y(r=+r)&&(r=s?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(s)return-1;r=e.length-1}else if(r<0){if(!s)return-1;r=0}if("string"==typeof t&&(t=A.from(t,n)),A.isBuffer(t))return 0===t.length?-1:m(e,t,r,n,s);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):m(e,[t],r,n,s);throw new TypeError("val must be string, number or Buffer")}function m(e,t,r,n,s){let i,o=1,a=e.length,A=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,a/=2,A/=2,r/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(s){let n=-1;for(i=r;i<a;i++)if(c(e,i)===c(t,-1===n?0:i-n)){if(-1===n&&(n=i),i-n+1===A)return n*o}else-1!==n&&(i-=i-n),n=-1}else for(r+A>a&&(r=a-A),i=r;i>=0;i--){let r=!0;for(let n=0;n<A;n++)if(c(e,i+n)!==c(t,n)){r=!1;break}if(r)return i}return-1}function b(e,t,r,n){r=Number(r)||0;const s=e.length-r;n?(n=Number(n))>s&&(n=s):n=s;const i=t.length;let o;for(n>i/2&&(n=i/2),o=0;o<n;++o){const n=parseInt(t.substr(2*o,2),16);if(Y(n))return o;e[r+o]=n}return o}function E(e,t,r,n){return q(G(t,e.length-r),e,r,n)}function v(e,t,r,n){return q(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function B(e,t,r,n){return q($(t),e,r,n)}function _(e,t,r,n){return q(function(e,t){let r,n,s;const i=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)r=e.charCodeAt(o),n=r>>8,s=r%256,i.push(s),i.push(n);return i}(t,e.length-r),e,r,n)}function C(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function S(e,t,r){r=Math.min(e.length,r);const n=[];let s=t;for(;s<r;){const t=e[s];let i=null,o=t>239?4:t>223?3:t>191?2:1;if(s+o<=r){let r,n,a,A;switch(o){case 1:t<128&&(i=t);break;case 2:r=e[s+1],128==(192&r)&&(A=(31&t)<<6|63&r,A>127&&(i=A));break;case 3:r=e[s+1],n=e[s+2],128==(192&r)&&128==(192&n)&&(A=(15&t)<<12|(63&r)<<6|63&n,A>2047&&(A<55296||A>57343)&&(i=A));break;case 4:r=e[s+1],n=e[s+2],a=e[s+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(A=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a,A>65535&&A<1114112&&(i=A))}}null===i?(i=65533,o=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),s+=o}return function(e){const t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=I));return r}(n)}t.kMaxLength=o,A.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),A.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(A.prototype,"parent",{enumerable:!0,get:function(){if(A.isBuffer(this))return this.buffer}}),Object.defineProperty(A.prototype,"offset",{enumerable:!0,get:function(){if(A.isBuffer(this))return this.byteOffset}}),A.poolSize=8192,A.from=function(e,t,r){return c(e,t,r)},Object.setPrototypeOf(A.prototype,Uint8Array.prototype),Object.setPrototypeOf(A,Uint8Array),A.alloc=function(e,t,r){return function(e,t,r){return l(e),e<=0?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)}(e,t,r)},A.allocUnsafe=function(e){return u(e)},A.allocUnsafeSlow=function(e){return u(e)},A.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==A.prototype},A.compare=function(e,t){if(W(e,Uint8Array)&&(e=A.from(e,e.offset,e.byteLength)),W(t,Uint8Array)&&(t=A.from(t,t.offset,t.byteLength)),!A.isBuffer(e)||!A.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let s=0,i=Math.min(r,n);s<i;++s)if(e[s]!==t[s]){r=e[s],n=t[s];break}return r<n?-1:n<r?1:0},A.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},A.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return A.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=A.allocUnsafe(t);let s=0;for(r=0;r<e.length;++r){let t=e[r];if(W(t,Uint8Array))s+t.length>n.length?(A.isBuffer(t)||(t=A.from(t)),t.copy(n,s)):Uint8Array.prototype.set.call(n,t,s);else{if(!A.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,s)}s+=t.length}return n},A.byteLength=p,A.prototype._isBuffer=!0,A.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},A.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},A.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},A.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?S(this,0,e):g.apply(this,arguments)},A.prototype.toLocaleString=A.prototype.toString,A.prototype.equals=function(e){if(!A.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===A.compare(this,e)},A.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},i&&(A.prototype[i]=A.prototype.inspect),A.prototype.compare=function(e,t,r,n,s){if(W(e,Uint8Array)&&(e=A.from(e,e.offset,e.byteLength)),!A.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===s&&(s=this.length),t<0||r>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&t>=r)return 0;if(n>=s)return-1;if(t>=r)return 1;if(this===e)return 0;let i=(s>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0);const a=Math.min(i,o),c=this.slice(n,s),l=e.slice(t,r);for(let e=0;e<a;++e)if(c[e]!==l[e]){i=c[e],o=l[e];break}return i<o?-1:o<i?1:0},A.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},A.prototype.indexOf=function(e,t,r){return w(this,e,t,r,!0)},A.prototype.lastIndexOf=function(e,t,r){return w(this,e,t,r,!1)},A.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const s=this.length-t;if((void 0===r||r>s)&&(r=s),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let i=!1;for(;;)switch(n){case"hex":return b(this,e,t,r);case"utf8":case"utf-8":return E(this,e,t,r);case"ascii":case"latin1":case"binary":return v(this,e,t,r);case"base64":return B(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},A.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const I=4096;function T(e,t,r){let n="";r=Math.min(e.length,r);for(let s=t;s<r;++s)n+=String.fromCharCode(127&e[s]);return n}function R(e,t,r){let n="";r=Math.min(e.length,r);for(let s=t;s<r;++s)n+=String.fromCharCode(e[s]);return n}function k(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let s="";for(let n=t;n<r;++n)s+=X[e[n]];return s}function U(e,t,r){const n=e.slice(t,r);let s="";for(let e=0;e<n.length-1;e+=2)s+=String.fromCharCode(n[e]+256*n[e+1]);return s}function D(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,r,n,s,i){if(!A.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>s||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function L(e,t,r,n,s){K(t,n,s,e,r,7);let i=Number(t&BigInt(4294967295));e[r++]=i,i>>=8,e[r++]=i,i>>=8,e[r++]=i,i>>=8,e[r++]=i;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,r}function N(e,t,r,n,s){K(t,n,s,e,r,7);let i=Number(t&BigInt(4294967295));e[r+7]=i,i>>=8,e[r+6]=i,i>>=8,e[r+5]=i,i>>=8,e[r+4]=i;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,o>>=8,e[r+2]=o,o>>=8,e[r+1]=o,o>>=8,e[r]=o,r+8}function O(e,t,r,n,s,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function F(e,t,r,n,i){return t=+t,r>>>=0,i||O(e,0,r,4),s.write(e,t,r,n,23,4),r+4}function Q(e,t,r,n,i){return t=+t,r>>>=0,i||O(e,0,r,8),s.write(e,t,r,n,52,8),r+8}A.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,A.prototype),n},A.prototype.readUintLE=A.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e],s=1,i=0;for(;++i<t&&(s*=256);)n+=this[e+i]*s;return n},A.prototype.readUintBE=A.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e+--t],s=1;for(;t>0&&(s*=256);)n+=this[e+--t]*s;return n},A.prototype.readUint8=A.prototype.readUInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),this[e]},A.prototype.readUint16LE=A.prototype.readUInt16LE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]|this[e+1]<<8},A.prototype.readUint16BE=A.prototype.readUInt16BE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]<<8|this[e+1]},A.prototype.readUint32LE=A.prototype.readUInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},A.prototype.readUint32BE=A.prototype.readUInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},A.prototype.readBigUInt64LE=J((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||z(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,s=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))})),A.prototype.readBigUInt64BE=J((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||z(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],s=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(s)})),A.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e],s=1,i=0;for(;++i<t&&(s*=256);)n+=this[e+i]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*t)),n},A.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=t,s=1,i=this[e+--n];for(;n>0&&(s*=256);)i+=this[e+--n]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*t)),i},A.prototype.readInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},A.prototype.readInt16LE=function(e,t){e>>>=0,t||D(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},A.prototype.readInt16BE=function(e,t){e>>>=0,t||D(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},A.prototype.readInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},A.prototype.readInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},A.prototype.readBigInt64LE=J((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||z(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),A.prototype.readBigInt64BE=J((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||z(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),A.prototype.readFloatLE=function(e,t){return e>>>=0,t||D(e,4,this.length),s.read(this,e,!0,23,4)},A.prototype.readFloatBE=function(e,t){return e>>>=0,t||D(e,4,this.length),s.read(this,e,!1,23,4)},A.prototype.readDoubleLE=function(e,t){return e>>>=0,t||D(e,8,this.length),s.read(this,e,!0,52,8)},A.prototype.readDoubleBE=function(e,t){return e>>>=0,t||D(e,8,this.length),s.read(this,e,!1,52,8)},A.prototype.writeUintLE=A.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){P(this,e,t,r,Math.pow(2,8*r)-1,0)}let s=1,i=0;for(this[t]=255&e;++i<r&&(s*=256);)this[t+i]=e/s&255;return t+r},A.prototype.writeUintBE=A.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){P(this,e,t,r,Math.pow(2,8*r)-1,0)}let s=r-1,i=1;for(this[t+s]=255&e;--s>=0&&(i*=256);)this[t+s]=e/i&255;return t+r},A.prototype.writeUint8=A.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,1,255,0),this[t]=255&e,t+1},A.prototype.writeUint16LE=A.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},A.prototype.writeUint16BE=A.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},A.prototype.writeUint32LE=A.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},A.prototype.writeUint32BE=A.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},A.prototype.writeBigUInt64LE=J((function(e,t=0){return L(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),A.prototype.writeBigUInt64BE=J((function(e,t=0){return N(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),A.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);P(this,e,t,r,n-1,-n)}let s=0,i=1,o=0;for(this[t]=255&e;++s<r&&(i*=256);)e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=(e/i>>0)-o&255;return t+r},A.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);P(this,e,t,r,n-1,-n)}let s=r-1,i=1,o=0;for(this[t+s]=255&e;--s>=0&&(i*=256);)e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=(e/i>>0)-o&255;return t+r},A.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},A.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},A.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},A.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},A.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},A.prototype.writeBigInt64LE=J((function(e,t=0){return L(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),A.prototype.writeBigInt64BE=J((function(e,t=0){return N(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),A.prototype.writeFloatLE=function(e,t,r){return F(this,e,t,!0,r)},A.prototype.writeFloatBE=function(e,t,r){return F(this,e,t,!1,r)},A.prototype.writeDoubleLE=function(e,t,r){return Q(this,e,t,!0,r)},A.prototype.writeDoubleBE=function(e,t,r){return Q(this,e,t,!1,r)},A.prototype.copy=function(e,t,r,n){if(!A.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const s=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),s},A.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!A.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let s;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(s=t;s<r;++s)this[s]=e;else{const i=A.isBuffer(e)?e:A.from(e,n),o=i.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<r-t;++s)this[s+t]=i[s%o]}return this};const x={};function M(e,t,r){x[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function H(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function K(e,t,r,n,s,i){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let s;throw s=i>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(i+1)}${n}`:`>= -(2${n} ** ${8*(i+1)-1}${n}) and < 2 ** ${8*(i+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new x.ERR_OUT_OF_RANGE("value",s,e)}!function(e,t,r){V(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||z(t,e.length-(r+1))}(n,s,i)}function V(e,t){if("number"!=typeof e)throw new x.ERR_INVALID_ARG_TYPE(t,"number",e)}function z(e,t,r){if(Math.floor(e)!==e)throw V(e,r),new x.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new x.ERR_BUFFER_OUT_OF_BOUNDS;throw new x.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}M("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),M("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),M("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,s=r;return Number.isInteger(r)&&Math.abs(r)>2**32?s=H(String(r)):"bigint"==typeof r&&(s=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(s=H(s)),s+="n"),n+=` It must be ${t}. Received ${s}`,n}),RangeError);const j=/[^+/0-9A-Za-z-_]/g;function G(e,t){let r;t=t||1/0;const n=e.length;let s=null;const i=[];for(let o=0;o<n;++o){if(r=e.charCodeAt(o),r>55295&&r<57344){if(!s){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&i.push(239,191,189);continue}s=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),s=r;continue}r=65536+(s-55296<<10|r-56320)}else s&&(t-=3)>-1&&i.push(239,191,189);if(s=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function $(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(j,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function q(e,t,r,n){let s;for(s=0;s<n&&!(s+r>=t.length||s>=e.length);++s)t[s+r]=e[s];return s}function W(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Y(e){return e!=e}const X=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let s=0;s<16;++s)t[n+s]=e[r]+e[s]}return t}();function J(e){return"undefined"==typeof BigInt?Z:e}function Z(){throw new Error("BigInt not supported")}},21301:function(e,t,r){t.Level=r(11708).BrowserLevel},70942:function(e,t,r){"use strict";const n=r(49727),{hasOwnProperty:s}=Object.prototype,{propertyIsEnumerable:i}=Object,o=(e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0}),a=this,A={concatArrays:!1,ignoreUndefined:!1},c=e=>{const t=[];for(const r in e)s.call(e,r)&&t.push(r);if(Object.getOwnPropertySymbols){const r=Object.getOwnPropertySymbols(e);for(const n of r)i.call(e,n)&&t.push(n)}return t};function l(e){return Array.isArray(e)?function(e){const t=e.slice(0,0);return c(e).forEach((r=>{o(t,r,l(e[r]))})),t}(e):n(e)?function(e){const t=null===Object.getPrototypeOf(e)?Object.create(null):{};return c(e).forEach((r=>{o(t,r,l(e[r]))})),t}(e):e}const u=(e,t,r,n)=>(r.forEach((r=>{void 0===t[r]&&n.ignoreUndefined||(r in e&&e[r]!==Object.getPrototypeOf(e)?o(e,r,h(e[r],t[r],n)):o(e,r,l(t[r])))})),e);function h(e,t,r){return r.concatArrays&&Array.isArray(e)&&Array.isArray(t)?((e,t,r)=>{let n=e.slice(0,0),i=0;return[e,t].forEach((t=>{const a=[];for(let r=0;r<t.length;r++)s.call(t,r)&&(a.push(String(r)),o(n,i++,t===e?t[r]:l(t[r])));n=u(n,t,c(t).filter((e=>!a.includes(e))),r)})),n})(e,t,r):n(t)&&n(e)?u(e,t,c(t),r):l(t)}e.exports=function(...e){const t=h(l(A),this!==a&&this||{},A);let r={_:{}};for(const s of e)if(void 0!==s){if(!n(s))throw new TypeError("`"+s+"` is not an Option Object");r=h(r,{_:s},t)}return r._}},49727:function(e){"use strict";e.exports=e=>{if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}},94473:function(e){"use strict";e.exports=class extends Error{constructor(e,t){super(e||""),"object"==typeof t&&null!==t&&(t.code&&(this.code=String(t.code)),t.expected&&(this.expected=!0),t.transient&&(this.transient=!0),t.cause&&(this.cause=t.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}},57824:function(e){var t=1e3,r=60*t,n=60*r,s=24*n,i=7*s,o=365.25*s;function a(e,t,r,n){var s=t>=1.5*r;return Math.round(e/r)+" "+n+(s?"s":"")}e.exports=function(e,A){A=A||{};var c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!a)return;var A=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return A*o;case"weeks":case"week":case"w":return A*i;case"days":case"day":case"d":return A*s;case"hours":case"hour":case"hrs":case"hr":case"h":return A*n;case"minutes":case"minute":case"mins":case"min":case"m":return A*r;case"seconds":case"second":case"secs":case"sec":case"s":return A*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return A;default:return}}(e);if("number"===c&&isFinite(e))return A.long?function(e){var i=Math.abs(e);if(i>=s)return a(e,i,s,"day");if(i>=n)return a(e,i,n,"hour");if(i>=r)return a(e,i,r,"minute");if(i>=t)return a(e,i,t,"second");return e+" ms"}(e):function(e){var i=Math.abs(e);if(i>=s)return Math.round(e/s)+"d";if(i>=n)return Math.round(e/n)+"h";if(i>=r)return Math.round(e/r)+"m";if(i>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},40469:function(e,t,r){e.exports=r(18027)},18027:function(e,t){!function(r,n){"use strict";var s={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function i(e){if(!Array.isArray(e)&&!ArrayBuffer.isView(e))return!1;for(var t=0;t<e.length;t++)if(!Number.isInteger(e[t])||e[t]<0||e[t]>255)return!1;return!0}function o(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function a(e,t){return e<<t|e>>>32-t}function A(e){return e=o(e^=e>>>16,2246822507),e=o(e^=e>>>13,3266489909),e^=e>>>16}function c(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]+t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]+t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]+t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]+t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function l(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]*t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]*t[3],r[1]+=r[2]>>>16,r[2]&=65535,r[2]+=e[3]*t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]*t[3],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[2]*t[2],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[3]*t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function u(e,t){return 32===(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])}function h(e,t){return 0===(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function d(e,t){return[e[0]^t[0],e[1]^t[1]]}function f(e){return e=d(e,[0,e[0]>>>1]),e=d(e=l(e,[4283543511,3981806797]),[0,e[0]>>>1]),e=d(e=l(e,[3301882366,444984403]),[0,e[0]>>>1])}s.x86.hash32=function(e,t){if(s.inputValidation&&!i(e))return n;t=t||0;for(var r=e.length%4,c=e.length-r,l=t,u=0,h=3432918353,d=461845907,f=0;f<c;f+=4)u=o(u=e[f]|e[f+1]<<8|e[f+2]<<16|e[f+3]<<24,h),u=o(u=a(u,15),d),l=o(l=a(l^=u,13),5)+3864292196;switch(u=0,r){case 3:u^=e[f+2]<<16;case 2:u^=e[f+1]<<8;case 1:u=o(u^=e[f],h),l^=u=o(u=a(u,15),d)}return(l=A(l^=e.length))>>>0},s.x86.hash128=function(e,t){if(s.inputValidation&&!i(e))return n;t=t||0;for(var r=e.length%16,c=e.length-r,l=t,u=t,h=t,d=t,f=0,p=0,g=0,y=0,w=597399067,m=2869860233,b=951274213,E=2716044179,v=0;v<c;v+=16)f=e[v]|e[v+1]<<8|e[v+2]<<16|e[v+3]<<24,p=e[v+4]|e[v+5]<<8|e[v+6]<<16|e[v+7]<<24,g=e[v+8]|e[v+9]<<8|e[v+10]<<16|e[v+11]<<24,y=e[v+12]|e[v+13]<<8|e[v+14]<<16|e[v+15]<<24,f=a(f=o(f,w),15),l=a(l^=f=o(f,m),19),l=o(l+=u,5)+1444728091,p=a(p=o(p,m),16),u=a(u^=p=o(p,b),17),u=o(u+=h,5)+197830471,g=a(g=o(g,b),17),h=a(h^=g=o(g,E),15),h=o(h+=d,5)+2530024501,y=a(y=o(y,E),18),d=a(d^=y=o(y,w),13),d=o(d+=l,5)+850148119;switch(f=0,p=0,g=0,y=0,r){case 15:y^=e[v+14]<<16;case 14:y^=e[v+13]<<8;case 13:y=o(y^=e[v+12],E),d^=y=o(y=a(y,18),w);case 12:g^=e[v+11]<<24;case 11:g^=e[v+10]<<16;case 10:g^=e[v+9]<<8;case 9:g=o(g^=e[v+8],b),h^=g=o(g=a(g,17),E);case 8:p^=e[v+7]<<24;case 7:p^=e[v+6]<<16;case 6:p^=e[v+5]<<8;case 5:p=o(p^=e[v+4],m),u^=p=o(p=a(p,16),b);case 4:f^=e[v+3]<<24;case 3:f^=e[v+2]<<16;case 2:f^=e[v+1]<<8;case 1:f=o(f^=e[v],w),l^=f=o(f=a(f,15),m)}return l^=e.length,l+=u^=e.length,l+=h^=e.length,u+=l+=d^=e.length,h+=l,d+=l,l=A(l),l+=u=A(u),l+=h=A(h),u+=l+=d=A(d),h+=l,d+=l,("00000000"+(l>>>0).toString(16)).slice(-8)+("00000000"+(u>>>0).toString(16)).slice(-8)+("00000000"+(h>>>0).toString(16)).slice(-8)+("00000000"+(d>>>0).toString(16)).slice(-8)},s.x64.hash128=function(e,t){if(s.inputValidation&&!i(e))return n;t=t||0;for(var r=e.length%16,o=e.length-r,a=[0,t],A=[0,t],p=[0,0],g=[0,0],y=[2277735313,289559509],w=[1291169091,658871167],m=0;m<o;m+=16)p=[e[m+4]|e[m+5]<<8|e[m+6]<<16|e[m+7]<<24,e[m]|e[m+1]<<8|e[m+2]<<16|e[m+3]<<24],g=[e[m+12]|e[m+13]<<8|e[m+14]<<16|e[m+15]<<24,e[m+8]|e[m+9]<<8|e[m+10]<<16|e[m+11]<<24],p=u(p=l(p,y),31),a=c(a=u(a=d(a,p=l(p,w)),27),A),a=c(l(a,[0,5]),[0,1390208809]),g=u(g=l(g,w),33),A=c(A=u(A=d(A,g=l(g,y)),31),a),A=c(l(A,[0,5]),[0,944331445]);switch(p=[0,0],g=[0,0],r){case 15:g=d(g,h([0,e[m+14]],48));case 14:g=d(g,h([0,e[m+13]],40));case 13:g=d(g,h([0,e[m+12]],32));case 12:g=d(g,h([0,e[m+11]],24));case 11:g=d(g,h([0,e[m+10]],16));case 10:g=d(g,h([0,e[m+9]],8));case 9:g=l(g=d(g,[0,e[m+8]]),w),A=d(A,g=l(g=u(g,33),y));case 8:p=d(p,h([0,e[m+7]],56));case 7:p=d(p,h([0,e[m+6]],48));case 6:p=d(p,h([0,e[m+5]],40));case 5:p=d(p,h([0,e[m+4]],32));case 4:p=d(p,h([0,e[m+3]],24));case 3:p=d(p,h([0,e[m+2]],16));case 2:p=d(p,h([0,e[m+1]],8));case 1:p=l(p=d(p,[0,e[m]]),y),a=d(a,p=l(p=u(p,31),w))}return a=c(a=d(a,[0,e.length]),A=d(A,[0,e.length])),A=c(A,a),a=c(a=f(a),A=f(A)),A=c(A,a),("00000000"+(a[0]>>>0).toString(16)).slice(-8)+("00000000"+(a[1]>>>0).toString(16)).slice(-8)+("00000000"+(A[0]>>>0).toString(16)).slice(-8)+("00000000"+(A[1]>>>0).toString(16)).slice(-8)},e.exports&&(t=e.exports=s),t.murmurHash3=s}()},28951:function(e,t){(function(){var e,r,n,s,i,o,a,A;A=function(e){return[(e&255<<24)>>>24,(e&255<<16)>>>16,(65280&e)>>>8,255&e].join(".")},a=function(e){var t,n,s,i,o,a;for(t=[],s=i=0;i<=3&&0!==e.length;s=++i){if(s>0){if("."!==e[0])throw new Error("Invalid IP");e=e.substring(1)}o=(a=r(e))[0],n=a[1],e=e.substring(n),t.push(o)}if(0!==e.length)throw new Error("Invalid IP");switch(t.length){case 1:if(t[0]>4294967295)throw new Error("Invalid IP");return t[0]>>>0;case 2:if(t[0]>255||t[1]>16777215)throw new Error("Invalid IP");return(t[0]<<24|t[1])>>>0;case 3:if(t[0]>255||t[1]>255||t[2]>65535)throw new Error("Invalid IP");return(t[0]<<24|t[1]<<16|t[2])>>>0;case 4:if(t[0]>255||t[1]>255||t[2]>255||t[3]>255)throw new Error("Invalid IP");return(t[0]<<24|t[1]<<16|t[2]<<8|t[3])>>>0;default:throw new Error("Invalid IP")}},s=(n=function(e){return e.charCodeAt(0)})("0"),o=n("a"),i=n("A"),r=function(e){var t,r,a,A,c;for(A=0,t=10,r="9",a=0,e.length>1&&"0"===e[a]&&("x"===e[a+1]||"X"===e[a+1]?(a+=2,t=16):"0"<=e[a+1]&&e[a+1]<="9"&&(a++,t=8,r="7")),c=a;a<e.length;){if("0"<=e[a]&&e[a]<=r)A=A*t+(n(e[a])-s)>>>0;else{if(16!==t)break;if("a"<=e[a]&&e[a]<="f")A=A*t+(10+n(e[a])-o)>>>0;else{if(!("A"<=e[a]&&e[a]<="F"))break;A=A*t+(10+n(e[a])-i)>>>0}}if(A>4294967295)throw new Error("too large");a++}if(a===c)throw new Error("empty octet");return[A,a]},e=function(){function e(e,t){var r,n,s;if("string"!=typeof e)throw new Error("Missing `net' parameter");if(t||(s=e.split("/",2),e=s[0],t=s[1]),t||(t=32),"string"==typeof t&&t.indexOf(".")>-1){try{this.maskLong=a(t)}catch(e){throw e,new Error("Invalid mask: "+t)}for(r=n=32;n>=0;r=--n)if(this.maskLong===4294967295<<32-r>>>0){this.bitmask=r;break}}else{if(!t&&0!==t)throw new Error("Invalid mask: empty");this.bitmask=parseInt(t,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0)}try{this.netLong=(a(e)&this.maskLong)>>>0}catch(t){throw t,new Error("Invalid net address: "+e)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+t);this.size=Math.pow(2,32-this.bitmask),this.base=A(this.netLong),this.mask=A(this.maskLong),this.hostmask=A(~this.maskLong),this.first=this.bitmask<=30?A(this.netLong+1):this.base,this.last=this.bitmask<=30?A(this.netLong+this.size-2):A(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?A(this.netLong+this.size-1):void 0}return e.prototype.contains=function(t){return"string"==typeof t&&(t.indexOf("/")>0||4!==t.split(".").length)&&(t=new e(t)),t instanceof e?this.contains(t.base)&&this.contains(t.broadcast||t.last):(a(t)&this.maskLong)>>>0==(this.netLong&this.maskLong)>>>0},e.prototype.next=function(t){return null==t&&(t=1),new e(A(this.netLong+this.size*t),this.mask)},e.prototype.forEach=function(e){var t,r,n;for(n=a(this.first),r=a(this.last),t=0;n<=r;)e(A(n),n,t),t++,n++},e.prototype.toString=function(){return this.base+"/"+this.bitmask},e}(),t.ip2long=a,t.long2ip=A,t.Netmask=e}).call(this)},8925:function(e,t,r){var n=r(3832);function s(e,t){n.cipher.registerAlgorithm(e,(function(){return new n.aes.Algorithm(e,t)}))}r(85649),r(61967),r(97116),e.exports=n.aes=n.aes||{},n.aes.startEncrypting=function(e,t,r,n){var s=f({key:e,output:r,decrypt:!1,mode:n});return s.start(t),s},n.aes.createEncryptionCipher=function(e,t){return f({key:e,output:null,decrypt:!1,mode:t})},n.aes.startDecrypting=function(e,t,r,n){var s=f({key:e,output:r,decrypt:!0,mode:n});return s.start(t),s},n.aes.createDecryptionCipher=function(e,t){return f({key:e,output:null,decrypt:!0,mode:t})},n.aes.Algorithm=function(e,t){l||u();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(e,t){return d(r._w,e,t,!1)},decrypt:function(e,t){return d(r._w,e,t,!0)}}}),r._init=!1},n.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t,r=e.key;if("string"!=typeof r||16!==r.length&&24!==r.length&&32!==r.length){if(n.util.isArray(r)&&(16===r.length||24===r.length||32===r.length)){t=r,r=n.util.createBuffer();for(var s=0;s<t.length;++s)r.putByte(t[s])}}else r=n.util.createBuffer(r);if(!n.util.isArray(r)){t=r,r=[];var i=t.length();if(16===i||24===i||32===i){i>>>=2;for(s=0;s<i;++s)r.push(t.getInt32())}}if(!n.util.isArray(r)||4!==r.length&&6!==r.length&&8!==r.length)throw new Error("Invalid key parameter.");var o=this.mode.name,a=-1!==["CFB","OFB","CTR","GCM"].indexOf(o);this._w=h(r,e.decrypt&&!a),this._init=!0}},n.aes._expandKey=function(e,t){return l||u(),h(e,t)},n.aes._updateBlock=d,s("AES-ECB",n.cipher.modes.ecb),s("AES-CBC",n.cipher.modes.cbc),s("AES-CFB",n.cipher.modes.cfb),s("AES-OFB",n.cipher.modes.ofb),s("AES-CTR",n.cipher.modes.ctr),s("AES-GCM",n.cipher.modes.gcm);var i,o,a,A,c,l=!1;function u(){l=!0,a=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;i=new Array(256),o=new Array(256),A=new Array(4),c=new Array(4);for(t=0;t<4;++t)A[t]=new Array(256),c[t]=new Array(256);var r,n,s,u,h,d,f,p=0,g=0;for(t=0;t<256;++t){u=(u=g^g<<1^g<<2^g<<3^g<<4)>>8^255&u^99,i[p]=u,o[u]=p,d=(h=e[u])<<24^u<<16^u<<8^u^h,f=((r=e[p])^(n=e[r])^(s=e[n]))<<24^(p^s)<<16^(p^n^s)<<8^p^r^s;for(var y=0;y<4;++y)A[y][p]=d,c[y][u]=f,d=d<<24|d>>>8,f=f<<24|f>>>8;0===p?p=g=1:(p=r^e[e[e[r^s]]],g^=e[e[g]])}}function h(e,t){for(var r,n=e.slice(0),s=1,o=n.length,A=4*(o+6+1),l=o;l<A;++l)r=n[l-1],l%o==0?(r=i[r>>>16&255]<<24^i[r>>>8&255]<<16^i[255&r]<<8^i[r>>>24]^a[s]<<24,s++):o>6&&l%o==4&&(r=i[r>>>24]<<24^i[r>>>16&255]<<16^i[r>>>8&255]<<8^i[255&r]),n[l]=n[l-o]^r;if(t){for(var u,h=c[0],d=c[1],f=c[2],p=c[3],g=n.slice(0),y=(l=0,(A=n.length)-4);l<A;l+=4,y-=4)if(0===l||l===A-4)g[l]=n[y],g[l+1]=n[y+3],g[l+2]=n[y+2],g[l+3]=n[y+1];else for(var w=0;w<4;++w)u=n[y+w],g[l+(3&-w)]=h[i[u>>>24]]^d[i[u>>>16&255]]^f[i[u>>>8&255]]^p[i[255&u]];n=g}return n}function d(e,t,r,n){var s,a,l,u,h,d,f,p,g,y,w,m,b=e.length/4-1;n?(s=c[0],a=c[1],l=c[2],u=c[3],h=o):(s=A[0],a=A[1],l=A[2],u=A[3],h=i),d=t[0]^e[0],f=t[n?3:1]^e[1],p=t[2]^e[2],g=t[n?1:3]^e[3];for(var E=3,v=1;v<b;++v)y=s[d>>>24]^a[f>>>16&255]^l[p>>>8&255]^u[255&g]^e[++E],w=s[f>>>24]^a[p>>>16&255]^l[g>>>8&255]^u[255&d]^e[++E],m=s[p>>>24]^a[g>>>16&255]^l[d>>>8&255]^u[255&f]^e[++E],g=s[g>>>24]^a[d>>>16&255]^l[f>>>8&255]^u[255&p]^e[++E],d=y,f=w,p=m;r[0]=h[d>>>24]<<24^h[f>>>16&255]<<16^h[p>>>8&255]<<8^h[255&g]^e[++E],r[n?3:1]=h[f>>>24]<<24^h[p>>>16&255]<<16^h[g>>>8&255]<<8^h[255&d]^e[++E],r[2]=h[p>>>24]<<24^h[g>>>16&255]<<16^h[d>>>8&255]<<8^h[255&f]^e[++E],r[n?1:3]=h[g>>>24]<<24^h[d>>>16&255]<<16^h[f>>>8&255]<<8^h[255&p]^e[++E]}function f(e){var t,r="AES-"+((e=e||{}).mode||"CBC").toUpperCase(),s=(t=e.decrypt?n.cipher.createDecipher(r,e.key):n.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var i=null;r instanceof n.util.ByteBuffer&&(i=r,r={}),(r=r||{}).output=i,r.iv=e,s.call(t,r)},t}},3068:function(e,t,r){var n=r(3832);r(97116),r(66270);var s=e.exports=n.asn1=n.asn1||{};function i(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}s.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},s.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},s.create=function(e,t,r,i,o){if(n.util.isArray(i)){for(var a=[],A=0;A<i.length;++A)void 0!==i[A]&&a.push(i[A]);i=a}var c={tagClass:e,type:t,constructed:r,composed:r||n.util.isArray(i),value:i};return o&&"bitStringContents"in o&&(c.bitStringContents=o.bitStringContents,c.original=s.copy(c)),c},s.copy=function(e,t){var r;if(n.util.isArray(e)){r=[];for(var i=0;i<e.length;++i)r.push(s.copy(e[i],t));return r}return"string"==typeof e?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:s.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)},s.equals=function(e,t,r){if(n.util.isArray(e)){if(!n.util.isArray(t))return!1;if(e.length!==t.length)return!1;for(var i=0;i<e.length;++i)if(!s.equals(e[i],t[i]))return!1;return!0}if(typeof e!=typeof t)return!1;if("string"==typeof e)return e===t;var o=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&s.equals(e.value,t.value);return r&&r.includeBitStringContents&&(o=o&&e.bitStringContents===t.bitStringContents),o},s.getBerValueLength=function(e){var t=e.getByte();if(128!==t)return 128&t?e.getInt((127&t)<<3):t};function o(e,t,r,n){var a;i(e,t,2);var A=e.getByte();t--;var c=192&A,l=31&A;a=e.length();var u,h,d=function(e,t){var r=e.getByte();if(t--,128!==r){var n;if(128&r){var s=127&r;i(e,t,s),n=e.getInt(s<<3)}else n=r;if(n<0)throw new Error("Negative length: "+n);return n}}(e,t);if(t-=a-e.length(),void 0!==d&&d>t){if(n.strict){var f=new Error("Too few bytes to read ASN.1 value.");throw f.available=e.length(),f.remaining=t,f.requested=d,f}d=t}var p=32==(32&A);if(p)if(u=[],void 0===d)for(;;){if(i(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}a=e.length(),u.push(o(e,t,r+1,n)),t-=a-e.length()}else for(;d>0;)a=e.length(),u.push(o(e,d,r+1,n)),t-=a-e.length(),d-=a-e.length();if(void 0===u&&c===s.Class.UNIVERSAL&&l===s.Type.BITSTRING&&(h=e.bytes(d)),void 0===u&&n.decodeBitStrings&&c===s.Class.UNIVERSAL&&l===s.Type.BITSTRING&&d>1){var g=e.read,y=t,w=0;if(l===s.Type.BITSTRING&&(i(e,t,1),w=e.getByte(),t--),0===w)try{a=e.length();var m=o(e,t,r+1,{strict:!0,decodeBitStrings:!0}),b=a-e.length();t-=b,l==s.Type.BITSTRING&&b++;var E=m.tagClass;b!==d||E!==s.Class.UNIVERSAL&&E!==s.Class.CONTEXT_SPECIFIC||(u=[m])}catch(e){}void 0===u&&(e.read=g,t=y)}if(void 0===u){if(void 0===d){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");d=t}if(l===s.Type.BMPSTRING)for(u="";d>0;d-=2)i(e,t,2),u+=String.fromCharCode(e.getInt16()),t-=2;else u=e.getBytes(d),t-=d}var v=void 0===h?null:{bitStringContents:h};return s.create(c,l,p,u,v)}s.fromDer=function(e,t){void 0===t&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),"boolean"==typeof t&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),"string"==typeof e&&(e=n.util.createBuffer(e));var r=e.length(),s=o(e,e.length(),0,t);if(t.parseAllBytes&&0!==e.length()){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=e.length(),i}return s},s.toDer=function(e){var t=n.util.createBuffer(),r=e.tagClass|e.type,i=n.util.createBuffer(),o=!1;if("bitStringContents"in e&&(o=!0,e.original&&(o=s.equals(e,e.original))),o)i.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:i.putByte(0);for(var a=0;a<e.value.length;++a)void 0!==e.value[a]&&i.putBuffer(s.toDer(e.value[a]))}else if(e.type===s.Type.BMPSTRING)for(a=0;a<e.value.length;++a)i.putInt16(e.value.charCodeAt(a));else e.type===s.Type.INTEGER&&e.value.length>1&&(0===e.value.charCodeAt(0)&&0==(128&e.value.charCodeAt(1))||255===e.value.charCodeAt(0)&&128==(128&e.value.charCodeAt(1)))?i.putBytes(e.value.substr(1)):i.putBytes(e.value);if(t.putByte(r),i.length()<=127)t.putByte(127&i.length());else{var A=i.length(),c="";do{c+=String.fromCharCode(255&A),A>>>=8}while(A>0);t.putByte(128|c.length);for(a=c.length-1;a>=0;--a)t.putByte(c.charCodeAt(a))}return t.putBuffer(i),t},s.oidToDer=function(e){var t,r,s,i,o=e.split("."),a=n.util.createBuffer();a.putByte(40*parseInt(o[0],10)+parseInt(o[1],10));for(var A=2;A<o.length;++A){t=!0,r=[],s=parseInt(o[A],10);do{i=127&s,s>>>=7,t||(i|=128),r.push(i),t=!1}while(s>0);for(var c=r.length-1;c>=0;--c)a.putByte(r[c])}return a},s.derToOid=function(e){var t;"string"==typeof e&&(e=n.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var s=0;e.length()>0;)s<<=7,128&(r=e.getByte())?s+=127&r:(t+="."+(s+r),s=0);return t},s.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,s=parseInt(e.substr(4,2),10),i=parseInt(e.substr(6,2),10),o=parseInt(e.substr(8,2),10),a=0;if(e.length>11){var A=e.charAt(10),c=10;"+"!==A&&"-"!==A&&(a=parseInt(e.substr(10,2),10),c+=2)}if(t.setUTCFullYear(r,n,s),t.setUTCHours(i,o,a,0),c&&("+"===(A=e.charAt(c))||"-"===A)){var l=60*parseInt(e.substr(c+1,2),10)+parseInt(e.substr(c+4,2),10);l*=6e4,"+"===A?t.setTime(+t-l):t.setTime(+t+l)}return t},s.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,s=parseInt(e.substr(6,2),10),i=parseInt(e.substr(8,2),10),o=parseInt(e.substr(10,2),10),a=parseInt(e.substr(12,2),10),A=0,c=0,l=!1;"Z"===e.charAt(e.length-1)&&(l=!0);var u=e.length-5,h=e.charAt(u);"+"!==h&&"-"!==h||(c=60*parseInt(e.substr(u+1,2),10)+parseInt(e.substr(u+4,2),10),c*=6e4,"+"===h&&(c*=-1),l=!0);return"."===e.charAt(14)&&(A=1e3*parseFloat(e.substr(14),10)),l?(t.setUTCFullYear(r,n,s),t.setUTCHours(i,o,a,A),t.setTime(+t+c)):(t.setFullYear(r,n,s),t.setHours(i,o,a,A)),t},s.dateToUtcTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},s.dateToGeneralizedTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},s.integerToDer=function(e){var t=n.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r},s.derToInteger=function(e){"string"==typeof e&&(e=n.util.createBuffer(e));var t=8*e.length();if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)},s.validate=function(e,t,r,i){var o=!1;if(e.tagClass!==t.tagClass&&void 0!==t.tagClass||e.type!==t.type&&void 0!==t.type)i&&(e.tagClass!==t.tagClass&&i.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&i.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));else if(e.constructed===t.constructed||void 0===t.constructed){if(o=!0,t.value&&n.util.isArray(t.value))for(var a=0,A=0;o&&A<t.value.length;++A)o=t.value[A].optional||!1,e.value[a]&&((o=s.validate(e.value[a],t.value[A],r,i))?++a:t.value[A].optional&&(o=!0)),!o&&i&&i.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(o&&r)if(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{if(0!==e.bitStringContents.charCodeAt(0))throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}else i&&i.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');return o};var a=/[^\\u0000-\\u00ff]/;s.prettyPrint=function(e,t,r){var i="";r=r||2,(t=t||0)>0&&(i+="\n");for(var o="",A=0;A<t*r;++A)o+=" ";switch(i+=o+"Tag: ",e.tagClass){case s.Class.UNIVERSAL:i+="Universal:";break;case s.Class.APPLICATION:i+="Application:";break;case s.Class.CONTEXT_SPECIFIC:i+="Context-Specific:";break;case s.Class.PRIVATE:i+="Private:"}if(e.tagClass===s.Class.UNIVERSAL)switch(i+=e.type,e.type){case s.Type.NONE:i+=" (None)";break;case s.Type.BOOLEAN:i+=" (Boolean)";break;case s.Type.INTEGER:i+=" (Integer)";break;case s.Type.BITSTRING:i+=" (Bit string)";break;case s.Type.OCTETSTRING:i+=" (Octet string)";break;case s.Type.NULL:i+=" (Null)";break;case s.Type.OID:i+=" (Object Identifier)";break;case s.Type.ODESC:i+=" (Object Descriptor)";break;case s.Type.EXTERNAL:i+=" (External or Instance of)";break;case s.Type.REAL:i+=" (Real)";break;case s.Type.ENUMERATED:i+=" (Enumerated)";break;case s.Type.EMBEDDED:i+=" (Embedded PDV)";break;case s.Type.UTF8:i+=" (UTF8)";break;case s.Type.ROID:i+=" (Relative Object Identifier)";break;case s.Type.SEQUENCE:i+=" (Sequence)";break;case s.Type.SET:i+=" (Set)";break;case s.Type.PRINTABLESTRING:i+=" (Printable String)";break;case s.Type.IA5String:i+=" (IA5String (ASCII))";break;case s.Type.UTCTIME:i+=" (UTC time)";break;case s.Type.GENERALIZEDTIME:i+=" (Generalized time)";break;case s.Type.BMPSTRING:i+=" (BMP String)"}else i+=e.type;if(i+="\n",i+=o+"Constructed: "+e.constructed+"\n",e.composed){var c=0,l="";for(A=0;A<e.value.length;++A)void 0!==e.value[A]&&(c+=1,l+=s.prettyPrint(e.value[A],t+1,r),A+1<e.value.length&&(l+=","));i+=o+"Sub values: "+c+l}else{if(i+=o+"Value: ",e.type===s.Type.OID){var u=s.derToOid(e.value);i+=u,n.pki&&n.pki.oids&&u in n.pki.oids&&(i+=" ("+n.pki.oids[u]+") ")}if(e.type===s.Type.INTEGER)try{i+=s.derToInteger(e.value)}catch(t){i+="0x"+n.util.bytesToHex(e.value)}else if(e.type===s.Type.BITSTRING){if(e.value.length>1?i+="0x"+n.util.bytesToHex(e.value.slice(1)):i+="(none)",e.value.length>0){var h=e.value.charCodeAt(0);1==h?i+=" (1 unused bit shown)":h>1&&(i+=" ("+h+" unused bits shown)")}}else if(e.type===s.Type.OCTETSTRING)a.test(e.value)||(i+="("+e.value+") "),i+="0x"+n.util.bytesToHex(e.value);else if(e.type===s.Type.UTF8)try{i+=n.util.decodeUtf8(e.value)}catch(t){if("URI malformed"!==t.message)throw t;i+="0x"+n.util.bytesToHex(e.value)+" (malformed UTF8)"}else e.type===s.Type.PRINTABLESTRING||e.type===s.Type.IA5String?i+=e.value:a.test(e.value)?i+="0x"+n.util.bytesToHex(e.value):0===e.value.length?i+="[null]":i+=e.value}return i}},78807:function(e,t,r){var n=r(62678).Buffer,s={};e.exports=s;var i={};s.encode=function(e,t,r){if("string"!=typeof t)throw new TypeError('"alphabet" must be a string.');if(void 0!==r&&"number"!=typeof r)throw new TypeError('"maxline" must be a number.');var n="";if(e instanceof Uint8Array){var s=0,i=t.length,o=t.charAt(0),a=[0];for(s=0;s<e.length;++s){for(var A=0,c=e[s];A<a.length;++A)c+=a[A]<<8,a[A]=c%i,c=c/i|0;for(;c>0;)a.push(c%i),c=c/i|0}for(s=0;0===e[s]&&s<e.length-1;++s)n+=o;for(s=a.length-1;s>=0;--s)n+=t[a[s]]}else n=function(e,t){var r=0,n=t.length,s=t.charAt(0),i=[0];for(r=0;r<e.length();++r){for(var o=0,a=e.at(r);o<i.length;++o)a+=i[o]<<8,i[o]=a%n,a=a/n|0;for(;a>0;)i.push(a%n),a=a/n|0}var A="";for(r=0;0===e.at(r)&&r<e.length()-1;++r)A+=s;for(r=i.length-1;r>=0;--r)A+=t[i[r]];return A}(e,t);if(r){var l=new RegExp(".{1,"+r+"}","g");n=n.match(l).join("\r\n")}return n},s.decode=function(e,t){if("string"!=typeof e)throw new TypeError('"input" must be a string.');if("string"!=typeof t)throw new TypeError('"alphabet" must be a string.');var r=i[t];if(!r){r=i[t]=[];for(var s=0;s<t.length;++s)r[t.charCodeAt(s)]=s}e=e.replace(/\s/g,"");var o=t.length,a=t.charAt(0),A=[0];for(s=0;s<e.length;s++){var c=r[e.charCodeAt(s)];if(void 0===c)return;for(var l=0,u=c;l<A.length;++l)u+=A[l]*o,A[l]=255&u,u>>=8;for(;u>0;)A.push(255&u),u>>=8}for(var h=0;e[h]===a&&h<e.length-1;++h)A.push(0);return void 0!==n?n.from(A.reverse()):new Uint8Array(A.reverse())}},85649:function(e,t,r){var n=r(3832);r(97116),e.exports=n.cipher=n.cipher||{},n.cipher.algorithms=n.cipher.algorithms||{},n.cipher.createCipher=function(e,t){var r=e;if("string"==typeof r&&(r=n.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})},n.cipher.createDecipher=function(e,t){var r=e;if("string"==typeof r&&(r=n.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})},n.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),n.cipher.algorithms[e]=t},n.cipher.getAlgorithm=function(e){return(e=e.toUpperCase())in n.cipher.algorithms?n.cipher.algorithms[e]:null};var s=n.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};s.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=n.util.createBuffer(),this.output=e.output||n.util.createBuffer(),this.mode.start(t)},s.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},s.prototype.finish=function(e){!e||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(t){return e(this.blockSize,t,!1)},this.mode.unpad=function(t){return e(this.blockSize,t,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t))&&(this._finish=!0,this.update(),!(this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))&&!(this.mode.afterFinish&&!this.mode.afterFinish(this.output,t)))}},61967:function(e,t,r){var n=r(3832);r(97116),n.cipher=n.cipher||{};var s=e.exports=n.cipher.modes=n.cipher.modes||{};function i(e,t){if("string"==typeof e&&(e=n.util.createBuffer(e)),n.util.isArray(e)&&e.length>4){var r=e;e=n.util.createBuffer();for(var s=0;s<r.length;++s)e.putByte(r[s])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!n.util.isArray(e)){var i=[],o=t/4;for(s=0;s<o;++s)i.push(e.getInt32());e=i}return e}function o(e){e[e.length-1]=e[e.length-1]+1&4294967295}function a(e){return[e/4294967296|0,4294967295&e]}s.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},s.ecb.prototype.start=function(e){},s.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},s.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},s.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},s.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},s.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},s.cbc.prototype.start=function(e){if(null===e.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=i(e.iv,this.blockSize),this._prev=this._iv.slice(0)}},s.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock},s.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)},s.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},s.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},s.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},s.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=i(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},s.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var s=0;s<this._ints;++s)this._inBlock[s]=e.getInt32()^this._outBlock[s],t.putInt32(this._inBlock[s]);else{var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(s=0;s<this._ints;++s)this._partialBlock[s]=e.getInt32()^this._outBlock[s],this._partialOutput.putInt32(this._partialBlock[s]);if(i>0)e.read-=this.blockSize;else for(s=0;s<this._ints;++s)this._inBlock[s]=this._partialBlock[s];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},s.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var s=0;s<this._ints;++s)this._inBlock[s]=e.getInt32(),t.putInt32(this._inBlock[s]^this._outBlock[s]);else{var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(s=0;s<this._ints;++s)this._partialBlock[s]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[s]^this._outBlock[s]);if(i>0)e.read-=this.blockSize;else for(s=0;s<this._ints;++s)this._inBlock[s]=this._partialBlock[s];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},s.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},s.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=i(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},s.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===e.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var s=0;s<this._ints;++s)t.putInt32(e.getInt32()^this._outBlock[s]),this._inBlock[s]=this._outBlock[s];else{var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(s=0;s<this._ints;++s)this._partialOutput.putInt32(e.getInt32()^this._outBlock[s]);if(i>0)e.read-=this.blockSize;else for(s=0;s<this._ints;++s)this._inBlock[s]=this._outBlock[s];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},s.ofb.prototype.decrypt=s.ofb.prototype.encrypt,s.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},s.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=i(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},s.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var s=0;s<this._ints;++s)t.putInt32(e.getInt32()^this._outBlock[s]);else{var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(s=0;s<this._ints;++s)this._partialOutput.putInt32(e.getInt32()^this._outBlock[s]);if(i>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}o(this._inBlock)},s.ctr.prototype.decrypt=s.ctr.prototype.encrypt,s.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0,this._R=3774873600},s.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t,r=n.util.createBuffer(e.iv);if(this._cipherLength=0,t="additionalData"in e?n.util.createBuffer(e.additionalData):n.util.createBuffer(),this._tagLength="tagLength"in e?e.tagLength:128,this._tag=null,e.decrypt&&(this._tag=n.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var s=r.length();if(12===s)this._j0=[r.getInt32(),r.getInt32(),r.getInt32(),1];else{for(this._j0=[0,0,0,0];r.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(a(8*s)))}this._inBlock=this._j0.slice(0),o(this._inBlock),this._partialBytes=0,t=n.util.createBuffer(t),this._aDataLength=a(8*t.length());var i=t.length()%this.blockSize;for(i&&t.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])},s.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize){for(var s=0;s<this._ints;++s)t.putInt32(this._outBlock[s]^=e.getInt32());this._cipherLength+=this.blockSize}else{var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(s=0;s<this._ints;++s)this._partialOutput.putInt32(e.getInt32()^this._outBlock[s]);if(i<=0||r){if(r){var a=n%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(s=0;s<this._ints;++s)this._outBlock[s]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),o(this._inBlock)},s.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),o(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var s=0;s<this._ints;++s)t.putInt32(this._outBlock[s]^this._hashBlock[s]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize},s.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=n.util.createBuffer();var s=this._aDataLength.concat(a(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,s);var i=[];this.cipher.encrypt(this._j0,i);for(var o=0;o<this._ints;++o)this.tag.putInt32(this._s[o]^i[o]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r},s.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),s=0;s<128;++s){e[s/32|0]&1<<31-s%32&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r},s.gcm.prototype.pow=function(e,t){for(var r=1&e[3],n=3;n>0;--n)t[n]=e[n]>>>1|(1&e[n-1])<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)},s.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=e[r/8|0]>>>4*(7-r%8)&15,s=this._m[r][n];t[0]^=s[0],t[1]^=s[1],t[2]^=s[2],t[3]^=s[3]}return t},s.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)},s.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,s=16*r,i=new Array(s),o=0;o<s;++o){var a=[0,0,0,0],A=(n-1-o%n)*t;a[o/n|0]=1<<t-1<<A,i[o]=this.generateSubHashTable(this.multiply(a,e),t)}return i},s.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,s=new Array(r);s[n]=e.slice(0);for(var i=n>>>1;i>0;)this.pow(s[2*i],s[i]=[]),i>>=1;for(i=2;i<n;){for(var o=1;o<i;++o){var a=s[i],A=s[o];s[i+o]=[a[0]^A[0],a[1]^A[1],a[2]^A[2],a[3]^A[3]]}i*=2}for(s[0]=[0,0,0,0],i=n+1;i<r;++i){var c=s[i^n];s[i]=[e[0]^c[0],e[1]^c[1],e[2]^c[2],e[3]^c[3]]}return s}},33480:function(e,t,r){var n=r(3832);function s(e,t){n.cipher.registerAlgorithm(e,(function(){return new n.des.Algorithm(e,t)}))}r(85649),r(61967),r(97116),e.exports=n.des=n.des||{},n.des.startEncrypting=function(e,t,r,n){var s=f({key:e,output:r,decrypt:!1,mode:n||(null===t?"ECB":"CBC")});return s.start(t),s},n.des.createEncryptionCipher=function(e,t){return f({key:e,output:null,decrypt:!1,mode:t})},n.des.startDecrypting=function(e,t,r,n){var s=f({key:e,output:r,decrypt:!0,mode:n||(null===t?"ECB":"CBC")});return s.start(t),s},n.des.createDecryptionCipher=function(e,t){return f({key:e,output:null,decrypt:!0,mode:t})},n.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(e,t){return d(r._keys,e,t,!1)},decrypt:function(e,t){return d(r._keys,e,t,!0)}}}),r._init=!1},n.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=n.util.createBuffer(e.key);if(0===this.name.indexOf("3DES")&&24!==t.length())throw new Error("Invalid Triple-DES key size: "+8*t.length());this._keys=function(e){for(var t,r=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],n=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],s=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],o=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],A=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],l=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],d=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],f=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=e.length()>8?3:1,y=[],w=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],m=0,b=0;b<g;b++){var E=e.getInt32(),v=e.getInt32();E^=(t=252645135&(E>>>4^v))<<4,E^=t=65535&((v^=t)>>>-16^E),E^=(t=858993459&(E>>>2^(v^=t<<-16)))<<2,E^=t=65535&((v^=t)>>>-16^E),E^=(t=1431655765&(E>>>1^(v^=t<<-16)))<<1,E^=t=16711935&((v^=t)>>>8^E),t=(E^=(t=1431655765&(E>>>1^(v^=t<<8)))<<1)<<8|(v^=t)>>>20&240,E=v<<24|v<<8&16711680|v>>>8&65280|v>>>24&240,v=t;for(var B=0;B<w.length;++B){w[B]?(E=E<<2|E>>>26,v=v<<2|v>>>26):(E=E<<1|E>>>27,v=v<<1|v>>>27),v&=-15;var _=r[(E&=-15)>>>28]|n[E>>>24&15]|s[E>>>20&15]|i[E>>>16&15]|o[E>>>12&15]|a[E>>>8&15]|A[E>>>4&15],C=c[v>>>28]|l[v>>>24&15]|u[v>>>20&15]|h[v>>>16&15]|d[v>>>12&15]|f[v>>>8&15]|p[v>>>4&15];t=65535&(C>>>16^_),y[m++]=_^t,y[m++]=C^t<<16}}return y}(t),this._init=!0}},s("DES-ECB",n.cipher.modes.ecb),s("DES-CBC",n.cipher.modes.cbc),s("DES-CFB",n.cipher.modes.cfb),s("DES-OFB",n.cipher.modes.ofb),s("DES-CTR",n.cipher.modes.ctr),s("3DES-ECB",n.cipher.modes.ecb),s("3DES-CBC",n.cipher.modes.cbc),s("3DES-CFB",n.cipher.modes.cfb),s("3DES-OFB",n.cipher.modes.ofb),s("3DES-CTR",n.cipher.modes.ctr);var i=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],a=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],A=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],c=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],l=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],u=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],h=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function d(e,t,r,n){var s,d,f=32===e.length?3:9;s=3===f?n?[30,-2,-2]:[0,32,2]:n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var p=t[0],g=t[1];p^=(d=252645135&(p>>>4^g))<<4,p^=(d=65535&(p>>>16^(g^=d)))<<16,p^=d=858993459&((g^=d)>>>2^p),p^=d=16711935&((g^=d<<2)>>>8^p),p=(p^=(d=1431655765&(p>>>1^(g^=d<<8)))<<1)<<1|p>>>31,g=(g^=d)<<1|g>>>31;for(var y=0;y<f;y+=3){for(var w=s[y+1],m=s[y+2],b=s[y];b!=w;b+=m){var E=g^e[b],v=(g>>>4|g<<28)^e[b+1];d=p,p=g,g=d^(o[E>>>24&63]|A[E>>>16&63]|l[E>>>8&63]|h[63&E]|i[v>>>24&63]|a[v>>>16&63]|c[v>>>8&63]|u[63&v])}d=p,p=g,g=d}g=g>>>1|g<<31,g^=d=1431655765&((p=p>>>1|p<<31)>>>1^g),g^=(d=16711935&(g>>>8^(p^=d<<1)))<<8,g^=(d=858993459&(g>>>2^(p^=d)))<<2,g^=d=65535&((p^=d)>>>16^g),g^=d=252645135&((p^=d<<16)>>>4^g),p^=d<<4,r[0]=p,r[1]=g}function f(e){var t,r="DES-"+((e=e||{}).mode||"CBC").toUpperCase(),s=(t=e.decrypt?n.cipher.createDecipher(r,e.key):n.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var i=null;r instanceof n.util.ByteBuffer&&(i=r,r={}),(r=r||{}).output=i,r.iv=e,s.call(t,r)},t}},3832:function(e){e.exports={options:{usePureJavaScript:!1}}},36607:function(e,t,r){var n=r(3832);r(28991),r(97116),(e.exports=n.hmac=n.hmac||{}).create=function(){var e=null,t=null,r=null,s=null,i={start:function(i,o){if(null!==i)if("string"==typeof i){if(!((i=i.toLowerCase())in n.md.algorithms))throw new Error('Unknown hash algorithm "'+i+'"');t=n.md.algorithms[i].create()}else t=i;if(null===o)o=e;else{if("string"==typeof o)o=n.util.createBuffer(o);else if(n.util.isArray(o)){var a=o;o=n.util.createBuffer();for(var A=0;A<a.length;++A)o.putByte(a[A])}var c=o.length();c>t.blockLength&&(t.start(),t.update(o.bytes()),o=t.digest()),r=n.util.createBuffer(),s=n.util.createBuffer(),c=o.length();for(A=0;A<c;++A){a=o.at(A);r.putByte(54^a),s.putByte(92^a)}if(c<t.blockLength)for(a=t.blockLength-c,A=0;A<a;++A)r.putByte(54),s.putByte(92);e=o,r=r.bytes(),s=s.bytes()}t.start(),t.update(r)},update:function(e){t.update(e)},getMac:function(){var e=t.digest().bytes();return t.start(),t.update(s),t.update(e),t.digest()}};return i.digest=i.getMac,i}},15764:function(e,t,r){var n,s=r(3832);e.exports=s.jsbn=s.jsbn||{};function i(e,t,r){this.data=[],null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function o(){return new i(null)}function a(e,t,r,n,s,i){for(var o=16383&t,a=t>>14;--i>=0;){var A=16383&this.data[e],c=this.data[e++]>>14,l=a*A+c*o;s=((A=o*A+((16383&l)<<14)+r.data[n]+s)>>28)+(l>>14)+a*c,r.data[n++]=268435455&A}return s}s.jsbn.BigInteger=i,"undefined"==typeof navigator?(i.prototype.am=a,n=28):"Microsoft Internet Explorer"==navigator.appName?(i.prototype.am=function(e,t,r,n,s,i){for(var o=32767&t,a=t>>15;--i>=0;){var A=32767&this.data[e],c=this.data[e++]>>15,l=a*A+c*o;s=((A=o*A+((32767&l)<<15)+r.data[n]+(1073741823&s))>>>30)+(l>>>15)+a*c+(s>>>30),r.data[n++]=1073741823&A}return s},n=30):"Netscape"!=navigator.appName?(i.prototype.am=function(e,t,r,n,s,i){for(;--i>=0;){var o=t*this.data[e++]+r.data[n]+s;s=Math.floor(o/67108864),r.data[n++]=67108863&o}return s},n=26):(i.prototype.am=a,n=28),i.prototype.DB=n,i.prototype.DM=(1<<n)-1,i.prototype.DV=1<<n;i.prototype.FV=Math.pow(2,52),i.prototype.F1=52-n,i.prototype.F2=2*n-52;var A,c,l=new Array;for(A="0".charCodeAt(0),c=0;c<=9;++c)l[A++]=c;for(A="a".charCodeAt(0),c=10;c<36;++c)l[A++]=c;for(A="A".charCodeAt(0),c=10;c<36;++c)l[A++]=c;function u(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function h(e,t){var r=l[e.charCodeAt(t)];return null==r?-1:r}function d(e){var t=o();return t.fromInt(e),t}function f(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function p(e){this.m=e}function g(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function y(e,t){return e&t}function w(e,t){return e|t}function m(e,t){return e^t}function b(e,t){return e&~t}function E(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function v(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function B(){}function _(e){return e}function C(e){this.r2=o(),this.q3=o(),i.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}p.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},p.prototype.revert=function(e){return e},p.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},p.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},p.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},g.prototype.convert=function(e){var t=o();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(i.ZERO)>0&&this.m.subTo(t,t),t},g.prototype.revert=function(e){var t=o();return e.copyTo(t),this.reduce(t),t},g.prototype.reduce=function(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e.data[t],n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},g.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},g.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},i.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s},i.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0},i.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var n=e.length,s=!1,o=0;--n>=0;){var a=8==r?255&e[n]:h(e,n);a<0?"-"==e.charAt(n)&&(s=!0):(s=!1,0==o?this.data[this.t++]=a:o+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this.data[this.t++]=a>>this.DB-o):this.data[this.t-1]|=a<<o,(o+=r)>=this.DB&&(o-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,o>0&&(this.data[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),s&&i.ZERO.subTo(this,this)},i.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t},i.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s},i.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s},i.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,s=this.DB-n,i=(1<<s)-1,o=Math.floor(e/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t.data[r+o+1]=this.data[r]>>s|a,a=(this.data[r]&i)<<n;for(r=o-1;r>=0;--r)t.data[r]=0;t.data[o]=a,t.t=this.t+o+1,t.s=this.s,t.clamp()},i.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,s=this.DB-n,i=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)t.data[o-r-1]|=(this.data[o]&i)<<s,t.data[o-r]=this.data[o]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&i)<<s),t.t=this.t-r,t.clamp()}},i.prototype.subTo=function(e,t){for(var r=0,n=0,s=Math.min(e.t,this.t);r<s;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()},i.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),s=r.t;for(t.t=s+n.t;--s>=0;)t.data[s]=0;for(s=0;s<n.t;++s)t.data[s+r.t]=r.am(0,n.data[s],t,s,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&i.ZERO.subTo(t,t)},i.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()},i.prototype.divRemTo=function(e,t,r){var n=e.abs();if(!(n.t<=0)){var s=this.abs();if(s.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=o());var a=o(),A=this.s,c=e.s,l=this.DB-f(n.data[n.t-1]);l>0?(n.lShiftTo(l,a),s.lShiftTo(l,r)):(n.copyTo(a),s.copyTo(r));var u=a.t,h=a.data[u-1];if(0!=h){var d=h*(1<<this.F1)+(u>1?a.data[u-2]>>this.F2:0),p=this.FV/d,g=(1<<this.F1)/d,y=1<<this.F2,w=r.t,m=w-u,b=null==t?o():t;for(a.dlShiftTo(m,b),r.compareTo(b)>=0&&(r.data[r.t++]=1,r.subTo(b,r)),i.ONE.dlShiftTo(u,b),b.subTo(a,a);a.t<u;)a.data[a.t++]=0;for(;--m>=0;){var E=r.data[--w]==h?this.DM:Math.floor(r.data[w]*p+(r.data[w-1]+y)*g);if((r.data[w]+=a.am(0,E,r,m,0,u))<E)for(a.dlShiftTo(m,b),r.subTo(b,r);r.data[w]<--E;)r.subTo(b,r)}null!=t&&(r.drShiftTo(u,t),A!=c&&i.ZERO.subTo(t,t)),r.t=u,r.clamp(),l>0&&r.rShiftTo(l,r),A<0&&i.ZERO.subTo(r,r)}}},i.prototype.invDigit=function(){if(this.t<1)return 0;var e=this.data[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},i.prototype.isEven=function(){return 0==(this.t>0?1&this.data[0]:this.s)},i.prototype.exp=function(e,t){if(e>4294967295||e<1)return i.ONE;var r=o(),n=o(),s=t.convert(this),a=f(e)-1;for(s.copyTo(r);--a>=0;)if(t.sqrTo(r,n),(e&1<<a)>0)t.mulTo(n,s,r);else{var A=r;r=n,n=A}return t.revert(r)},i.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,s=!1,i="",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0)for(a<this.DB&&(r=this.data[o]>>a)>0&&(s=!0,i=u(r));o>=0;)a<t?(r=(this.data[o]&(1<<a)-1)<<t-a,r|=this.data[--o]>>(a+=this.DB-t)):(r=this.data[o]>>(a-=t)&n,a<=0&&(a+=this.DB,--o)),r>0&&(s=!0),s&&(i+=u(r));return s?i:"0"},i.prototype.negate=function(){var e=o();return i.ZERO.subTo(this,e),e},i.prototype.abs=function(){return this.s<0?this.negate():this},i.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this.data[r]-e.data[r]))return t;return 0},i.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+f(this.data[this.t-1]^this.s&this.DM)},i.prototype.mod=function(e){var t=o();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(i.ZERO)>0&&e.subTo(t,t),t},i.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new p(t):new g(t),this.exp(e,r)},i.ZERO=d(0),i.ONE=d(1),B.prototype.convert=_,B.prototype.revert=_,B.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},B.prototype.sqrTo=function(e,t){e.squareTo(t)},C.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=o();return e.copyTo(t),this.reduce(t),t},C.prototype.revert=function(e){return e},C.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},C.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},C.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var S=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],I=(1<<26)/S[S.length-1];i.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},i.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=d(r),s=o(),i=o(),a="";for(this.divRemTo(n,s,i);s.signum()>0;)a=(r+i.intValue()).toString(e).substr(1)+a,s.divRemTo(n,s,i);return i.intValue().toString(e)+a},i.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),s=!1,o=0,a=0,A=0;A<e.length;++A){var c=h(e,A);c<0?"-"==e.charAt(A)&&0==this.signum()&&(s=!0):(a=t*a+c,++o>=r&&(this.dMultiply(n),this.dAddOffset(a,0),o=0,a=0))}o>0&&(this.dMultiply(Math.pow(t,o)),this.dAddOffset(a,0)),s&&i.ZERO.subTo(this,this)},i.prototype.fromNumber=function(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(i.ONE.shiftLeft(e-1),w,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(i.ONE.shiftLeft(e-1),this);else{var n=new Array,s=7&e;n.length=1+(e>>3),t.nextBytes(n),s>0?n[0]&=(1<<s)-1:n[0]=0,this.fromString(n,256)}},i.prototype.bitwiseTo=function(e,t,r){var n,s,i=Math.min(e.t,this.t);for(n=0;n<i;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(s=e.s&this.DM,n=i;n<this.t;++n)r.data[n]=t(this.data[n],s);r.t=this.t}else{for(s=this.s&this.DM,n=i;n<e.t;++n)r.data[n]=t(s,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},i.prototype.changeBit=function(e,t){var r=i.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},i.prototype.addTo=function(e,t){for(var r=0,n=0,s=Math.min(e.t,this.t);r<s;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()},i.prototype.dMultiply=function(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},i.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}},i.prototype.multiplyLowerTo=function(e,t,r){var n,s=Math.min(this.t+e.t,t);for(r.s=0,r.t=s;s>0;)r.data[--s]=0;for(n=r.t-this.t;s<n;++s)r.data[s+this.t]=this.am(0,e.data[s],r,s,0,this.t);for(n=Math.min(e.t,t);s<n;++s)this.am(0,e.data[s],r,s,0,t-s);r.clamp()},i.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},i.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r},i.prototype.millerRabin=function(e){var t=this.subtract(i.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n,s=t.shiftRight(r),o={nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(256*Math.random())}},a=0;a<e;++a){do{n=new i(this.bitLength(),o)}while(n.compareTo(i.ONE)<=0||n.compareTo(t)>=0);var A=n.modPow(s,this);if(0!=A.compareTo(i.ONE)&&0!=A.compareTo(t)){for(var c=1;c++<r&&0!=A.compareTo(t);)if(0==(A=A.modPowInt(2,this)).compareTo(i.ONE))return!1;if(0!=A.compareTo(t))return!1}}return!0},i.prototype.clone=function(){var e=o();return this.copyTo(e),e},i.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]},i.prototype.byteValue=function(){return 0==this.t?this.s:this.data[0]<<24>>24},i.prototype.shortValue=function(){return 0==this.t?this.s:this.data[0]<<16>>16},i.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1},i.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,s=0;if(e-- >0)for(n<this.DB&&(r=this.data[e]>>n)!=(this.s&this.DM)>>n&&(t[s++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this.data[e]&(1<<n)-1)<<8-n,r|=this.data[--e]>>(n+=this.DB-8)):(r=this.data[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==s&&(128&this.s)!=(128&r)&&++s,(s>0||r!=this.s)&&(t[s++]=r);return t},i.prototype.equals=function(e){return 0==this.compareTo(e)},i.prototype.min=function(e){return this.compareTo(e)<0?this:e},i.prototype.max=function(e){return this.compareTo(e)>0?this:e},i.prototype.and=function(e){var t=o();return this.bitwiseTo(e,y,t),t},i.prototype.or=function(e){var t=o();return this.bitwiseTo(e,w,t),t},i.prototype.xor=function(e){var t=o();return this.bitwiseTo(e,m,t),t},i.prototype.andNot=function(e){var t=o();return this.bitwiseTo(e,b,t),t},i.prototype.not=function(){for(var e=o(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e},i.prototype.shiftLeft=function(e){var t=o();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},i.prototype.shiftRight=function(e){var t=o();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},i.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this.data[e])return e*this.DB+E(this.data[e]);return this.s<0?this.t*this.DB:-1},i.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=v(this.data[r]^t);return e},i.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this.data[t]&1<<e%this.DB)},i.prototype.setBit=function(e){return this.changeBit(e,w)},i.prototype.clearBit=function(e){return this.changeBit(e,b)},i.prototype.flipBit=function(e){return this.changeBit(e,m)},i.prototype.add=function(e){var t=o();return this.addTo(e,t),t},i.prototype.subtract=function(e){var t=o();return this.subTo(e,t),t},i.prototype.multiply=function(e){var t=o();return this.multiplyTo(e,t),t},i.prototype.divide=function(e){var t=o();return this.divRemTo(e,t,null),t},i.prototype.remainder=function(e){var t=o();return this.divRemTo(e,null,t),t},i.prototype.divideAndRemainder=function(e){var t=o(),r=o();return this.divRemTo(e,t,r),new Array(t,r)},i.prototype.modPow=function(e,t){var r,n,s=e.bitLength(),i=d(1);if(s<=0)return i;r=s<18?1:s<48?3:s<144?4:s<768?5:6,n=s<8?new p(t):t.isEven()?new C(t):new g(t);var a=new Array,A=3,c=r-1,l=(1<<r)-1;if(a[1]=n.convert(this),r>1){var u=o();for(n.sqrTo(a[1],u);A<=l;)a[A]=o(),n.mulTo(u,a[A-2],a[A]),A+=2}var h,y,w=e.t-1,m=!0,b=o();for(s=f(e.data[w])-1;w>=0;){for(s>=c?h=e.data[w]>>s-c&l:(h=(e.data[w]&(1<<s+1)-1)<<c-s,w>0&&(h|=e.data[w-1]>>this.DB+s-c)),A=r;0==(1&h);)h>>=1,--A;if((s-=A)<0&&(s+=this.DB,--w),m)a[h].copyTo(i),m=!1;else{for(;A>1;)n.sqrTo(i,b),n.sqrTo(b,i),A-=2;A>0?n.sqrTo(i,b):(y=i,i=b,b=y),n.mulTo(b,a[h],i)}for(;w>=0&&0==(e.data[w]&1<<s);)n.sqrTo(i,b),y=i,i=b,b=y,--s<0&&(s=this.DB-1,--w)}return n.revert(i)},i.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return i.ZERO;for(var r=e.clone(),n=this.clone(),s=d(1),o=d(0),a=d(0),A=d(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(s.isEven()&&o.isEven()||(s.addTo(this,s),o.subTo(e,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),t?(a.isEven()&&A.isEven()||(a.addTo(this,a),A.subTo(e,A)),a.rShiftTo(1,a)):A.isEven()||A.subTo(e,A),A.rShiftTo(1,A);r.compareTo(n)>=0?(r.subTo(n,r),t&&s.subTo(a,s),o.subTo(A,o)):(n.subTo(r,n),t&&a.subTo(s,a),A.subTo(o,A))}return 0!=n.compareTo(i.ONE)?i.ZERO:A.compareTo(e)>=0?A.subtract(e):A.signum()<0?(A.addTo(e,A),A.signum()<0?A.add(e):A):A},i.prototype.pow=function(e){return this.exp(e,new B)},i.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var s=t.getLowestSetBit(),i=r.getLowestSetBit();if(i<0)return t;for(s<i&&(i=s),i>0&&(t.rShiftTo(i,t),r.rShiftTo(i,r));t.signum()>0;)(s=t.getLowestSetBit())>0&&t.rShiftTo(s,t),(s=r.getLowestSetBit())>0&&r.rShiftTo(s,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return i>0&&r.lShiftTo(i,r),r},i.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r.data[0]<=S[S.length-1]){for(t=0;t<S.length;++t)if(r.data[0]==S[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<S.length;){for(var n=S[t],s=t+1;s<S.length&&n<I;)n*=S[s++];for(n=r.modInt(n);t<s;)if(n%S[t++]==0)return!1}return r.millerRabin(e)}},28991:function(e,t,r){var n=r(3832);e.exports=n.md=n.md||{},n.md.algorithms=n.md.algorithms||{}},86971:function(e,t,r){var n=r(3832);r(83453),e.exports=n.mgf=n.mgf||{},n.mgf.mgf1=n.mgf1},83453:function(e,t,r){var n=r(3832);r(97116),n.mgf=n.mgf||{},(e.exports=n.mgf.mgf1=n.mgf1=n.mgf1||{}).create=function(e){return{generate:function(t,r){for(var s=new n.util.ByteBuffer,i=Math.ceil(r/e.digestLength),o=0;o<i;o++){var a=new n.util.ByteBuffer;a.putInt32(o),e.start(),e.update(t+a.getBytes()),s.putBuffer(e.digest())}return s.truncate(s.length()-r),s.getBytes()}}}},66270:function(e,t,r){var n=r(3832);n.pki=n.pki||{};var s=e.exports=n.pki.oids=n.oids=n.oids||{};function i(e,t){s[e]=t,s[t]=e}function o(e,t){s[e]=t}i("1.2.840.113549.1.1.1","rsaEncryption"),i("1.2.840.113549.1.1.4","md5WithRSAEncryption"),i("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),i("1.2.840.113549.1.1.7","RSAES-OAEP"),i("1.2.840.113549.1.1.8","mgf1"),i("1.2.840.113549.1.1.9","pSpecified"),i("1.2.840.113549.1.1.10","RSASSA-PSS"),i("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),i("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),i("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),i("1.3.101.112","EdDSA25519"),i("1.2.840.10040.4.3","dsa-with-sha1"),i("1.3.14.3.2.7","desCBC"),i("1.3.14.3.2.26","sha1"),i("1.3.14.3.2.29","sha1WithRSASignature"),i("2.16.840.1.101.3.4.2.1","sha256"),i("2.16.840.1.101.3.4.2.2","sha384"),i("2.16.840.1.101.3.4.2.3","sha512"),i("2.16.840.1.101.3.4.2.4","sha224"),i("2.16.840.1.101.3.4.2.5","sha512-224"),i("2.16.840.1.101.3.4.2.6","sha512-256"),i("1.2.840.113549.2.2","md2"),i("1.2.840.113549.2.5","md5"),i("1.2.840.113549.1.7.1","data"),i("1.2.840.113549.1.7.2","signedData"),i("1.2.840.113549.1.7.3","envelopedData"),i("1.2.840.113549.1.7.4","signedAndEnvelopedData"),i("1.2.840.113549.1.7.5","digestedData"),i("1.2.840.113549.1.7.6","encryptedData"),i("1.2.840.113549.1.9.1","emailAddress"),i("1.2.840.113549.1.9.2","unstructuredName"),i("1.2.840.113549.1.9.3","contentType"),i("1.2.840.113549.1.9.4","messageDigest"),i("1.2.840.113549.1.9.5","signingTime"),i("1.2.840.113549.1.9.6","counterSignature"),i("1.2.840.113549.1.9.7","challengePassword"),i("1.2.840.113549.1.9.8","unstructuredAddress"),i("1.2.840.113549.1.9.14","extensionRequest"),i("1.2.840.113549.1.9.20","friendlyName"),i("1.2.840.113549.1.9.21","localKeyId"),i("1.2.840.113549.1.9.22.1","x509Certificate"),i("1.2.840.113549.1.12.10.1.1","keyBag"),i("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),i("1.2.840.113549.1.12.10.1.3","certBag"),i("1.2.840.113549.1.12.10.1.4","crlBag"),i("1.2.840.113549.1.12.10.1.5","secretBag"),i("1.2.840.113549.1.12.10.1.6","safeContentsBag"),i("1.2.840.113549.1.5.13","pkcs5PBES2"),i("1.2.840.113549.1.5.12","pkcs5PBKDF2"),i("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),i("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),i("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),i("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),i("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),i("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),i("1.2.840.113549.2.7","hmacWithSHA1"),i("1.2.840.113549.2.8","hmacWithSHA224"),i("1.2.840.113549.2.9","hmacWithSHA256"),i("1.2.840.113549.2.10","hmacWithSHA384"),i("1.2.840.113549.2.11","hmacWithSHA512"),i("1.2.840.113549.3.7","des-EDE3-CBC"),i("2.16.840.1.101.3.4.1.2","aes128-CBC"),i("2.16.840.1.101.3.4.1.22","aes192-CBC"),i("2.16.840.1.101.3.4.1.42","aes256-CBC"),i("2.5.4.3","commonName"),i("2.5.4.4","surname"),i("2.5.4.5","serialNumber"),i("2.5.4.6","countryName"),i("2.5.4.7","localityName"),i("2.5.4.8","stateOrProvinceName"),i("2.5.4.9","streetAddress"),i("2.5.4.10","organizationName"),i("2.5.4.11","organizationalUnitName"),i("2.5.4.12","title"),i("2.5.4.13","description"),i("2.5.4.15","businessCategory"),i("2.5.4.17","postalCode"),i("2.5.4.42","givenName"),i("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),i("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),i("2.16.840.1.113730.1.1","nsCertType"),i("2.16.840.1.113730.1.13","nsComment"),o("2.5.29.1","authorityKeyIdentifier"),o("2.5.29.2","keyAttributes"),o("2.5.29.3","certificatePolicies"),o("2.5.29.4","keyUsageRestriction"),o("2.5.29.5","policyMapping"),o("2.5.29.6","subtreesConstraint"),o("2.5.29.7","subjectAltName"),o("2.5.29.8","issuerAltName"),o("2.5.29.9","subjectDirectoryAttributes"),o("2.5.29.10","basicConstraints"),o("2.5.29.11","nameConstraints"),o("2.5.29.12","policyConstraints"),o("2.5.29.13","basicConstraints"),i("2.5.29.14","subjectKeyIdentifier"),i("2.5.29.15","keyUsage"),o("2.5.29.16","privateKeyUsagePeriod"),i("2.5.29.17","subjectAltName"),i("2.5.29.18","issuerAltName"),i("2.5.29.19","basicConstraints"),o("2.5.29.20","cRLNumber"),o("2.5.29.21","cRLReason"),o("2.5.29.22","expirationDate"),o("2.5.29.23","instructionCode"),o("2.5.29.24","invalidityDate"),o("2.5.29.25","cRLDistributionPoints"),o("2.5.29.26","issuingDistributionPoint"),o("2.5.29.27","deltaCRLIndicator"),o("2.5.29.28","issuingDistributionPoint"),o("2.5.29.29","certificateIssuer"),o("2.5.29.30","nameConstraints"),i("2.5.29.31","cRLDistributionPoints"),i("2.5.29.32","certificatePolicies"),o("2.5.29.33","policyMappings"),o("2.5.29.34","policyConstraints"),i("2.5.29.35","authorityKeyIdentifier"),o("2.5.29.36","policyConstraints"),i("2.5.29.37","extKeyUsage"),o("2.5.29.46","freshestCRL"),o("2.5.29.54","inhibitAnyPolicy"),i("1.3.6.1.4.1.11129.2.4.2","timestampList"),i("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),i("1.3.6.1.5.5.7.3.1","serverAuth"),i("1.3.6.1.5.5.7.3.2","clientAuth"),i("1.3.6.1.5.5.7.3.3","codeSigning"),i("1.3.6.1.5.5.7.3.4","emailProtection"),i("1.3.6.1.5.5.7.3.8","timeStamping")},97450:function(e,t,r){var n=r(3832);if(r(8925),r(3068),r(33480),r(28991),r(66270),r(98960),r(26953),r(49563),r(69372),r(28095),r(97116),void 0===s)var s=n.jsbn.BigInteger;var i=n.asn1,o=n.pki=n.pki||{};e.exports=o.pbe=n.pbe=n.pbe||{};var a=o.oids,A={name:"EncryptedPrivateKeyInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},c={name:"PBES2Algorithms",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},l={name:"pkcs-12PbeParams",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"iterations"}]};function u(e,t){return e.start().update(t).digest().getBytes()}function h(e){var t;if(e){if(!(t=o.oids[i.derToOid(e)])){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}}else t="hmacWithSHA1";return d(t)}function d(e){var t=n.md;switch(e){case"hmacWithSHA224":t=n.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}o.encryptPrivateKeyInfo=function(e,t,r){(r=r||{}).saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var s,A,c,l=n.random.getBytesSync(r.saltSize),u=r.count,h=i.integerToDer(u);if(0===r.algorithm.indexOf("aes")||"des"===r.algorithm){var f,p,g;switch(r.algorithm){case"aes128":s=16,f=16,p=a["aes128-CBC"],g=n.aes.createEncryptionCipher;break;case"aes192":s=24,f=16,p=a["aes192-CBC"],g=n.aes.createEncryptionCipher;break;case"aes256":s=32,f=16,p=a["aes256-CBC"],g=n.aes.createEncryptionCipher;break;case"des":s=8,f=8,p=a.desCBC,g=n.des.createEncryptionCipher;break;default:throw(v=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,v}var y="hmacWith"+r.prfAlgorithm.toUpperCase(),w=d(y),m=n.pkcs5.pbkdf2(t,l,u,s,w),b=n.random.getBytesSync(f);(B=g(m)).start(b),B.update(i.toDer(e)),B.finish(),c=B.output.getBytes();var E=function(e,t,r,s){var a=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,t.getBytes())]);"hmacWithSHA1"!==s&&a.value.push(i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(r.toString(16))),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids[s]).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]));return a}(l,h,s,y);A=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a.pkcs5PBES2).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a.pkcs5PBKDF2).getBytes()),E]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(p).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,b)])])])}else{var v;if("3des"!==r.algorithm)throw(v=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,v;s=24;var B,_=new n.util.ByteBuffer(l);m=o.pbe.generatePkcs12Key(t,_,1,u,s),b=o.pbe.generatePkcs12Key(t,_,2,u,s);(B=n.des.createEncryptionCipher(m)).start(b),B.update(i.toDer(e)),B.finish(),c=B.output.getBytes(),A=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,l),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,h.getBytes())])])}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[A,i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,c)])},o.decryptPrivateKeyInfo=function(e,t){var r=null,s={},a=[];if(!i.validate(e,A,s,a)){var c=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw c.errors=a,c}var l=i.derToOid(s.encryptionOid),u=o.pbe.getCipher(l,s.encryptionParams,t),h=n.util.createBuffer(s.encryptedData);return u.update(h),u.finish()&&(r=i.fromDer(u.output)),r},o.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:i.toDer(e).getBytes()};return n.pem.encode(r,{maxline:t})},o.encryptedPrivateKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==t.type){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return i.fromDer(t.body)},o.encryptRsaPrivateKey=function(e,t,r){if(!(r=r||{}).legacy){var s=o.wrapRsaPrivateKey(o.privateKeyToAsn1(e));return s=o.encryptPrivateKeyInfo(s,t,r),o.encryptedPrivateKeyToPem(s)}var a,A,c,l;switch(r.algorithm){case"aes128":a="AES-128-CBC",c=16,A=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"aes192":a="AES-192-CBC",c=24,A=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"aes256":a="AES-256-CBC",c=32,A=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"3des":a="DES-EDE3-CBC",c=24,A=n.random.getBytesSync(8),l=n.des.createEncryptionCipher;break;case"des":a="DES-CBC",c=8,A=n.random.getBytesSync(8),l=n.des.createEncryptionCipher;break;default:var u=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw u.algorithm=r.algorithm,u}var h=l(n.pbe.opensslDeriveBytes(t,A.substr(0,8),c));h.start(A),h.update(i.toDer(o.privateKeyToAsn1(e))),h.finish();var d={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:a,parameters:n.util.bytesToHex(A).toUpperCase()},body:h.output.getBytes()};return n.pem.encode(d)},o.decryptRsaPrivateKey=function(e,t){var r=null,s=n.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==s.type&&"PRIVATE KEY"!==s.type&&"RSA PRIVATE KEY"!==s.type)throw(c=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".')).headerType=c,c;if(s.procType&&"ENCRYPTED"===s.procType.type){var a,A;switch(s.dekInfo.algorithm){case"DES-CBC":a=8,A=n.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,A=n.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,A=n.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,A=n.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,A=n.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,A=function(e){return n.rc2.createDecryptionCipher(e,40)};break;case"RC2-64-CBC":a=8,A=function(e){return n.rc2.createDecryptionCipher(e,64)};break;case"RC2-128-CBC":a=16,A=function(e){return n.rc2.createDecryptionCipher(e,128)};break;default:var c;throw(c=new Error('Could not decrypt private key; unsupported encryption algorithm "'+s.dekInfo.algorithm+'".')).algorithm=s.dekInfo.algorithm,c}var l=n.util.hexToBytes(s.dekInfo.parameters),u=A(n.pbe.opensslDeriveBytes(t,l.substr(0,8),a));if(u.start(l),u.update(n.util.createBuffer(s.body)),!u.finish())return r;r=u.output.getBytes()}else r=s.body;return null!==(r="ENCRYPTED PRIVATE KEY"===s.type?o.decryptPrivateKeyInfo(i.fromDer(r),t):i.fromDer(r))&&(r=o.privateKeyFromAsn1(r)),r},o.pbe.generatePkcs12Key=function(e,t,r,s,i,o){var a,A;if(null==o){if(!("sha1"in n.md))throw new Error('"sha1" hash algorithm unavailable.');o=n.md.sha1.create()}var c=o.digestLength,l=o.blockLength,u=new n.util.ByteBuffer,h=new n.util.ByteBuffer;if(null!=e){for(A=0;A<e.length;A++)h.putInt16(e.charCodeAt(A));h.putInt16(0)}var d=h.length(),f=t.length(),p=new n.util.ByteBuffer;p.fillWithByte(r,l);var g=l*Math.ceil(f/l),y=new n.util.ByteBuffer;for(A=0;A<g;A++)y.putByte(t.at(A%f));var w=l*Math.ceil(d/l),m=new n.util.ByteBuffer;for(A=0;A<w;A++)m.putByte(h.at(A%d));var b=y;b.putBuffer(m);for(var E=Math.ceil(i/c),v=1;v<=E;v++){var B=new n.util.ByteBuffer;B.putBytes(p.bytes()),B.putBytes(b.bytes());for(var _=0;_<s;_++)o.start(),o.update(B.getBytes()),B=o.digest();var C=new n.util.ByteBuffer;for(A=0;A<l;A++)C.putByte(B.at(A%c));var S=Math.ceil(f/l)+Math.ceil(d/l),I=new n.util.ByteBuffer;for(a=0;a<S;a++){var T=new n.util.ByteBuffer(b.getBytes(l)),R=511;for(A=C.length()-1;A>=0;A--)R>>=8,R+=C.at(A)+T.at(A),T.setAt(A,255&R);I.putBuffer(T)}b=I,u.putBuffer(B)}return u.truncate(u.length()-i),u},o.pbe.getCipher=function(e,t,r){switch(e){case o.oids.pkcs5PBES2:return o.pbe.getCipherForPBES2(e,t,r);case o.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case o.oids["pbewithSHAAnd40BitRC2-CBC"]:return o.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}},o.pbe.getCipherForPBES2=function(e,t,r){var s,a={},A=[];if(!i.validate(t,c,a,A))throw(s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=A,s;if((e=i.derToOid(a.kdfOid))!==o.oids.pkcs5PBKDF2)throw(s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.")).oid=e,s.supportedOids=["pkcs5PBKDF2"],s;if((e=i.derToOid(a.encOid))!==o.oids["aes128-CBC"]&&e!==o.oids["aes192-CBC"]&&e!==o.oids["aes256-CBC"]&&e!==o.oids["des-EDE3-CBC"]&&e!==o.oids.desCBC)throw(s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.")).oid=e,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s;var l,u,d=a.kdfSalt,f=n.util.createBuffer(a.kdfIterationCount);switch(f=f.getInt(f.length()<<3),o.oids[e]){case"aes128-CBC":l=16,u=n.aes.createDecryptionCipher;break;case"aes192-CBC":l=24,u=n.aes.createDecryptionCipher;break;case"aes256-CBC":l=32,u=n.aes.createDecryptionCipher;break;case"des-EDE3-CBC":l=24,u=n.des.createDecryptionCipher;break;case"desCBC":l=8,u=n.des.createDecryptionCipher}var p=h(a.prfOid),g=n.pkcs5.pbkdf2(r,d,f,l,p),y=a.encIv,w=u(g);return w.start(y),w},o.pbe.getCipherForPKCS12PBE=function(e,t,r){var s={},a=[];if(!i.validate(t,l,s,a))throw(p=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=a,p;var A,c,u,d=n.util.createBuffer(s.salt),f=n.util.createBuffer(s.iterations);switch(f=f.getInt(f.length()<<3),e){case o.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:A=24,c=8,u=n.des.startDecrypting;break;case o.oids["pbewithSHAAnd40BitRC2-CBC"]:A=5,c=8,u=function(e,t){var r=n.rc2.createDecryptionCipher(e,40);return r.start(t,null),r};break;default:var p;throw(p=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.")).oid=e,p}var g=h(s.prfOid),y=o.pbe.generatePkcs12Key(r,d,1,f,A,g);return g.start(),u(y,o.pbe.generatePkcs12Key(r,d,2,f,c,g))},o.pbe.opensslDeriveBytes=function(e,t,r,s){if(null==s){if(!("md5"in n.md))throw new Error('"md5" hash algorithm unavailable.');s=n.md.md5.create()}null===t&&(t="");for(var i=[u(s,e+t)],o=16,a=1;o<r;++a,o+=16)i.push(u(s,i[a-1]+e+t));return i.join("").substr(0,r)}},98960:function(e,t,r){var n=r(62678).Buffer,s=r(3832);r(36607),r(28991),r(97116);var i,o=s.pkcs5=s.pkcs5||{};s.util.isNodejs&&!s.options.usePureJavaScript&&(i=r(25819)),e.exports=s.pbkdf2=o.pbkdf2=function(e,t,r,o,a,A){if("function"==typeof a&&(A=a,a=null),s.util.isNodejs&&!s.options.usePureJavaScript&&i.pbkdf2&&(null===a||"object"!=typeof a)&&(i.pbkdf2Sync.length>4||!a||"sha1"===a))return"string"!=typeof a&&(a="sha1"),e=n.from(e,"binary"),t=n.from(t,"binary"),A?4===i.pbkdf2Sync.length?i.pbkdf2(e,t,r,o,(function(e,t){if(e)return A(e);A(null,t.toString("binary"))})):i.pbkdf2(e,t,r,o,a,(function(e,t){if(e)return A(e);A(null,t.toString("binary"))})):4===i.pbkdf2Sync.length?i.pbkdf2Sync(e,t,r,o).toString("binary"):i.pbkdf2Sync(e,t,r,o,a).toString("binary");if(null==a&&(a="sha1"),"string"==typeof a){if(!(a in s.md.algorithms))throw new Error("Unknown hash algorithm: "+a);a=s.md[a].create()}var c=a.digestLength;if(o>4294967295*c){var l=new Error("Derived key is too long.");if(A)return A(l);throw l}var u=Math.ceil(o/c),h=o-(u-1)*c,d=s.hmac.create();d.start(a,e);var f,p,g,y="";if(!A){for(var w=1;w<=u;++w){d.start(null,null),d.update(t),d.update(s.util.int32ToBytes(w)),f=g=d.digest().getBytes();for(var m=2;m<=r;++m)d.start(null,null),d.update(g),p=d.digest().getBytes(),f=s.util.xorBytes(f,p,c),g=p;y+=w<u?f:f.substr(0,h)}return y}w=1;function b(){if(w>u)return A(null,y);d.start(null,null),d.update(t),d.update(s.util.int32ToBytes(w)),f=g=d.digest().getBytes(),m=2,E()}function E(){if(m<=r)return d.start(null,null),d.update(g),p=d.digest().getBytes(),f=s.util.xorBytes(f,p,c),g=p,++m,s.util.setImmediate(E);y+=w<u?f:f.substr(0,h),++w,b()}b()}},26953:function(e,t,r){var n=r(3832);r(97116);var s=e.exports=n.pem=n.pem||{};function i(e){for(var t=e.name+": ",r=[],n=function(e,t){return" "+t},s=0;s<e.values.length;++s)r.push(e.values[s].replace(/^(\S+\r\n)/,n));t+=r.join(",")+"\r\n";var i=0,o=-1;for(s=0;s<t.length;++s,++i)if(i>65&&-1!==o){var a=t[o];","===a?(++o,t=t.substr(0,o)+"\r\n "+t.substr(o)):t=t.substr(0,o)+"\r\n"+a+t.substr(o+1),i=s-o-1,o=-1,++s}else" "!==t[s]&&"\t"!==t[s]&&","!==t[s]||(o=s);return t}function o(e){return e.replace(/^\s+/,"")}s.encode=function(e,t){t=t||{};var r,s="-----BEGIN "+e.type+"-----\r\n";if(e.procType&&(s+=i(r={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]})),e.contentDomain&&(s+=i(r={name:"Content-Domain",values:[e.contentDomain]})),e.dekInfo&&(r={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&r.values.push(e.dekInfo.parameters),s+=i(r)),e.headers)for(var o=0;o<e.headers.length;++o)s+=i(e.headers[o]);return e.procType&&(s+="\r\n"),s+=n.util.encode64(e.body,t.maxline||64)+"\r\n",s+="-----END "+e.type+"-----\r\n"},s.decode=function(e){for(var t,r=[],s=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,i=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,a=/\r?\n/;t=s.exec(e);){var A=t[1];"NEW CERTIFICATE REQUEST"===A&&(A="CERTIFICATE REQUEST");var c={type:A,procType:null,contentDomain:null,dekInfo:null,headers:[],body:n.util.decode64(t[3])};if(r.push(c),t[2]){for(var l=t[2].split(a),u=0;t&&u<l.length;){for(var h=l[u].replace(/\s+$/,""),d=u+1;d<l.length;++d){var f=l[d];if(!/\s/.test(f[0]))break;h+=f,u=d}if(t=h.match(i)){for(var p={name:t[1],values:[]},g=t[2].split(","),y=0;y<g.length;++y)p.values.push(o(g[y]));if(c.procType)if(c.contentDomain||"Content-Domain"!==p.name)if(c.dekInfo||"DEK-Info"!==p.name)c.headers.push(p);else{if(0===p.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');c.dekInfo={algorithm:g[0],parameters:g[1]||null}}else c.contentDomain=g[0]||"";else{if("Proc-Type"!==p.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==p.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');c.procType={version:g[0],type:g[1]}}}++u}if("ENCRYPTED"===c.procType&&!c.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===r.length)throw new Error("Invalid PEM formatted message.");return r}},18936:function(e,t,r){var n=r(3832);r(97116),r(49563),r(137);var s=e.exports=n.pkcs1=n.pkcs1||{};function i(e,t,r){r||(r=n.md.sha1.create());for(var s="",i=Math.ceil(t/r.digestLength),o=0;o<i;++o){var a=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,255&o);r.start(),r.update(e+a),s+=r.digest().getBytes()}return s.substring(0,t)}s.encode_rsa_oaep=function(e,t,r){var s,o,a,A;"string"==typeof r?(s=r,o=arguments[3]||void 0,a=arguments[4]||void 0):r&&(s=r.label||void 0,o=r.seed||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(A=r.mgf1.md)),a?a.start():a=n.md.sha1.create(),A||(A=a);var c=Math.ceil(e.n.bitLength()/8),l=c-2*a.digestLength-2;if(t.length>l)throw(g=new Error("RSAES-OAEP input message length is too long.")).length=t.length,g.maxLength=l,g;s||(s=""),a.update(s,"raw");for(var u=a.digest(),h="",d=l-t.length,f=0;f<d;f++)h+="\0";var p=u.getBytes()+h+""+t;if(o){if(o.length!==a.digestLength){var g;throw(g=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.")).seedLength=o.length,g.digestLength=a.digestLength,g}}else o=n.random.getBytes(a.digestLength);var y=i(o,c-a.digestLength-1,A),w=n.util.xorBytes(p,y,p.length),m=i(w,a.digestLength,A),b=n.util.xorBytes(o,m,o.length);return"\0"+b+w},s.decode_rsa_oaep=function(e,t,r){var s,o,a;"string"==typeof r?(s=r,o=arguments[3]||void 0):r&&(s=r.label||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md));var A=Math.ceil(e.n.bitLength()/8);if(t.length!==A)throw(w=new Error("RSAES-OAEP encoded message length is invalid.")).length=t.length,w.expectedLength=A,w;if(void 0===o?o=n.md.sha1.create():o.start(),a||(a=o),A<2*o.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");s||(s=""),o.update(s,"raw");for(var c=o.digest().getBytes(),l=t.charAt(0),u=t.substring(1,o.digestLength+1),h=t.substring(1+o.digestLength),d=i(h,o.digestLength,a),f=n.util.xorBytes(u,d,u.length),p=i(f,A-o.digestLength-1,a),g=n.util.xorBytes(h,p,h.length),y=g.substring(0,o.digestLength),w="\0"!==l,m=0;m<o.digestLength;++m)w|=c.charAt(m)!==y.charAt(m);for(var b=1,E=o.digestLength,v=o.digestLength;v<g.length;v++){var B=g.charCodeAt(v),_=1&B^1,C=b?65534:0;w|=B&C,E+=b&=_}if(w||1!==g.charCodeAt(E))throw new Error("Invalid RSAES-OAEP padding.");return g.substring(E+1)}},79437:function(e,t,r){var n=r(3832);r(8925),r(3068),r(33480),r(66270),r(26953),r(95496),r(49563),r(97116),r(25414);var s=n.asn1,i=e.exports=n.pkcs7=n.pkcs7||{};function o(e){var t={},r=[];if(!s.validate(e,i.asn1.recipientInfoValidator,t,r)){var o=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw o.errors=r,o}return{version:t.version.charCodeAt(0),issuer:n.pki.RDNAttributesAsArray(t.issuer),serialNumber:n.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:s.derToOid(t.encAlgorithm),parameter:t.encParameter?t.encParameter.value:void 0,content:t.encKey}}}function a(e){for(var t,r=[],i=0;i<e.length;++i)r.push((t=e[i],s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(t.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:t.issuer}),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,n.util.hexToBytes(t.serialNumber))]),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.encryptedContent.algorithm).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,t.encryptedContent.content)])));return r}function A(e){var t=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:e.issuer}),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,n.util.hexToBytes(e.serialNumber))]),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.digestAlgorithm).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.signatureAlgorithm).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")])),t.value.push(s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var r=s.create(s.Class.CONTEXT_SPECIFIC,1,!0,[]),i=0;i<e.unauthenticatedAttributes.length;++i){var o=e.unauthenticatedAttributes[i];r.values.push(c(o))}t.value.push(r)}return t}function c(e){var t;if(e.type===n.pki.oids.contentType)t=s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.value).getBytes());else if(e.type===n.pki.oids.messageDigest)t=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===n.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),i=new Date("2050-01-01T00:00:00Z"),o=e.value;if("string"==typeof o){var a=Date.parse(o);o=isNaN(a)?13===o.length?s.utcTimeToDate(o):s.generalizedTimeToDate(o):new Date(a)}t=o>=r&&o<i?s.create(s.Class.UNIVERSAL,s.Type.UTCTIME,!1,s.dateToUtcTime(o)):s.create(s.Class.UNIVERSAL,s.Type.GENERALIZEDTIME,!1,s.dateToGeneralizedTime(o))}return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.type).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SET,!0,[t])])}function l(e,t,r){var i={};if(!s.validate(t,r,i,[])){var o=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw o.errors=o,o}if(s.derToOid(i.contentType)!==n.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(i.encryptedContent){var a="";if(n.util.isArray(i.encryptedContent))for(var A=0;A<i.encryptedContent.length;++A){if(i.encryptedContent[A].type!==s.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=i.encryptedContent[A].value}else a=i.encryptedContent;e.encryptedContent={algorithm:s.derToOid(i.encAlgorithm),parameter:n.util.createBuffer(i.encParameter.value),content:n.util.createBuffer(a)}}if(i.content){a="";if(n.util.isArray(i.content))for(A=0;A<i.content.length;++A){if(i.content[A].type!==s.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=i.content[A].value}else a=i.content;e.content=n.util.createBuffer(a)}return e.version=i.version.charCodeAt(0),e.rawCapture=i,i}function u(e){if(void 0===e.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===e.content){var t;switch(e.encryptedContent.algorithm){case n.pki.oids["aes128-CBC"]:case n.pki.oids["aes192-CBC"]:case n.pki.oids["aes256-CBC"]:t=n.aes.createDecryptionCipher(e.encryptedContent.key);break;case n.pki.oids.desCBC:case n.pki.oids["des-EDE3-CBC"]:t=n.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}i.messageFromPem=function(e){var t=n.pem.decode(e)[0];if("PKCS7"!==t.type){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var o=s.fromDer(t.body);return i.messageFromAsn1(o)},i.messageToPem=function(e,t){var r={type:"PKCS7",body:s.toDer(e.toAsn1()).getBytes()};return n.pem.encode(r,{maxline:t})},i.messageFromAsn1=function(e){var t={},r=[];if(!s.validate(e,i.asn1.contentInfoValidator,t,r)){var o=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw o.errors=r,o}var a,A=s.derToOid(t.contentType);switch(A){case n.pki.oids.envelopedData:a=i.createEnvelopedData();break;case n.pki.oids.encryptedData:a=i.createEncryptedData();break;case n.pki.oids.signedData:a=i.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+A+" is not (yet) supported.")}return a.fromAsn1(t.content.value[0]),a},i.createSignedData=function(){var e=null;return e={type:n.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){if(l(e,t,i.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var r=e.rawCapture.certificates.value,s=0;s<r.length;++s)e.certificates.push(n.pki.certificateFromAsn1(r[s]))},toAsn1:function(){e.contentInfo||e.sign();for(var t=[],r=0;r<e.certificates.length;++r)t.push(n.pki.certificateToAsn1(e.certificates[r]));var i=[],o=s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return t.length>0&&o.value[0].value.push(s.create(s.Class.CONTEXT_SPECIFIC,0,!0,t)),i.length>0&&o.value[0].value.push(s.create(s.Class.CONTEXT_SPECIFIC,1,!0,i)),o.value[0].value.push(s.create(s.Class.UNIVERSAL,s.Type.SET,!0,e.signerInfos)),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.type).getBytes()),o])},addSigner:function(t){var r=t.issuer,s=t.serialNumber;if(t.certificate){var i=t.certificate;"string"==typeof i&&(i=n.pki.certificateFromPem(i)),r=i.issuer.attributes,s=i.serialNumber}var o=t.key;if(!o)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof o&&(o=n.pki.privateKeyFromPem(o));var a=t.digestAlgorithm||n.pki.oids.sha1;switch(a){case n.pki.oids.sha1:case n.pki.oids.sha256:case n.pki.oids.sha384:case n.pki.oids.sha512:case n.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+a)}var A=t.authenticatedAttributes||[];if(A.length>0){for(var c=!1,l=!1,u=0;u<A.length;++u){var h=A[u];if(c||h.type!==n.pki.oids.contentType){if(l||h.type!==n.pki.oids.messageDigest);else if(l=!0,c)break}else if(c=!0,l)break}if(!c||!l)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:o,version:1,issuer:r,serialNumber:s,digestAlgorithm:a,signatureAlgorithm:n.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:A,unauthenticatedAttributes:[]})},sign:function(t){var r;(t=t||{},"object"!=typeof e.content||null===e.contentInfo)&&(e.contentInfo=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(n.pki.oids.data).getBytes())]),"content"in e&&(e.content instanceof n.util.ByteBuffer?r=e.content.bytes():"string"==typeof e.content&&(r=n.util.encodeUtf8(e.content)),t.detached?e.detachedContent=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,r):e.contentInfo.value.push(s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,r)]))));0!==e.signers.length&&function(t){var r;r=e.detachedContent?e.detachedContent:(r=e.contentInfo.value[1]).value[0];if(!r)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var i=s.derToOid(e.contentInfo.value[0].value),o=s.toDer(r);for(var a in o.getByte(),s.getBerValueLength(o),o=o.getBytes(),t)t[a].start().update(o);for(var l=new Date,u=0;u<e.signers.length;++u){var h=e.signers[u];if(0===h.authenticatedAttributes.length){if(i!==n.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{h.authenticatedAttributesAsn1=s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var d=s.create(s.Class.UNIVERSAL,s.Type.SET,!0,[]),f=0;f<h.authenticatedAttributes.length;++f){var p=h.authenticatedAttributes[f];p.type===n.pki.oids.messageDigest?p.value=t[h.digestAlgorithm].digest():p.type===n.pki.oids.signingTime&&(p.value||(p.value=l)),d.value.push(c(p)),h.authenticatedAttributesAsn1.value.push(c(p))}o=s.toDer(d).getBytes(),h.md.start().update(o)}h.signature=h.key.sign(h.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=function(e){for(var t=[],r=0;r<e.length;++r)t.push(A(e[r]));return t}(e.signers)}(function(){for(var t={},r=0;r<e.signers.length;++r){var i=e.signers[r];(o=i.digestAlgorithm)in t||(t[o]=n.md[n.pki.oids[o]].create()),0===i.authenticatedAttributes.length?i.md=t[o]:i.md=n.md[n.pki.oids[o]].create()}for(var o in e.digestAlgorithmIdentifiers=[],t)e.digestAlgorithmIdentifiers.push(s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(o).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]));return t}())},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){"string"==typeof t&&(t=n.pki.certificateFromPem(t)),e.certificates.push(t)},addCertificateRevokationList:function(e){throw new Error("PKCS#7 CRL support not yet implemented.")}}},i.createEncryptedData=function(){var e=null;return e={type:n.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(t){l(e,t,i.asn1.encryptedDataValidator)},decrypt:function(t){void 0!==t&&(e.encryptedContent.key=t),u(e)}}},i.createEnvelopedData=function(){var e=null;return e={type:n.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(t){var r=l(e,t,i.asn1.envelopedDataValidator);e.recipients=function(e){for(var t=[],r=0;r<e.length;++r)t.push(o(e[r]));return t}(r.recipientInfos.value)},toAsn1:function(){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.type).getBytes()),s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SET,!0,a(e.recipients)),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,(t=e.encryptedContent,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(n.pki.oids.data).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.algorithm).getBytes()),t.parameter?s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,t.parameter.getBytes()):void 0]),s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,t.content.getBytes())])]))])])]);var t},findRecipient:function(t){for(var r=t.issuer.attributes,n=0;n<e.recipients.length;++n){var s=e.recipients[n],i=s.issuer;if(s.serialNumber===t.serialNumber&&i.length===r.length){for(var o=!0,a=0;a<r.length;++a)if(i[a].type!==r[a].type||i[a].value!==r[a].value){o=!1;break}if(o)return s}}return null},decrypt:function(t,r){if(void 0===e.encryptedContent.key&&void 0!==t&&void 0!==r)switch(t.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:case n.pki.oids.desCBC:var s=r.decrypt(t.encryptedContent.content);e.encryptedContent.key=n.util.createBuffer(s);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}u(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:n.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,r){if(void 0===e.encryptedContent.content){var s,i,o;switch(r=r||e.encryptedContent.algorithm,t=t||e.encryptedContent.key,r){case n.pki.oids["aes128-CBC"]:s=16,i=16,o=n.aes.createEncryptionCipher;break;case n.pki.oids["aes192-CBC"]:s=24,i=16,o=n.aes.createEncryptionCipher;break;case n.pki.oids["aes256-CBC"]:s=32,i=16,o=n.aes.createEncryptionCipher;break;case n.pki.oids["des-EDE3-CBC"]:s=24,i=8,o=n.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(void 0===t)t=n.util.createBuffer(n.random.getBytes(s));else if(t.length()!=s)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+s+".");e.encryptedContent.algorithm=r,e.encryptedContent.key=t,e.encryptedContent.parameter=n.util.createBuffer(n.random.getBytes(i));var a=o(t);if(a.start(e.encryptedContent.parameter.copy()),a.update(e.content),!a.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=a.output}for(var A=0;A<e.recipients.length;++A){var c=e.recipients[A];if(void 0===c.encryptedContent.content){if(c.encryptedContent.algorithm!==n.pki.oids.rsaEncryption)throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm);c.encryptedContent.content=c.encryptedContent.key.encrypt(e.encryptedContent.key.data)}}}}}},95496:function(e,t,r){var n=r(3832);r(3068),r(97116);var s=n.asn1,i=e.exports=n.pkcs7asn1=n.pkcs7asn1||{};n.pkcs7=n.pkcs7||{},n.pkcs7.asn1=i;var o={name:"ContentInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};i.contentInfoValidator=o;var a={name:"EncryptedContentInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:s.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};i.envelopedDataValidator={name:"EnvelopedData",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:s.Class.UNIVERSAL,type:s.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(a)},i.encryptedDataValidator={name:"EncryptedData",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"version"}].concat(a)};var A={name:"SignerInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:s.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:s.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};i.signedDataValidator={name:"SignedData",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:s.Class.UNIVERSAL,type:s.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},o,{name:"SignedData.Certificates",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:s.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:s.Class.UNIVERSAL,type:s.Type.SET,capture:"signerInfos",optional:!0,value:[A]}]},i.recipientInfoValidator={name:"RecipientInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:s.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},29654:function(e,t,r){var n=r(3832);r(97116),r(15764),r(49563),function(){if(n.prime)e.exports=n.prime;else{var t=e.exports=n.prime=n.prime||{},r=n.jsbn.BigInteger,s=[6,4,2,4,2,4,6,2],i=new r(null);i.fromInt(30);var o=function(e,t){return e|t};t.generateProbablePrime=function(e,t,s){"function"==typeof t&&(s=t,t={});var i=(t=t||{}).algorithm||"PRIMEINC";"string"==typeof i&&(i={name:i}),i.options=i.options||{};var o=t.prng||n.random,A={nextBytes:function(e){for(var t=o.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}};if("PRIMEINC"===i.name)return function(e,t,s,i){if("workers"in s)return function(e,t,s,i){if("undefined"==typeof Worker)return a(e,t,s,i);var o=c(e,t),A=s.workers,l=s.workLoad||100,u=30*l/8,h=s.workerScript||"forge/prime.worker.js";if(-1===A)return n.util.estimateCores((function(e,t){e&&(t=2),A=t-1,d()}));function d(){A=Math.max(1,A);for(var n=[],s=0;s<A;++s)n[s]=new Worker(h);for(s=0;s<A;++s)n[s].addEventListener("message",d);var a=!1;function d(s){if(!a){0;var A=s.data;if(A.found){for(var h=0;h<n.length;++h)n[h].terminate();return a=!0,i(null,new r(A.prime,16))}o.bitLength()>e&&(o=c(e,t));var d=o.toString(16);s.target.postMessage({hex:d,workLoad:l}),o.dAddOffset(u,0)}}}d()}(e,t,s,i);return a(e,t,s,i)}(e,A,i.options,s);throw new Error("Invalid prime generation algorithm: "+i.name)}}function a(e,t,r,n){var s=c(e,t),i=function(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}(s.bitLength());"millerRabinTests"in r&&(i=r.millerRabinTests);var o=10;"maxBlockTime"in r&&(o=r.maxBlockTime),A(s,e,t,0,i,o,n)}function A(e,t,r,i,o,a,l){var u=+new Date;do{if(e.bitLength()>t&&(e=c(t,r)),e.isProbablePrime(o))return l(null,e);e.dAddOffset(s[i++%8],0)}while(a<0||+new Date-u<a);n.util.setImmediate((function(){A(e,t,r,i,o,a,l)}))}function c(e,t){var n=new r(e,t),s=e-1;return n.testBit(s)||n.bitwiseTo(r.ONE.shiftLeft(s),o,n),n.dAddOffset(31-n.mod(i).byteValue(),0),n}}()},74933:function(e,t,r){var n=r(34155),s=r(3832);r(97116);var i=null;!s.util.isNodejs||s.options.usePureJavaScript||n.versions["node-webkit"]||(i=r(25819)),(e.exports=s.prng=s.prng||{}).create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),o=0;o<32;++o)n[o]=r.create();function a(){if(t.pools[0].messageLength>=32)return A();var e=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(e)),A()}function A(){t.reseeds=4294967295===t.reseeds?0:t.reseeds+1;var e=t.plugin.md.create();e.update(t.keyBytes);for(var r=1,n=0;n<32;++n)t.reseeds%r==0&&(e.update(t.pools[n].digest().getBytes()),t.pools[n].start()),r<<=1;t.keyBytes=e.digest().getBytes(),e.start(),e.update(t.keyBytes);var s=e.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(s),t.generated=0}function c(e){var t=null,r=s.util.globalScope,n=r.crypto||r.msCrypto;n&&n.getRandomValues&&(t=function(e){return n.getRandomValues(e)});var i=s.util.createBuffer();if(t)for(;i.length()<e;){var o=Math.max(1,Math.min(e-i.length(),65536)/4),a=new Uint32Array(Math.floor(o));try{t(a);for(var A=0;A<a.length;++A)i.putInt32(a[A])}catch(e){if(!("undefined"!=typeof QuotaExceededError&&e instanceof QuotaExceededError))throw e}}if(i.length()<e)for(var c,l,u,h=Math.floor(65536*Math.random());i.length()<e;){l=16807*(65535&h),l+=(32767&(c=16807*(h>>16)))<<16,h=4294967295&(l=(2147483647&(l+=c>>15))+(l>>31));for(A=0;A<3;++A)u=h>>>(A<<3),u^=Math.floor(256*Math.random()),i.putByte(255&u)}return i.getBytes(e)}return t.pools=n,t.pool=0,t.generate=function(e,r){if(!r)return t.generateSync(e);var n=t.plugin.cipher,i=t.plugin.increment,o=t.plugin.formatKey,a=t.plugin.formatSeed,c=s.util.createBuffer();t.key=null,function l(u){if(u)return r(u);if(c.length()>=e)return r(null,c.getBytes(e));t.generated>1048575&&(t.key=null);if(null===t.key)return s.util.nextTick((function(){!function(e){if(t.pools[0].messageLength>=32)return A(),e();var r=32-t.pools[0].messageLength<<5;t.seedFile(r,(function(r,n){if(r)return e(r);t.collect(n),A(),e()}))}(l)}));var h=n(t.key,t.seed);t.generated+=h.length,c.putBytes(h),t.key=o(n(t.key,i(t.seed))),t.seed=a(n(t.key,t.seed)),s.util.setImmediate(l)}()},t.generateSync=function(e){var r=t.plugin.cipher,n=t.plugin.increment,i=t.plugin.formatKey,o=t.plugin.formatSeed;t.key=null;for(var A=s.util.createBuffer();A.length()<e;){t.generated>1048575&&(t.key=null),null===t.key&&a();var c=r(t.key,t.seed);t.generated+=c.length,A.putBytes(c),t.key=i(r(t.key,n(t.seed))),t.seed=o(r(t.key,t.seed))}return A.getBytes(e)},i?(t.seedFile=function(e,t){i.randomBytes(e,(function(e,r){if(e)return t(e);t(null,r.toString())}))},t.seedFileSync=function(e){return i.randomBytes(e).toString()}):(t.seedFile=function(e,t){try{t(null,c(e))}catch(e){t(e)}},t.seedFileSync=c),t.collect=function(e){for(var r=e.length,n=0;n<r;++n)t.pools[t.pool].update(e.substr(n,1)),t.pool=31===t.pool?0:t.pool+1},t.collectInt=function(e,r){for(var n="",s=0;s<r;s+=8)n+=String.fromCharCode(e>>s&255);t.collect(n)},t.registerWorker=function(e){if(e===self)t.seedFile=function(e,t){self.addEventListener("message",(function e(r){var n=r.data;n.forge&&n.forge.prng&&(self.removeEventListener("message",e),t(n.forge.prng.err,n.forge.prng.bytes))})),self.postMessage({forge:{prng:{needed:e}}})};else{e.addEventListener("message",(function(r){var n=r.data;n.forge&&n.forge.prng&&t.seedFile(n.forge.prng.needed,(function(t,r){e.postMessage({forge:{prng:{err:t,bytes:r}}})}))}))}},t}},96007:function(e,t,r){var n=r(3832);r(49563),r(97116),(e.exports=n.pss=n.pss||{}).create=function(e){3===arguments.length&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t,r=e.md,s=e.mgf,i=r.digestLength,o=e.salt||null;if("string"==typeof o&&(o=n.util.createBuffer(o)),"saltLength"in e)t=e.saltLength;else{if(null===o)throw new Error("Salt length not specified or specific salt not given.");t=o.length()}if(null!==o&&o.length()!==t)throw new Error("Given salt length does not match length of given salt.");var a=e.prng||n.random,A={encode:function(e,A){var c,l,u=A-1,h=Math.ceil(u/8),d=e.digest().getBytes();if(h<i+t+2)throw new Error("Message is too long to encrypt.");l=null===o?a.getBytesSync(t):o.bytes();var f=new n.util.ByteBuffer;f.fillWithByte(0,8),f.putBytes(d),f.putBytes(l),r.start(),r.update(f.getBytes());var p=r.digest().getBytes(),g=new n.util.ByteBuffer;g.fillWithByte(0,h-t-i-2),g.putByte(1),g.putBytes(l);var y=g.getBytes(),w=h-i-1,m=s.generate(p,w),b="";for(c=0;c<w;c++)b+=String.fromCharCode(y.charCodeAt(c)^m.charCodeAt(c));var E=65280>>8*h-u&255;return(b=String.fromCharCode(b.charCodeAt(0)&~E)+b.substr(1))+p+String.fromCharCode(188)},verify:function(e,o,a){var A,c=a-1,l=Math.ceil(c/8);if(o=o.substr(-l),l<i+t+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==o.charCodeAt(l-1))throw new Error("Encoded message does not end in 0xBC.");var u=l-i-1,h=o.substr(0,u),d=o.substr(u,i),f=65280>>8*l-c&255;if(0!=(h.charCodeAt(0)&f))throw new Error("Bits beyond keysize not zero as expected.");var p=s.generate(d,u),g="";for(A=0;A<u;A++)g+=String.fromCharCode(h.charCodeAt(A)^p.charCodeAt(A));g=String.fromCharCode(g.charCodeAt(0)&~f)+g.substr(1);var y=l-i-t-2;for(A=0;A<y;A++)if(0!==g.charCodeAt(A))throw new Error("Leftmost octets not zero as expected");if(1!==g.charCodeAt(y))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var w=g.substr(-t),m=new n.util.ByteBuffer;return m.fillWithByte(0,8),m.putBytes(e),m.putBytes(w),r.start(),r.update(m.getBytes()),d===r.digest().getBytes()}};return A}},49563:function(e,t,r){var n=r(3832);r(8925),r(41668),r(74933),r(97116),n.random&&n.random.getBytes?e.exports=n.random:function(t){var r={},s=new Array(4),i=n.util.createBuffer();function o(){var e=n.prng.create(r);return e.getBytes=function(t,r){return e.generate(t,r)},e.getBytesSync=function(t){return e.generate(t)},e}r.formatKey=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),n.aes._expandKey(e,!1)},r.formatSeed=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),e},r.cipher=function(e,t){return n.aes._updateBlock(e,t,s,!1),i.putInt32(s[0]),i.putInt32(s[1]),i.putInt32(s[2]),i.putInt32(s[3]),i.getBytes()},r.increment=function(e){return++e[3],e},r.md=n.md.sha256;var a=o(),A=null,c=n.util.globalScope,l=c.crypto||c.msCrypto;if(l&&l.getRandomValues&&(A=function(e){return l.getRandomValues(e)}),n.options.usePureJavaScript||!n.util.isNodejs&&!A){if("undefined"==typeof window||window.document,a.collectInt(+new Date,32),"undefined"!=typeof navigator){var u="";for(var h in navigator)try{"string"==typeof navigator[h]&&(u+=navigator[h])}catch(e){}a.collect(u),u=null}t&&(t().mousemove((function(e){a.collectInt(e.clientX,16),a.collectInt(e.clientY,16)})),t().keypress((function(e){a.collectInt(e.charCode,8)})))}if(n.random)for(var h in a)n.random[h]=a[h];else n.random=a;n.random.createInstance=o,e.exports=n.random}("undefined"!=typeof jQuery?jQuery:null)},69372:function(e,t,r){var n=r(3832);r(97116);var s=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],i=[1,2,3,5],o=function(e,t){return e<<t&65535|(65535&e)>>16-t},a=function(e,t){return(65535&e)>>t|e<<16-t&65535};e.exports=n.rc2=n.rc2||{},n.rc2.expandKey=function(e,t){"string"==typeof e&&(e=n.util.createBuffer(e)),t=t||128;var r,i=e,o=e.length(),a=t,A=Math.ceil(a/8),c=255>>(7&a);for(r=o;r<128;r++)i.putByte(s[i.at(r-1)+i.at(r-o)&255]);for(i.setAt(128-A,s[i.at(128-A)&c]),r=127-A;r>=0;r--)i.setAt(r,s[i.at(r+1)^i.at(r+A)]);return i};var A=function(e,t,r){var s,A,c,l,u=!1,h=null,d=null,f=null,p=[];for(e=n.rc2.expandKey(e,t),c=0;c<64;c++)p.push(e.getInt16Le());r?(s=function(e){for(c=0;c<4;c++)e[c]+=p[l]+(e[(c+3)%4]&e[(c+2)%4])+(~e[(c+3)%4]&e[(c+1)%4]),e[c]=o(e[c],i[c]),l++},A=function(e){for(c=0;c<4;c++)e[c]+=p[63&e[(c+3)%4]]}):(s=function(e){for(c=3;c>=0;c--)e[c]=a(e[c],i[c]),e[c]-=p[l]+(e[(c+3)%4]&e[(c+2)%4])+(~e[(c+3)%4]&e[(c+1)%4]),l--},A=function(e){for(c=3;c>=0;c--)e[c]-=p[63&e[(c+3)%4]]});var g=function(e){var t=[];for(c=0;c<4;c++){var n=h.getInt16Le();null!==f&&(r?n^=f.getInt16Le():f.putInt16Le(n)),t.push(65535&n)}l=r?0:63;for(var s=0;s<e.length;s++)for(var i=0;i<e[s][0];i++)e[s][1](t);for(c=0;c<4;c++)null!==f&&(r?f.putInt16Le(t[c]):t[c]^=f.getInt16Le()),d.putInt16Le(t[c])},y=null;return y={start:function(e,t){e&&"string"==typeof e&&(e=n.util.createBuffer(e)),u=!1,h=n.util.createBuffer(),d=t||new n.util.createBuffer,f=e,y.output=d},update:function(e){for(u||h.putBuffer(e);h.length()>=8;)g([[5,s],[1,A],[6,s],[1,A],[5,s]])},finish:function(e){var t=!0;if(r)if(e)t=e(8,h,!r);else{var n=8===h.length()?8:8-h.length();h.fillWithByte(n,n)}if(t&&(u=!0,y.update()),!r&&(t=0===h.length()))if(e)t=e(8,d,!r);else{var s=d.length(),i=d.at(s-1);i>s?t=!1:d.truncate(i)}return t}}};n.rc2.startEncrypting=function(e,t,r){var s=n.rc2.createEncryptionCipher(e,128);return s.start(t,r),s},n.rc2.createEncryptionCipher=function(e,t){return A(e,t,!0)},n.rc2.startDecrypting=function(e,t,r){var s=n.rc2.createDecryptionCipher(e,128);return s.start(t,r),s},n.rc2.createDecryptionCipher=function(e,t){return A(e,t,!1)}},28095:function(e,t,r){var n=r(3832);if(r(3068),r(15764),r(66270),r(18936),r(29654),r(49563),r(97116),void 0===s)var s=n.jsbn.BigInteger;var i=n.util.isNodejs?r(25819):null,o=n.asn1,a=n.util;n.pki=n.pki||{},e.exports=n.pki.rsa=n.rsa=n.rsa||{};var A=n.pki,c=[6,4,2,4,2,4,6,2],l={name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},u={name:"RSAPrivateKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},h={name:"RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},d=n.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},f={name:"DigestInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:o.Class.UNIVERSAL,type:o.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},p=function(e){var t;if(!(e.algorithm in A.oids)){var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}t=A.oids[e.algorithm];var n=o.oidToDer(t).getBytes(),s=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]),i=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);i.value.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,n)),i.value.push(o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,""));var a=o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,e.digest().getBytes());return s.value.push(i),s.value.push(a),o.toDer(s).getBytes()},g=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);var i;t.dP||(t.dP=t.d.mod(t.p.subtract(s.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(s.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));do{i=new s(n.util.bytesToHex(n.random.getBytes(t.n.bitLength()/8)),16)}while(i.compareTo(t.n)>=0||!i.gcd(t.n).equals(s.ONE));for(var o=(e=e.multiply(i.modPow(t.e,t.n)).mod(t.n)).mod(t.p).modPow(t.dP,t.p),a=e.mod(t.q).modPow(t.dQ,t.q);o.compareTo(a)<0;)o=o.add(t.p);var A=o.subtract(a).multiply(t.qInv).mod(t.p).multiply(t.q).add(a);return A=A.multiply(i.modInverse(t.n)).mod(t.n)};function y(e,t,r){var s=n.util.createBuffer(),i=Math.ceil(t.n.bitLength()/8);if(e.length>i-11){var o=new Error("Message is too long for PKCS#1 v1.5 padding.");throw o.length=e.length,o.max=i-11,o}s.putByte(0),s.putByte(r);var a,A=i-3-e.length;if(0===r||1===r){a=0===r?0:255;for(var c=0;c<A;++c)s.putByte(a)}else for(;A>0;){var l=0,u=n.random.getBytes(A);for(c=0;c<A;++c)0===(a=u.charCodeAt(c))?++l:s.putByte(a);A=l}return s.putByte(0),s.putBytes(e),s}function w(e,t,r,s){var i=Math.ceil(t.n.bitLength()/8),o=n.util.createBuffer(e),a=o.getByte(),A=o.getByte();if(0!==a||r&&0!==A&&1!==A||!r&&2!=A||r&&0===A&&void 0===s)throw new Error("Encryption block is invalid.");var c=0;if(0===A){c=i-3-s;for(var l=0;l<c;++l)if(0!==o.getByte())throw new Error("Encryption block is invalid.")}else if(1===A)for(c=0;o.length()>1;){if(255!==o.getByte()){--o.read;break}++c}else if(2===A)for(c=0;o.length()>1;){if(0===o.getByte()){--o.read;break}++c}if(0!==o.getByte()||c!==i-3-o.length())throw new Error("Encryption block is invalid.");return o.getBytes()}function m(e,t,r){"function"==typeof t&&(r=t,t={});var i={algorithm:{name:(t=t||{}).algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};function o(){a(e.pBits,(function(t,n){return t?r(t):(e.p=n,null!==e.q?c(t,e.q):void a(e.qBits,c))}))}function a(e,t){n.prime.generateProbablePrime(e,i,t)}function c(t,n){if(t)return r(t);if(e.q=n,e.p.compareTo(e.q)<0){var i=e.p;e.p=e.q,e.q=i}if(0!==e.p.subtract(s.ONE).gcd(e.e).compareTo(s.ONE))return e.p=null,void o();if(0!==e.q.subtract(s.ONE).gcd(e.e).compareTo(s.ONE))return e.q=null,void a(e.qBits,c);if(e.p1=e.p.subtract(s.ONE),e.q1=e.q.subtract(s.ONE),e.phi=e.p1.multiply(e.q1),0!==e.phi.gcd(e.e).compareTo(s.ONE))return e.p=e.q=null,void o();if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits)return e.q=null,void a(e.qBits,c);var l=e.e.modInverse(e.phi);e.keys={privateKey:A.rsa.setPrivateKey(e.n,e.e,l,e.p,e.q,l.mod(e.p1),l.mod(e.q1),e.q.modInverse(e.p)),publicKey:A.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}"prng"in t&&(i.prng=t.prng),o()}function b(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=n.util.hexToBytes(t);return r.length>1&&(0===r.charCodeAt(0)&&0==(128&r.charCodeAt(1))||255===r.charCodeAt(0)&&128==(128&r.charCodeAt(1)))?r.substr(1):r}function E(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function v(e){return n.util.isNodejs&&"function"==typeof i[e]}function B(e){return void 0!==a.globalScope&&"object"==typeof a.globalScope.crypto&&"object"==typeof a.globalScope.crypto.subtle&&"function"==typeof a.globalScope.crypto.subtle[e]}function _(e){return void 0!==a.globalScope&&"object"==typeof a.globalScope.msCrypto&&"object"==typeof a.globalScope.msCrypto.subtle&&"function"==typeof a.globalScope.msCrypto.subtle[e]}function C(e){for(var t=n.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),s=0;s<t.length;++s)r[s]=t.charCodeAt(s);return r}A.rsa.encrypt=function(e,t,r){var i,o=r,a=Math.ceil(t.n.bitLength()/8);!1!==r&&!0!==r?(o=2===r,i=y(e,t,r)):(i=n.util.createBuffer()).putBytes(e);for(var A=new s(i.toHex(),16),c=g(A,t,o).toString(16),l=n.util.createBuffer(),u=a-Math.ceil(c.length/2);u>0;)l.putByte(0),--u;return l.putBytes(n.util.hexToBytes(c)),l.getBytes()},A.rsa.decrypt=function(e,t,r,i){var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var a=new Error("Encrypted message length is invalid.");throw a.length=e.length,a.expected=o,a}var A=new s(n.util.createBuffer(e).toHex(),16);if(A.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var c=g(A,t,r).toString(16),l=n.util.createBuffer(),u=o-Math.ceil(c.length/2);u>0;)l.putByte(0),--u;return l.putBytes(n.util.hexToBytes(c)),!1!==i?w(l.getBytes(),t,r):l.getBytes()},A.rsa.createKeyPairGenerationState=function(e,t,r){"string"==typeof e&&(e=parseInt(e,10)),e=e||2048;var i,o=(r=r||{}).prng||n.random,a={nextBytes:function(e){for(var t=o.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}},A=r.algorithm||"PRIMEINC";if("PRIMEINC"!==A)throw new Error("Invalid key generation algorithm: "+A);return(i={algorithm:A,state:0,bits:e,rng:a,eInt:t||65537,e:new s(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null}).e.fromInt(i.eInt),i},A.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new s(null);r.fromInt(30);for(var n,i=0,o=function(e,t){return e|t},a=+new Date,l=0;null===e.keys&&(t<=0||l<t);){if(0===e.state){var u=null===e.p?e.pBits:e.qBits,h=u-1;0===e.pqState?(e.num=new s(u,e.rng),e.num.testBit(h)||e.num.bitwiseTo(s.ONE.shiftLeft(h),o,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),i=0,++e.pqState):1===e.pqState?e.num.bitLength()>u?e.pqState=0:e.num.isProbablePrime(E(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(c[i++%8],0):2===e.pqState?e.pqState=0===e.num.subtract(s.ONE).gcd(e.e).compareTo(s.ONE)?3:0:3===e.pqState&&(e.pqState=0,null===e.p?e.p=e.num:e.q=e.num,null!==e.p&&null!==e.q&&++e.state,e.num=null)}else if(1===e.state)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(2===e.state)e.p1=e.p.subtract(s.ONE),e.q1=e.q.subtract(s.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(3===e.state)0===e.phi.gcd(e.e).compareTo(s.ONE)?++e.state:(e.p=null,e.q=null,e.state=0);else if(4===e.state)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(5===e.state){var d=e.e.modInverse(e.phi);e.keys={privateKey:A.rsa.setPrivateKey(e.n,e.e,d,e.p,e.q,d.mod(e.p1),d.mod(e.q1),e.q.modInverse(e.p)),publicKey:A.rsa.setPublicKey(e.n,e.e)}}l+=(n=+new Date)-a,a=n}return null!==e.keys},A.rsa.generateKeyPair=function(e,t,r,s){if(1===arguments.length?"object"==typeof e?(r=e,e=void 0):"function"==typeof e&&(s=e,e=void 0):2===arguments.length?"number"==typeof e?"function"==typeof t?(s=t,t=void 0):"number"!=typeof t&&(r=t,t=void 0):(r=e,s=t,e=void 0,t=void 0):3===arguments.length&&("number"==typeof t?"function"==typeof r&&(s=r,r=void 0):(s=r,r=t,t=void 0)),r=r||{},void 0===e&&(e=r.bits||2048),void 0===t&&(t=r.e||65537),!n.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(65537===t||3===t))if(s){if(v("generateKeyPair"))return i.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},(function(e,t,r){if(e)return s(e);s(null,{privateKey:A.privateKeyFromPem(r),publicKey:A.publicKeyFromPem(t)})}));if(B("generateKey")&&B("exportKey"))return a.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:C(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then((function(e){return a.globalScope.crypto.subtle.exportKey("pkcs8",e.privateKey)})).then(void 0,(function(e){s(e)})).then((function(e){if(e){var t=A.privateKeyFromAsn1(o.fromDer(n.util.createBuffer(e)));s(null,{privateKey:t,publicKey:A.setRsaPublicKey(t.n,t.e)})}}));if(_("generateKey")&&_("exportKey")){var c=a.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:C(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);return c.oncomplete=function(e){var t=e.target.result,r=a.globalScope.msCrypto.subtle.exportKey("pkcs8",t.privateKey);r.oncomplete=function(e){var t=e.target.result,r=A.privateKeyFromAsn1(o.fromDer(n.util.createBuffer(t)));s(null,{privateKey:r,publicKey:A.setRsaPublicKey(r.n,r.e)})},r.onerror=function(e){s(e)}},void(c.onerror=function(e){s(e)})}}else if(v("generateKeyPairSync")){var l=i.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:A.privateKeyFromPem(l.privateKey),publicKey:A.publicKeyFromPem(l.publicKey)}}var u=A.rsa.createKeyPairGenerationState(e,t,r);if(!s)return A.rsa.stepKeyPairGenerationState(u,0),u.keys;m(u,r,s)},A.setRsaPublicKey=A.rsa.setPublicKey=function(e,t){var r={n:e,e:t,encrypt:function(e,t,s){if("string"==typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===t)t={encode:function(e,t,r){return y(e,t,2).getBytes()}};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={encode:function(e,t){return n.pkcs1.encode_rsa_oaep(t,e,s)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(t))t={encode:function(e){return e}};else if("string"==typeof t)throw new Error('Unsupported encryption scheme: "'+t+'".');var i=t.encode(e,r,!0);return A.rsa.encrypt(i,r,!0)},verify:function(e,t,s,i){"string"==typeof s?s=s.toUpperCase():void 0===s&&(s="RSASSA-PKCS1-V1_5"),void 0===i&&(i={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in i||(i._parseAllDigestBytes=!0),"RSASSA-PKCS1-V1_5"===s?s={verify:function(e,t){t=w(t,r,!0);var s=o.fromDer(t,{parseAllBytes:i._parseAllDigestBytes}),a={},A=[];if(!o.validate(s,f,a,A))throw(c=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.")).errors=A,c;var c,l=o.derToOid(a.algorithmIdentifier);if(l!==n.oids.md2&&l!==n.oids.md5&&l!==n.oids.sha1&&l!==n.oids.sha224&&l!==n.oids.sha256&&l!==n.oids.sha384&&l!==n.oids.sha512&&l!==n.oids["sha512-224"]&&l!==n.oids["sha512-256"])throw(c=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.")).oid=l,c;if((l===n.oids.md2||l===n.oids.md5)&&!("parameters"in a))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return e===a.digest}}:"NONE"!==s&&"NULL"!==s&&null!==s||(s={verify:function(e,t){return e===(t=w(t,r,!0))}});var a=A.rsa.decrypt(t,r,!0,!1);return s.verify(e,a,r.n.bitLength())}};return r},A.setRsaPrivateKey=A.rsa.setPrivateKey=function(e,t,r,s,i,o,a,c){var l={n:e,e:t,d:r,p:s,q:i,dP:o,dQ:a,qInv:c,decrypt:function(e,t,r){"string"==typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5");var s=A.rsa.decrypt(e,l,!1,!1);if("RSAES-PKCS1-V1_5"===t)t={decode:w};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={decode:function(e,t){return n.pkcs1.decode_rsa_oaep(t,e,r)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(t))throw new Error('Unsupported encryption scheme: "'+t+'".');t={decode:function(e){return e}}}return t.decode(s,l,!1)},sign:function(e,t){var r=!1;"string"==typeof t&&(t=t.toUpperCase()),void 0===t||"RSASSA-PKCS1-V1_5"===t?(t={encode:p},r=1):"NONE"!==t&&"NULL"!==t&&null!==t||(t={encode:function(){return e}},r=1);var n=t.encode(e,l.n.bitLength());return A.rsa.encrypt(n,l,r)}};return l},A.wrapRsaPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(A.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(e).getBytes())])},A.privateKeyFromAsn1=function(e){var t,r,i,a,c,h,d,f,p={},g=[];if(o.validate(e,l,p,g)&&(e=o.fromDer(n.util.createBuffer(p.privateKey))),p={},g=[],!o.validate(e,u,p,g)){var y=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw y.errors=g,y}return t=n.util.createBuffer(p.privateKeyModulus).toHex(),r=n.util.createBuffer(p.privateKeyPublicExponent).toHex(),i=n.util.createBuffer(p.privateKeyPrivateExponent).toHex(),a=n.util.createBuffer(p.privateKeyPrime1).toHex(),c=n.util.createBuffer(p.privateKeyPrime2).toHex(),h=n.util.createBuffer(p.privateKeyExponent1).toHex(),d=n.util.createBuffer(p.privateKeyExponent2).toHex(),f=n.util.createBuffer(p.privateKeyCoefficient).toHex(),A.setRsaPrivateKey(new s(t,16),new s(r,16),new s(i,16),new s(a,16),new s(c,16),new s(h,16),new s(d,16),new s(f,16))},A.privateKeyToAsn1=A.privateKeyToRSAPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,b(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,b(e.e)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,b(e.d)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,b(e.p)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,b(e.q)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,b(e.dP)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,b(e.dQ)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,b(e.qInv))])},A.publicKeyFromAsn1=function(e){var t={},r=[];if(o.validate(e,d,t,r)){var i,a=o.derToOid(t.publicKeyOid);if(a!==A.oids.rsaEncryption)throw(i=new Error("Cannot read public key. Unknown OID.")).oid=a,i;e=t.rsaPublicKey}if(r=[],!o.validate(e,h,t,r))throw(i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.")).errors=r,i;var c=n.util.createBuffer(t.publicKeyModulus).toHex(),l=n.util.createBuffer(t.publicKeyExponent).toHex();return A.setRsaPublicKey(new s(c,16),new s(l,16))},A.publicKeyToAsn1=A.publicKeyToSubjectPublicKeyInfo=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(A.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,[A.publicKeyToRSAPublicKey(e)])])},A.publicKeyToRSAPublicKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,b(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,b(e.e))])}},137:function(e,t,r){var n=r(3832);r(28991),r(97116);var s=e.exports=n.sha1=n.sha1||{};n.md.sha1=n.md.algorithms.sha1=s,s.create=function(){o||(i=String.fromCharCode(128),i+=n.util.fillString(String.fromCharCode(0),64),o=!0);var e=null,t=n.util.createBuffer(),r=new Array(80),s={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){s.messageLength=0,s.fullMessageLength=s.messageLength64=[];for(var r=s.messageLengthSize/4,i=0;i<r;++i)s.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},s}};return s.start(),s.update=function(i,o){"utf8"===o&&(i=n.util.encodeUtf8(i));var A=i.length;s.messageLength+=A,A=[A/4294967296>>>0,A>>>0];for(var c=s.fullMessageLength.length-1;c>=0;--c)s.fullMessageLength[c]+=A[1],A[1]=A[0]+(s.fullMessageLength[c]/4294967296>>>0),s.fullMessageLength[c]=s.fullMessageLength[c]>>>0,A[0]=A[1]/4294967296>>>0;return t.putBytes(i),a(e,r,t),(t.read>2048||0===t.length())&&t.compact(),s},s.digest=function(){var o=n.util.createBuffer();o.putBytes(t.bytes());var A,c=s.fullMessageLength[s.fullMessageLength.length-1]+s.messageLengthSize&s.blockLength-1;o.putBytes(i.substr(0,s.blockLength-c));for(var l=8*s.fullMessageLength[0],u=0;u<s.fullMessageLength.length-1;++u)l+=(A=8*s.fullMessageLength[u+1])/4294967296>>>0,o.putInt32(l>>>0),l=A>>>0;o.putInt32(l);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};a(h,r,o);var d=n.util.createBuffer();return d.putInt32(h.h0),d.putInt32(h.h1),d.putInt32(h.h2),d.putInt32(h.h3),d.putInt32(h.h4),d},s};var i=null,o=!1;function a(e,t,r){for(var n,s,i,o,a,A,c,l=r.length();l>=64;){for(s=e.h0,i=e.h1,o=e.h2,a=e.h3,A=e.h4,c=0;c<16;++c)n=r.getInt32(),t[c]=n,n=(s<<5|s>>>27)+(a^i&(o^a))+A+1518500249+n,A=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;c<20;++c)n=(n=t[c-3]^t[c-8]^t[c-14]^t[c-16])<<1|n>>>31,t[c]=n,n=(s<<5|s>>>27)+(a^i&(o^a))+A+1518500249+n,A=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;c<32;++c)n=(n=t[c-3]^t[c-8]^t[c-14]^t[c-16])<<1|n>>>31,t[c]=n,n=(s<<5|s>>>27)+(i^o^a)+A+1859775393+n,A=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;c<40;++c)n=(n=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|n>>>30,t[c]=n,n=(s<<5|s>>>27)+(i^o^a)+A+1859775393+n,A=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;c<60;++c)n=(n=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|n>>>30,t[c]=n,n=(s<<5|s>>>27)+(i&o|a&(i^o))+A+2400959708+n,A=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;c<80;++c)n=(n=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|n>>>30,t[c]=n,n=(s<<5|s>>>27)+(i^o^a)+A+3395469782+n,A=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;e.h0=e.h0+s|0,e.h1=e.h1+i|0,e.h2=e.h2+o|0,e.h3=e.h3+a|0,e.h4=e.h4+A|0,l-=64}}},41668:function(e,t,r){var n=r(3832);r(28991),r(97116);var s=e.exports=n.sha256=n.sha256||{};n.md.sha256=n.md.algorithms.sha256=s,s.create=function(){o||(i=String.fromCharCode(128),i+=n.util.fillString(String.fromCharCode(0),64),a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=!0);var e=null,t=n.util.createBuffer(),r=new Array(64),s={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){s.messageLength=0,s.fullMessageLength=s.messageLength64=[];for(var r=s.messageLengthSize/4,i=0;i<r;++i)s.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},s}};return s.start(),s.update=function(i,o){"utf8"===o&&(i=n.util.encodeUtf8(i));var a=i.length;s.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=s.fullMessageLength.length-1;c>=0;--c)s.fullMessageLength[c]+=a[1],a[1]=a[0]+(s.fullMessageLength[c]/4294967296>>>0),s.fullMessageLength[c]=s.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(i),A(e,r,t),(t.read>2048||0===t.length())&&t.compact(),s},s.digest=function(){var o=n.util.createBuffer();o.putBytes(t.bytes());var a,c=s.fullMessageLength[s.fullMessageLength.length-1]+s.messageLengthSize&s.blockLength-1;o.putBytes(i.substr(0,s.blockLength-c));for(var l=8*s.fullMessageLength[0],u=0;u<s.fullMessageLength.length-1;++u)l+=(a=8*s.fullMessageLength[u+1])/4294967296>>>0,o.putInt32(l>>>0),l=a>>>0;o.putInt32(l);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};A(h,r,o);var d=n.util.createBuffer();return d.putInt32(h.h0),d.putInt32(h.h1),d.putInt32(h.h2),d.putInt32(h.h3),d.putInt32(h.h4),d.putInt32(h.h5),d.putInt32(h.h6),d.putInt32(h.h7),d},s};var i=null,o=!1,a=null;function A(e,t,r){for(var n,s,i,o,A,c,l,u,h,d,f,p,g,y=r.length();y>=64;){for(A=0;A<16;++A)t[A]=r.getInt32();for(;A<64;++A)n=((n=t[A-2])>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,s=((s=t[A-15])>>>7|s<<25)^(s>>>18|s<<14)^s>>>3,t[A]=n+t[A-7]+s+t[A-16]|0;for(c=e.h0,l=e.h1,u=e.h2,h=e.h3,d=e.h4,f=e.h5,p=e.h6,g=e.h7,A=0;A<64;++A)i=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),o=c&l|u&(c^l),n=g+((d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7))+(p^d&(f^p))+a[A]+t[A],g=p,p=f,f=d,d=h+n>>>0,h=u,u=l,l=c,c=n+(s=i+o)>>>0;e.h0=e.h0+c|0,e.h1=e.h1+l|0,e.h2=e.h2+u|0,e.h3=e.h3+h|0,e.h4=e.h4+d|0,e.h5=e.h5+f|0,e.h6=e.h6+p|0,e.h7=e.h7+g|0,y-=64}}},63219:function(e,t,r){var n=r(3832);r(28991),r(97116);var s=e.exports=n.sha512=n.sha512||{};n.md.sha512=n.md.algorithms.sha512=s;var i=n.sha384=n.sha512.sha384=n.sha512.sha384||{};i.create=function(){return s.create("SHA-384")},n.md.sha384=n.md.algorithms.sha384=i,n.sha512.sha256=n.sha512.sha256||{create:function(){return s.create("SHA-512/256")}},n.md["sha512/256"]=n.md.algorithms["sha512/256"]=n.sha512.sha256,n.sha512.sha224=n.sha512.sha224||{create:function(){return s.create("SHA-512/224")}},n.md["sha512/224"]=n.md.algorithms["sha512/224"]=n.sha512.sha224,s.create=function(e){if(a||(o=String.fromCharCode(128),o+=n.util.fillString(String.fromCharCode(0),128),A=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],(c={})["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],c["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],c["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],c["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],a=!0),void 0===e&&(e="SHA-512"),!(e in c))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=c[e],r=null,s=n.util.createBuffer(),i=new Array(80),u=0;u<80;++u)i[u]=new Array(2);var h=64;switch(e){case"SHA-384":h=48;break;case"SHA-512/256":h=32;break;case"SHA-512/224":h=28}var d={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:h,messageLength:0,fullMessageLength:null,messageLengthSize:16,start:function(){d.messageLength=0,d.fullMessageLength=d.messageLength128=[];for(var e=d.messageLengthSize/4,i=0;i<e;++i)d.fullMessageLength.push(0);s=n.util.createBuffer(),r=new Array(t.length);for(i=0;i<t.length;++i)r[i]=t[i].slice(0);return d}};return d.start(),d.update=function(e,t){"utf8"===t&&(e=n.util.encodeUtf8(e));var o=e.length;d.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=d.fullMessageLength.length-1;a>=0;--a)d.fullMessageLength[a]+=o[1],o[1]=o[0]+(d.fullMessageLength[a]/4294967296>>>0),d.fullMessageLength[a]=d.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return s.putBytes(e),l(r,i,s),(s.read>2048||0===s.length())&&s.compact(),d},d.digest=function(){var t=n.util.createBuffer();t.putBytes(s.bytes());var a,A=d.fullMessageLength[d.fullMessageLength.length-1]+d.messageLengthSize&d.blockLength-1;t.putBytes(o.substr(0,d.blockLength-A));for(var c=8*d.fullMessageLength[0],u=0;u<d.fullMessageLength.length-1;++u)c+=(a=8*d.fullMessageLength[u+1])/4294967296>>>0,t.putInt32(c>>>0),c=a>>>0;t.putInt32(c);var h=new Array(r.length);for(u=0;u<r.length;++u)h[u]=r[u].slice(0);l(h,i,t);var f,p=n.util.createBuffer();f="SHA-512"===e?h.length:"SHA-384"===e?h.length-2:h.length-4;for(u=0;u<f;++u)p.putInt32(h[u][0]),u===f-1&&"SHA-512/224"===e||p.putInt32(h[u][1]);return p},d};var o=null,a=!1,A=null,c=null;function l(e,t,r){for(var n,s,i,o,a,c,l,u,h,d,f,p,g,y,w,m,b,E,v,B,_,C,S,I,T,R,k,U,D,P,L,N,O,F=r.length();F>=128;){for(k=0;k<16;++k)t[k][0]=r.getInt32()>>>0,t[k][1]=r.getInt32()>>>0;for(;k<80;++k)n=(((U=(P=t[k-2])[0])>>>19|(D=P[1])<<13)^(D>>>29|U<<3)^U>>>6)>>>0,s=((U<<13|D>>>19)^(D<<3|U>>>29)^(U<<26|D>>>6))>>>0,i=(((U=(N=t[k-15])[0])>>>1|(D=N[1])<<31)^(U>>>8|D<<24)^U>>>7)>>>0,o=((U<<31|D>>>1)^(U<<24|D>>>8)^(U<<25|D>>>7))>>>0,L=t[k-7],O=t[k-16],D=s+L[1]+o+O[1],t[k][0]=n+L[0]+i+O[0]+(D/4294967296>>>0)>>>0,t[k][1]=D>>>0;for(f=e[0][0],p=e[0][1],g=e[1][0],y=e[1][1],w=e[2][0],m=e[2][1],b=e[3][0],E=e[3][1],v=e[4][0],B=e[4][1],_=e[5][0],C=e[5][1],S=e[6][0],I=e[6][1],T=e[7][0],R=e[7][1],k=0;k<80;++k)l=((v>>>14|B<<18)^(v>>>18|B<<14)^(B>>>9|v<<23))>>>0,u=(S^v&(_^S))>>>0,a=((f>>>28|p<<4)^(p>>>2|f<<30)^(p>>>7|f<<25))>>>0,c=((f<<4|p>>>28)^(p<<30|f>>>2)^(p<<25|f>>>7))>>>0,h=(f&g|w&(f^g))>>>0,d=(p&y|m&(p^y))>>>0,D=R+(((v<<18|B>>>14)^(v<<14|B>>>18)^(B<<23|v>>>9))>>>0)+((I^B&(C^I))>>>0)+A[k][1]+t[k][1],n=T+l+u+A[k][0]+t[k][0]+(D/4294967296>>>0)>>>0,s=D>>>0,i=a+h+((D=c+d)/4294967296>>>0)>>>0,o=D>>>0,T=S,R=I,S=_,I=C,_=v,C=B,v=b+n+((D=E+s)/4294967296>>>0)>>>0,B=D>>>0,b=w,E=m,w=g,m=y,g=f,y=p,f=n+i+((D=s+o)/4294967296>>>0)>>>0,p=D>>>0;D=e[0][1]+p,e[0][0]=e[0][0]+f+(D/4294967296>>>0)>>>0,e[0][1]=D>>>0,D=e[1][1]+y,e[1][0]=e[1][0]+g+(D/4294967296>>>0)>>>0,e[1][1]=D>>>0,D=e[2][1]+m,e[2][0]=e[2][0]+w+(D/4294967296>>>0)>>>0,e[2][1]=D>>>0,D=e[3][1]+E,e[3][0]=e[3][0]+b+(D/4294967296>>>0)>>>0,e[3][1]=D>>>0,D=e[4][1]+B,e[4][0]=e[4][0]+v+(D/4294967296>>>0)>>>0,e[4][1]=D>>>0,D=e[5][1]+C,e[5][0]=e[5][0]+_+(D/4294967296>>>0)>>>0,e[5][1]=D>>>0,D=e[6][1]+I,e[6][0]=e[6][0]+S+(D/4294967296>>>0)>>>0,e[6][1]=D>>>0,D=e[7][1]+R,e[7][0]=e[7][0]+T+(D/4294967296>>>0)>>>0,e[7][1]=D>>>0,F-=128}}},97116:function(e,t,r){var n=r(34155),s=r(62678).Buffer,i=r(3832),o=r(78807),a=e.exports=i.util=i.util||{};function A(e){if(8!==e&&16!==e&&24!==e&&32!==e)throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}function c(e){if(this.data="",this.read=0,"string"==typeof e)this.data=e;else if(a.isArrayBuffer(e)||a.isArrayBufferView(e))if(void 0!==s&&e instanceof s)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(e){for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof c||"object"==typeof e&&"string"==typeof e.data&&"number"==typeof e.read)&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}!function(){if(void 0!==n&&n.nextTick&&!n.browser)return a.nextTick=n.nextTick,void("function"==typeof setImmediate?a.setImmediate=setImmediate:a.setImmediate=a.nextTick);if("function"==typeof setImmediate)return a.setImmediate=function(){return setImmediate.apply(void 0,arguments)},void(a.nextTick=function(e){return setImmediate(e)});if(a.setImmediate=function(e){setTimeout(e,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){var e="forge.setImmediate",t=[];a.setImmediate=function(r){t.push(r),1===t.length&&window.postMessage(e,"*")},window.addEventListener("message",(function(r){if(r.source===window&&r.data===e){r.stopPropagation();var n=t.slice();t.length=0,n.forEach((function(e){e()}))}}),!0)}if("undefined"!=typeof MutationObserver){var r=Date.now(),s=!0,i=document.createElement("div");t=[];new MutationObserver((function(){var e=t.slice();t.length=0,e.forEach((function(e){e()}))})).observe(i,{attributes:!0});var o=a.setImmediate;a.setImmediate=function(e){Date.now()-r>15?(r=Date.now(),o(e)):(t.push(e),1===t.length&&i.setAttribute("a",s=!s))}}a.nextTick=a.setImmediate}(),a.isNodejs=void 0!==n&&n.versions&&n.versions.node,a.globalScope=a.isNodejs?r.g:"undefined"==typeof self?window:self,a.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},a.isArrayBuffer=function(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer},a.isArrayBufferView=function(e){return e&&a.isArrayBuffer(e.buffer)&&void 0!==e.byteLength},a.ByteBuffer=c,a.ByteStringBuffer=c;a.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>4096&&(this.data.substr(0,1),this._constructedStringLength=0)},a.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},a.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},a.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))},a.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this},a.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this},a.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(a.encodeUtf8(e))},a.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},a.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},a.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},a.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255))},a.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))},a.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))},a.ByteStringBuffer.prototype.putInt=function(e,t){A(t);var r="";do{t-=8,r+=String.fromCharCode(e>>t&255)}while(t>0);return this.putBytes(r)},a.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},a.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())},a.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},a.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},a.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},a.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},a.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},a.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},a.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},a.ByteStringBuffer.prototype.getInt=function(e){A(e);var t=0;do{t=(t<<8)+this.data.charCodeAt(this.read++),e-=8}while(e>0);return t},a.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},a.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},a.ByteStringBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},a.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},a.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},a.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},a.ByteStringBuffer.prototype.copy=function(){var e=a.createBuffer(this.data);return e.read=this.read,e},a.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},a.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},a.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},a.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e},a.ByteStringBuffer.prototype.toString=function(){return a.decodeUtf8(this.bytes())},a.DataBuffer=function(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=a.isArrayBuffer(e),n=a.isArrayBufferView(e);if(r||n)return this.data=r?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),void(this.write="writeOffset"in t?t.writeOffset:this.data.byteLength);this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!=e&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)},a.DataBuffer.prototype.length=function(){return this.write-this.read},a.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},a.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this},a.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this},a.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this},a.DataBuffer.prototype.putBytes=function(e,t){if(a.isArrayBufferView(e)){var r=(n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)).byteLength-n.byteOffset;return this.accommodate(r),new Uint8Array(this.data.buffer,this.write).set(n),this.write+=r,this}if(a.isArrayBuffer(e)){var n=new Uint8Array(e);return this.accommodate(n.byteLength),new Uint8Array(this.data.buffer).set(n,this.write),this.write+=n.byteLength,this}if(e instanceof a.DataBuffer||"object"==typeof e&&"number"==typeof e.read&&"number"==typeof e.write&&a.isArrayBufferView(e.data)){n=new Uint8Array(e.data.byteLength,e.read,e.length());return this.accommodate(n.byteLength),new Uint8Array(e.data.byteLength,this.write).set(n),this.write+=n.byteLength,this}if(e instanceof a.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary","string"==typeof e){var s;if("hex"===t)return this.accommodate(Math.ceil(e.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=a.binary.hex.decode(e,s,this.write),this;if("base64"===t)return this.accommodate(3*Math.ceil(e.length/4)),s=new Uint8Array(this.data.buffer,this.write),this.write+=a.binary.base64.decode(e,s,this.write),this;if("utf8"===t&&(e=a.encodeUtf8(e),t="binary"),"binary"===t||"raw"===t)return this.accommodate(e.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=a.binary.raw.decode(s),this;if("utf16"===t)return this.accommodate(2*e.length),s=new Uint16Array(this.data.buffer,this.write),this.write+=a.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)},a.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this},a.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")},a.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this},a.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this},a.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this},a.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this},a.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this},a.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this},a.DataBuffer.prototype.putInt=function(e,t){A(t),this.accommodate(t/8);do{t-=8,this.data.setInt8(this.write++,e>>t&255)}while(t>0);return this},a.DataBuffer.prototype.putSignedInt=function(e,t){return A(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)},a.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},a.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e},a.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e},a.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e},a.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e},a.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e},a.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e},a.DataBuffer.prototype.getInt=function(e){A(e);var t=0;do{t=(t<<8)+this.data.getInt8(this.read++),e-=8}while(e>0);return t},a.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},a.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},a.DataBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},a.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)},a.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this},a.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},a.DataBuffer.prototype.copy=function(){return new a.DataBuffer(this)},a.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this},a.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},a.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this},a.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e},a.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if("binary"===(e=e||"utf8")||"raw"===e)return a.binary.raw.encode(t);if("hex"===e)return a.binary.hex.encode(t);if("base64"===e)return a.binary.base64.encode(t);if("utf8"===e)return a.text.utf8.decode(t);if("utf16"===e)return a.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)},a.createBuffer=function(e,t){return t=t||"raw",void 0!==e&&"utf8"===t&&(e=a.encodeUtf8(e)),new a.ByteBuffer(e)},a.fillString=function(e,t){for(var r="";t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return r},a.xorBytes=function(e,t,r){for(var n="",s="",i="",o=0,a=0;r>0;--r,++o)s=e.charCodeAt(o)^t.charCodeAt(o),a>=10&&(n+=i,i="",a=0),i+=String.fromCharCode(s),++a;return n+=i},a.hexToBytes=function(e){var t="",r=0;for(!0&e.length&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t},a.bytesToHex=function(e){return a.createBuffer(e).toHex()},a.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],h="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";a.encode64=function(e,t){for(var r,n,s,i="",o="",a=0;a<e.length;)r=e.charCodeAt(a++),n=e.charCodeAt(a++),s=e.charCodeAt(a++),i+=l.charAt(r>>2),i+=l.charAt((3&r)<<4|n>>4),isNaN(n)?i+="==":(i+=l.charAt((15&n)<<2|s>>6),i+=isNaN(s)?"=":l.charAt(63&s)),t&&i.length>t&&(o+=i.substr(0,t)+"\r\n",i=i.substr(t));return o+=i},a.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,r,n,s,i="",o=0;o<e.length;)t=u[e.charCodeAt(o++)-43],r=u[e.charCodeAt(o++)-43],n=u[e.charCodeAt(o++)-43],s=u[e.charCodeAt(o++)-43],i+=String.fromCharCode(t<<2|r>>4),64!==n&&(i+=String.fromCharCode((15&r)<<4|n>>2),64!==s&&(i+=String.fromCharCode((3&n)<<6|s)));return i},a.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},a.decodeUtf8=function(e){return decodeURIComponent(escape(e))},a.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:o.encode,decode:o.decode}},a.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)},a.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length));for(var s=r=r||0,i=0;i<e.length;++i)n[s++]=e.charCodeAt(i);return t?s-r:n},a.binary.hex.encode=a.bytesToHex,a.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2)));var s=0,i=r=r||0;for(1&e.length&&(s=1,n[i++]=parseInt(e[0],16));s<e.length;s+=2)n[i++]=parseInt(e.substr(s,2),16);return t?i-r:n},a.binary.base64.encode=function(e,t){for(var r,n,s,i="",o="",a=0;a<e.byteLength;)r=e[a++],n=e[a++],s=e[a++],i+=l.charAt(r>>2),i+=l.charAt((3&r)<<4|n>>4),isNaN(n)?i+="==":(i+=l.charAt((15&n)<<2|s>>6),i+=isNaN(s)?"=":l.charAt(63&s)),t&&i.length>t&&(o+=i.substr(0,t)+"\r\n",i=i.substr(t));return o+=i},a.binary.base64.decode=function(e,t,r){var n,s,i,o,a=t;a||(a=new Uint8Array(3*Math.ceil(e.length/4))),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var A=0,c=r=r||0;A<e.length;)n=u[e.charCodeAt(A++)-43],s=u[e.charCodeAt(A++)-43],i=u[e.charCodeAt(A++)-43],o=u[e.charCodeAt(A++)-43],a[c++]=n<<2|s>>4,64!==i&&(a[c++]=(15&s)<<4|i>>2,64!==o&&(a[c++]=(3&i)<<6|o));return t?c-r:a.subarray(0,c)},a.binary.base58.encode=function(e,t){return a.binary.baseN.encode(e,h,t)},a.binary.base58.decode=function(e,t){return a.binary.baseN.decode(e,h,t)},a.text={utf8:{},utf16:{}},a.text.utf8.encode=function(e,t,r){e=a.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length));for(var s=r=r||0,i=0;i<e.length;++i)n[s++]=e.charCodeAt(i);return t?s-r:n},a.text.utf8.decode=function(e){return a.decodeUtf8(String.fromCharCode.apply(null,e))},a.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(2*e.length));for(var s=new Uint16Array(n.buffer),i=r=r||0,o=r,a=0;a<e.length;++a)s[o++]=e.charCodeAt(a),i+=2;return t?i-r:n},a.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},a.deflate=function(e,t,r){if(t=a.decode64(e.deflate(a.encode64(t)).rval),r){var n=2;32&t.charCodeAt(1)&&(n=6),t=t.substring(n,t.length-4)}return t},a.inflate=function(e,t,r){var n=e.inflate(a.encode64(t)).rval;return null===n?null:a.decode64(n)};var d=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(null===r?n=e.removeItem(t):(r=a.encode64(JSON.stringify(r)),n=e.setItem(t,r)),void 0!==n&&!0!==n.rval){var s=new Error(n.error.message);throw s.id=n.error.id,s.name=n.error.name,s}},f=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(null===r.rval){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return null!==r&&(r=JSON.parse(a.decode64(r))),r},p=function(e,t,r,n){var s=f(e,t);null===s&&(s={}),s[r]=n,d(e,t,s)},g=function(e,t,r){var n=f(e,t);return null!==n&&(n=r in n?n[r]:null),n},y=function(e,t,r){var n=f(e,t);if(null!==n&&r in n){delete n[r];var s=!0;for(var i in n){s=!1;break}s&&(n=null),d(e,t,n)}},w=function(e,t){d(e,t,null)},m=function(e,t,r){var n,s=null;void 0===r&&(r=["web","flash"]);var i=!1,o=null;for(var a in r){n=r[a];try{if("flash"===n||"both"===n){if(null===t[0])throw new Error("Flash local storage not available.");s=e.apply(this,t),i="flash"===n}"web"!==n&&"both"!==n||(t[0]=localStorage,s=e.apply(this,t),i=!0)}catch(e){o=e}if(i)break}if(!i)throw o;return s};a.setItem=function(e,t,r,n,s){m(p,arguments,s)},a.getItem=function(e,t,r,n){return m(g,arguments,n)},a.removeItem=function(e,t,r,n){m(y,arguments,n)},a.clearItems=function(e,t,r){m(w,arguments,r)},a.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},a.format=function(e){for(var t,r,n=/%./g,s=0,i=[],o=0;t=n.exec(e);){(r=e.substring(o,n.lastIndex-2)).length>0&&i.push(r),o=n.lastIndex;var a=t[0][1];switch(a){case"s":case"o":s<arguments.length?i.push(arguments[1+s++]):i.push("<?>");break;case"%":i.push("%");break;default:i.push("<%"+a+"?>")}}return i.push(e.substring(o)),i.join("")},a.formatNumber=function(e,t,r,n){var s=e,i=isNaN(t=Math.abs(t))?2:t,o=void 0===r?",":r,a=void 0===n?".":n,A=s<0?"-":"",c=parseInt(s=Math.abs(+s||0).toFixed(i),10)+"",l=c.length>3?c.length%3:0;return A+(l?c.substr(0,l)+a:"")+c.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+a)+(i?o+Math.abs(s-c).toFixed(i).slice(2):"")},a.formatSize=function(e){return e=e>=1073741824?a.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?a.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?a.formatNumber(e/1024,0)+" KiB":a.formatNumber(e,0)+" bytes"},a.bytesFromIP=function(e){return-1!==e.indexOf(".")?a.bytesFromIPv4(e):-1!==e.indexOf(":")?a.bytesFromIPv6(e):null},a.bytesFromIPv4=function(e){if(4!==(e=e.split(".")).length)return null;for(var t=a.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()},a.bytesFromIPv6=function(e){for(var t=0,r=2*(8-(e=e.split(":").filter((function(e){return 0===e.length&&++t,!0}))).length+t),n=a.createBuffer(),s=0;s<8;++s)if(e[s]&&0!==e[s].length){var i=a.hexToBytes(e[s]);i.length<2&&n.putByte(0),n.putBytes(i)}else n.fillWithByte(0,r),r=0;return n.getBytes()},a.bytesToIP=function(e){return 4===e.length?a.bytesToIPv4(e):16===e.length?a.bytesToIPv6(e):null},a.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")},a.bytesToIPv6=function(e){if(16!==e.length)return null;for(var t=[],r=[],n=0,s=0;s<e.length;s+=2){for(var i=a.bytesToHex(e[s]+e[s+1]);"0"===i[0]&&"0"!==i;)i=i.substr(1);if("0"===i){var o=r[r.length-1],A=t.length;o&&A===o.end+1?(o.end=A,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1)):r.push({start:A,end:A})}t.push(i)}if(r.length>0){var c=r[n];c.end-c.start>0&&(t.splice(c.start,c.end-c.start+1,""),0===c.start&&t.unshift(""),7===c.end&&t.push(""))}return t.join(":")},a.estimateCores=function(e,t){if("function"==typeof e&&(t=e,e={}),e=e||{},"cores"in a&&!e.update)return t(null,a.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return a.cores=navigator.hardwareConcurrency,t(null,a.cores);if("undefined"==typeof Worker)return a.cores=1,t(null,a.cores);if("undefined"==typeof Blob)return a.cores=2,t(null,a.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",(function(e){for(var t=Date.now(),r=t+4;Date.now()<r;);self.postMessage({st:t,et:r})}))}.toString(),")()"],{type:"application/javascript"}));!function e(n,s,i){if(0===s){var o=Math.floor(n.reduce((function(e,t){return e+t}),0)/n.length);return a.cores=Math.max(1,o),URL.revokeObjectURL(r),t(null,a.cores)}!function(e,t){for(var n=[],s=[],i=0;i<e;++i){var o=new Worker(r);o.addEventListener("message",(function(r){if(s.push(r.data),s.length===e){for(var i=0;i<e;++i)n[i].terminate();t(null,s)}})),n.push(o)}for(i=0;i<e;++i)n[i].postMessage(i)}(i,(function(t,r){n.push(function(e,t){for(var r=[],n=0;n<e;++n)for(var s=t[n],i=r[n]=[],o=0;o<e;++o)if(n!==o){var a=t[o];(s.st>a.st&&s.st<a.et||a.st>s.st&&a.st<s.et)&&i.push(o)}return r.reduce((function(e,t){return Math.max(e,t.length)}),0)}(i,r)),e(n,s-1,i)}))}([],5,16)}},25414:function(e,t,r){var n=r(3832);r(8925),r(3068),r(33480),r(28991),r(86971),r(66270),r(26953),r(96007),r(28095),r(97116);var s=n.asn1,i=e.exports=n.pki=n.pki||{},o=i.oids,a={};a.CN=o.commonName,a.commonName="CN",a.C=o.countryName,a.countryName="C",a.L=o.localityName,a.localityName="L",a.ST=o.stateOrProvinceName,a.stateOrProvinceName="ST",a.O=o.organizationName,a.organizationName="O",a.OU=o.organizationalUnitName,a.organizationalUnitName="OU",a.E=o.emailAddress,a.emailAddress="E";var A=n.pki.rsa.publicKeyValidator,c={name:"Certificate",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:s.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:s.Class.UNIVERSAL,type:s.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:s.Class.UNIVERSAL,type:s.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:s.Class.UNIVERSAL,type:s.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:s.Class.UNIVERSAL,type:s.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},A,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:s.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:s.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:s.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:s.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},l={name:"rsapss",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:s.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:s.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:s.Class.UNIVERSAL,type:s.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:s.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:s.Class.UNIVERSAL,type:s.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},u={name:"CertificationRequestInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},A,{name:"CertificationRequestInfo.attributes",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:s.Class.UNIVERSAL,type:s.Type.SET,constructed:!0}]}]}]},h={name:"CertificationRequest",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[u,{name:"CertificationRequest.signatureAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:s.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};function d(e,t){"string"==typeof t&&(t={shortName:t});for(var r,n=null,s=0;null===n&&s<e.attributes.length;++s)r=e.attributes[s],(t.type&&t.type===r.type||t.name&&t.name===r.name||t.shortName&&t.shortName===r.shortName)&&(n=r);return n}i.RDNAttributesAsArray=function(e,t){for(var r,n,i,A=[],c=0;c<e.value.length;++c){r=e.value[c];for(var l=0;l<r.value.length;++l)i={},n=r.value[l],i.type=s.derToOid(n.value[0].value),i.value=n.value[1].value,i.valueTagClass=n.value[1].type,i.type in o&&(i.name=o[i.type],i.name in a&&(i.shortName=a[i.name])),t&&(t.update(i.type),t.update(i.value)),A.push(i)}return A},i.CRIAttributesAsArray=function(e){for(var t=[],r=0;r<e.length;++r)for(var n=e[r],A=s.derToOid(n.value[0].value),c=n.value[1].value,l=0;l<c.length;++l){var u={};if(u.type=A,u.value=c[l].value,u.valueTagClass=c[l].type,u.type in o&&(u.name=o[u.type],u.name in a&&(u.shortName=a[u.name])),u.type===o.extensionRequest){u.extensions=[];for(var h=0;h<u.value.length;++h)u.extensions.push(i.certificateExtensionFromAsn1(u.value[h]))}t.push(u)}return t};var f=function(e,t,r){var n={};if(e!==o["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:o.sha1},mgf:{algorithmOid:o.mgf1,hash:{algorithmOid:o.sha1}},saltLength:20});var i={},a=[];if(!s.validate(t,l,i,a)){var A=new Error("Cannot read RSASSA-PSS parameter block.");throw A.errors=a,A}return void 0!==i.hashOid&&(n.hash=n.hash||{},n.hash.algorithmOid=s.derToOid(i.hashOid)),void 0!==i.maskGenOid&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=s.derToOid(i.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=s.derToOid(i.maskGenHashOid)),void 0!==i.saltLength&&(n.saltLength=i.saltLength.charCodeAt(0)),n},p=function(e){switch(o[e.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return n.md.sha1.create();case"md5WithRSAEncryption":return n.md.md5.create();case"sha256WithRSAEncryption":case"RSASSA-PSS":return n.md.sha256.create();case"sha384WithRSAEncryption":return n.md.sha384.create();case"sha512WithRSAEncryption":return n.md.sha512.create();default:var t=new Error("Could not compute "+e.type+" digest. Unknown signature OID.");throw t.signatureOid=e.signatureOid,t}},g=function(e){var t,r=e.certificate;switch(r.signatureOid){case o.sha1WithRSAEncryption:case o.sha1WithRSASignature:break;case o["RSASSA-PSS"]:var s,i,a;if(void 0===(s=o[r.signatureParameters.mgf.hash.algorithmOid])||void 0===n.md[s])throw(a=new Error("Unsupported MGF hash function.")).oid=r.signatureParameters.mgf.hash.algorithmOid,a.name=s,a;if(void 0===(i=o[r.signatureParameters.mgf.algorithmOid])||void 0===n.mgf[i])throw(a=new Error("Unsupported MGF function.")).oid=r.signatureParameters.mgf.algorithmOid,a.name=i,a;if(i=n.mgf[i].create(n.md[s].create()),void 0===(s=o[r.signatureParameters.hash.algorithmOid])||void 0===n.md[s])throw(a=new Error("Unsupported RSASSA-PSS hash function.")).oid=r.signatureParameters.hash.algorithmOid,a.name=s,a;t=n.pss.create(n.md[s].create(),i,r.signatureParameters.saltLength)}return r.publicKey.verify(e.md.digest().getBytes(),e.signature,t)};function y(e){for(var t,r,i=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]),o=e.attributes,a=0;a<o.length;++a){var A=(t=o[a]).value,c=s.Type.PRINTABLESTRING;"valueTagClass"in t&&(c=t.valueTagClass)===s.Type.UTF8&&(A=n.util.encodeUtf8(A)),r=s.create(s.Class.UNIVERSAL,s.Type.SET,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.type).getBytes()),s.create(s.Class.UNIVERSAL,c,!1,A)])]),i.value.push(r)}return i}function w(e){for(var t,r=0;r<e.length;++r){if(void 0===(t=e[r]).name&&(t.type&&t.type in i.oids?t.name=i.oids[t.type]:t.shortName&&t.shortName in a&&(t.name=i.oids[a[t.shortName]])),void 0===t.type){if(!t.name||!(t.name in i.oids))throw(A=new Error("Attribute type not specified.")).attribute=t,A;t.type=i.oids[t.name]}if(void 0===t.shortName&&t.name&&t.name in a&&(t.shortName=a[t.name]),t.type===o.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=s.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var n=0;n<t.extensions.length;++n)t.value.push(i.certificateExtensionToAsn1(m(t.extensions[n])))}var A;if(void 0===t.value)throw(A=new Error("Attribute value not specified.")).attribute=t,A}}function m(e,t){if(t=t||{},void 0===e.name&&e.id&&e.id in i.oids&&(e.name=i.oids[e.id]),void 0===e.id){if(!e.name||!(e.name in i.oids))throw(E=new Error("Extension ID not specified.")).extension=e,E;e.id=i.oids[e.name]}if(void 0!==e.value)return e;if("keyUsage"===e.name){var r=0,a=0,A=0;e.digitalSignature&&(a|=128,r=7),e.nonRepudiation&&(a|=64,r=6),e.keyEncipherment&&(a|=32,r=5),e.dataEncipherment&&(a|=16,r=4),e.keyAgreement&&(a|=8,r=3),e.keyCertSign&&(a|=4,r=2),e.cRLSign&&(a|=2,r=1),e.encipherOnly&&(a|=1,r=0),e.decipherOnly&&(A|=128,r=7);var c=String.fromCharCode(r);0!==A?c+=String.fromCharCode(a)+String.fromCharCode(A):0!==a&&(c+=String.fromCharCode(a)),e.value=s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,c)}else if("basicConstraints"===e.name)e.value=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(s.create(s.Class.UNIVERSAL,s.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.pathLenConstraint).getBytes()));else if("extKeyUsage"===e.name){e.value=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);var l=e.value.value;for(var u in e)!0===e[u]&&(u in o?l.push(s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(o[u]).getBytes())):-1!==u.indexOf(".")&&l.push(s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(u).getBytes())))}else if("nsCertType"===e.name){r=0,a=0;e.client&&(a|=128,r=7),e.server&&(a|=64,r=6),e.email&&(a|=32,r=5),e.objsign&&(a|=16,r=4),e.reserved&&(a|=8,r=3),e.sslCA&&(a|=4,r=2),e.emailCA&&(a|=2,r=1),e.objCA&&(a|=1,r=0);c=String.fromCharCode(r);0!==a&&(c+=String.fromCharCode(a)),e.value=s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,c)}else if("subjectAltName"===e.name||"issuerAltName"===e.name){e.value=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);for(var h=0;h<e.altNames.length;++h){c=(w=e.altNames[h]).value;if(7===w.type&&w.ip){if(null===(c=n.util.bytesFromIP(w.ip)))throw(E=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,E}else 8===w.type&&(c=w.oid?s.oidToDer(s.oidToDer(w.oid)):s.oidToDer(c));e.value.value.push(s.create(s.Class.CONTEXT_SPECIFIC,w.type,!1,c))}}else if("nsComment"===e.name&&t.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128)throw new Error('Invalid "nsComment" content.');e.value=s.create(s.Class.UNIVERSAL,s.Type.IA5STRING,!1,e.comment)}else if("subjectKeyIdentifier"===e.name&&t.cert){var d=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=d.toHex(),e.value=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,d.getBytes())}else if("authorityKeyIdentifier"===e.name&&t.cert){e.value=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);l=e.value.value;if(e.keyIdentifier){var f=!0===e.keyIdentifier?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;l.push(s.create(s.Class.CONTEXT_SPECIFIC,0,!1,f))}if(e.authorityCertIssuer){var p=[s.create(s.Class.CONTEXT_SPECIFIC,4,!0,[y(!0===e.authorityCertIssuer?t.cert.issuer:e.authorityCertIssuer)])];l.push(s.create(s.Class.CONTEXT_SPECIFIC,1,!0,p))}if(e.serialNumber){var g=n.util.hexToBytes(!0===e.serialNumber?t.cert.serialNumber:e.serialNumber);l.push(s.create(s.Class.CONTEXT_SPECIFIC,2,!1,g))}}else if("cRLDistributionPoints"===e.name){e.value=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);l=e.value.value;var w,m=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]),b=s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[]);for(h=0;h<e.altNames.length;++h){c=(w=e.altNames[h]).value;if(7===w.type&&w.ip){if(null===(c=n.util.bytesFromIP(w.ip)))throw(E=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,E}else 8===w.type&&(c=w.oid?s.oidToDer(s.oidToDer(w.oid)):s.oidToDer(c));b.value.push(s.create(s.Class.CONTEXT_SPECIFIC,w.type,!1,c))}m.value.push(s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[b])),l.push(m)}var E;if(void 0===e.value)throw(E=new Error("Extension value not specified.")).extension=e,E;return e}function b(e,t){if(e===o["RSASSA-PSS"]){var r=[];return void 0!==t.hash.algorithmOid&&r.push(s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.hash.algorithmOid).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")])])),void 0!==t.mgf.algorithmOid&&r.push(s.create(s.Class.CONTEXT_SPECIFIC,1,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.mgf.algorithmOid).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.mgf.hash.algorithmOid).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")])])])),void 0!==t.saltLength&&r.push(s.create(s.Class.CONTEXT_SPECIFIC,2,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(t.saltLength).getBytes())])),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,r)}return s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")}function E(e){var t=s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===e.attributes.length)return t;for(var r=e.attributes,i=0;i<r.length;++i){var o=r[i],a=o.value,A=s.Type.UTF8;"valueTagClass"in o&&(A=o.valueTagClass),A===s.Type.UTF8&&(a=n.util.encodeUtf8(a));var c=!1;"valueConstructed"in o&&(c=o.valueConstructed);var l=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(o.type).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SET,!0,[s.create(s.Class.UNIVERSAL,A,c,a)])]);t.value.push(l)}return t}i.certificateFromPem=function(e,t,r){var o=n.pem.decode(e)[0];if("CERTIFICATE"!==o.type&&"X509 CERTIFICATE"!==o.type&&"TRUSTED CERTIFICATE"!==o.type){var a=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw a.headerType=o.type,a}if(o.procType&&"ENCRYPTED"===o.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var A=s.fromDer(o.body,r);return i.certificateFromAsn1(A,t)},i.certificateToPem=function(e,t){var r={type:"CERTIFICATE",body:s.toDer(i.certificateToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},i.publicKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("PUBLIC KEY"!==t.type&&"RSA PUBLIC KEY"!==t.type){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var o=s.fromDer(t.body);return i.publicKeyFromAsn1(o)},i.publicKeyToPem=function(e,t){var r={type:"PUBLIC KEY",body:s.toDer(i.publicKeyToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},i.publicKeyToRSAPublicKeyPem=function(e,t){var r={type:"RSA PUBLIC KEY",body:s.toDer(i.publicKeyToRSAPublicKey(e)).getBytes()};return n.pem.encode(r,{maxline:t})},i.getPublicKeyFingerprint=function(e,t){var r,o=(t=t||{}).md||n.md.sha1.create();switch(t.type||"RSAPublicKey"){case"RSAPublicKey":r=s.toDer(i.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":r=s.toDer(i.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}o.start(),o.update(r);var a=o.digest();if("hex"===t.encoding){var A=a.toHex();return t.delimiter?A.match(/.{2}/g).join(t.delimiter):A}if("binary"===t.encoding)return a.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".');return a},i.certificationRequestFromPem=function(e,t,r){var o=n.pem.decode(e)[0];if("CERTIFICATE REQUEST"!==o.type){var a=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw a.headerType=o.type,a}if(o.procType&&"ENCRYPTED"===o.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var A=s.fromDer(o.body,r);return i.certificationRequestFromAsn1(A,t)},i.certificationRequestToPem=function(e,t){var r={type:"CERTIFICATE REQUEST",body:s.toDer(i.certificationRequestToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},i.createCertificate=function(){var e={version:2,serialNumber:"00",signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return d(e.issuer,t)},e.issuer.addField=function(t){w([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return d(e.subject,t)},e.subject.addField=function(t){w([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,r){w(t),e.subject.attributes=t,delete e.subject.uniqueId,r&&(e.subject.uniqueId=r),e.subject.hash=null},e.setIssuer=function(t,r){w(t),e.issuer.attributes=t,delete e.issuer.uniqueId,r&&(e.issuer.uniqueId=r),e.issuer.hash=null},e.setExtensions=function(t){for(var r=0;r<t.length;++r)m(t[r],{cert:e});e.extensions=t},e.getExtension=function(t){"string"==typeof t&&(t={name:t});for(var r,n=null,s=0;null===n&&s<e.extensions.length;++s)r=e.extensions[s],(t.id&&r.id===t.id||t.name&&r.name===t.name)&&(n=r);return n},e.sign=function(t,r){e.md=r||n.md.sha1.create();var a=o[e.md.algorithm+"WithRSAEncryption"];if(!a){var A=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw A.algorithm=e.md.algorithm,A}e.signatureOid=e.siginfo.algorithmOid=a,e.tbsCertificate=i.getTBSCertificate(e);var c=s.toDer(e.tbsCertificate);e.md.update(c.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var r=!1;if(!e.issued(t)){var n=t.issuer,o=e.subject,a=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw a.expectedIssuer=o.attributes,a.actualIssuer=n.attributes,a}var A=t.md;if(null===A){A=p({signatureOid:t.signatureOid,type:"certificate"});var c=t.tbsCertificate||i.getTBSCertificate(t),l=s.toDer(c);A.update(l.getBytes())}return null!==A&&(r=g({certificate:e,md:A,signature:t.signature})),r},e.isIssuer=function(t){var r=!1,n=e.issuer,s=t.subject;if(n.hash&&s.hash)r=n.hash===s.hash;else if(n.attributes.length===s.attributes.length){var i,o;r=!0;for(var a=0;r&&a<n.attributes.length;++a)i=n.attributes[a],o=s.attributes[a],i.type===o.type&&i.value===o.value||(r=!1)}return r},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return i.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=o.subjectKeyIdentifier,r=0;r<e.extensions.length;++r){var s=e.extensions[r];if(s.id===t){var i=e.generateSubjectKeyIdentifier().getBytes();return n.util.hexToBytes(s.subjectKeyIdentifier)===i}}return!1},e},i.certificateFromAsn1=function(e,t){var r={},o=[];if(!s.validate(e,c,r,o)){var a=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw a.errors=o,a}if(s.derToOid(r.publicKeyOid)!==i.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var A=i.createCertificate();A.version=r.certVersion?r.certVersion.charCodeAt(0):0;var l=n.util.createBuffer(r.certSerialNumber);A.serialNumber=l.toHex(),A.signatureOid=n.asn1.derToOid(r.certSignatureOid),A.signatureParameters=f(A.signatureOid,r.certSignatureParams,!0),A.siginfo.algorithmOid=n.asn1.derToOid(r.certinfoSignatureOid),A.siginfo.parameters=f(A.siginfo.algorithmOid,r.certinfoSignatureParams,!1),A.signature=r.certSignature;var u=[];if(void 0!==r.certValidity1UTCTime&&u.push(s.utcTimeToDate(r.certValidity1UTCTime)),void 0!==r.certValidity2GeneralizedTime&&u.push(s.generalizedTimeToDate(r.certValidity2GeneralizedTime)),void 0!==r.certValidity3UTCTime&&u.push(s.utcTimeToDate(r.certValidity3UTCTime)),void 0!==r.certValidity4GeneralizedTime&&u.push(s.generalizedTimeToDate(r.certValidity4GeneralizedTime)),u.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(u.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(A.validity.notBefore=u[0],A.validity.notAfter=u[1],A.tbsCertificate=r.tbsCertificate,t){A.md=p({signatureOid:A.signatureOid,type:"certificate"});var h=s.toDer(A.tbsCertificate);A.md.update(h.getBytes())}var g=n.md.sha1.create(),y=s.toDer(r.certIssuer);g.update(y.getBytes()),A.issuer.getField=function(e){return d(A.issuer,e)},A.issuer.addField=function(e){w([e]),A.issuer.attributes.push(e)},A.issuer.attributes=i.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(A.issuer.uniqueId=r.certIssuerUniqueId),A.issuer.hash=g.digest().toHex();var m=n.md.sha1.create(),b=s.toDer(r.certSubject);return m.update(b.getBytes()),A.subject.getField=function(e){return d(A.subject,e)},A.subject.addField=function(e){w([e]),A.subject.attributes.push(e)},A.subject.attributes=i.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(A.subject.uniqueId=r.certSubjectUniqueId),A.subject.hash=m.digest().toHex(),r.certExtensions?A.extensions=i.certificateExtensionsFromAsn1(r.certExtensions):A.extensions=[],A.publicKey=i.publicKeyFromAsn1(r.subjectPublicKeyInfo),A},i.certificateExtensionsFromAsn1=function(e){for(var t=[],r=0;r<e.value.length;++r)for(var n=e.value[r],s=0;s<n.value.length;++s)t.push(i.certificateExtensionFromAsn1(n.value[s]));return t},i.certificateExtensionFromAsn1=function(e){var t={};if(t.id=s.derToOid(e.value[0].value),t.critical=!1,e.value[1].type===s.Type.BOOLEAN?(t.critical=0!==e.value[1].value.charCodeAt(0),t.value=e.value[2].value):t.value=e.value[1].value,t.id in o)if(t.name=o[t.id],"keyUsage"===t.name){var r=0,i=0;(A=s.fromDer(t.value)).value.length>1&&(r=A.value.charCodeAt(1),i=A.value.length>2?A.value.charCodeAt(2):0),t.digitalSignature=128==(128&r),t.nonRepudiation=64==(64&r),t.keyEncipherment=32==(32&r),t.dataEncipherment=16==(16&r),t.keyAgreement=8==(8&r),t.keyCertSign=4==(4&r),t.cRLSign=2==(2&r),t.encipherOnly=1==(1&r),t.decipherOnly=128==(128&i)}else if("basicConstraints"===t.name){(A=s.fromDer(t.value)).value.length>0&&A.value[0].type===s.Type.BOOLEAN?t.cA=0!==A.value[0].value.charCodeAt(0):t.cA=!1;var a=null;A.value.length>0&&A.value[0].type===s.Type.INTEGER?a=A.value[0].value:A.value.length>1&&(a=A.value[1].value),null!==a&&(t.pathLenConstraint=s.derToInteger(a))}else if("extKeyUsage"===t.name)for(var A=s.fromDer(t.value),c=0;c<A.value.length;++c){var l=s.derToOid(A.value[c].value);l in o?t[o[l]]=!0:t[l]=!0}else if("nsCertType"===t.name){r=0;(A=s.fromDer(t.value)).value.length>1&&(r=A.value.charCodeAt(1)),t.client=128==(128&r),t.server=64==(64&r),t.email=32==(32&r),t.objsign=16==(16&r),t.reserved=8==(8&r),t.sslCA=4==(4&r),t.emailCA=2==(2&r),t.objCA=1==(1&r)}else if("subjectAltName"===t.name||"issuerAltName"===t.name){var u;t.altNames=[];A=s.fromDer(t.value);for(var h=0;h<A.value.length;++h){var d={type:(u=A.value[h]).type,value:u.value};switch(t.altNames.push(d),u.type){case 1:case 2:case 6:break;case 7:d.ip=n.util.bytesToIP(u.value);break;case 8:d.oid=s.derToOid(u.value)}}}else if("subjectKeyIdentifier"===t.name){A=s.fromDer(t.value);t.subjectKeyIdentifier=n.util.bytesToHex(A.value)}return t},i.certificationRequestFromAsn1=function(e,t){var r={},o=[];if(!s.validate(e,h,r,o)){var a=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw a.errors=o,a}if(s.derToOid(r.publicKeyOid)!==i.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var A=i.createCertificationRequest();if(A.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,A.signatureOid=n.asn1.derToOid(r.csrSignatureOid),A.signatureParameters=f(A.signatureOid,r.csrSignatureParams,!0),A.siginfo.algorithmOid=n.asn1.derToOid(r.csrSignatureOid),A.siginfo.parameters=f(A.siginfo.algorithmOid,r.csrSignatureParams,!1),A.signature=r.csrSignature,A.certificationRequestInfo=r.certificationRequestInfo,t){A.md=p({signatureOid:A.signatureOid,type:"certification request"});var c=s.toDer(A.certificationRequestInfo);A.md.update(c.getBytes())}var l=n.md.sha1.create();return A.subject.getField=function(e){return d(A.subject,e)},A.subject.addField=function(e){w([e]),A.subject.attributes.push(e)},A.subject.attributes=i.RDNAttributesAsArray(r.certificationRequestInfoSubject,l),A.subject.hash=l.digest().toHex(),A.publicKey=i.publicKeyFromAsn1(r.subjectPublicKeyInfo),A.getAttribute=function(e){return d(A,e)},A.addAttribute=function(e){w([e]),A.attributes.push(e)},A.attributes=i.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),A},i.createCertificationRequest=function(){var e={version:0,signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return d(e.subject,t)},e.subject.addField=function(t){w([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return d(e,t)},e.addAttribute=function(t){w([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){w(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){w(t),e.attributes=t},e.sign=function(t,r){e.md=r||n.md.sha1.create();var a=o[e.md.algorithm+"WithRSAEncryption"];if(!a){var A=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw A.algorithm=e.md.algorithm,A}e.signatureOid=e.siginfo.algorithmOid=a,e.certificationRequestInfo=i.getCertificationRequestInfo(e);var c=s.toDer(e.certificationRequestInfo);e.md.update(c.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,r=e.md;if(null===r){r=p({signatureOid:e.signatureOid,type:"certification request"});var n=e.certificationRequestInfo||i.getCertificationRequestInfo(e),o=s.toDer(n);r.update(o.getBytes())}return null!==r&&(t=g({certificate:e,md:r,signature:e.signature})),t},e};var v=new Date("1950-01-01T00:00:00Z"),B=new Date("2050-01-01T00:00:00Z");function _(e){return e>=v&&e<B?s.create(s.Class.UNIVERSAL,s.Type.UTCTIME,!1,s.dateToUtcTime(e)):s.create(s.Class.UNIVERSAL,s.Type.GENERALIZEDTIME,!1,s.dateToGeneralizedTime(e))}i.getTBSCertificate=function(e){var t=_(e.validity.notBefore),r=_(e.validity.notAfter),o=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes())]),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,n.util.hexToBytes(e.serialNumber)),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.siginfo.algorithmOid).getBytes()),b(e.siginfo.algorithmOid,e.siginfo.parameters)]),y(e.issuer),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[t,r]),y(e.subject),i.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&o.value.push(s.create(s.Class.CONTEXT_SPECIFIC,1,!0,[s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&o.value.push(s.create(s.Class.CONTEXT_SPECIFIC,2,!0,[s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&o.value.push(i.certificateExtensionsToAsn1(e.extensions)),o},i.getCertificationRequestInfo=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes()),y(e.subject),i.publicKeyToAsn1(e.publicKey),E(e)])},i.distinguishedNameToAsn1=function(e){return y(e)},i.certificateToAsn1=function(e){var t=e.tbsCertificate||i.getTBSCertificate(e);return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[t,s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.signatureOid).getBytes()),b(e.signatureOid,e.signatureParameters)]),s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},i.certificateExtensionsToAsn1=function(e){var t=s.create(s.Class.CONTEXT_SPECIFIC,3,!0,[]),r=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);t.value.push(r);for(var n=0;n<e.length;++n)r.value.push(i.certificateExtensionToAsn1(e[n]));return t},i.certificateExtensionToAsn1=function(e){var t=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);t.value.push(s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.id).getBytes())),e.critical&&t.value.push(s.create(s.Class.UNIVERSAL,s.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=e.value;return"string"!=typeof e.value&&(r=s.toDer(r).getBytes()),t.value.push(s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,r)),t},i.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||i.getCertificationRequestInfo(e);return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[t,s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.signatureOid).getBytes()),b(e.signatureOid,e.signatureParameters)]),s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},i.createCaStore=function(e){var t={certs:{}};function r(e){return o(e),t.certs[e.hash]||null}function o(e){if(!e.hash){var t=n.md.sha1.create();e.attributes=i.RDNAttributesAsArray(y(e),t),e.hash=t.digest().toHex()}}if(t.getIssuer=function(e){return r(e.issuer)},t.addCertificate=function(e){if("string"==typeof e&&(e=n.pki.certificateFromPem(e)),o(e.subject),!t.hasCertificate(e))if(e.subject.hash in t.certs){var r=t.certs[e.subject.hash];n.util.isArray(r)||(r=[r]),r.push(e),t.certs[e.subject.hash]=r}else t.certs[e.subject.hash]=e},t.hasCertificate=function(e){"string"==typeof e&&(e=n.pki.certificateFromPem(e));var t=r(e.subject);if(!t)return!1;n.util.isArray(t)||(t=[t]);for(var o=s.toDer(i.certificateToAsn1(e)).getBytes(),a=0;a<t.length;++a){if(o===s.toDer(i.certificateToAsn1(t[a])).getBytes())return!0}return!1},t.listAllCertificates=function(){var e=[];for(var r in t.certs)if(t.certs.hasOwnProperty(r)){var s=t.certs[r];if(n.util.isArray(s))for(var i=0;i<s.length;++i)e.push(s[i]);else e.push(s)}return e},t.removeCertificate=function(e){var a;if("string"==typeof e&&(e=n.pki.certificateFromPem(e)),o(e.subject),!t.hasCertificate(e))return null;var A=r(e.subject);if(!n.util.isArray(A))return a=t.certs[e.subject.hash],delete t.certs[e.subject.hash],a;for(var c=s.toDer(i.certificateToAsn1(e)).getBytes(),l=0;l<A.length;++l){c===s.toDer(i.certificateToAsn1(A[l])).getBytes()&&(a=A[l],A.splice(l,1))}return 0===A.length&&delete t.certs[e.subject.hash],a},e)for(var a=0;a<e.length;++a){var A=e[a];t.addCertificate(A)}return t},i.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},i.verifyCertificateChain=function(e,t,r){"function"==typeof r&&(r={verify:r}),r=r||{};var s=(t=t.slice(0)).slice(0),o=r.validityCheckDate;void 0===o&&(o=new Date);var a=!0,A=null,c=0;do{var l=t.shift(),u=null,h=!1;if(o&&(o<l.validity.notBefore||o>l.validity.notAfter)&&(A={message:"Certificate is not valid yet or has expired.",error:i.certificateError.certificate_expired,notBefore:l.validity.notBefore,notAfter:l.validity.notAfter,now:o}),null===A){if(null===(u=t[0]||e.getIssuer(l))&&l.isIssuer(l)&&(h=!0,u=l),u){var d=u;n.util.isArray(d)||(d=[d]);for(var f=!1;!f&&d.length>0;){u=d.shift();try{f=u.verify(l)}catch(e){}}f||(A={message:"Certificate signature is invalid.",error:i.certificateError.bad_certificate})}null!==A||u&&!h||e.hasCertificate(l)||(A={message:"Certificate is not trusted.",error:i.certificateError.unknown_ca})}if(null===A&&u&&!l.isIssuer(u)&&(A={message:"Certificate issuer is invalid.",error:i.certificateError.bad_certificate}),null===A)for(var p={keyUsage:!0,basicConstraints:!0},g=0;null===A&&g<l.extensions.length;++g){var y=l.extensions[g];y.critical&&!(y.name in p)&&(A={message:"Certificate has an unsupported critical extension.",error:i.certificateError.unsupported_certificate})}if(null===A&&(!a||0===t.length&&(!u||h))){var w=l.getExtension("basicConstraints"),m=l.getExtension("keyUsage");if(null!==m&&(m.keyCertSign&&null!==w||(A={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:i.certificateError.bad_certificate})),null!==A||null===w||w.cA||(A={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:i.certificateError.bad_certificate}),null===A&&null!==m&&"pathLenConstraint"in w)c-1>w.pathLenConstraint&&(A={message:"Certificate basicConstraints pathLenConstraint violated.",error:i.certificateError.bad_certificate})}var b=null===A||A.error,E=r.verify?r.verify(b,c,s):b;if(!0!==E)throw!0===b&&(A={message:"The application rejected the certificate.",error:i.certificateError.bad_certificate}),(E||0===E)&&("object"!=typeof E||n.util.isArray(E)?"string"==typeof E&&(A.error=E):(E.message&&(A.message=E.message),E.error&&(A.error=E.error))),A;A=null,a=!1,++c}while(t.length>0);return!0}},35103:function(e,t,r){const n=r(91607),s=r(50603);e.exports=class{constructor(){this._buffer=new n,this._waitingConsumers=new n}push(e){const{promise:t,resolve:r}=s();return this._buffer.push({chunk:e,resolve:r}),this._consume(),t}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){const e=this._waitingConsumers.shift(),t=this._buffer.shift();e.resolve(t.chunk),t.resolve()}}shift(){const{promise:e,resolve:t}=s();return this._waitingConsumers.push({resolve:t}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}},50603:function(e){"use strict";e.exports=()=>{const e={};return e.promise=new Promise(((t,r)=>{e.resolve=t,e.reject=r})),e}},62100:function(e,t,r){"use strict";e.exports=r(89482)},89482:function(e,t,r){"use strict";var n=t;function s(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=r(41173),n.BufferWriter=r(43155),n.Reader=r(51408),n.BufferReader=r(50593),n.util=r(99693),n.rpc=r(35994),n.roots=r(85054),n.configure=s,s()},51408:function(e,t,r){"use strict";e.exports=A;var n,s=r(99693),i=s.LongBits,o=s.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function A(e){this.buf=e,this.pos=0,this.len=e.length}var c,l="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new A(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new A(e);throw Error("illegal buffer")},u=function(){return s.Buffer?function(e){return(A.create=function(e){return s.Buffer.isBuffer(e)?new n(e):l(e)})(e)}:l};function h(){var e=new i(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function d(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw a(this,8);return new i(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}A.create=u(),A.prototype._slice=s.Array.prototype.subarray||s.Array.prototype.slice,A.prototype.uint32=(c=4294967295,function(){if(c=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return c;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return c}),A.prototype.int32=function(){return 0|this.uint32()},A.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},A.prototype.bool=function(){return 0!==this.uint32()},A.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return d(this.buf,this.pos+=4)},A.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|d(this.buf,this.pos+=4)},A.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=s.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},A.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=s.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},A.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},A.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},A.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},A.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},A._configure=function(e){n=e,A.create=u(),n._configure();var t=s.Long?"toLong":"toNumber";s.merge(A.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},50593:function(e,t,r){"use strict";e.exports=i;var n=r(51408);(i.prototype=Object.create(n.prototype)).constructor=i;var s=r(99693);function i(e){n.call(this,e)}i._configure=function(){s.Buffer&&(i.prototype._slice=s.Buffer.prototype.slice)},i.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},i._configure()},85054:function(e){"use strict";e.exports={}},35994:function(e,t,r){"use strict";t.Service=r(77948)},77948:function(e,t,r){"use strict";e.exports=s;var n=r(99693);function s(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(s.prototype=Object.create(n.EventEmitter.prototype)).constructor=s,s.prototype.rpcCall=function e(t,r,s,i,o){if(!i)throw TypeError("request must be specified");var a=this;if(!o)return n.asPromise(e,a,t,r,s,i);if(a.rpcImpl)try{return a.rpcImpl(t,r[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,r){if(e)return a.emit("error",e,t),o(e);if(null!==r){if(!(r instanceof s))try{r=s[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return a.emit("error",e,t),o(e)}return a.emit("data",r,t),o(null,r)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){o(e)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},s.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},1945:function(e,t,r){"use strict";e.exports=s;var n=r(99693);function s(e,t){this.lo=e>>>0,this.hi=t>>>0}var i=s.zero=new s(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var o=s.zeroHash="\0\0\0\0\0\0\0\0";s.fromNumber=function(e){if(0===e)return i;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new s(r,n)},s.from=function(e){if("number"==typeof e)return s.fromNumber(e);if(n.isString(e)){if(!n.Long)return s.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new s(e.low>>>0,e.high>>>0):i},s.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},s.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;s.fromHash=function(e){return e===o?i:new s((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},s.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},s.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},s.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},s.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},99693:function(e,t,r){"use strict";var n=t;function s(e,t,r){for(var n=Object.keys(t),s=0;s<n.length;++s)void 0!==e[n[s]]&&r||(e[n[s]]=t[n[s]]);return e}function i(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&s(this,r)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}n.asPromise=r(34537),n.base64=r(97419),n.EventEmitter=r(19211),n.float=r(10945),n.inquire=r(67199),n.utf8=r(94997),n.pool=r(76662),n.LongBits=r(1945),n.isNode=Boolean(void 0!==r.g&&r.g&&r.g.process&&r.g.process.versions&&r.g.process.versions.node),n.global=n.isNode&&r.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var r=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},n.merge=s,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=i,n.ProtocolError=i("ProtocolError"),n.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},n.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},41173:function(e,t,r){"use strict";e.exports=u;var n,s=r(99693),i=s.LongBits,o=s.base64,a=s.utf8;function A(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function c(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function u(){this.len=0,this.head=new A(c,0,0),this.tail=this.head,this.states=null}var h=function(){return s.Buffer?function(){return(u.create=function(){return new n})()}:function(){return new u}};function d(e,t,r){t[r]=255&e}function f(e,t){this.len=e,this.next=void 0,this.val=t}function p(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function g(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}u.create=h(),u.alloc=function(e){return new s.Array(e)},s.Array!==Array&&(u.alloc=s.pool(u.alloc,s.Array.prototype.subarray)),u.prototype._push=function(e,t,r){return this.tail=this.tail.next=new A(e,t,r),this.len+=t,this},f.prototype=Object.create(A.prototype),f.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},u.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},u.prototype.int32=function(e){return e<0?this._push(p,10,i.fromNumber(e)):this.uint32(e)},u.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},u.prototype.uint64=function(e){var t=i.from(e);return this._push(p,t.length(),t)},u.prototype.int64=u.prototype.uint64,u.prototype.sint64=function(e){var t=i.from(e).zzEncode();return this._push(p,t.length(),t)},u.prototype.bool=function(e){return this._push(d,1,e?1:0)},u.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},u.prototype.sfixed32=u.prototype.fixed32,u.prototype.fixed64=function(e){var t=i.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},u.prototype.sfixed64=u.prototype.fixed64,u.prototype.float=function(e){return this._push(s.float.writeFloatLE,4,e)},u.prototype.double=function(e){return this._push(s.float.writeDoubleLE,8,e)};var y=s.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};u.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(d,1,0);if(s.isString(e)){var r=u.alloc(t=o.length(e));o.decode(e,r,0),e=r}return this.uint32(t)._push(y,t,e)},u.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(d,1,0)},u.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new A(c,0,0),this.len=0,this},u.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new A(c,0,0),this.len=0),this},u.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},u.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},u._configure=function(e){n=e,u.create=h(),n._configure()}},43155:function(e,t,r){"use strict";e.exports=i;var n=r(41173);(i.prototype=Object.create(n.prototype)).constructor=i;var s=r(99693);function i(){n.call(this)}function o(e,t,r){e.length<40?s.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}i._configure=function(){i.alloc=s._Buffer_allocUnsafe,i.writeBytesBuffer=s.Buffer&&s.Buffer.prototype instanceof Uint8Array&&"set"===s.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},i.prototype.bytes=function(e){s.isString(e)&&(e=s._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(i.writeBytesBuffer,t,e),this},i.prototype.string=function(e){var t=s.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},i._configure()},54375:function(e,t,r){let n;e.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:r.g):e=>(n||(n=Promise.resolve())).then(e).catch((e=>setTimeout((()=>{throw e}),0)))},33286:function(e,t,r){const{instantiate:n}=r(19824);function s(e={}){if(!s.supported)return null;var t=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return n(new Response(new Blob([t],{type:"application/wasm"})),e)}s.supported="undefined"!=typeof WebAssembly,e.exports=s},63060:function(e,t,r){const n=r(57118),s=r(33286);e.exports={Rabin:n,create:async(e,t,r,i,o)=>{const a=await s();return new n(a,e,t,r,i,o)}}},57118:function(e){e.exports=class{constructor(e,t=12,r=8192,n=32768,s=64,i){this.bits=t,this.min=r,this.max=n,this.asModule=e,this.rabin=new e.Rabin(t,r,n,s,i),this.polynomial=i}fingerprint(e){const{__retain:t,__release:r,__allocArray:n,__getInt32Array:s,Int32Array_ID:i,Uint8Array_ID:o}=this.asModule,a=t(n(i,new Int32Array(Math.ceil(e.length/this.min)))),A=t(n(o,e)),c=s(this.rabin.fingerprint(A,a));r(A),r(a);const l=c.indexOf(0);return l>=0?c.subarray(0,l):c}}},61798:function(e,t,r){"use strict";var n=r(34155),s=65536,i=4294967295;var o=r(89509).Buffer,a=r.g.crypto||r.g.msCrypto;a&&a.getRandomValues?e.exports=function(e,t){if(e>i)throw new RangeError("requested too many random bytes");var r=o.allocUnsafe(e);if(e>0)if(e>s)for(var A=0;A<e;A+=s)a.getRandomValues(r.slice(A,A+s));else a.getRandomValues(r);if("function"==typeof t)return n.nextTick((function(){t(null,r)}));return r}:e.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}},8558:function(e,t,r){const n=r(14636),s=r(81391),i=r(54156),o=r(4832),{RateLimiterClusterMaster:a,RateLimiterClusterMasterPM2:A,RateLimiterCluster:c}=r(91713),l=r(22288),u=r(45105),h=r(60911),d=r(33766),f=r(78686),p=r(73328),g=r(15155);e.exports={RateLimiterRedis:n,RateLimiterMongo:s,RateLimiterMySQL:i,RateLimiterPostgres:o,RateLimiterMemory:l,RateLimiterMemcache:u,RateLimiterClusterMaster:a,RateLimiterClusterMasterPM2:A,RateLimiterCluster:c,RLWrapperBlackAndWhite:h,RateLimiterUnion:d,RateLimiterQueue:f,BurstyRateLimiter:p,RateLimiterRes:g}},73328:function(e,t,r){const n=r(15155);e.exports=class{constructor(e,t){this._rateLimiter=e,this._burstLimiter=t}_combineRes(e,t){return new n(e.remainingPoints,Math.min(e.msBeforeNext,t.msBeforeNext),e.consumedPoints,e.isFirstInDuration)}consume(e,t=1,r={}){return this._rateLimiter.consume(e,t,r).catch((s=>s instanceof n?this._burstLimiter.consume(e,t,r).then((e=>Promise.resolve(this._combineRes(s,e)))).catch((e=>e instanceof n?Promise.reject(this._combineRes(s,e)):Promise.reject(e))):Promise.reject(s)))}get(e){return Promise.all([this._rateLimiter.get(e),this._burstLimiter.get(e)]).then((([e,t])=>this._combineRes(e,t)))}get points(){return this._rateLimiter.points}}},60911:function(e,t,r){const n=r(15155);e.exports=class{constructor(e={}){this.limiter=e.limiter,this.blackList=e.blackList,this.whiteList=e.whiteList,this.isBlackListed=e.isBlackListed,this.isWhiteListed=e.isWhiteListed,this.runActionAnyway=e.runActionAnyway}get limiter(){return this._limiter}set limiter(e){if(void 0===e)throw new Error("limiter is not set");this._limiter=e}get runActionAnyway(){return this._runActionAnyway}set runActionAnyway(e){this._runActionAnyway=void 0!==e&&e}get blackList(){return this._blackList}set blackList(e){this._blackList=Array.isArray(e)?e:[]}get isBlackListed(){return this._isBlackListed}set isBlackListed(e){if(void 0===e&&(e=()=>!1),"function"!=typeof e)throw new Error("isBlackListed must be function");this._isBlackListed=e}get whiteList(){return this._whiteList}set whiteList(e){this._whiteList=Array.isArray(e)?e:[]}get isWhiteListed(){return this._isWhiteListed}set isWhiteListed(e){if(void 0===e&&(e=()=>!1),"function"!=typeof e)throw new Error("isWhiteListed must be function");this._isWhiteListed=e}isBlackListedSomewhere(e){return this.blackList.indexOf(e)>=0||this.isBlackListed(e)}isWhiteListedSomewhere(e){return this.whiteList.indexOf(e)>=0||this.isWhiteListed(e)}getBlackRes(){return new n(0,Number.MAX_SAFE_INTEGER,0,!1)}getWhiteRes(){return new n(Number.MAX_SAFE_INTEGER,0,0,!1)}rejectBlack(){return Promise.reject(this.getBlackRes())}resolveBlack(){return Promise.resolve(this.getBlackRes())}resolveWhite(){return Promise.resolve(this.getWhiteRes())}consume(e,t=1){let r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.rejectBlack()),void 0===r?this.limiter.consume(e,t):(this.runActionAnyway&&this.limiter.consume(e,t).catch((()=>{})),r)}block(e,t){let r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.resolveBlack()),void 0===r?this.limiter.block(e,t):(this.runActionAnyway&&this.limiter.block(e,t).catch((()=>{})),r)}penalty(e,t){let r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.resolveBlack()),void 0===r?this.limiter.penalty(e,t):(this.runActionAnyway&&this.limiter.penalty(e,t).catch((()=>{})),r)}reward(e,t){let r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.resolveBlack()),void 0===r?this.limiter.reward(e,t):(this.runActionAnyway&&this.limiter.reward(e,t).catch((()=>{})),r)}get(e){let t;return this.isWhiteListedSomewhere(e)?t=this.resolveWhite():this.isBlackListedSomewhere(e)&&(t=this.resolveBlack()),void 0===t||this.runActionAnyway?this.limiter.get(e):t}delete(e){return this.limiter.delete(e)}}},81352:function(e){e.exports=class{constructor(e={}){this.points=e.points,this.duration=e.duration,this.blockDuration=e.blockDuration,this.execEvenly=e.execEvenly,this.execEvenlyMinDelayMs=e.execEvenlyMinDelayMs,this.keyPrefix=e.keyPrefix}get points(){return this._points}set points(e){this._points=e>=0?e:4}get duration(){return this._duration}set duration(e){this._duration=void 0===e?1:e}get msDuration(){return 1e3*this.duration}get blockDuration(){return this._blockDuration}set blockDuration(e){this._blockDuration=void 0===e?0:e}get msBlockDuration(){return 1e3*this.blockDuration}get execEvenly(){return this._execEvenly}set execEvenly(e){this._execEvenly=void 0!==e&&Boolean(e)}get execEvenlyMinDelayMs(){return this._execEvenlyMinDelayMs}set execEvenlyMinDelayMs(e){this._execEvenlyMinDelayMs=void 0===e?Math.ceil(this.msDuration/this.points):e}get keyPrefix(){return this._keyPrefix}set keyPrefix(e){if(void 0===e&&(e="rlflx"),"string"!=typeof e)throw new Error("keyPrefix must be string");this._keyPrefix=e}_getKeySecDuration(e={}){return e&&e.customDuration>=0?e.customDuration:this.duration}getKey(e){return this.keyPrefix.length>0?`${this.keyPrefix}:${e}`:e}parseKey(e){return e.substring(this.keyPrefix.length)}consume(){throw new Error("You have to implement the method 'consume'!")}penalty(){throw new Error("You have to implement the method 'penalty'!")}reward(){throw new Error("You have to implement the method 'reward'!")}get(){throw new Error("You have to implement the method 'get'!")}set(){throw new Error("You have to implement the method 'set'!")}block(){throw new Error("You have to implement the method 'block'!")}delete(){throw new Error("You have to implement the method 'delete'!")}}},91713:function(e,t,r){var n=r(34155);const s=r(81265),i=r(35539),o=r(81352),a=r(22288),A=r(15155),c="rate_limiter_flexible";let l=null;const u=function(e,t,r,n){let s;s=null===n||!0===n||!1===n?n:{remainingPoints:n.remainingPoints,msBeforeNext:n.msBeforeNext,consumedPoints:n.consumedPoints,isFirstInDuration:n.isFirstInDuration},e.send({channel:c,keyPrefix:t.keyPrefix,promiseId:t.promiseId,type:r,data:s})},h=function(e){setTimeout((()=>{this._initiated?n.send(e):void 0!==this._promises[e.promiseId]&&h.call(this,e)}),30)},d=function(e,t,r,s,i){const o={channel:c,keyPrefix:this.keyPrefix,func:e,promiseId:t,data:{key:r,arg:s,opts:i}};this._initiated?n.send(o):h.call(this,o)},f=function(e,t){if(!t||t.channel!==c||void 0===this._rateLimiters[t.keyPrefix])return!1;let r;switch(t.func){case"consume":r=this._rateLimiters[t.keyPrefix].consume(t.data.key,t.data.arg,t.data.opts);break;case"penalty":r=this._rateLimiters[t.keyPrefix].penalty(t.data.key,t.data.arg,t.data.opts);break;case"reward":r=this._rateLimiters[t.keyPrefix].reward(t.data.key,t.data.arg,t.data.opts);break;case"block":r=this._rateLimiters[t.keyPrefix].block(t.data.key,t.data.arg,t.data.opts);break;case"get":r=this._rateLimiters[t.keyPrefix].get(t.data.key,t.data.opts);break;case"delete":r=this._rateLimiters[t.keyPrefix].delete(t.data.key,t.data.opts);break;default:return!1}r&&r.then((r=>{u(e,t,"resolve",r)})).catch((r=>{u(e,t,"reject",r)}))},p=function(e){if(!e||e.channel!==c||e.keyPrefix!==this.keyPrefix)return!1;if(this._promises[e.promiseId]){let t;switch(clearTimeout(this._promises[e.promiseId].timeoutId),t=null===e.data||!0===e.data||!1===e.data?e.data:new A(e.data.remainingPoints,e.data.msBeforeNext,e.data.consumedPoints,e.data.isFirstInDuration),e.type){case"resolve":this._promises[e.promiseId].resolve(t);break;case"reject":this._promises[e.promiseId].reject(t);break;default:throw new Error(`RateLimiterCluster: no such message type '${e.type}'`)}delete this._promises[e.promiseId]}},g=function(){return{points:this.points,duration:this.duration,blockDuration:this.blockDuration,execEvenly:this.execEvenly,execEvenlyMinDelayMs:this.execEvenlyMinDelayMs,keyPrefix:this.keyPrefix}},y=function(e,t){const r=n.hrtime();let s=r[0].toString()+r[1].toString();return void 0!==this._promises[s]&&(s+=i.randomBytes(12).toString("base64")),this._promises[s]={resolve:e,reject:t,timeoutId:setTimeout((()=>{delete this._promises[s],t(new Error("RateLimiterCluster timeout: no answer from master in time"))}),this.timeoutMs)},s};e.exports={RateLimiterClusterMaster:class{constructor(){if(l)return l;this._rateLimiters={},s.setMaxListeners(0),s.on("message",((e,t)=>{t&&t.channel===c&&"init"===t.type?(void 0===this._rateLimiters[t.opts.keyPrefix]&&(this._rateLimiters[t.opts.keyPrefix]=new a(t.opts)),e.send({channel:c,type:"init",keyPrefix:t.opts.keyPrefix})):f.call(this,e,t)})),l=this}},RateLimiterClusterMasterPM2:class{constructor(e){if(l)return l;this._rateLimiters={},e.launchBus(((t,r)=>{r.on("process:msg",(t=>{const r=t.raw;if(r&&r.channel===c&&"init"===r.type)void 0===this._rateLimiters[r.opts.keyPrefix]&&(this._rateLimiters[r.opts.keyPrefix]=new a(r.opts)),e.sendDataToProcessId(t.process.pm_id,{data:{},topic:c,channel:c,type:"init",keyPrefix:r.opts.keyPrefix},((e,t)=>{e&&console.log(e,t)}));else{f.call(this,{send:r=>{const n=r;n.topic=c,void 0===n.data&&(n.data={}),e.sendDataToProcessId(t.process.pm_id,n,((e,t)=>{e&&console.log(e,t)}))}},r)}}))})),l=this}},RateLimiterCluster:class extends o{get timeoutMs(){return this._timeoutMs}set timeoutMs(e){this._timeoutMs=void 0===e?5e3:Math.abs(parseInt(e))}constructor(e={}){super(e),n.setMaxListeners(0),this.timeoutMs=e.timeoutMs,this._initiated=!1,n.on("message",(e=>{e&&e.channel===c&&"init"===e.type&&e.keyPrefix===this.keyPrefix?this._initiated=!0:p.call(this,e)})),n.send({channel:c,type:"init",opts:g.call(this)}),this._promises={}}consume(e,t=1,r={}){return new Promise(((n,s)=>{const i=y.call(this,n,s);d.call(this,"consume",i,e,t,r)}))}penalty(e,t=1,r={}){return new Promise(((n,s)=>{const i=y.call(this,n,s);d.call(this,"penalty",i,e,t,r)}))}reward(e,t=1,r={}){return new Promise(((n,s)=>{const i=y.call(this,n,s);d.call(this,"reward",i,e,t,r)}))}block(e,t,r={}){return new Promise(((n,s)=>{const i=y.call(this,n,s);d.call(this,"block",i,e,t,r)}))}get(e,t={}){return new Promise(((r,n)=>{const s=y.call(this,r,n);d.call(this,"get",s,e,t)}))}delete(e,t={}){return new Promise(((r,n)=>{const s=y.call(this,r,n);d.call(this,"delete",s,e,t)}))}}}},45105:function(e,t,r){const n=r(91090),s=r(15155);e.exports=class extends n{constructor(e){super(e),this.client=e.storeClient}_getRateLimiterRes(e,t,r){const n=new s;return n.consumedPoints=parseInt(r.consumedPoints),n.isFirstInDuration=r.consumedPoints===t,n.remainingPoints=Math.max(this.points-n.consumedPoints,0),n.msBeforeNext=r.msBeforeNext,n}_upsert(e,t,r,n=!1,s={}){return new Promise(((i,o)=>{const a=Date.now(),A=Math.floor(r/1e3);n?this.client.set(e,t,A,(r=>{r?o(r):this.client.set(`${e}_expire`,A>0?a+1e3*A:-1,A,(()=>{i({consumedPoints:t,msBeforeNext:A>0?1e3*A:-1})}))})):this.client.incr(e,t,((c,l)=>{c||!1===l?this.client.add(e,t,A,((c,l)=>{if(c||!l)if(void 0===s.attemptNumber||s.attemptNumber<3){const a=Object.assign({},s);a.attemptNumber=a.attemptNumber?a.attemptNumber+1:1,this._upsert(e,t,r,n,a).then((e=>i(e))).catch((e=>o(e)))}else o(new Error("Can not add key"));else this.client.add(`${e}_expire`,A>0?a+1e3*A:-1,A,(()=>{i({consumedPoints:t,msBeforeNext:A>0?1e3*A:-1})}))})):this.client.get(`${e}_expire`,((e,t)=>{if(e)o(e);else{const e=!1===t?0:t,r={consumedPoints:l,msBeforeNext:e>=0?Math.max(e-a,0):-1};i(r)}}))}))}))}_get(e){return new Promise(((t,r)=>{const n=Date.now();this.client.get(e,((s,i)=>{i?this.client.get(`${e}_expire`,((e,s)=>{if(e)r(e);else{const e=!1===s?0:s,r={consumedPoints:i,msBeforeNext:e>=0?Math.max(e-n,0):-1};t(r)}})):t(null)}))}))}_delete(e){return new Promise(((t,r)=>{this.client.del(e,((n,s)=>{n?r(n):!1===s?t(s):this.client.del(`${e}_expire`,(e=>{e?r(e):t(s)}))}))}))}}},22288:function(e,t,r){const n=r(81352),s=r(58425),i=r(15155);e.exports=class extends n{constructor(e={}){super(e),this._memoryStorage=new s}consume(e,t=1,r={}){return new Promise(((n,s)=>{const i=this.getKey(e),o=this._getKeySecDuration(r);let a=this._memoryStorage.incrby(i,t,o);if(a.remainingPoints=Math.max(this.points-a.consumedPoints,0),a.consumedPoints>this.points)this.blockDuration>0&&a.consumedPoints<=this.points+t&&(a=this._memoryStorage.set(i,a.consumedPoints,this.blockDuration)),s(a);else if(this.execEvenly&&a.msBeforeNext>0&&!a.isFirstInDuration){let e=Math.ceil(a.msBeforeNext/(a.remainingPoints+2));e<this.execEvenlyMinDelayMs&&(e=a.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(n,e,a)}else n(a)}))}penalty(e,t=1,r={}){const n=this.getKey(e);return new Promise((e=>{const s=this._getKeySecDuration(r),i=this._memoryStorage.incrby(n,t,s);i.remainingPoints=Math.max(this.points-i.consumedPoints,0),e(i)}))}reward(e,t=1,r={}){const n=this.getKey(e);return new Promise((e=>{const s=this._getKeySecDuration(r),i=this._memoryStorage.incrby(n,-t,s);i.remainingPoints=Math.max(this.points-i.consumedPoints,0),e(i)}))}block(e,t){const r=1e3*t,n=this.points+1;return this._memoryStorage.set(this.getKey(e),n,t),Promise.resolve(new i(0,0===r?-1:r,n))}set(e,t,r){const n=1e3*(r>=0?r:this.duration);return this._memoryStorage.set(this.getKey(e),t,r),Promise.resolve(new i(0,0===n?-1:n,t))}get(e){const t=this._memoryStorage.get(this.getKey(e));return null!==t&&(t.remainingPoints=Math.max(this.points-t.consumedPoints,0)),Promise.resolve(t)}delete(e){return Promise.resolve(this._memoryStorage.delete(this.getKey(e)))}}},81391:function(e,t,r){const n=r(91090),s=r(15155);function i(e){try{const t=e.client?e.client:e,{version:r}=t.topology.s.options.metadata.driver,n=r.split(".").map((e=>parseInt(e)));return{major:n[0],feature:n[1],patch:n[2]}}catch(e){return{major:0,feature:0,patch:0}}}class o extends n{constructor(e){super(e),this.dbName=e.dbName,this.tableName=e.tableName,this.indexKeyPrefix=e.indexKeyPrefix,e.mongo?this.client=e.mongo:this.client=e.storeClient,"function"==typeof this.client.then?this.client.then((e=>{this.client=e,this._initCollection(),this._driverVersion=i(this.client)})):(this._initCollection(),this._driverVersion=i(this.client))}get dbName(){return this._dbName}set dbName(e){this._dbName=void 0===e?o.getDbName():e}static getDbName(){return"node-rate-limiter-flexible"}get tableName(){return this._tableName}set tableName(e){this._tableName=void 0===e?this.keyPrefix:e}get client(){return this._client}set client(e){if(void 0===e)throw new Error("mongo is not set");this._client=e}get indexKeyPrefix(){return this._indexKeyPrefix}set indexKeyPrefix(e){this._indexKeyPrefix=e||{}}_initCollection(){const e=("function"==typeof this.client.db?this.client.db(this.dbName):this.client).collection(this.tableName);e.createIndex({expire:-1},{expireAfterSeconds:0}),e.createIndex(Object.assign({},this.indexKeyPrefix,{key:1}),{unique:!0}),this._collection=e}_getRateLimiterRes(e,t,r){const n=new s;let i;return i=void 0===r.value?r:r.value,n.isFirstInDuration=i.points===t,n.consumedPoints=i.points,n.remainingPoints=Math.max(this.points-n.consumedPoints,0),n.msBeforeNext=null!==i.expire?Math.max(new Date(i.expire).getTime()-Date.now(),0):-1,n}_upsert(e,t,r,n=!1,s={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const i=s.attrs||{};let o,a;n?(o={key:e},o=Object.assign(o,i),a={$set:{key:e,points:t,expire:r>0?new Date(Date.now()+r):null}},a.$set=Object.assign(a.$set,i)):(o={$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}],key:e},o=Object.assign(o,i),a={$setOnInsert:{key:e,expire:r>0?new Date(Date.now()+r):null},$inc:{points:t}},a.$setOnInsert=Object.assign(a.$setOnInsert,i));const A={upsert:!0};return this._driverVersion.major>=4||3===this._driverVersion.major&&this._driverVersion.feature>=7||this._driverVersion.feature>=6&&this._driverVersion.patch>=7?A.returnDocument="after":A.returnOriginal=!1,new Promise(((s,c)=>{this._collection.findOneAndUpdate(o,a,A).then((e=>{s(e)})).catch((o=>{if(o&&11e3===o.code){const o=Object.assign({$or:[{expire:{$lte:new Date}},{expire:{$eq:null}}],key:e},i),a={$set:Object.assign({key:e,points:t,expire:r>0?new Date(Date.now()+r):null},i)};this._collection.findOneAndUpdate(o,a,A).then((e=>{s(e)})).catch((i=>{i&&11e3===i.code?this._upsert(e,t,r,n).then((e=>s(e))).catch((e=>c(e))):c(i)}))}else c(o)}))}))}_get(e,t={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const r=t.attrs||{},n=Object.assign({key:e,$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}]},r);return this._collection.findOne(n)}_delete(e,t={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const r=t.attrs||{},n=Object.assign({key:e},r);return this._collection.deleteOne(n).then((e=>e.deletedCount>0))}}e.exports=o},54156:function(e,t,r){const n=r(91090),s=r(15155);e.exports=class extends n{constructor(e,t=null){super(e),this.client=e.storeClient,this.clientType=e.storeType,this.dbName=e.dbName,this.tableName=e.tableName,this.clearExpiredByTimeout=e.clearExpiredByTimeout,this.tableCreated=e.tableCreated,this.tableCreated?(this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"==typeof t&&t()):this._createDbAndTable().then((()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"==typeof t&&t()})).catch((e=>{if("function"!=typeof t)throw e;t(e)}))}clearExpired(e){return new Promise((t=>{this._getConnection().then((r=>{r.query("DELETE FROM ??.?? WHERE expire < ?",[this.dbName,this.tableName,e],(()=>{this._releaseConnection(r),t()}))})).catch((()=>{t()}))}))}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout((()=>{this.clearExpired(Date.now()-36e5).then((()=>{this._clearExpiredHourAgo()}))}),3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":return new Promise(((e,t)=>{this.client.getConnection(((r,n)=>{if(r)return t(r);e(n)}))}));case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();default:return Promise.resolve(this.client)}}_releaseConnection(e){switch(this.clientType){case"pool":return e.release();case"sequelize":return this.client.connectionManager.releaseConnection(e);case"knex":return this.client.client.releaseConnection(e);default:return!0}}_createDbAndTable(){return new Promise(((e,t)=>{this._getConnection().then((r=>{r.query(`CREATE DATABASE IF NOT EXISTS \`${this.dbName}\`;`,(n=>{if(n)return this._releaseConnection(r),t(n);r.query(this._getCreateTableStmt(),(n=>{if(n)return this._releaseConnection(r),t(n);this._releaseConnection(r),e()}))}))})).catch((e=>{t(e)}))}))}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS \`${this.dbName}\`.\`${this.tableName}\` (\`key\` VARCHAR(255) CHARACTER SET utf8 NOT NULL,\`points\` INT(9) NOT NULL default 0,\`expire\` BIGINT UNSIGNED,PRIMARY KEY (\`key\`)) ENGINE = INNODB;`}get clientType(){return this._clientType}set clientType(e){if(void 0===e)if("Connection"===this.client.constructor.name)e="connection";else if("Pool"===this.client.constructor.name)e="pool";else{if("Sequelize"!==this.client.constructor.name)throw new Error("storeType is not defined");e="sequelize"}this._clientType=e.toLowerCase()}get dbName(){return this._dbName}set dbName(e){this._dbName=void 0===e?"rtlmtrflx":e}get tableName(){return this._tableName}set tableName(e){this._tableName=void 0===e?this.keyPrefix:e}get tableCreated(){return this._tableCreated}set tableCreated(e){this._tableCreated=void 0!==e&&!!e}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(e){this._clearExpiredByTimeout=void 0===e||Boolean(e)}_getRateLimiterRes(e,t,r){const n=new s,[i]=r;return n.isFirstInDuration=t===i.points,n.consumedPoints=n.isFirstInDuration?t:i.points,n.remainingPoints=Math.max(this.points-n.consumedPoints,0),n.msBeforeNext=i.expire?Math.max(i.expire-Date.now(),0):-1,n}_upsertTransaction(e,t,r,n,s){return new Promise(((i,o)=>{e.query("BEGIN",(a=>{if(a)return e.rollback(),o(a);const A=Date.now(),c=n>0?A+n:null;let l,u;s?(l="INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = ?, \n            expire = ?;",u=[this.dbName,this.tableName,t,r,c,r,c]):(l="INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = IF(expire <= ?, ?, points + (?)), \n            expire = IF(expire <= ?, ?, expire);",u=[this.dbName,this.tableName,t,r,c,A,r,r,A,c]),e.query(l,u,(r=>{if(r)return e.rollback(),o(r);e.query("SELECT points, expire FROM ??.?? WHERE `key` = ?;",[this.dbName,this.tableName,t],((t,r)=>{if(t)return e.rollback(),o(t);e.query("COMMIT",(t=>{if(t)return e.rollback(),o(t);i(r)}))}))}))}))}))}_upsert(e,t,r,n=!1){return this.tableCreated?new Promise(((s,i)=>{this._getConnection().then((o=>{this._upsertTransaction(o,e,t,r,n).then((e=>{s(e),this._releaseConnection(o)})).catch((e=>{i(e),this._releaseConnection(o)}))})).catch((e=>{i(e)}))})):Promise.reject(Error("Table is not created yet"))}_get(e){return this.tableCreated?new Promise(((t,r)=>{this._getConnection().then((n=>{n.query("SELECT points, expire FROM ??.?? WHERE `key` = ? AND (`expire` > ? OR `expire` IS NULL)",[this.dbName,this.tableName,e,Date.now()],((e,s)=>{e?r(e):0===s.length?t(null):t(s),this._releaseConnection(n)}))})).catch((e=>{r(e)}))})):Promise.reject(Error("Table is not created yet"))}_delete(e){return this.tableCreated?new Promise(((t,r)=>{this._getConnection().then((n=>{n.query("DELETE FROM ??.?? WHERE `key` = ?",[this.dbName,this.tableName,e],((e,s)=>{e?r(e):t(s.affectedRows>0),this._releaseConnection(n)}))})).catch((e=>{r(e)}))})):Promise.reject(Error("Table is not created yet"))}}},4832:function(e,t,r){const n=r(91090),s=r(15155);e.exports=class extends n{constructor(e,t=null){super(e),this.client=e.storeClient,this.clientType=e.storeType,this.tableName=e.tableName,this.clearExpiredByTimeout=e.clearExpiredByTimeout,this.tableCreated=e.tableCreated,this.tableCreated?"function"==typeof t&&t():this._createTable().then((()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"==typeof t&&t()})).catch((e=>{if("function"!=typeof t)throw e;t(e)}))}clearExpired(e){return new Promise((t=>{const r={name:"rlflx-clear-expired",text:`DELETE FROM ${this.tableName} WHERE expire < $1`,values:[e]};this._query(r).then((()=>{t()})).catch((()=>{t()}))}))}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout((()=>{this.clearExpired(Date.now()-36e5).then((()=>{this._clearExpiredHourAgo()}))}),3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":default:return Promise.resolve(this.client);case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();case"typeorm":return Promise.resolve(this.client.driver.master)}}_releaseConnection(e){switch(this.clientType){case"pool":case"typeorm":default:return!0;case"sequelize":return this.client.connectionManager.releaseConnection(e);case"knex":return this.client.client.releaseConnection(e)}}_createTable(){return new Promise(((e,t)=>{this._query({text:this._getCreateTableStmt()}).then((()=>{e()})).catch((r=>{"23505"===r.code?e():t(r)}))}))}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS ${this.tableName} ( \n      key varchar(255) PRIMARY KEY,\n      points integer NOT NULL DEFAULT 0,\n      expire bigint\n    );`}get clientType(){return this._clientType}set clientType(e){const t=this.client.constructor.name;if(void 0===e)if("Client"===t)e="client";else if("Pool"===t||"BoundPool"===t)e="pool";else{if("Sequelize"!==t)throw new Error("storeType is not defined");e="sequelize"}this._clientType=e.toLowerCase()}get tableName(){return this._tableName}set tableName(e){this._tableName=void 0===e?this.keyPrefix:e}get tableCreated(){return this._tableCreated}set tableCreated(e){this._tableCreated=void 0!==e&&!!e}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(e){this._clearExpiredByTimeout=void 0===e||Boolean(e)}_getRateLimiterRes(e,t,r){const n=new s,i=r.rows[0];return n.isFirstInDuration=t===i.points,n.consumedPoints=n.isFirstInDuration?t:i.points,n.remainingPoints=Math.max(this.points-n.consumedPoints,0),n.msBeforeNext=i.expire?Math.max(i.expire-Date.now(),0):-1,n}_query(e){const t={name:`${this.tableName.toLowerCase()}:${e.name}`,text:e.text,values:e.values};return new Promise(((e,r)=>{this._getConnection().then((n=>{n.query(t).then((t=>{e(t),this._releaseConnection(n)})).catch((e=>{r(e),this._releaseConnection(n)}))})).catch((e=>{r(e)}))}))}_upsert(e,t,r,n=!1){if(!this.tableCreated)return Promise.reject(Error("Table is not created yet"));const s=r>0?Date.now()+r:null,i=n?" $3 ":` CASE\n             WHEN ${this.tableName}.expire <= $4 THEN $3\n             ELSE ${this.tableName}.expire\n            END `;return this._query({name:n?"rlflx-upsert-force":"rlflx-upsert",text:`\n            INSERT INTO ${this.tableName} VALUES ($1, $2, $3)\n              ON CONFLICT(key) DO UPDATE SET\n                points = CASE\n                          WHEN (${this.tableName}.expire <= $4 OR 1=${n?1:0}) THEN $2\n                          ELSE ${this.tableName}.points + ($2)\n                         END,\n                expire = ${i}\n            RETURNING points, expire;`,values:[e,t,s,Date.now()]})}_get(e){return this.tableCreated?new Promise(((t,r)=>{this._query({name:"rlflx-get",text:`\n            SELECT points, expire FROM ${this.tableName} WHERE key = $1 AND (expire > $2 OR expire IS NULL);`,values:[e,Date.now()]}).then((e=>{0===e.rowCount&&(e=null),t(e)})).catch((e=>{r(e)}))})):Promise.reject(Error("Table is not created yet"))}_delete(e){return this.tableCreated?this._query({name:"rlflx-delete",text:`DELETE FROM ${this.tableName} WHERE key = $1`,values:[e]}).then((e=>e.rowCount>0)):Promise.reject(Error("Table is not created yet"))}}},78686:function(e,t,r){const n=r(45255),s=4294967295,i="limiter";e.exports=class{constructor(e,t={maxQueueSize:s}){this._queueLimiters={KEY_DEFAULT:new o(e,t)},this._limiterFlexible=e,this._maxQueueSize=t.maxQueueSize}getTokensRemaining(e=i){return this._queueLimiters[e]?this._queueLimiters[e].getTokensRemaining():Promise.resolve(this._limiterFlexible.points)}removeTokens(e,t=i){return this._queueLimiters[t]||(this._queueLimiters[t]=new o(this._limiterFlexible,{key:t,maxQueueSize:this._maxQueueSize})),this._queueLimiters[t].removeTokens(e)}};class o{constructor(e,t={maxQueueSize:s,key:i}){this._key=t.key,this._waitTimeout=null,this._queue=[],this._limiterFlexible=e,this._maxQueueSize=t.maxQueueSize}getTokensRemaining(){return this._limiterFlexible.get(this._key).then((e=>null!==e?e.remainingPoints:this._limiterFlexible.points))}removeTokens(e){const t=this;return new Promise(((r,s)=>{e>t._limiterFlexible.points?s(new n(`Requested tokens ${e} exceeds maximum ${t._limiterFlexible.points} tokens per interval`)):t._queue.length>0?t._queueRequest.call(t,r,s,e):t._limiterFlexible.consume(t._key,e).then((e=>{r(e.remainingPoints)})).catch((n=>{n instanceof Error?s(n):(t._queueRequest.call(t,r,s,e),null===t._waitTimeout&&(t._waitTimeout=setTimeout(t._processFIFO.bind(t),n.msBeforeNext)))}))}))}_queueRequest(e,t,r){const s=this;s._queue.length<s._maxQueueSize?s._queue.push({resolve:e,reject:t,tokens:r}):t(new n(`Number of requests reached it's maximum ${s._maxQueueSize}`))}_processFIFO(){const e=this;if(null!==e._waitTimeout&&(clearTimeout(e._waitTimeout),e._waitTimeout=null),0===e._queue.length)return;const t=e._queue.shift();e._limiterFlexible.consume(e._key,t.tokens).then((r=>{t.resolve(r.remainingPoints),e._processFIFO.call(e)})).catch((r=>{r instanceof Error?(t.reject(r),e._processFIFO.call(e)):(e._queue.unshift(t),null===e._waitTimeout&&(e._waitTimeout=setTimeout(e._processFIFO.bind(e),r.msBeforeNext)))}))}}},14636:function(e,t,r){const n=r(91090),s=r(15155),i="redis.call('set', KEYS[1], 0, 'EX', ARGV[2], 'NX') local consumed = redis.call('incrby', KEYS[1], ARGV[1]) local ttl = redis.call('pttl', KEYS[1]) if ttl == -1 then   redis.call('expire', KEYS[1], ARGV[2])   ttl = 1000 * ARGV[2] end return {consumed, ttl} ";e.exports=class extends n{constructor(e){super(e),e.redis?this.client=e.redis:this.client=e.storeClient,this._rejectIfRedisNotReady=!!e.rejectIfRedisNotReady,"function"==typeof this.client.defineCommand&&this.client.defineCommand("rlflxIncr",{numberOfKeys:1,lua:i})}_isRedisReady(){return!this._rejectIfRedisNotReady||(!this.client.status||"ready"===this.client.status)&&!("function"==typeof this.client.isReady&&!this.client.isReady())}_getRateLimiterRes(e,t,r){let[n,i]=r;Array.isArray(n)&&([,n]=n,[,i]=i);const o=new s;return o.consumedPoints=parseInt(n),o.isFirstInDuration=o.consumedPoints===t,o.remainingPoints=Math.max(this.points-o.consumedPoints,0),o.msBeforeNext=i,o}_upsert(e,t,r,n=!1){return new Promise(((s,o)=>{if(!this._isRedisReady())return o(new Error("Redis connection is not ready"));const a=Math.floor(r/1e3),A=this.client.multi();if(n)a>0?A.set(e,t,"EX",a):A.set(e,t),A.pttl(e).exec(((e,t)=>e?o(e):s(t)));else if(a>0){const r=function(e,t){return e?o(e):s(t)};"function"==typeof this.client.rlflxIncr?this.client.rlflxIncr(e,t,a,r):this.client.eval(i,1,e,t,a,r)}else A.incrby(e,t).pttl(e).exec(((e,t)=>e?o(e):s(t)))}))}_get(e){return new Promise(((t,r)=>{if(!this._isRedisReady())return r(new Error("Redis connection is not ready"));this.client.multi().get(e).pttl(e).exec(((e,n)=>{if(e)r(e);else{const[e]=n;if(null===e)return t(null);t(n)}}))}))}_delete(e){return new Promise(((t,r)=>{this.client.del(e,((e,n)=>{e?r(e):t(n>0)}))}))}}},15155:function(e){e.exports=class{constructor(e,t,r,n){this.remainingPoints=void 0===e?0:e,this.msBeforeNext=void 0===t?0:t,this.consumedPoints=void 0===r?0:r,this.isFirstInDuration=void 0!==n&&n}get msBeforeNext(){return this._msBeforeNext}set msBeforeNext(e){return this._msBeforeNext=e,this}get remainingPoints(){return this._remainingPoints}set remainingPoints(e){return this._remainingPoints=e,this}get consumedPoints(){return this._consumedPoints}set consumedPoints(e){return this._consumedPoints=e,this}get isFirstInDuration(){return this._isFirstInDuration}set isFirstInDuration(e){this._isFirstInDuration=Boolean(e)}_getDecoratedProperties(){return{remainingPoints:this.remainingPoints,msBeforeNext:this.msBeforeNext,consumedPoints:this.consumedPoints,isFirstInDuration:this.isFirstInDuration}}[Symbol.for("nodejs.util.inspect.custom")](){return this._getDecoratedProperties()}toString(){return JSON.stringify(this._getDecoratedProperties())}toJSON(){return this._getDecoratedProperties()}}},91090:function(e,t,r){const n=r(81352),s=r(52423),i=r(15155);e.exports=class extends n{constructor(e={}){super(e),this.inMemoryBlockOnConsumed=e.inMemoryBlockOnConsumed||e.inmemoryBlockOnConsumed,this.inMemoryBlockDuration=e.inMemoryBlockDuration||e.inmemoryBlockDuration,this.insuranceLimiter=e.insuranceLimiter,this._inMemoryBlockedKeys=new s}get client(){return this._client}set client(e){if(void 0===e)throw new Error("storeClient is not set");this._client=e}_afterConsume(e,t,r,n,s,i={}){const o=this._getRateLimiterRes(r,n,s);if(this.inMemoryBlockOnConsumed>0&&!(this.inMemoryBlockDuration>0)&&o.consumedPoints>=this.inMemoryBlockOnConsumed)return this._inMemoryBlockedKeys.addMs(r,o.msBeforeNext),o.consumedPoints>this.points?t(o):e(o);if(o.consumedPoints>this.points){let e=Promise.resolve();this.blockDuration>0&&o.consumedPoints<=this.points+n&&(o.msBeforeNext=this.msBlockDuration,e=this._block(r,o.consumedPoints,this.msBlockDuration,i)),this.inMemoryBlockOnConsumed>0&&o.consumedPoints>=this.inMemoryBlockOnConsumed&&(this._inMemoryBlockedKeys.add(r,this.inMemoryBlockDuration),o.msBeforeNext=this.msInMemoryBlockDuration),e.then((()=>{t(o)})).catch((e=>{t(e)}))}else if(this.execEvenly&&o.msBeforeNext>0&&!o.isFirstInDuration){let t=Math.ceil(o.msBeforeNext/(o.remainingPoints+2));t<this.execEvenlyMinDelayMs&&(t=o.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(e,t,o)}else e(o)}_handleError(e,t,r,s,i,o=!1,a={}){this.insuranceLimiter instanceof n?this.insuranceLimiter[t](i,o,a).then((e=>{r(e)})).catch((e=>{s(e)})):s(e)}get _inmemoryBlockedKeys(){return this._inMemoryBlockedKeys}getInmemoryBlockMsBeforeExpire(e){return this.getInMemoryBlockMsBeforeExpire(e)}get inmemoryBlockOnConsumed(){return this.inMemoryBlockOnConsumed}set inmemoryBlockOnConsumed(e){this.inMemoryBlockOnConsumed=e}get inmemoryBlockDuration(){return this.inMemoryBlockDuration}set inmemoryBlockDuration(e){this.inMemoryBlockDuration=e}get msInmemoryBlockDuration(){return 1e3*this.inMemoryBlockDuration}getInMemoryBlockMsBeforeExpire(e){return this.inMemoryBlockOnConsumed>0?this._inMemoryBlockedKeys.msBeforeExpire(e):0}get inMemoryBlockOnConsumed(){return this._inMemoryBlockOnConsumed}set inMemoryBlockOnConsumed(e){if(this._inMemoryBlockOnConsumed=e?parseInt(e):0,this.inMemoryBlockOnConsumed>0&&this.points>this.inMemoryBlockOnConsumed)throw new Error('inMemoryBlockOnConsumed option must be greater or equal "points" option')}get inMemoryBlockDuration(){return this._inMemoryBlockDuration}set inMemoryBlockDuration(e){if(this._inMemoryBlockDuration=e?parseInt(e):0,this.inMemoryBlockDuration>0&&0===this.inMemoryBlockOnConsumed)throw new Error("inMemoryBlockOnConsumed option must be set up")}get msInMemoryBlockDuration(){return 1e3*this._inMemoryBlockDuration}get insuranceLimiter(){return this._insuranceLimiter}set insuranceLimiter(e){if(void 0!==e&&!(e instanceof n))throw new Error("insuranceLimiter must be instance of RateLimiterAbstract");this._insuranceLimiter=e,this._insuranceLimiter&&(this._insuranceLimiter.blockDuration=this.blockDuration,this._insuranceLimiter.execEvenly=this.execEvenly)}block(e,t,r={}){const n=1e3*t;return this._block(this.getKey(e),this.points+1,n,r)}set(e,t,r,n={}){const s=1e3*(r>=0?r:this.duration);return this._block(this.getKey(e),t,s,n)}consume(e,t=1,r={}){return new Promise(((n,s)=>{const o=this.getKey(e),a=this.getInMemoryBlockMsBeforeExpire(o);if(a>0)return s(new i(0,a));this._upsert(o,t,1e3*this._getKeySecDuration(r),!1,r).then((e=>{this._afterConsume(n,s,o,t,e)})).catch((i=>{this._handleError(i,"consume",n,s,e,t,r)}))}))}penalty(e,t=1,r={}){const n=this.getKey(e);return new Promise(((s,i)=>{this._upsert(n,t,1e3*this._getKeySecDuration(r),!1,r).then((e=>{s(this._getRateLimiterRes(n,t,e))})).catch((n=>{this._handleError(n,"penalty",s,i,e,t,r)}))}))}reward(e,t=1,r={}){const n=this.getKey(e);return new Promise(((s,i)=>{this._upsert(n,-t,1e3*this._getKeySecDuration(r),!1,r).then((e=>{s(this._getRateLimiterRes(n,-t,e))})).catch((n=>{this._handleError(n,"reward",s,i,e,t,r)}))}))}get(e,t={}){const r=this.getKey(e);return new Promise(((n,s)=>{this._get(r,t).then((e=>{n(null==e?null:this._getRateLimiterRes(r,0,e))})).catch((r=>{this._handleError(r,"get",n,s,e,t)}))}))}delete(e,t={}){const r=this.getKey(e);return new Promise(((n,s)=>{this._delete(r,t).then((e=>{this._inMemoryBlockedKeys.delete(r),n(e)})).catch((r=>{this._handleError(r,"delete",n,s,e,t)}))}))}deleteInMemoryBlockedAll(){this._inMemoryBlockedKeys.delete()}_getRateLimiterRes(e,t,r){throw new Error("You have to implement the method '_getRateLimiterRes'!")}_block(e,t,r,n={}){return new Promise(((s,o)=>{this._upsert(e,t,r,!0,n).then((()=>{s(new i(0,r>0?r:-1,t))})).catch((t=>{this._handleError(t,"block",s,o,this.parseKey(e),r/1e3,n)}))}))}_get(e,t={}){throw new Error("You have to implement the method '_get'!")}_delete(e,t={}){throw new Error("You have to implement the method '_delete'!")}_upsert(e,t,r,n=!1,s={}){throw new Error("You have to implement the method '_upsert'!")}}},33766:function(e,t,r){const n=r(81352);e.exports=class{constructor(...e){if(e.length<1)throw new Error("RateLimiterUnion: at least one limiter have to be passed");e.forEach((e=>{if(!(e instanceof n))throw new Error("RateLimiterUnion: all limiters have to be instance of RateLimiterAbstract")})),this._limiters=e}consume(e,t=1){return new Promise(((r,n)=>{const s=[];this._limiters.forEach((r=>{s.push(r.consume(e,t).catch((e=>({rejected:!0,rej:e}))))})),Promise.all(s).then((e=>{const t={};let s=!1;e.forEach((e=>{!0===e.rejected&&(s=!0)}));for(let r=0;r<e.length;r++)s&&!0===e[r].rejected?t[this._limiters[r].keyPrefix]=e[r].rej:s||(t[this._limiters[r].keyPrefix]=e[r]);s?n(t):r(t)}))}))}}},78894:function(e){e.exports=class{constructor(){this._keys={},this._addedKeysAmount=0}collectExpired(){const e=Date.now();Object.keys(this._keys).forEach((t=>{this._keys[t]<=e&&delete this._keys[t]})),this._addedKeysAmount=Object.keys(this._keys).length}add(e,t){this.addMs(e,1e3*t)}addMs(e,t){this._keys[e]=Date.now()+t,this._addedKeysAmount++,this._addedKeysAmount>999&&this.collectExpired()}msBeforeExpire(e){const t=this._keys[e];if(t&&t>=Date.now()){this.collectExpired();const e=Date.now();return t>=e?t-e:0}return 0}delete(e){e?delete this._keys[e]:Object.keys(this._keys).forEach((e=>{delete this._keys[e]}))}}},52423:function(e,t,r){const n=r(78894);e.exports=n},58425:function(e,t,r){const n=r(9250),s=r(15155);e.exports=class{constructor(){this._storage={}}incrby(e,t,r){if(this._storage[e]){const n=this._storage[e].expiresAt?this._storage[e].expiresAt.getTime()-(new Date).getTime():-1;return 0!==n?(this._storage[e].value=this._storage[e].value+t,new s(0,n,this._storage[e].value,!1)):this.set(e,t,r)}return this.set(e,t,r)}set(e,t,r){const i=1e3*r;return this._storage[e]&&this._storage[e].timeoutId&&clearTimeout(this._storage[e].timeoutId),this._storage[e]=new n(t,i>0?new Date(Date.now()+i):null),i>0&&(this._storage[e].timeoutId=setTimeout((()=>{delete this._storage[e]}),i),this._storage[e].timeoutId.unref&&this._storage[e].timeoutId.unref()),new s(0,0===i?-1:i,this._storage[e].value,!0)}get(e){if(this._storage[e]){const t=this._storage[e].expiresAt?this._storage[e].expiresAt.getTime()-(new Date).getTime():-1;return new s(0,t,this._storage[e].value,!1)}return null}delete(e){return!!this._storage[e]&&(this._storage[e].timeoutId&&clearTimeout(this._storage[e].timeoutId),delete this._storage[e],!0)}}},9250:function(e){e.exports=class{constructor(e,t,r=null){this.value=e,this.expiresAt=t,this.timeoutId=r}get value(){return this._value}set value(e){this._value=parseInt(e)}get expiresAt(){return this._expiresAt}set expiresAt(e){e instanceof Date||!Number.isInteger(e)||(e=new Date(e)),this._expiresAt=e}get timeoutId(){return this._timeoutId}set timeoutId(e){this._timeoutId=e}}},45255:function(e){e.exports=class extends Error{constructor(e,t){super(),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="CustomError",this.message=e,t&&(this.extra=t)}}},92419:function(e,t,r){"use strict";r.d(t,{Z:function(){return y}});var n=r(87462),s=r(71002),i=r(1413),o=r(45987),a=r(62435),A=r(81263),c={adjustX:1,adjustY:1},l=[0,0],u={left:{points:["cr","cl"],overflow:c,offset:[-4,0],targetOffset:l},right:{points:["cl","cr"],overflow:c,offset:[4,0],targetOffset:l},top:{points:["bc","tc"],overflow:c,offset:[0,-4],targetOffset:l},bottom:{points:["tc","bc"],overflow:c,offset:[0,4],targetOffset:l},topLeft:{points:["bl","tl"],overflow:c,offset:[0,-4],targetOffset:l},leftTop:{points:["tr","tl"],overflow:c,offset:[-4,0],targetOffset:l},topRight:{points:["br","tr"],overflow:c,offset:[0,-4],targetOffset:l},rightTop:{points:["tl","tr"],overflow:c,offset:[4,0],targetOffset:l},bottomRight:{points:["tr","br"],overflow:c,offset:[0,4],targetOffset:l},rightBottom:{points:["bl","br"],overflow:c,offset:[4,0],targetOffset:l},bottomLeft:{points:["tl","bl"],overflow:c,offset:[0,4],targetOffset:l},leftBottom:{points:["br","bl"],overflow:c,offset:[-4,0],targetOffset:l}},h=r(94184),d=r.n(h);function f(e){var t=e.showArrow,r=e.arrowContent,n=e.children,s=e.prefixCls,i=e.id,o=e.overlayInnerStyle,A=e.className,c=e.style;return a.createElement("div",{className:d()("".concat(s,"-content"),A),style:c},!1!==t&&a.createElement("div",{className:"".concat(s,"-arrow"),key:"arrow"},r),a.createElement("div",{className:"".concat(s,"-inner"),id:i,role:"tooltip",style:o},"function"==typeof n?n():n))}var p=["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","children","onVisibleChange","afterVisibleChange","transitionName","animation","motion","placement","align","destroyTooltipOnHide","defaultVisible","getTooltipContainer","overlayInnerStyle","arrowContent","overlay","id","showArrow"],g=function(e,t){var r=e.overlayClassName,c=e.trigger,l=void 0===c?["hover"]:c,h=e.mouseEnterDelay,d=void 0===h?0:h,g=e.mouseLeaveDelay,y=void 0===g?.1:g,w=e.overlayStyle,m=e.prefixCls,b=void 0===m?"rc-tooltip":m,E=e.children,v=e.onVisibleChange,B=e.afterVisibleChange,_=e.transitionName,C=e.animation,S=e.motion,I=e.placement,T=void 0===I?"right":I,R=e.align,k=void 0===R?{}:R,U=e.destroyTooltipOnHide,D=void 0!==U&&U,P=e.defaultVisible,L=e.getTooltipContainer,N=e.overlayInnerStyle,O=e.arrowContent,F=e.overlay,Q=e.id,x=e.showArrow,M=void 0===x||x,H=(0,o.Z)(e,p),K=(0,a.useRef)(null);(0,a.useImperativeHandle)(t,(function(){return K.current}));var V=(0,i.Z)({},H);"visible"in e&&(V.popupVisible=e.visible);var z=!1,j=!1;if("boolean"==typeof D)z=D;else if(D&&"object"===(0,s.Z)(D)){var G=D.keepParent;z=!0===G,j=!1===G}return a.createElement(A.Z,(0,n.Z)({popupClassName:r,prefixCls:b,popup:function(){return a.createElement(f,{showArrow:M,arrowContent:O,key:"content",prefixCls:b,id:Q,overlayInnerStyle:N},F)},action:l,builtinPlacements:u,popupPlacement:T,ref:K,popupAlign:k,getPopupContainer:L,onPopupVisibleChange:v,afterPopupVisibleChange:B,popupTransitionName:_,popupAnimation:C,popupMotion:S,defaultPopupVisible:P,destroyPopupOnHide:z,autoDestroy:j,mouseLeaveDelay:y,popupStyle:w,mouseEnterDelay:d},V),E)},y=(0,a.forwardRef)(g)},74300:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.CopyToClipboard=void 0;var s=a(r(62435)),i=a(r(20640)),o=["text","onCopy","options","children"];function a(e){return e&&e.__esModule?e:{default:e}}function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y(e);if(t){var s=y(this).constructor;r=Reflect.construct(n,arguments,s)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function w(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(A,e);var t,r,n,a=f(A);function A(){var e;u(this,A);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return w(g(e=a.call.apply(a,[this].concat(r))),"onClick",(function(t){var r=e.props,n=r.text,o=r.onCopy,a=r.children,A=r.options,c=s.default.Children.only(a),l=(0,i.default)(n,A);o&&o(n,l),c&&c.props&&"function"==typeof c.props.onClick&&c.props.onClick(t)})),e}return t=A,(r=[{key:"render",value:function(){var e=this.props,t=(e.text,e.onCopy,e.options,e.children),r=l(e,o),n=s.default.Children.only(t);return s.default.cloneElement(n,c(c({},r),{},{onClick:this.onClick}))}}])&&h(t.prototype,r),n&&h(t,n),Object.defineProperty(t,"prototype",{writable:!1}),A}(s.default.PureComponent);t.CopyToClipboard=m,w(m,"defaultProps",{onCopy:void 0,options:void 0})},74855:function(e,t,r){"use strict";var n=r(74300).CopyToClipboard;n.CopyToClipboard=n,e.exports=n},13907:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(62435),s=function(){};var i="undefined"!=typeof window,o=function(e,t,r){if(!i)return[t,s,s];if(!e)throw new Error("useLocalStorage key may not be falsy");var o=r?r.raw?function(e){return e}:r.deserializer:JSON.parse,a=(0,n.useRef)((function(e){try{var n=r?r.raw?String:r.serializer:JSON.stringify,s=localStorage.getItem(e);return null!==s?o(s):(t&&localStorage.setItem(e,n(t)),t)}catch(e){return t}})),A=(0,n.useState)((function(){return a.current(e)})),c=A[0],l=A[1];(0,n.useLayoutEffect)((function(){return l(a.current(e))}),[e]);var u=(0,n.useCallback)((function(t){try{var n="function"==typeof t?t(c):t;if(void 0===n)return;var s=void 0;s=r?r.raw?"string"==typeof n?n:JSON.stringify(n):r.serializer?r.serializer(n):JSON.stringify(n):JSON.stringify(n),localStorage.setItem(e,s),l(o(s))}catch(e){}}),[e,l]),h=(0,n.useCallback)((function(){try{localStorage.removeItem(e),l(void 0)}catch(e){}}),[e,l]);return[c,u,h]}},73692:function(e,t,r){"use strict";e.exports=o;var n=r(57824),s=o.prototype,i=new Date%1e9;function o(e){e=e||{},this.id=e.id||(1e9*Math.random()>>>0)+i++,this.max=e.max||1/0,this.items=e.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(e.lastModified||new Date);for(var t,r,n=this.items.length;n--;)t=this.items[n],r=new Date(t.expires)-new Date,this._lookup[t.key]=t,r>0?this.expire(t.key,r):r<=0&&this.delete(t.key)}s.has=function(e){return e in this._lookup},s.get=function(e){if(!this.has(e))return null;var t=this._lookup[e];return t.refresh&&this.expire(e,t.refresh),this.items.splice(this.items.indexOf(t),1),this.items.push(t),t.value},s.meta=function(e){if(!this.has(e))return null;var t=this._lookup[e];return"meta"in t?t.meta:null},s.set=function(e,t,r){var n=this._lookup[e],s=this._lookup[e]={key:e,value:t};return this.lastModified=new Date,n?(clearTimeout(n.timeout),this.items.splice(this.items.indexOf(n),1,s)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(s),this.size++),r&&("ttl"in r&&this.expire(e,r.ttl),"meta"in r&&(s.meta=r.meta),r.refresh&&(s.refresh=r.ttl)),this},s.delete=function(e){var t=this._lookup[e];return!!t&&(this.lastModified=new Date,this.items.splice(this.items.indexOf(t),1),clearTimeout(t.timeout),delete this._lookup[e],this.size--,this)},s.expire=function(e,t){var r=t||0,s=this._lookup[e];if(!s)return this;if("string"==typeof r&&(r=n(t)),"number"!=typeof r)throw new TypeError("Expiration time must be a string or number.");return clearTimeout(s.timeout),s.timeout=setTimeout(this.delete.bind(this,s.key),r),s.expires=Number(new Date)+r,this},s.clear=function(){for(var e=this.items.length;e--;)this.delete(this.items[e].key);return this},s.toJSON=function(){for(var e,t=new Array(this.items.length),r=t.length;r--;)e=this.items[r],t[r]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:t}}},4480:function(e,t,r){"use strict";r.d(t,{CG:function(){return fa},FV:function(){return ga},Wh:function(){return ua},cn:function(){return ha},nZ:function(){return da},sJ:function(){return pa}});var n=r(62435),s=r(61254),i=r(34155);var o=function(e){const t=new Error(e);if(void 0===t.stack)try{throw t}catch(e){}return t};var a=function(e){return!!e&&"function"==typeof e.then};var A=function(e,t){if(null!=e)return e;throw o(null!=t?t:"Got unexpected null or undefined")};function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class l{getValue(){throw o("BaseLoadable")}toPromise(){throw o("BaseLoadable")}valueMaybe(){throw o("BaseLoadable")}valueOrThrow(){throw o(`Loadable expected value, but in "${this.state}" state`)}promiseMaybe(){throw o("BaseLoadable")}promiseOrThrow(){throw o(`Loadable expected promise, but in "${this.state}" state`)}errorMaybe(){throw o("BaseLoadable")}errorOrThrow(){throw o(`Loadable expected error, but in "${this.state}" state`)}is(e){return e.state===this.state&&e.contents===this.contents}map(e){throw o("BaseLoadable")}}class u extends l{constructor(e){super(),c(this,"state","hasValue"),c(this,"contents",void 0),this.contents=e}getValue(){return this.contents}toPromise(){return Promise.resolve(this.contents)}valueMaybe(){return this.contents}valueOrThrow(){return this.contents}promiseMaybe(){}errorMaybe(){}map(e){try{const t=e(this.contents);return a(t)?g(t):m(t)?t:f(t)}catch(t){return a(t)?g(t.next((()=>this.map(e)))):p(t)}}}class h extends l{constructor(e){super(),c(this,"state","hasError"),c(this,"contents",void 0),this.contents=e}getValue(){throw this.contents}toPromise(){return Promise.reject(this.contents)}valueMaybe(){}promiseMaybe(){}errorMaybe(){return this.contents}errorOrThrow(){return this.contents}map(e){return this}}class d extends l{constructor(e){super(),c(this,"state","loading"),c(this,"contents",void 0),this.contents=e}getValue(){throw this.contents}toPromise(){return this.contents}valueMaybe(){}promiseMaybe(){return this.contents}promiseOrThrow(){return this.contents}errorMaybe(){}map(e){return g(this.contents.then((t=>{const r=e(t);if(m(r)){const e=r;switch(e.state){case"hasValue":case"loading":return e.contents;case"hasError":throw e.contents}}return r})).catch((t=>{if(a(t))return t.then((()=>this.map(e).contents));throw t})))}}function f(e){return Object.freeze(new u(e))}function p(e){return Object.freeze(new h(e))}function g(e){return Object.freeze(new d(e))}function y(){return Object.freeze(new d(new Promise((()=>{}))))}function w(e){const t=function(e){return e.every((e=>"hasValue"===e.state))?f(e.map((e=>e.contents))):e.some((e=>"hasError"===e.state))?p(A(e.find((e=>"hasError"===e.state)),"Invalid loadable passed to loadableAll").contents):g(Promise.all(e.map((e=>e.contents))))}((Array.isArray(e)?e:Object.getOwnPropertyNames(e).map((t=>e[t]))).map((e=>m(e)?e:a(e)?g(e):f(e))));return Array.isArray(e)?t:t.map((t=>Object.getOwnPropertyNames(e).reduce(((e,r,n)=>({...e,[r]:t[n]})),{})))}function m(e){return e instanceof l}const b={of:e=>a(e)?g(e):m(e)?e:f(e),error:e=>p(e),loading:()=>y(),all:w,isLoadable:m};var E={loadableWithValue:f,loadableWithError:p,loadableWithPromise:g,loadableLoading:y,loadableAll:w,isLoadable:m,RecoilLoadable:b},v=E.loadableWithValue,B=E.loadableWithError,_=E.loadableWithPromise,C=E.loadableLoading,S=E.loadableAll,I=E.isLoadable,T=E.RecoilLoadable,R=Object.freeze({__proto__:null,loadableWithValue:v,loadableWithError:B,loadableWithPromise:_,loadableLoading:C,loadableAll:S,isLoadable:I,RecoilLoadable:T});const k=(new Map).set("recoil_hamt_2020",!0).set("recoil_sync_external_store",!0).set("recoil_suppress_rerender_in_callback",!0).set("recoil_memory_managament_2020",!0);function U(e){var t;return null!==(t=k.get(e))&&void 0!==t&&t}U.setPass=e=>{k.set(e,!0)},U.setFail=e=>{k.set(e,!1)},U.clear=()=>{k.clear()};var D=U;var P,L,N,O=function(e,t,{error:r}={}){return null};const F=null!==(P=n.createMutableSource)&&void 0!==P?P:n.unstable_createMutableSource,Q=null!==(L=n.useMutableSource)&&void 0!==L?L:n.unstable_useMutableSource,x=null!==(N=n.useSyncExternalStore)&&void 0!==N?N:n.unstable_useSyncExternalStore;let M=!1;var H={createMutableSource:F,useMutableSource:Q,useSyncExternalStore:x,currentRendererSupportsUseSyncExternalStore:function(){var e;const{ReactCurrentDispatcher:t,ReactCurrentOwner:r}=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,s=null!=(null!==(e=null==t?void 0:t.current)&&void 0!==e?e:r.currentDispatcher).useSyncExternalStore;return!x||s||M||(M=!0,O("A React renderer without React 18+ API support is being used with React 18+.")),s},reactMode:function(){return D("recoil_transition_support")?{mode:"TRANSITION_SUPPORT",early:!0,concurrent:!0}:D("recoil_sync_external_store")&&null!=x?{mode:"SYNC_EXTERNAL_STORE",early:!0,concurrent:!1}:D("recoil_mutable_source")&&null!=Q&&"undefined"!=typeof window&&!window.$disableRecoilValueMutableSource_TEMP_HACK_DO_NOT_USE?D("recoil_suppress_rerender_in_callback")?{mode:"MUTABLE_SOURCE",early:!0,concurrent:!0}:{mode:"MUTABLE_SOURCE",early:!1,concurrent:!1}:D("recoil_suppress_rerender_in_callback")?{mode:"LEGACY",early:!0,concurrent:!1}:{mode:"LEGACY",early:!1,concurrent:!1}},isFastRefreshEnabled:function(){return!1}};const K={RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED:!0};!function(){var e,t;if(void 0===i)return;if(null==(null===i||void 0===i?void 0:{NODE_ENV:"production",PUBLIC_PATH:"./"}))return;const r=null===(e={NODE_ENV:"production",PUBLIC_PATH:"./"}.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED)||void 0===e||null===(t=e.toLowerCase())||void 0===t?void 0:t.trim();if(null==r||""===r)return;if(!["true","false"].includes(r))throw o(`process.env.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED value must be 'true', 'false', or empty: ${r}`);K.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED="true"===r}();var V=K;class z{constructor(e){c(this,"key",void 0),this.key=e}toJSON(){return{key:this.key}}}class j extends z{}class G extends z{}var $={AbstractRecoilValue:z,RecoilState:j,RecoilValueReadOnly:G,isRecoilValue:function(e){return e instanceof j||e instanceof G}},q=$.AbstractRecoilValue,W=$.RecoilState,Y=$.RecoilValueReadOnly,X=$.isRecoilValue,J=Object.freeze({__proto__:null,AbstractRecoilValue:q,RecoilState:W,RecoilValueReadOnly:Y,isRecoilValue:X});var Z=function(e,...t){0};var ee=function(e,t){return function*(){let r=0;for(const n of e)yield t(n,r++)}()};const{isFastRefreshEnabled:te}=H;class re{}const ne=new re,se=new Map,ie=new Map;class oe extends Error{}const ae=new Map;function Ae(e){return ae.get(e)}var ce={nodes:se,recoilValues:ie,registerNode:function(e){V.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED&&function(e){if(se.has(e)){const t=`Duplicate atom key "${e}". This is a FATAL ERROR in\n      production. But it is safe to ignore this warning if it occurred because of\n      hot module replacement.`;console.warn(t)}}(e.key),se.set(e.key,e);const t=null==e.set?new J.RecoilValueReadOnly(e.key):new J.RecoilState(e.key);return ie.set(e.key,t),t},getNode:function(e){const t=se.get(e);if(null==t)throw new oe(`Missing definition for RecoilValue: "${e}""`);return t},getNodeMaybe:function(e){return se.get(e)},deleteNodeConfigIfPossible:function(e){var t;if(!D("recoil_memory_managament_2020"))return;const r=se.get(e);var n;null!=r&&null!==(t=r.shouldDeleteConfigOnRelease)&&void 0!==t&&t.call(r)&&(se.delete(e),null===(n=Ae(e))||void 0===n||n(),ae.delete(e))},setConfigDeletionHandler:function(e,t){D("recoil_memory_managament_2020")&&(void 0===t?ae.delete(e):ae.set(e,t))},getConfigDeletionHandler:Ae,recoilValuesForKeys:function(e){return ee(e,(e=>A(ie.get(e))))},NodeMissingError:oe,DefaultValue:re,DEFAULT_VALUE:ne};var le={enqueueExecution:function(e,t){t()}};var ue,he,de=(ue=function(e){var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r={},n=Math.pow(2,5),s=n-1,i=n/2,o=n/4,a={},A=function(e){return function(){return e}},c=r.hash=function(e){var r=void 0===e?"undefined":t(e);if("number"===r)return e;"string"!==r&&(e+="");for(var n=0,s=0,i=e.length;s<i;++s)n=(n<<5)-n+e.charCodeAt(s)|0;return n},l=function(e,t){return t>>>e&s},u=function(e){return 1<<e},h=function(e,t){return r=e&t-1,r=(r=(858993459&(r-=r>>1&1431655765))+(r>>2&858993459))+(r>>4)&252645135,127&(r+=r>>8)+(r>>16);var r},d=function(e,t,r,n){var s=n;if(!e){var i=n.length;s=new Array(i);for(var o=0;o<i;++o)s[o]=n[o]}return s[t]=r,s},f=function(e,t,r){var n=r.length-1,s=0,i=0,o=r;if(e)s=i=t;else for(o=new Array(n);s<t;)o[i++]=r[s++];for(++s;s<=n;)o[i++]=r[s++];return e&&(o.length=n),o},p={__hamt_isEmpty:!0},g=function(e){return e===p||e&&e.__hamt_isEmpty},y=function(e,t,r,n){return{type:1,edit:e,hash:t,key:r,value:n,_modify:B}},w=function(e,t,r){return{type:2,edit:e,hash:t,children:r,_modify:_}},m=function(e,t,r){return{type:3,edit:e,mask:t,children:r,_modify:C}},b=function(e,t,r){return{type:4,edit:e,size:t,children:r,_modify:S}},E=function e(t,r,n,s,i,o){if(n===i)return w(t,n,[o,s]);var a=l(r,n),A=l(r,i);return m(t,u(a)|u(A),a===A?[e(t,r+5,n,s,i,o)]:a<A?[s,o]:[o,s])},v=function(e,t){return e===t.edit},B=function(e,t,r,n,s,i,o){if(t(i,this.key)){var A=n(this.value);return A===this.value?this:A===a?(--o.value,p):v(e,this)?(this.value=A,this):y(e,s,i,A)}var c=n();return c===a?this:(++o.value,E(e,r,this.hash,this,s,y(e,s,i,c)))},_=function(e,t,r,n,s,i,o){if(s===this.hash){var A=function(e,t,r,n,s,i,o,A){for(var c=s.length,l=0;l<c;++l){var u=s[l];if(r(o,u.key)){var h=u.value,p=i(h);return p===h?s:p===a?(--A.value,f(e,l,s)):d(e,l,y(t,n,o,p),s)}}var g=i();return g===a?s:(++A.value,d(e,c,y(t,n,o,g),s))}(v(e,this),e,t,this.hash,this.children,n,i,o);return A===this.children?this:A.length>1?w(e,this.hash,A):A[0]}var c=n();return c===a?this:(++o.value,E(e,r,this.hash,this,s,y(e,s,i,c)))},C=function(e,t,r,n,s,o,a){var A=this.mask,c=this.children,y=l(r,s),w=u(y),E=h(A,w),B=A&w,_=B?c[E]:p,C=_._modify(e,t,r+5,n,s,o,a);if(_===C)return this;var S,I=v(e,this),T=A,R=void 0;if(B&&g(C)){if(!(T&=~w))return p;if(c.length<=2&&((S=c[1^E])===p||1===S.type||2===S.type))return c[1^E];R=f(I,E,c)}else if(B||g(C))R=d(I,E,C,c);else{if(c.length>=i)return function(e,t,r,n,s){for(var i=[],o=n,a=0,A=0;o;++A)1&o&&(i[A]=s[a++]),o>>>=1;return i[t]=r,b(e,a+1,i)}(e,y,C,A,c);T|=w,R=function(e,t,r,n){var s=n.length;if(e){for(var i=s;i>=t;)n[i--]=n[i];return n[t]=r,n}for(var o=0,a=0,A=new Array(s+1);o<t;)A[a++]=n[o++];for(A[t]=r;o<s;)A[++a]=n[o++];return A}(I,E,C,c)}return I?(this.mask=T,this.children=R,this):m(e,T,R)},S=function(e,t,r,n,s,i,a){var A=this.size,c=this.children,u=l(r,s),h=c[u],f=(h||p)._modify(e,t,r+5,n,s,i,a);if(h===f)return this;var y=v(e,this),w=void 0;if(g(h)&&!g(f))++A,w=d(y,u,f,c);else if(!g(h)&&g(f)){if(--A<=o)return function(e,t,r,n){for(var s=new Array(t-1),i=0,o=0,a=0,A=n.length;a<A;++a)if(a!==r){var c=n[a];c&&!g(c)&&(s[i++]=c,o|=1<<a)}return m(e,o,s)}(e,A,u,c);w=d(y,u,p,c)}else w=d(y,u,f,c);return y?(this.size=A,this.children=w,this):b(e,A,w)};function I(e,t,r,n,s){this._editable=e,this._edit=t,this._config=r,this._root=n,this._size=s}p._modify=function(e,t,r,n,s,i,o){var A=n();return A===a?p:(++o.value,y(e,s,i,A))},I.prototype.setTree=function(e,t){return this._editable?(this._root=e,this._size=t,this):e===this._root?this:new I(this._editable,this._edit,this._config,e,t)};var T=r.tryGetHash=function(e,t,r,n){for(var s=n._root,i=0,o=n._config.keyEq;;)switch(s.type){case 1:return o(r,s.key)?s.value:e;case 2:if(t===s.hash)for(var a=s.children,A=0,c=a.length;A<c;++A){var d=a[A];if(o(r,d.key))return d.value}return e;case 3:var f=l(i,t),p=u(f);if(s.mask&p){s=s.children[h(s.mask,p)],i+=5;break}return e;case 4:if(s=s.children[l(i,t)]){i+=5;break}return e;default:return e}};I.prototype.tryGetHash=function(e,t,r){return T(e,t,r,this)};var R=r.tryGet=function(e,t,r){return T(e,r._config.hash(t),t,r)};I.prototype.tryGet=function(e,t){return R(e,t,this)};var k=r.getHash=function(e,t,r){return T(void 0,e,t,r)};I.prototype.getHash=function(e,t){return k(e,t,this)},r.get=function(e,t){return T(void 0,t._config.hash(e),e,t)},I.prototype.get=function(e,t){return R(t,e,this)};var U=r.has=function(e,t,r){return T(a,e,t,r)!==a};I.prototype.hasHash=function(e,t){return U(e,t,this)};var D=r.has=function(e,t){return U(t._config.hash(e),e,t)};I.prototype.has=function(e){return D(e,this)};var P=function(e,t){return e===t};r.make=function(e){return new I(0,0,{keyEq:e&&e.keyEq||P,hash:e&&e.hash||c},p,0)},r.empty=r.make();var L=r.isEmpty=function(e){return e&&!!g(e._root)};I.prototype.isEmpty=function(){return L(this)};var N=r.modifyHash=function(e,t,r,n){var s={value:n._size},i=n._root._modify(n._editable?n._edit:NaN,n._config.keyEq,0,e,t,r,s);return n.setTree(i,s.value)};I.prototype.modifyHash=function(e,t,r){return N(r,e,t,this)};var O=r.modify=function(e,t,r){return N(e,r._config.hash(t),t,r)};I.prototype.modify=function(e,t){return O(t,e,this)};var F=r.setHash=function(e,t,r,n){return N(A(r),e,t,n)};I.prototype.setHash=function(e,t,r){return F(e,t,r,this)};var Q=r.set=function(e,t,r){return F(r._config.hash(e),e,t,r)};I.prototype.set=function(e,t){return Q(e,t,this)};var x=A(a),M=r.removeHash=function(e,t,r){return N(x,e,t,r)};I.prototype.removeHash=I.prototype.deleteHash=function(e,t){return M(e,t,this)};var H=r.remove=function(e,t){return M(t._config.hash(e),e,t)};I.prototype.remove=I.prototype.delete=function(e){return H(e,this)};var K=r.beginMutation=function(e){return new I(e._editable+1,e._edit+1,e._config,e._root,e._size)};I.prototype.beginMutation=function(){return K(this)};var V=r.endMutation=function(e){return e._editable=e._editable&&e._editable-1,e};I.prototype.endMutation=function(){return V(this)};var z=r.mutate=function(e,t){var r=K(t);return e(r),V(r)};I.prototype.mutate=function(e){return z(e,this)};var j=function(e){return e&&G(e[0],e[1],e[2],e[3],e[4])},G=function(e,t,r,n,s){for(;r<e;){var i=t[r++];if(i&&!g(i))return $(i,n,[e,t,r,n,s])}return j(s)},$=function(e,t,r){switch(e.type){case 1:return{value:t(e),rest:r};case 2:case 4:case 3:var n=e.children;return G(n.length,n,0,t,r);default:return j(r)}},q={done:!0};function W(e){this.v=e}W.prototype.next=function(){if(!this.v)return q;var e=this.v;return this.v=j(e.rest),e},W.prototype[Symbol.iterator]=function(){return this};var Y=function(e,t){return new W($(e._root,t))},X=function(e){return[e.key,e.value]},J=r.entries=function(e){return Y(e,X)};I.prototype.entries=I.prototype[Symbol.iterator]=function(){return J(this)};var Z=function(e){return e.key},ee=r.keys=function(e){return Y(e,Z)};I.prototype.keys=function(){return ee(this)};var te=function(e){return e.value},re=r.values=I.prototype.values=function(e){return Y(e,te)};I.prototype.values=function(){return re(this)};var ne=r.fold=function(e,t,r){var n=r._root;if(1===n.type)return e(t,n.value,n.key);for(var s=[n.children],i=void 0;i=s.pop();)for(var o=0,a=i.length;o<a;){var A=i[o++];A&&A.type&&(1===A.type?t=e(t,A.value,A.key):s.push(A.children))}return t};I.prototype.fold=function(e,t){return ne(e,t,this)};var se=r.forEach=function(e,t){return ne((function(r,n,s){return e(n,s,t)}),null,t)};I.prototype.forEach=function(e){return se(e,this)};var ie=r.count=function(e){return e._size};I.prototype.count=function(){return ie(this)},Object.defineProperty(I.prototype,"size",{get:I.prototype.count}),e.exports?e.exports=r:(void 0).hamt=r},ue(he={exports:{}},he.exports),he.exports);class fe{constructor(e){c(this,"_map",void 0),this._map=new Map(null==e?void 0:e.entries())}keys(){return this._map.keys()}entries(){return this._map.entries()}get(e){return this._map.get(e)}has(e){return this._map.has(e)}set(e,t){return this._map.set(e,t),this}delete(e){return this._map.delete(e),this}clone(){return ge(this)}toMap(){return new Map(this._map)}}class pe{constructor(e){if(c(this,"_hamt",de.empty.beginMutation()),e instanceof pe){const t=e._hamt.endMutation();e._hamt=t.beginMutation(),this._hamt=t.beginMutation()}else if(e)for(const[t,r]of e.entries())this._hamt.set(t,r)}keys(){return this._hamt.keys()}entries(){return this._hamt.entries()}get(e){return this._hamt.get(e)}has(e){return this._hamt.has(e)}set(e,t){return this._hamt.set(e,t),this}delete(e){return this._hamt.delete(e),this}clone(){return ge(this)}toMap(){return new Map(this._hamt)}}function ge(e){return D("recoil_hamt_2020")?new pe(e):new fe(e)}var ye=ge,we=Object.freeze({__proto__:null,persistentMap:ye});var me=function(e,...t){const r=new Set;e:for(const n of e){for(const e of t)if(e.has(n))continue e;r.add(n)}return r};var be=function(e,t){const r=new Map;return e.forEach(((e,n)=>{r.set(n,t(e,n))})),r};function Ee(e,t,r,n){const{nodeDeps:s,nodeToNodeSubscriptions:i}=r,o=s.get(e);if(o&&n&&o!==n.nodeDeps.get(e))return;s.set(e,t);const a=null==o?t:me(t,o);for(const t of a){i.has(t)||i.set(t,new Set);A(i.get(t)).add(e)}if(o){const r=me(o,t);for(const t of r){if(!i.has(t))return;const r=A(i.get(t));r.delete(e),0===r.size&&i.delete(t)}}}var ve={cloneGraph:function(e){return{nodeDeps:be(e.nodeDeps,(e=>new Set(e))),nodeToNodeSubscriptions:be(e.nodeToNodeSubscriptions,(e=>new Set(e)))}},graph:function(){return{nodeDeps:new Map,nodeToNodeSubscriptions:new Map}},saveDepsToStore:function(e,t,r,n){var s,i,o,a;const A=r.getState();n!==A.currentTree.version&&n!==(null===(s=A.nextTree)||void 0===s?void 0:s.version)&&n!==(null===(i=A.previousTree)||void 0===i?void 0:i.version)&&O("Tried to save dependencies to a discarded tree");const c=r.getGraph(n);if(Ee(e,t,c),n===(null===(o=A.previousTree)||void 0===o?void 0:o.version)){Ee(e,t,r.getGraph(A.currentTree.version),c)}if(n===(null===(a=A.previousTree)||void 0===a?void 0:a.version)||n===A.currentTree.version){var l;const n=null===(l=A.nextTree)||void 0===l?void 0:l.version;if(void 0!==n){Ee(e,t,r.getGraph(n),c)}}}};let Be=0;let _e=0;let Ce=0;var Se={getNextTreeStateVersion:()=>Be++,getNextStoreID:()=>_e++,getNextComponentID:()=>Ce++};const{persistentMap:Ie}=we,{graph:Te}=ve,{getNextTreeStateVersion:Re}=Se;function ke(){const e=Re();return{version:e,stateID:e,transactionMetadata:{},dirtyAtoms:new Set,atomValues:Ie(),nonvalidatedAtoms:Ie()}}var Ue={makeEmptyTreeState:ke,makeEmptyStoreState:function(){const e=ke();return{currentTree:e,nextTree:null,previousTree:null,commitDepth:0,knownAtoms:new Set,knownSelectors:new Set,transactionSubscriptions:new Map,nodeTransactionSubscriptions:new Map,nodeToComponentSubscriptions:new Map,queuedComponentCallbacks_DEPRECATED:[],suspendedComponentResolvers:new Set,graphsByVersion:(new Map).set(e.version,Te()),retention:{referenceCounts:new Map,nodesRetainedByZone:new Map,retainablesToCheckForRelease:new Set},nodeCleanupFunctions:new Map}},getNextTreeStateVersion:Re};class De{}var Pe={RetentionZone:De,retentionZone:function(){return new De}};var Le={setByAddingToSet:function(e,t){const r=new Set(e);return r.add(t),r},setByDeletingFromSet:function(e,t){const r=new Set(e);return r.delete(t),r},mapBySettingInMap:function(e,t,r){const n=new Map(e);return n.set(t,r),n},mapByUpdatingInMap:function(e,t,r){const n=new Map(e);return n.set(t,r(n.get(t))),n},mapByDeletingFromMap:function(e,t){const r=new Map(e);return r.delete(t),r},mapByDeletingMultipleFromMap:function(e,t){const r=new Map(e);return t.forEach((e=>r.delete(e))),r}};var Ne=function*(e,t){let r=0;for(const n of e)t(n,r++)&&(yield n)};var Oe=function(e,t){return new Proxy(e,{get:(e,r)=>(!(r in e)&&r in t&&(e[r]=t[r]()),e[r]),ownKeys:e=>Object.keys(e)})};const{getNode:Fe,getNodeMaybe:Qe,recoilValuesForKeys:xe}=ce,{RetentionZone:Me}=Pe,{setByAddingToSet:He}=Le,Ke=Object.freeze(new Set);class Ve extends Error{}function ze(e,t,r,n){const s=e.getState();if(s.nodeCleanupFunctions.has(r))return;const i=Fe(r),o=function(e,t,r){if(!D("recoil_memory_managament_2020"))return()=>{};const{nodesRetainedByZone:n}=e.getState().retention;function s(e){let r=n.get(e);r||n.set(e,r=new Set),r.add(t)}if(r instanceof Me)s(r);else if(Array.isArray(r))for(const e of r)s(e);return()=>{if(!D("recoil_memory_managament_2020"))return;const{retention:n}=e.getState();function s(e){const r=n.nodesRetainedByZone.get(e);null==r||r.delete(t),r&&0===r.size&&n.nodesRetainedByZone.delete(e)}if(r instanceof Me)s(r);else if(Array.isArray(r))for(const e of r)s(e)}}(e,r,i.retainedBy),a=i.init(e,t,n);s.nodeCleanupFunctions.set(r,(()=>{a(),o()}))}function je(e,t,r){return Fe(r).peek(e,t)}function Ge(e,t,r){const n=new Set,s=Array.from(r),i=e.getGraph(t.version);for(let e=s.pop();e;e=s.pop()){var o;n.add(e);const t=null!==(o=i.nodeToNodeSubscriptions.get(e))&&void 0!==o?o:Ke;for(const e of t)n.has(e)||s.push(e)}return n}var $e={getNodeLoadable:function(e,t,r){return ze(e,t,r,"get"),Fe(r).get(e,t)},peekNodeLoadable:je,setNodeValue:function(e,t,r,n){const s=Fe(r);if(null==s.set)throw new Ve(`Attempt to set read-only RecoilValue: ${r}`);const i=s.set;return ze(e,t,r,"set"),i(e,t,n)},initializeNode:function(e,t,r){ze(e,e.getState().currentTree,t,r)},cleanUpNode:function(e,t){var r;const n=e.getState();null===(r=n.nodeCleanupFunctions.get(t))||void 0===r||r(),n.nodeCleanupFunctions.delete(t)},setUnvalidatedAtomValue_DEPRECATED:function(e,t,r){var n;const s=Qe(t);return null==s||null===(n=s.invalidate)||void 0===n||n.call(s,e),{...e,atomValues:e.atomValues.clone().delete(t),nonvalidatedAtoms:e.nonvalidatedAtoms.clone().set(t,r),dirtyAtoms:He(e.dirtyAtoms,t)}},peekNodeInfo:function(e,t,r){const n=e.getState(),s=e.getGraph(t.version),i=Fe(r).nodeType;return Oe({type:i},{loadable:()=>je(e,t,r),isActive:()=>n.knownAtoms.has(r)||n.knownSelectors.has(r),isSet:()=>"selector"!==i&&t.atomValues.has(r),isModified:()=>t.dirtyAtoms.has(r),deps:()=>{var e;return xe(null!==(e=s.nodeDeps.get(r))&&void 0!==e?e:[])},subscribers:()=>{var s,i;return{nodes:xe(Ne(Ge(e,t,new Set([r])),(e=>e!==r))),components:ee(null!==(s=null===(i=n.nodeToComponentSubscriptions.get(r))||void 0===i?void 0:i.values())&&void 0!==s?s:[],(([e])=>({name:e})))}}})},getDownstreamNodes:Ge};let qe=null;var We={setInvalidateMemoizedSnapshot:function(e){qe=e},invalidateMemoizedSnapshot:function(){var e;null===(e=qe)||void 0===e||e()}};const{getDownstreamNodes:Ye,getNodeLoadable:Xe,setNodeValue:Je}=$e,{getNextComponentID:Ze}=Se,{getNode:et,getNodeMaybe:tt}=ce,{DefaultValue:rt}=ce,{reactMode:nt}=H,{AbstractRecoilValue:st,RecoilState:it,RecoilValueReadOnly:ot,isRecoilValue:at}=J,{invalidateMemoizedSnapshot:At}=We;function ct(e,t,r){if("set"===r.type){const{recoilValue:n,valueOrUpdater:s}=r,i=function(e,t,{key:r},n){if("function"==typeof n){const s=Xe(e,t,r);if("loading"===s.state){const e=`Tried to set atom or selector "${r}" using an updater function while the current state is pending, this is not currently supported.`;throw O(e),o(e)}if("hasError"===s.state)throw s.contents;return n(s.contents)}return n}(e,t,n,s),a=Je(e,t,n.key,i);for(const[e,r]of a.entries())lt(t,e,r)}else if("setLoadable"===r.type){const{recoilValue:{key:e},loadable:n}=r;lt(t,e,n)}else if("markModified"===r.type){const{recoilValue:{key:e}}=r;t.dirtyAtoms.add(e)}else if("setUnvalidated"===r.type){var n;const{recoilValue:{key:e},unvalidatedValue:s}=r,i=tt(e);null==i||null===(n=i.invalidate)||void 0===n||n.call(i,t),t.atomValues.delete(e),t.nonvalidatedAtoms.set(e,s),t.dirtyAtoms.add(e)}else O(`Unknown action ${r.type}`)}function lt(e,t,r){"hasValue"===r.state&&r.contents instanceof rt?e.atomValues.delete(t):e.atomValues.set(t,r),e.dirtyAtoms.add(t),e.nonvalidatedAtoms.delete(t)}function ut(e,t){e.replaceState((r=>{const n=ft(r);for(const r of t)ct(e,n,r);return pt(e,n),At(),n}))}function ht(e,t){if(dt.length){const r=dt[dt.length-1];let n=r.get(e);n||r.set(e,n=[]),n.push(t)}else ut(e,[t])}const dt=[];function ft(e){return{...e,atomValues:e.atomValues.clone(),nonvalidatedAtoms:e.nonvalidatedAtoms.clone(),dirtyAtoms:new Set(e.dirtyAtoms)}}function pt(e,t){const r=Ye(e,t,t.dirtyAtoms);for(const e of r){var n,s;null===(n=tt(e))||void 0===n||null===(s=n.invalidate)||void 0===s||s.call(n,t)}}function gt(e,t,r){ht(e,{type:"set",recoilValue:t,valueOrUpdater:r})}var yt={RecoilValueReadOnly:ot,AbstractRecoilValue:st,RecoilState:it,getRecoilValueAsLoadable:function(e,{key:t},r=e.getState().currentTree){var n,s;const i=e.getState();r.version!==i.currentTree.version&&r.version!==(null===(n=i.nextTree)||void 0===n?void 0:n.version)&&r.version!==(null===(s=i.previousTree)||void 0===s?void 0:s.version)&&O("Tried to read from a discarded tree");const o=Xe(e,r,t);return"loading"===o.state&&o.contents.catch((()=>{})),o},setRecoilValue:gt,setRecoilValueLoadable:function(e,t,r){if(r instanceof rt)return gt(e,t,r);ht(e,{type:"setLoadable",recoilValue:t,loadable:r})},markRecoilValueModified:function(e,t){ht(e,{type:"markModified",recoilValue:t})},setUnvalidatedRecoilValue:function(e,t,r){ht(e,{type:"setUnvalidated",recoilValue:t,unvalidatedValue:r})},subscribeToRecoilValue:function(e,{key:t},r,n=null){const s=Ze(),i=e.getState();i.nodeToComponentSubscriptions.has(t)||i.nodeToComponentSubscriptions.set(t,new Map),A(i.nodeToComponentSubscriptions.get(t)).set(s,[null!=n?n:"<not captured>",r]);const o=nt();if(o.early&&("LEGACY"===o.mode||"MUTABLE_SOURCE"===o.mode)){const n=e.getState().nextTree;n&&n.dirtyAtoms.has(t)&&r(n)}return{release:()=>{const r=e.getState(),n=r.nodeToComponentSubscriptions.get(t);void 0!==n&&n.has(s)?(n.delete(s),0===n.size&&r.nodeToComponentSubscriptions.delete(t)):O(`Subscription missing at release time for atom ${t}. This is a bug in Recoil.`)}}},isRecoilValue:at,applyAtomValueWrites:function(e,t){const r=e.clone();return t.forEach(((e,t)=>{"hasValue"===e.state&&e.contents instanceof rt?r.delete(t):r.set(t,e)})),r},batchStart:function(){const e=new Map;return dt.push(e),()=>{for(const[t,r]of e)ut(t,r);dt.pop()!==e&&O("Incorrect order of batch popping")}},writeLoadableToTreeState:lt,invalidateDownstreams:pt,copyTreeState:ft,refreshRecoilValue:function(e,t){var r;const{currentTree:n}=e.getState(),s=et(t.key);null===(r=s.clearCache)||void 0===r||r.call(s,e,n)}};var wt=function(e,t,r){const n=e.entries();let s=n.next();for(;!s.done;){const i=s.value;if(t.call(r,i[1],i[0],e))return!0;s=n.next()}return!1};const{cleanUpNode:mt}=$e,{deleteNodeConfigIfPossible:bt,getNode:Et}=ce,{RetentionZone:vt}=Pe,Bt=new Set;function _t(e,t){const r=e.getState(),n=r.currentTree;if(r.nextTree)return void O("releaseNodesNowOnCurrentTree should only be called at the end of a batch");const s=new Set;for(const e of t)if(e instanceof vt)for(const t of St(r,e))s.add(t);else s.add(e);const i=function(e,t){const r=e.getState(),n=r.currentTree,s=e.getGraph(n.version),i=new Set,o=new Set;return a(t),i;function a(t){const c=new Set,l=function(e,t,r,n,s){const i=e.getGraph(t.version),o=[],a=new Set;for(;r.size>0;)c(A(r.values().next().value));return o;function c(e){if(n.has(e)||s.has(e))return void r.delete(e);if(a.has(e))return;const t=i.nodeToNodeSubscriptions.get(e);if(t)for(const e of t)c(e);a.add(e),r.delete(e),o.push(e)}}(e,n,t,i,o);for(const e of l){var u;if("recoilRoot"===Et(e).retainedBy){o.add(e);continue}if((null!==(u=r.retention.referenceCounts.get(e))&&void 0!==u?u:0)>0){o.add(e);continue}if(It(e).some((e=>r.retention.referenceCounts.get(e)))){o.add(e);continue}const t=s.nodeToNodeSubscriptions.get(e);t&&wt(t,(e=>o.has(e)))?o.add(e):(i.add(e),c.add(e))}const h=new Set;for(const e of c)for(const t of null!==(d=s.nodeDeps.get(e))&&void 0!==d?d:Bt){var d;i.has(t)||h.add(t)}h.size&&a(h)}}(e,s);for(const t of i)Ct(e,n,t)}function Ct(e,t,r){if(!D("recoil_memory_managament_2020"))return;mt(e,r);const n=e.getState();n.knownAtoms.delete(r),n.knownSelectors.delete(r),n.nodeTransactionSubscriptions.delete(r),n.retention.referenceCounts.delete(r);const s=It(r);for(const e of s){var i;null===(i=n.retention.nodesRetainedByZone.get(e))||void 0===i||i.delete(r)}t.atomValues.delete(r),t.dirtyAtoms.delete(r),t.nonvalidatedAtoms.delete(r);const o=n.graphsByVersion.get(t.version);if(o){const e=o.nodeDeps.get(r);if(void 0!==e){o.nodeDeps.delete(r);for(const t of e){var a;null===(a=o.nodeToNodeSubscriptions.get(t))||void 0===a||a.delete(r)}}o.nodeToNodeSubscriptions.delete(r)}bt(r)}function St(e,t){var r;return null!==(r=e.retention.nodesRetainedByZone.get(t))&&void 0!==r?r:Bt}function It(e){const t=Et(e).retainedBy;return void 0===t||"components"===t||"recoilRoot"===t?[]:t instanceof vt?[t]:t}function Tt(e,t){if(!D("recoil_memory_managament_2020"))return;e.getState().retention.referenceCounts.delete(t),function(e,t){const r=e.getState();r.nextTree?r.retention.retainablesToCheckForRelease.add(t):_t(e,new Set([t]))}(e,t)}var Rt={SUSPENSE_TIMEOUT_MS:12e4,updateRetainCount:function(e,t,r){var n;if(!D("recoil_memory_managament_2020"))return;const s=e.getState().retention.referenceCounts,i=(null!==(n=s.get(t))&&void 0!==n?n:0)+r;0===i?Tt(e,t):s.set(t,i)},updateRetainCountToZero:Tt,releaseScheduledRetainablesNow:function(e){if(!D("recoil_memory_managament_2020"))return;const t=e.getState();_t(e,t.retention.retainablesToCheckForRelease),t.retention.retainablesToCheckForRelease.clear()},retainedByOptionWithDefault:function(e){return void 0===e?"recoilRoot":e}};const{unstable_batchedUpdates:kt}=s;var Ut={unstable_batchedUpdates:kt};const{unstable_batchedUpdates:Dt}=Ut;var Pt={unstable_batchedUpdates:Dt};const{batchStart:Lt}=yt,{unstable_batchedUpdates:Nt}=Pt;let Ot=Nt;var Ft={getBatcher:()=>Ot,setBatcher:e=>{Ot=e},batchUpdates:e=>{Ot((()=>{let t=()=>{};try{t=Lt(),e()}finally{t()}}))}};var Qt=function*(e){for(const t of e)for(const e of t)yield e};const xt="undefined"==typeof Window||"undefined"==typeof window,Mt="undefined"!=typeof navigator&&"ReactNative"===navigator.product;var Ht={isSSR:xt,isReactNative:Mt,isWindow:e=>!xt&&(e===window||e instanceof Window)};var Kt={memoizeWithArgsHash:function(e,t){let r;return(...n)=>{r||(r={});const s=t(...n);return Object.hasOwnProperty.call(r,s)||(r[s]=e(...n)),r[s]}},memoizeOneWithArgsHash:function(e,t){let r,n;return(...s)=>{const i=t(...s);return r===i||(r=i,n=e(...s)),n}},memoizeOneWithArgsHashAndInvalidation:function(e,t){let r,n;return[(...s)=>{const i=t(...s);return r===i||(r=i,n=e(...s)),n},()=>{r=null}]}};const{batchUpdates:Vt}=Ft,{initializeNode:zt,peekNodeInfo:jt}=$e,{graph:Gt}=ve,{getNextStoreID:$t}=Se,{DEFAULT_VALUE:qt,recoilValues:Wt,recoilValuesForKeys:Yt}=ce,{AbstractRecoilValue:Xt,getRecoilValueAsLoadable:Jt,setRecoilValue:Zt,setUnvalidatedRecoilValue:er}=yt,{updateRetainCount:tr}=Rt,{setInvalidateMemoizedSnapshot:rr}=We,{getNextTreeStateVersion:nr,makeEmptyStoreState:sr}=Ue,{isSSR:ir}=Ht,{memoizeOneWithArgsHashAndInvalidation:or}=Kt;class ar{constructor(e,t){c(this,"_store",void 0),c(this,"_refCount",1),c(this,"getLoadable",(e=>(this.checkRefCount_INTERNAL(),Jt(this._store,e)))),c(this,"getPromise",(e=>(this.checkRefCount_INTERNAL(),this.getLoadable(e).toPromise()))),c(this,"getNodes_UNSTABLE",(e=>{if(this.checkRefCount_INTERNAL(),!0===(null==e?void 0:e.isModified)){if(!1===(null==e?void 0:e.isInitialized))return[];const t=this._store.getState().currentTree;return Yt(t.dirtyAtoms)}const t=this._store.getState().knownAtoms,r=this._store.getState().knownSelectors;return null==(null==e?void 0:e.isInitialized)?Wt.values():!0===e.isInitialized?Yt(Qt([t,r])):Ne(Wt.values(),(({key:e})=>!t.has(e)&&!r.has(e)))})),c(this,"getInfo_UNSTABLE",(({key:e})=>(this.checkRefCount_INTERNAL(),jt(this._store,this._store.getState().currentTree,e)))),c(this,"map",(e=>{this.checkRefCount_INTERNAL();const t=new ur(this,Vt);return e(t),t})),c(this,"asyncMap",(async e=>{this.checkRefCount_INTERNAL();const t=new ur(this,Vt);return t.retain(),await e(t),t.autoRelease_INTERNAL(),t})),this._store={storeID:$t(),parentStoreID:t,getState:()=>e,replaceState:t=>{e.currentTree=t(e.currentTree)},getGraph:t=>{const r=e.graphsByVersion;if(r.has(t))return A(r.get(t));const n=Gt();return r.set(t,n),n},subscribeToTransactions:()=>({release:()=>{}}),addTransactionMetadata:()=>{throw o("Cannot subscribe to Snapshots")}};for(const e of this._store.getState().knownAtoms)zt(this._store,e,"get"),tr(this._store,e,1);this.autoRelease_INTERNAL()}retain(){this._refCount<=0&&O("Attempt to retain() Snapshot that was already released."),this._refCount++;let e=!1;return()=>{e||(e=!0,this._release())}}autoRelease_INTERNAL(){ir||window.setTimeout((()=>this._release()),10)}_release(){if(this._refCount--,0===this._refCount){if(this._store.getState().nodeCleanupFunctions.forEach((e=>e())),this._store.getState().nodeCleanupFunctions.clear(),!D("recoil_memory_managament_2020"))return}else this._refCount}isRetained(){return this._refCount>0}checkRefCount_INTERNAL(){D("recoil_memory_managament_2020")&&this._refCount}getStore_INTERNAL(){return this.checkRefCount_INTERNAL(),this._store}getID(){return this.checkRefCount_INTERNAL(),this._store.getState().currentTree.stateID}getStoreID(){return this.checkRefCount_INTERNAL(),this._store.storeID}}function Ar(e,t,r=!1){const n=e.getState(),s=r?nr():t.version;return{currentTree:{version:r?s:t.version,stateID:r?s:t.stateID,transactionMetadata:{...t.transactionMetadata},dirtyAtoms:new Set(t.dirtyAtoms),atomValues:t.atomValues.clone(),nonvalidatedAtoms:t.nonvalidatedAtoms.clone()},commitDepth:0,nextTree:null,previousTree:null,knownAtoms:new Set(n.knownAtoms),knownSelectors:new Set(n.knownSelectors),transactionSubscriptions:new Map,nodeTransactionSubscriptions:new Map,nodeToComponentSubscriptions:new Map,queuedComponentCallbacks_DEPRECATED:[],suspendedComponentResolvers:new Set,graphsByVersion:(new Map).set(s,e.getGraph(t.version)),retention:{referenceCounts:new Map,nodesRetainedByZone:new Map,retainablesToCheckForRelease:new Set},nodeCleanupFunctions:new Map(ee(n.nodeCleanupFunctions.entries(),(([e])=>[e,()=>{}])))}}const[cr,lr]=or(((e,t)=>{var r;const n=e.getState(),s="latest"===t?null!==(r=n.nextTree)&&void 0!==r?r:n.currentTree:A(n.previousTree);return new ar(Ar(e,s),e.storeID)}),((e,t)=>{var r,n;return String(t)+String(e.storeID)+String(null===(r=e.getState().nextTree)||void 0===r?void 0:r.version)+String(e.getState().currentTree.version)+String(null===(n=e.getState().previousTree)||void 0===n?void 0:n.version)}));rr(lr);class ur extends ar{constructor(e,t){super(Ar(e.getStore_INTERNAL(),e.getStore_INTERNAL().getState().currentTree,!0),e.getStoreID()),c(this,"_batch",void 0),c(this,"set",((e,t)=>{this.checkRefCount_INTERNAL();const r=this.getStore_INTERNAL();this._batch((()=>{tr(r,e.key,1),Zt(this.getStore_INTERNAL(),e,t)}))})),c(this,"reset",(e=>{this.checkRefCount_INTERNAL();const t=this.getStore_INTERNAL();this._batch((()=>{tr(t,e.key,1),Zt(this.getStore_INTERNAL(),e,qt)}))})),c(this,"setUnvalidatedAtomValues_DEPRECATED",(e=>{this.checkRefCount_INTERNAL();const t=this.getStore_INTERNAL();Vt((()=>{for(const[r,n]of e.entries())tr(t,r,1),er(t,new Xt(r),n)}))})),this._batch=t}}var hr={Snapshot:ar,MutableSnapshot:ur,freshSnapshot:function(e){const t=new ar(sr());return null!=e?t.map(e):t},cloneSnapshot:function(e,t="latest"){const r=cr(e,t);return r.isRetained()?r:(lr(),cr(e,t))}},dr=hr.Snapshot,fr=hr.MutableSnapshot,pr=hr.freshSnapshot,gr=hr.cloneSnapshot,yr=Object.freeze({__proto__:null,Snapshot:dr,MutableSnapshot:fr,freshSnapshot:pr,cloneSnapshot:gr});var wr=function(...e){const t=new Set;for(const r of e)for(const e of r)t.add(e);return t};const{useRef:mr}=n;var br=function(e){const t=mr(e);return t.current===e&&"function"==typeof e&&(t.current=e()),t};const{getNextTreeStateVersion:Er,makeEmptyStoreState:vr}=Ue,{cleanUpNode:Br,getDownstreamNodes:_r,initializeNode:Cr,setNodeValue:Sr,setUnvalidatedAtomValue_DEPRECATED:Ir}=$e,{graph:Tr}=ve,{cloneGraph:Rr}=ve,{getNextStoreID:kr}=Se,{createMutableSource:Ur,reactMode:Dr}=H,{applyAtomValueWrites:Pr}=yt,{releaseScheduledRetainablesNow:Lr}=Rt,{freshSnapshot:Nr}=yr,{useCallback:Or,useContext:Fr,useEffect:Qr,useMemo:xr,useRef:Mr,useState:Hr}=n;function Kr(){throw o("This component must be used inside a <RecoilRoot> component.")}const Vr=Object.freeze({storeID:kr(),getState:Kr,replaceState:Kr,getGraph:Kr,subscribeToTransactions:Kr,addTransactionMetadata:Kr});let zr=!1;function jr(e){if(zr)throw o("An atom update was triggered within the execution of a state updater function. State updater functions provided to Recoil must be pure functions.");const t=e.getState();if(null===t.nextTree){D("recoil_memory_managament_2020")&&D("recoil_release_on_cascading_update_killswitch_2021")&&t.commitDepth>0&&Lr(e);const r=t.currentTree.version,n=Er();t.nextTree={...t.currentTree,version:n,stateID:n,dirtyAtoms:new Set,transactionMetadata:{}},t.graphsByVersion.set(n,Rr(A(t.graphsByVersion.get(r))))}}const Gr=n.createContext({current:Vr}),$r=()=>Fr(Gr),qr=n.createContext(null);function Wr(e,t,r){const n=_r(e,r,r.dirtyAtoms);for(const e of n){const n=t.nodeToComponentSubscriptions.get(e);if(n)for(const[e,[t,s]]of n)s(r)}}function Yr(e){const t=e.getState(),r=t.currentTree,n=r.dirtyAtoms;if(n.size){for(const[r,s]of t.nodeTransactionSubscriptions)if(n.has(r))for(const[t,r]of s)r(e);for(const[r,n]of t.transactionSubscriptions)n(e);(!Dr().early||t.suspendedComponentResolvers.size>0)&&(Wr(e,t,r),t.suspendedComponentResolvers.forEach((e=>e())),t.suspendedComponentResolvers.clear())}t.queuedComponentCallbacks_DEPRECATED.forEach((e=>e(r))),t.queuedComponentCallbacks_DEPRECATED.splice(0,t.queuedComponentCallbacks_DEPRECATED.length)}function Xr({setNotifyBatcherOfChange:e}){const t=$r(),[,r]=Hr([]);return e((()=>r({}))),Qr((()=>(e((()=>r({}))),()=>{e((()=>{}))})),[e]),Qr((()=>{le.enqueueExecution("Batcher",(()=>{!function(e){const t=e.getState();t.commitDepth++;try{const{nextTree:r}=t;if(null==r)return;t.previousTree=t.currentTree,t.currentTree=r,t.nextTree=null,Yr(e),null!=t.previousTree?t.graphsByVersion.delete(t.previousTree.version):O("Ended batch with no previous state, which is unexpected","recoil"),t.previousTree=null,D("recoil_memory_managament_2020")&&null==r&&Lr(e)}finally{t.commitDepth--}}(t.current)}))})),null}let Jr=0;function Zr({initializeState_DEPRECATED:e,initializeState:t,store_INTERNAL:r,children:s}){let i;const o=e=>{const t=i.current.graphsByVersion;if(t.has(e))return A(t.get(e));const r=Tr();return t.set(e,r),r},a=(e,t)=>{if(null==t){const{transactionSubscriptions:t}=d.current.getState(),r=Jr++;return t.set(r,e),{release:()=>{t.delete(r)}}}{const{nodeTransactionSubscriptions:r}=d.current.getState();r.has(t)||r.set(t,new Map);const n=Jr++;return A(r.get(t)).set(n,e),{release:()=>{const e=r.get(t);e&&(e.delete(n),0===e.size&&r.delete(t))}}}},c=e=>{jr(d.current);for(const t of Object.keys(e))A(d.current.getState().nextTree).transactionMetadata[t]=e[t]},l=e=>{jr(d.current);const t=A(i.current.nextTree);let r;try{zr=!0,r=e(t)}finally{zr=!1}r!==t&&(i.current.nextTree=r,Dr().early&&Wr(d.current,i.current,r),A(u.current)())},u=Mr(null),h=Or((e=>{u.current=e}),[u]),d=br((()=>null!=r?r:{storeID:kr(),getState:()=>i.current,replaceState:l,getGraph:o,subscribeToTransactions:a,addTransactionMetadata:c}));null!=r&&(d.current=r),i=br((()=>null!=e?function(e,t){const r=vr();return t({set:(t,n)=>{const s=r.currentTree,i=Sr(e,s,t.key,n),o=new Set(i.keys()),a=s.nonvalidatedAtoms.clone();for(const e of o)a.delete(e);r.currentTree={...s,dirtyAtoms:wr(s.dirtyAtoms,o),atomValues:Pr(s.atomValues,i),nonvalidatedAtoms:a}},setUnvalidatedAtomValues:e=>{e.forEach(((e,t)=>{r.currentTree=Ir(r.currentTree,t,e)}))}}),r}(d.current,e):null!=t?function(e){const t=Nr(e),r=t.getStore_INTERNAL().getState();return t.retain(),r.nodeCleanupFunctions.forEach((e=>e())),r.nodeCleanupFunctions.clear(),r}(t):vr()));const f=xr((()=>null==Ur?void 0:Ur(i,(()=>i.current.currentTree.version))),[i]);return Qr((()=>{const e=d.current;for(const t of new Set(e.getState().knownAtoms))Cr(e,t,"get");return()=>{for(const t of e.getState().knownAtoms)Br(e,t)}}),[d]),n.createElement(Gr.Provider,{value:d},n.createElement(qr.Provider,{value:f},n.createElement(Xr,{setNotifyBatcherOfChange:h}),s))}var en={RecoilRoot:function(e){const{override:t,...r}=e,s=$r();return!1===t&&s.current!==Vr?e.children:n.createElement(Zr,r)},useStoreRef:$r,useRecoilMutableSource:function(){const e=Fr(qr);return null==e&&Z("Attempted to use a Recoil hook outside of a <RecoilRoot>. <RecoilRoot> must be an ancestor of any component that uses Recoil hooks."),e},useRecoilStoreID:function(){return $r().current.storeID},notifyComponents_FOR_TESTING:Wr,sendEndOfBatchNotifications_FOR_TESTING:Yr};var tn=function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0};const{useEffect:rn,useRef:nn}=n;var sn=function(e){const t=nn();return rn((()=>{t.current=e})),t.current};const{useStoreRef:on}=en,{SUSPENSE_TIMEOUT_MS:an}=Rt,{updateRetainCount:An}=Rt,{RetentionZone:cn}=Pe,{useEffect:ln,useRef:un}=n,{isSSR:hn}=Ht;var dn=function(e){if(D("recoil_memory_managament_2020"))return function(e){const t=Array.isArray(e)?e:[e],r=t.map((e=>e instanceof cn?e:e.key)),n=on();ln((()=>{if(!D("recoil_memory_managament_2020"))return;const e=n.current;if(s.current&&!hn)window.clearTimeout(s.current),s.current=null;else for(const t of r)An(e,t,1);return()=>{for(const t of r)An(e,t,-1)}}),[n,...r]);const s=un(),i=sn(r);if(!(hn||void 0!==i&&tn(i,r))){const e=n.current;for(const t of r)An(e,t,1);if(i)for(const t of i)An(e,t,-1);s.current&&window.clearTimeout(s.current),s.current=window.setTimeout((()=>{s.current=null;for(const t of r)An(e,t,-1)}),an)}}(e)};var fn=function(){return"<component name not available>"};const{batchUpdates:pn}=Ft,{DEFAULT_VALUE:gn}=ce,{currentRendererSupportsUseSyncExternalStore:yn,reactMode:wn,useMutableSource:mn,useSyncExternalStore:bn}=H,{useRecoilMutableSource:En,useStoreRef:vn}=en,{isRecoilValue:Bn}=J,{AbstractRecoilValue:_n,getRecoilValueAsLoadable:Cn,setRecoilValue:Sn,setUnvalidatedRecoilValue:In,subscribeToRecoilValue:Tn}=yt,{useCallback:Rn,useEffect:kn,useMemo:Un,useRef:Dn,useState:Pn}=n,{setByAddingToSet:Ln}=Le;function Nn(e,t,r){if("hasValue"===e.state)return e.contents;if("loading"===e.state){throw new Promise((e=>{r.current.getState().suspendedComponentResolvers.add(e)}))}throw"hasError"===e.state?e.contents:o(`Invalid value of loadable atom "${t.key}"`)}function On(e){const t=vn(),r=fn(),n=Rn((()=>{var r;const n=t.current,s=n.getState(),i=wn().early&&null!==(r=s.nextTree)&&void 0!==r?r:s.currentTree;return{loadable:Cn(n,e,i),key:e.key}}),[t,e]),s=Rn((e=>{let t;return()=>{var r,n;const s=e();return null!==(r=t)&&void 0!==r&&r.loadable.is(s.loadable)&&(null===(n=t)||void 0===n?void 0:n.key)===s.key?t:(t=s,s)}}),[]),i=Un((()=>s(n)),[n,s]),o=Rn((n=>{const s=t.current;return Tn(s,e,n,r).release}),[t,e,r]);return bn(o,i,i).loadable}function Fn(e){const t=vn(),r=Rn((()=>{var r;const n=t.current,s=n.getState(),i=wn().early&&null!==(r=s.nextTree)&&void 0!==r?r:s.currentTree;return Cn(n,e,i)}),[t,e]),n=Rn((()=>r()),[r]),s=fn(),i=Rn(((n,i)=>{const o=t.current;return Tn(o,e,(()=>{if(!D("recoil_suppress_rerender_in_callback"))return i();const e=r();c.current.is(e)||i(),c.current=e}),s).release}),[t,e,s,r]),a=En();if(null==a)throw o("Recoil hooks must be used in components contained within a <RecoilRoot> component.");const A=mn(a,n,i),c=Dn(A);return kn((()=>{c.current=A})),A}function Qn(e){const t=vn(),r=fn(),n=Rn((()=>{var r;const n=t.current,s=n.getState(),i=wn().early&&null!==(r=s.nextTree)&&void 0!==r?r:s.currentTree;return Cn(n,e,i)}),[t,e]),s=Rn((()=>({loadable:n(),key:e.key})),[n,e.key]),i=Rn((e=>{const t=s();return e.loadable.is(t.loadable)&&e.key===t.key?e:t}),[s]);kn((()=>{const n=Tn(t.current,e,(e=>{a(i)}),r);return a(i),n.release}),[r,e,t,i]);const[o,a]=Pn(s);return o.key!==e.key?s().loadable:o.loadable}function xn(e){const t=vn(),[,r]=Pn([]),n=fn(),s=Rn((()=>{var r;const n=t.current,s=n.getState(),i=wn().early&&null!==(r=s.nextTree)&&void 0!==r?r:s.currentTree;return Cn(n,e,i)}),[t,e]),i=s(),o=Dn(i);return kn((()=>{o.current=i})),kn((()=>{const i=t.current,a=i.getState(),A=Tn(i,e,(e=>{var t;if(!D("recoil_suppress_rerender_in_callback"))return r([]);const n=s();null!==(t=o.current)&&void 0!==t&&t.is(n)||r(n),o.current=n}),n);if(a.nextTree)i.getState().queuedComponentCallbacks_DEPRECATED.push((()=>{o.current=null,r([])}));else{var c;if(!D("recoil_suppress_rerender_in_callback"))return r([]);const e=s();null!==(c=o.current)&&void 0!==c&&c.is(e)||r(e),o.current=e}return A.release}),[n,s,e,t]),i}function Mn(e){return D("recoil_memory_managament_2020")&&dn(e),{TRANSITION_SUPPORT:Qn,SYNC_EXTERNAL_STORE:yn()?On:Qn,MUTABLE_SOURCE:Fn,LEGACY:xn}[wn().mode](e)}function Hn(e){const t=vn();return Nn(Mn(e),e,t)}function Kn(e){const t=vn();return Rn((r=>{Sn(t.current,e,r)}),[t,e])}function Vn(e){return D("recoil_memory_managament_2020")&&dn(e),Qn(e)}function zn(e){const t=vn();return Nn(Vn(e),e,t)}var jn={recoilComponentGetRecoilValueCount_FOR_TESTING:{current:0},useRecoilInterface:function(){const e=fn(),t=vn(),[,r]=Pn([]),n=Dn(new Set);n.current=new Set;const s=Dn(new Set),i=Dn(new Map),o=Rn((e=>{const t=i.current.get(e);t&&(t.release(),i.current.delete(e))}),[i]),a=Rn(((e,t)=>{i.current.has(t)&&r([])}),[]);return kn((()=>{const r=t.current;me(n.current,s.current).forEach((t=>{if(i.current.has(t))return void Z(`Double subscription to RecoilValue "${t}"`);const n=Tn(r,new _n(t),(e=>a(e,t)),e);i.current.set(t,n);r.getState().nextTree?r.getState().queuedComponentCallbacks_DEPRECATED.push((()=>{a(r.getState(),t)})):a(r.getState(),t)})),me(s.current,n.current).forEach((e=>{o(e)})),s.current=n.current})),kn((()=>{const r=i.current;return me(n.current,new Set(r.keys())).forEach((n=>{const s=Tn(t.current,new _n(n),(e=>a(e,n)),e);r.set(n,s)})),()=>r.forEach(((e,t)=>o(t)))}),[e,t,o,a]),Un((()=>{function e(e){return r=>{Sn(t.current,e,r)}}function r(e){var r;n.current.has(e.key)||(n.current=Ln(n.current,e.key));const s=t.current.getState();return Cn(t.current,e,wn().early&&null!==(r=s.nextTree)&&void 0!==r?r:s.currentTree)}function s(e){return Nn(r(e),e,t)}return{getRecoilValue:s,getRecoilValueLoadable:r,getRecoilState:function(t){return[s(t),e(t)]},getRecoilStateLoadable:function(t){return[r(t),e(t)]},getSetRecoilState:e,getResetRecoilState:function(e){return()=>Sn(t.current,e,gn)}}}),[n,t])},useRecoilState:function(e){return[Hn(e),Kn(e)]},useRecoilStateLoadable:function(e){return[Mn(e),Kn(e)]},useRecoilValue:Hn,useRecoilValueLoadable:Mn,useResetRecoilState:function(e){const t=vn();return Rn((()=>{Sn(t.current,e,gn)}),[t,e])},useSetRecoilState:Kn,useSetUnvalidatedAtomValues:function(){const e=vn();return(t,r={})=>{pn((()=>{e.current.addTransactionMetadata(r),t.forEach(((t,r)=>In(e.current,new _n(r),t)))}))}},useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:Vn,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:zn,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:function(e){return[zn(e),Kn(e)]}};var Gn=function(e,t){const r=new Map;for(const[n,s]of e)t(s,n)&&r.set(n,s);return r};var $n=function(e,t){const r=new Set;for(const n of e)t(n)&&r.add(n);return r};var qn=function(...e){const t=new Map;for(let r=0;r<e.length;r++){const n=e[r].keys();let s;for(;!(s=n.next()).done;)t.set(s.value,e[r].get(s.value))}return t};const{batchUpdates:Wn}=Ft,{DEFAULT_VALUE:Yn,getNode:Xn,nodes:Jn}=ce,{useStoreRef:Zn}=en,{AbstractRecoilValue:es,setRecoilValueLoadable:ts}=yt,{SUSPENSE_TIMEOUT_MS:rs}=Rt,{cloneSnapshot:ns}=yr,{useCallback:ss,useEffect:is,useRef:os,useState:as}=n,{isSSR:As}=Ht;function cs(e){const t=Zn();is((()=>t.current.subscribeToTransactions(e).release),[e,t])}function ls(e){const t=e.atomValues.toMap(),r=be(Gn(t,((e,t)=>{const r=Xn(t).persistence_UNSTABLE;return null!=r&&"none"!==r.type&&"hasValue"===e.state})),(e=>e.contents));return qn(e.nonvalidatedAtoms.toMap(),r)}function us(e,t){var r;const n=e.getState(),s=null!==(r=n.nextTree)&&void 0!==r?r:n.currentTree,i=t.getStore_INTERNAL().getState().currentTree;Wn((()=>{const r=new Set;for(const e of[s.atomValues.keys(),i.atomValues.keys()])for(const t of e){var n,o;(null===(n=s.atomValues.get(t))||void 0===n?void 0:n.contents)!==(null===(o=i.atomValues.get(t))||void 0===o?void 0:o.contents)&&Xn(t).shouldRestoreFromSnapshots&&r.add(t)}r.forEach((t=>{ts(e,new es(t),i.atomValues.has(t)?A(i.atomValues.get(t)):Yn)})),e.replaceState((e=>({...e,stateID:t.getID()})))}))}var hs={useRecoilSnapshot:function(){const e=Zn(),[t,r]=as((()=>ns(e.current))),n=sn(t),s=os(),i=os();if(cs(ss((e=>r(ns(e))),[])),is((()=>{const e=t.retain();var r;s.current&&!As&&(window.clearTimeout(s.current),s.current=null,null===(r=i.current)||void 0===r||r.call(i),i.current=null);return()=>{window.setTimeout(e,10)}}),[t]),n!==t&&!As){var o;if(s.current)window.clearTimeout(s.current),s.current=null,null===(o=i.current)||void 0===o||o.call(i),i.current=null;i.current=t.retain(),s.current=window.setTimeout((()=>{var e;s.current=null,null===(e=i.current)||void 0===e||e.call(i),i.current=null}),rs)}return t},gotoSnapshot:us,useGotoRecoilSnapshot:function(){const e=Zn();return ss((t=>us(e.current,t)),[e])},useRecoilTransactionObserver:function(e){cs(ss((t=>{const r=ns(t,"latest"),n=ns(t,"previous");e({snapshot:r,previousSnapshot:n})}),[e]))},useTransactionObservation_DEPRECATED:function(e){cs(ss((t=>{let r=t.getState().previousTree;const n=t.getState().currentTree;r||(O("Transaction subscribers notified without a previous tree being present -- this is a bug in Recoil"),r=t.getState().currentTree);const s=ls(n),i=ls(r),o=be(Jn,(e=>{var t,r,n,s;return{persistence_UNSTABLE:{type:null!==(t=null===(r=e.persistence_UNSTABLE)||void 0===r?void 0:r.type)&&void 0!==t?t:"none",backButton:null!==(n=null===(s=e.persistence_UNSTABLE)||void 0===s?void 0:s.backButton)&&void 0!==n&&n}}})),a=$n(n.dirtyAtoms,(e=>s.has(e)||i.has(e)));e({atomValues:s,previousAtomValues:i,atomInfo:o,modifiedAtoms:a,transactionMetadata:{...n.transactionMetadata}})}),[e]))},useTransactionSubscription_DEPRECATED:cs};const{peekNodeInfo:ds}=$e,{useStoreRef:fs}=en;var ps=function(){const e=fs();return({key:t})=>ds(e.current,e.current.getState().currentTree,t)};const{reactMode:gs}=H,{RecoilRoot:ys,useStoreRef:ws}=en,{useMemo:ms}=n;var bs=function(){"MUTABLE_SOURCE"===gs().mode&&console.warn("Warning: There are known issues using useRecoilBridgeAcrossReactRoots() in recoil_mutable_source rendering mode.  Please consider upgrading to recoil_sync_external_store mode.");const e=ws().current;return ms((()=>function({children:t}){return n.createElement(ys,{store_INTERNAL:e},t)}),[e])};const{loadableWithValue:Es}=R,{initializeNode:vs}=$e,{DEFAULT_VALUE:Bs,getNode:_s}=ce,{copyTreeState:Cs,getRecoilValueAsLoadable:Ss,invalidateDownstreams:Is,writeLoadableToTreeState:Ts}=yt;function Rs(e){return"atom"===_s(e.key).nodeType}class ks{constructor(e,t){c(this,"_store",void 0),c(this,"_treeState",void 0),c(this,"_changes",void 0),c(this,"get",(e=>{if(this._changes.has(e.key))return this._changes.get(e.key);if(!Rs(e))throw o("Reading selectors within atomicUpdate is not supported");const t=Ss(this._store,e,this._treeState);if("hasValue"===t.state)return t.contents;throw"hasError"===t.state?t.contents:o(`Expected Recoil atom ${e.key} to have a value, but it is in a loading state.`)})),c(this,"set",((e,t)=>{if(!Rs(e))throw o("Setting selectors within atomicUpdate is not supported");if("function"==typeof t){const r=this.get(e);this._changes.set(e.key,t(r))}else vs(this._store,e.key,"set"),this._changes.set(e.key,t)})),c(this,"reset",(e=>{this.set(e,Bs)})),this._store=e,this._treeState=t,this._changes=new Map}newTreeState_INTERNAL(){if(0===this._changes.size)return this._treeState;const e=Cs(this._treeState);for(const[t,r]of this._changes)Ts(e,t,Es(r));return Is(this._store,e),e}}var Us=function(e){return t=>{e.replaceState((r=>{const n=new ks(e,r);return t(n),n.newTreeState_INTERNAL()}))}},Ds=Us,Ps=Object.freeze({__proto__:null,atomicUpdater:Ds});var Ls=function(e,t){if(!e)throw new Error(t)};const{atomicUpdater:Ns}=Ps,{batchUpdates:Os}=Ft,{DEFAULT_VALUE:Fs}=ce,{useStoreRef:Qs}=en,{refreshRecoilValue:xs,setRecoilValue:Ms}=yt,{cloneSnapshot:Hs}=yr,{gotoSnapshot:Ks}=hs,{useCallback:Vs}=n;class zs{}const js=new zs;function Gs(e,t,r,n){let s,i=js;var A;(Os((()=>{const a="useRecoilCallback() expects a function that returns a function: it accepts a function of the type (RecoilInterface) => (Args) => ReturnType and returns a callback function (Args) => ReturnType, where RecoilInterface is an object {snapshot, set, ...} and Args and ReturnType are the argument and return types of the callback you want to create.  Please see the docs at recoiljs.org for details.";if("function"!=typeof t)throw o(a);const A=Oe({...null!=n?n:{},set:(t,r)=>Ms(e,t,r),reset:t=>Ms(e,t,Fs),refresh:t=>xs(e,t),gotoSnapshot:t=>Ks(e,t),transact_UNSTABLE:t=>Ns(e)(t)},{snapshot:()=>{const t=Hs(e);return s=t.retain(),t}}),c=t(A);if("function"!=typeof c)throw o(a);i=c(...r)})),i instanceof zs&&Ls(!1),a(i))?i.finally((()=>{var e;null===(e=s)||void 0===e||e()})):null===(A=s)||void 0===A||A();return i}var $s={recoilCallback:Gs,useRecoilCallback:function(e,t){const r=Qs();return Vs(((...t)=>Gs(r.current,e,t)),null!=t?[...t,r]:void 0)}};const{useStoreRef:qs}=en,{refreshRecoilValue:Ws}=yt,{useCallback:Ys}=n;var Xs=function(e){const t=qs();return Ys((()=>{const r=t.current;Ws(r,e)}),[e,t])};const{atomicUpdater:Js}=Ps,{useStoreRef:Zs}=en,{useMemo:ei}=n;var ti=function(e,t){const r=Zs();return ei((()=>(...t)=>{Js(r.current)((r=>{e(r)(...t)}))}),null!=t?[...t,r]:void 0)};var ri=class{constructor(e){c(this,"value",void 0),this.value=e}},ni=Object.freeze({__proto__:null,WrappedValue:ri});const{isFastRefreshEnabled:si}=H;class ii extends Error{}var oi=class{constructor(e){var t,r,n;c(this,"_name",void 0),c(this,"_numLeafs",void 0),c(this,"_root",void 0),c(this,"_onHit",void 0),c(this,"_onSet",void 0),c(this,"_mapNodeValue",void 0),this._name=null==e?void 0:e.name,this._numLeafs=0,this._root=null,this._onHit=null!==(t=null==e?void 0:e.onHit)&&void 0!==t?t:()=>{},this._onSet=null!==(r=null==e?void 0:e.onSet)&&void 0!==r?r:()=>{},this._mapNodeValue=null!==(n=null==e?void 0:e.mapNodeValue)&&void 0!==n?n:e=>e}size(){return this._numLeafs}root(){return this._root}get(e,t){var r;return null===(r=this.getLeafNode(e,t))||void 0===r?void 0:r.value}getLeafNode(e,t){if(null==this._root)return;let r=this._root;for(;r;){if(null==t||t.onNodeVisit(r),"leaf"===r.type)return this._onHit(r),r;const n=this._mapNodeValue(e(r.nodeKey));r=r.branches.get(n)}}set(e,t,r){const n=()=>{var n,s,i,o;let a,A;for(const[t,n]of e){var c,l,u;const e=this._root;if("leaf"===(null==e?void 0:e.type))throw this.invalidCacheError();const s=a;if(a=s?s.branches.get(A):e,a=null!==(c=a)&&void 0!==c?c:{type:"branch",nodeKey:t,parent:s,branches:new Map,branchKey:A},"branch"!==a.type||a.nodeKey!==t)throw this.invalidCacheError();null==s||s.branches.set(A,a),null==r||null===(l=r.onNodeVisit)||void 0===l||l.call(r,a),A=this._mapNodeValue(n),this._root=null!==(u=this._root)&&void 0!==u?u:a}const h=a?null===(n=a)||void 0===n?void 0:n.branches.get(A):this._root;if(null!=h&&("leaf"!==h.type||h.branchKey!==A))throw this.invalidCacheError();const d={type:"leaf",value:t,parent:a,branchKey:A};null===(s=a)||void 0===s||s.branches.set(A,d),this._root=null!==(i=this._root)&&void 0!==i?i:d,this._numLeafs++,this._onSet(d),null==r||null===(o=r.onNodeVisit)||void 0===o||o.call(r,d)};try{n()}catch(e){if(!(e instanceof ii))throw e;this.clear(),n()}}delete(e){const t=this.root();if(!t)return!1;if(e===t)return this._root=null,this._numLeafs=0,!0;let r=e.parent,n=e.branchKey;for(;r;){var s;if(r.branches.delete(n),r===t)return 0===r.branches.size?(this._root=null,this._numLeafs=0):this._numLeafs--,!0;if(r.branches.size>0)break;n=null===(s=r)||void 0===s?void 0:s.branchKey,r=r.parent}for(;r!==t;r=r.parent)if(null==r)return!1;return this._numLeafs--,!0}clear(){this._numLeafs=0,this._root=null}invalidCacheError(){const e=si()?"Possible Fast Refresh module reload detected.  This may also be caused by an selector returning inconsistent values. Resetting cache.":"Invalid cache values.  This happens when selectors do not return consistent values for the same input dependency values.  That may also be caused when using Fast Refresh to change a selector implementation.  Resetting cache.";throw O(e+(null!=this._name?` - ${this._name}`:"")),new ii}},ai=Object.freeze({__proto__:null,TreeCache:oi});var Ai=class{constructor(e){var t;c(this,"_maxSize",void 0),c(this,"_size",void 0),c(this,"_head",void 0),c(this,"_tail",void 0),c(this,"_map",void 0),c(this,"_keyMapper",void 0),this._maxSize=e.maxSize,this._size=0,this._head=null,this._tail=null,this._map=new Map,this._keyMapper=null!==(t=e.mapKey)&&void 0!==t?t:e=>e}head(){return this._head}tail(){return this._tail}size(){return this._size}maxSize(){return this._maxSize}has(e){return this._map.has(this._keyMapper(e))}get(e){const t=this._keyMapper(e),r=this._map.get(t);if(r)return this.set(e,r.value),r.value}set(e,t){const r=this._keyMapper(e);this._map.get(r)&&this.delete(e);const n=this.head(),s={key:e,right:n,left:null,value:t};n?n.left=s:this._tail=s,this._map.set(r,s),this._head=s,this._size++,this._maybeDeleteLRU()}_maybeDeleteLRU(){this.size()>this.maxSize()&&this.deleteLru()}deleteLru(){const e=this.tail();e&&this.delete(e.key)}delete(e){const t=this._keyMapper(e);if(!this._size||!this._map.has(t))return;const r=A(this._map.get(t)),n=r.right,s=r.left;n&&(n.left=r.left),s&&(s.right=r.right),r===this.head()&&(this._head=n),r===this.tail()&&(this._tail=s),this._map.delete(t),this._size--}clear(){this._size=0,this._head=null,this._tail=null,this._map=new Map}},ci=Object.freeze({__proto__:null,LRUCache:Ai});const{LRUCache:li}=ci,{TreeCache:ui}=ai;var hi=function({name:e,maxSize:t,mapNodeValue:r=(e=>e)}){const n=new li({maxSize:t}),s=new ui({name:e,mapNodeValue:r,onHit:e=>{n.set(e,!0)},onSet:e=>{const r=n.tail();n.set(e,!0),r&&s.size()>t&&s.delete(r.key)}});return s};function di(e,t,r){if("string"==typeof e&&!e.includes('"')&&!e.includes("\\"))return`"${e}"`;switch(typeof e){case"undefined":return"";case"boolean":return e?"true":"false";case"number":case"symbol":return String(e);case"string":return JSON.stringify(e);case"function":if(!0!==(null==t?void 0:t.allowFunctions))throw o("Attempt to serialize function in a Recoil cache key");return`__FUNCTION(${e.name})__`}if(null===e)return"null";var n;if("object"!=typeof e)return null!==(n=JSON.stringify(e))&&void 0!==n?n:"";if(a(e))return"__PROMISE__";if(Array.isArray(e))return`[${e.map(((e,r)=>di(e,t,r.toString())))}]`;if("function"==typeof e.toJSON)return di(e.toJSON(r),t,r);if(e instanceof Map){const n={};for(const[r,s]of e)n["string"==typeof r?r:di(r,t)]=s;return di(n,t,r)}return e instanceof Set?di(Array.from(e).sort(((e,r)=>di(e,t).localeCompare(di(r,t)))),t,r):void 0!==Symbol&&null!=e[Symbol.iterator]&&"function"==typeof e[Symbol.iterator]?di(Array.from(e),t,r):`{${Object.keys(e).filter((t=>void 0!==e[t])).sort().map((r=>`${di(r,t)}:${di(e[r],t,r)}`)).join(",")}}`}var fi=function(e,t={allowFunctions:!1}){return di(e,t)};const{TreeCache:pi}=ai,gi={equality:"reference",eviction:"keep-all",maxSize:1/0};var yi=function({equality:e=gi.equality,eviction:t=gi.eviction,maxSize:r=gi.maxSize}=gi,n){const s=function(e){switch(e){case"reference":return e=>e;case"value":return e=>fi(e)}throw o(`Unrecognized equality policy ${e}`)}(e);return function(e,t,r,n){switch(e){case"keep-all":return new pi({name:n,mapNodeValue:r});case"lru":return hi({name:n,maxSize:A(t),mapNodeValue:r});case"most-recent":return hi({name:n,maxSize:1,mapNodeValue:r})}throw o(`Unrecognized eviction policy ${e}`)}(t,r,s,n)};const{isReactNative:wi,isWindow:mi}=Ht;var bi={startPerfBlock:function(e){return()=>null}};const{isLoadable:Ei,loadableWithError:vi,loadableWithPromise:Bi,loadableWithValue:_i}=R,{WrappedValue:Ci}=ni,{getNodeLoadable:Si,peekNodeLoadable:Ii,setNodeValue:Ti}=$e,{saveDepsToStore:Ri}=ve,{DEFAULT_VALUE:ki,getConfigDeletionHandler:Ui,getNode:Di,registerNode:Pi}=ce,{isRecoilValue:Li}=J,{markRecoilValueModified:Ni}=yt,{retainedByOptionWithDefault:Oi}=Rt,{recoilCallback:Fi}=$s,{startPerfBlock:Qi}=bi;class xi{}const Mi=new xi,Hi=[],Ki=new Map,Vi=(()=>{let e=0;return()=>e++})();function zi(e){let t=null;const{key:r,get:n,cachePolicy_UNSTABLE:s}=e,i=null!=e.set?e.set:void 0;const c=new Set,l=yi(null!=s?s:{equality:"reference",eviction:"keep-all"},r),u=Oi(e.retainedBy_UNSTABLE),h=new Map;let d=0;function f(){return!D("recoil_memory_managament_2020")||d>0}function p(e){return e.getState().knownSelectors.add(r),d++,()=>{d--}}function g(){return void 0!==Ui(r)&&!f()}function y(e,t,r,n,s){k(t,n,s),w(e,r)}function w(e,t){R(e,t)&&T(e),m(t,!0)}function m(e,r){const n=Ki.get(e);if(null!=n){for(const e of n)Ni(e,A(t));r&&Ki.delete(e)}}function b(e,t){let r=Ki.get(t);null==r&&Ki.set(t,r=new Set),r.add(e)}function E(e,t,r,n,s,i){return t.then((n=>{if(!f())throw T(e),Mi;null!=i.loadingDepKey&&i.loadingDepPromise===t?r.atomValues.set(i.loadingDepKey,_i(n)):e.getState().knownSelectors.forEach((e=>{r.atomValues.delete(e)}));const o=_(e,r);if(o&&"loading"!==o.state){if((R(e,s)||null==I(e))&&w(e,s),"hasValue"===o.state)return o.contents;throw o.contents}if(!R(e,s)){const t=S(e,r);if(null!=t)return t.loadingLoadable.contents}const[a,A]=B(e,r,s);if("loading"!==a.state&&y(e,r,s,a,A),"hasError"===a.state)throw a.contents;return a.contents})).catch((t=>{if(t instanceof xi)throw Mi;if(!f())throw T(e),Mi;const i=vi(t);throw y(e,r,s,i,n),t}))}function v(e,t,n,s){var i,o,a,A,l,u,h;(R(e,s)||t.version===(null===(i=e.getState())||void 0===i||null===(o=i.currentTree)||void 0===o?void 0:o.version)||t.version===(null===(a=e.getState())||void 0===a||null===(A=a.nextTree)||void 0===A?void 0:A.version))&&Ri(r,n,e,null!==(l=null===(u=e.getState())||void 0===u||null===(h=u.nextTree)||void 0===h?void 0:h.version)&&void 0!==l?l:e.getState().currentTree.version);for(const e of n)c.add(e)}function B(e,s,i){const c=Qi(r);let l=!0,u=!0;const h=()=>{c(),u=!1};let d,p,g=!1;const w={loadingDepKey:null,loadingDepPromise:null},b=new Map;function B({key:t}){const r=Si(e,s,t);switch(b.set(t,r),l||(v(e,s,new Set(b.keys()),i),function(e,t){R(e,t)&&(A(I(e)).stateVersions.clear(),m(t,!1))}(e,i)),r.state){case"hasValue":return r.contents;case"hasError":throw r.contents;case"loading":throw w.loadingDepKey=t,w.loadingDepPromise=r.contents,r.contents}throw o("Invalid Loadable state")}const _=r=>(...n)=>{if(u)throw o("Callbacks from getCallback() should only be called asynchronously after the selector is evalutated.  It can be used for selectors to return objects with callbacks that can work with Recoil state without a subscription.");return null==t&&Ls(!1),Fi(e,r,n,{node:t})};try{d=n({get:B,getCallback:_}),d=Li(d)?B(d):d,Ei(d)&&("hasError"===d.state&&(g=!0),d=d.contents),a(d)?d=function(e,t,r,n,s,i){return t.then((t=>{if(!f())throw T(e),Mi;const i=_i(t);return y(e,r,s,i,n),t})).catch((t=>{if(!f())throw T(e),Mi;if(a(t))return E(e,t,r,n,s,i);const o=vi(t);throw y(e,r,s,o,n),t}))}(e,d,s,b,i,w).finally(h):h(),d=d instanceof Ci?d.value:d}catch(t){d=t,a(d)?d=E(e,d,s,b,i,w).finally(h):(g=!0,h())}return p=g?vi(d):a(d)?Bi(d):_i(d),l=!1,function(e,t,r){if(R(e,t)){const t=I(e);null!=t&&(t.depValuesDiscoveredSoFarDuringAsyncWork=r)}}(e,i,b),v(e,s,new Set(b.keys()),i),[p,b]}function _(e,t){let n=t.atomValues.get(r);if(null!=n)return n;const s=new Set;try{n=l.get((r=>("string"!=typeof r&&Ls(!1),Si(e,t,r).contents)),{onNodeVisit:e=>{"branch"===e.type&&e.nodeKey!==r&&s.add(e.nodeKey)}})}catch(e){throw o(`Problem with cache lookup for selector "${r}": ${e.message}`)}var i;n&&(t.atomValues.set(r,n),v(e,t,s,null===(i=I(e))||void 0===i?void 0:i.executionID));return n}function C(e,t){const r=_(e,t);if(null!=r)return T(e),r;const n=S(e,t);var s;if(null!=n)return"loading"===(null===(s=n.loadingLoadable)||void 0===s?void 0:s.state)&&b(e,n.executionID),n.loadingLoadable;const i=Vi(),[o,a]=B(e,t,i);return"loading"===o.state?(!function(e,t,r,n,s){h.set(e,{depValuesDiscoveredSoFarDuringAsyncWork:n,executionID:t,loadingLoadable:r,stateVersions:new Map([[s.version,!0]])})}(e,i,o,a,t),b(e,i)):(T(e),k(t,o,a)),o}function S(e,t){const r=Qt([h.has(e)?[A(h.get(e))]:[],ee(Ne(h,(([t])=>t!==e)),(([,e])=>e))]);function n(r){for(const[n,s]of r)if(!Si(e,t,n).is(s))return!0;return!1}for(const e of r){if(e.stateVersions.get(t.version)||!n(e.depValuesDiscoveredSoFarDuringAsyncWork))return e.stateVersions.set(t.version,!0),e;e.stateVersions.set(t.version,!1)}}function I(e){return h.get(e)}function T(e){h.delete(e)}function R(e,t){var r;return t===(null===(r=I(e))||void 0===r?void 0:r.executionID)}function k(e,t,n){e.atomValues.set(r,t);try{l.set(function(e){return Array.from(e.entries()).map((([e,t])=>[e,t.contents]))}(n),t)}catch(e){throw o(`Problem with setting cache for selector "${r}": ${e.message}`)}}function U(e,t){const n=t.atomValues.get(r);return null!=n?n:l.get((r=>{var n;return"string"!=typeof r&&Ls(!1),null===(n=Ii(e,t,r))||void 0===n?void 0:n.contents}))}function P(e,t){return function(e){if(Hi.includes(r)){const e=`Recoil selector has circular dependencies: ${Hi.slice(Hi.indexOf(r)).join("  ")}`;return vi(o(e))}Hi.push(r);try{return e()}finally{Hi.pop()}}((()=>C(e,t)))}function L(e){e.atomValues.delete(r)}function N(e,r){null==t&&Ls(!1);for(const t of c){var n;const s=Di(t);null===(n=s.clearCache)||void 0===n||n.call(s,e,r)}c.clear(),L(r),l.clear(),Ni(e,t)}if(null!=i){return t=Pi({key:r,nodeType:"selector",peek:U,get:P,set:(e,t,n)=>{let s=!1;const A=new Map;function c({key:n}){if(s)throw o("Recoil: Async selector sets are not currently supported.");const i=Si(e,t,n);if("hasValue"===i.state)return i.contents;if("loading"===i.state){const e=`Getting value of asynchronous atom or selector "${n}" in a pending state while setting selector "${r}" is not yet supported.`;throw O(e),o(e)}throw i.contents}function l(r,n){if(s){const e="Recoil: Async selector sets are not currently supported.";throw O(e),o(e)}const i="function"==typeof n?n(c(r)):n;Ti(e,t,r.key,i).forEach(((e,t)=>A.set(t,e)))}const u=i({set:l,get:c,reset:function(e){l(e,ki)}},n);if(void 0!==u)throw a(u)?o("Recoil: Async selector sets are not currently supported."):o("Recoil: selector set should be a void function.");return s=!0,A},init:p,invalidate:L,clearCache:N,shouldDeleteConfigOnRelease:g,dangerouslyAllowMutability:e.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1,retainedBy:u})}return t=Pi({key:r,nodeType:"selector",peek:U,get:P,init:p,invalidate:L,clearCache:N,shouldDeleteConfigOnRelease:g,dangerouslyAllowMutability:e.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1,retainedBy:u})}zi.value=e=>new Ci(e);var ji=zi;const{isLoadable:Gi,loadableWithError:$i,loadableWithPromise:qi,loadableWithValue:Wi}=R,{WrappedValue:Yi}=ni,{peekNodeInfo:Xi}=$e,{DEFAULT_VALUE:Ji,DefaultValue:Zi,getConfigDeletionHandler:eo,registerNode:to,setConfigDeletionHandler:ro}=ce,{isRecoilValue:no}=J,{getRecoilValueAsLoadable:so,markRecoilValueModified:io,setRecoilValue:oo,setRecoilValueLoadable:ao}=yt,{retainedByOptionWithDefault:Ao}=Rt,co=e=>e instanceof Yi?e.value:e;function lo(e){const{key:t,persistence_UNSTABLE:r}=e,n=Ao(e.retainedBy_UNSTABLE);let s=0;function i(e){return qi(e.then((e=>(l=Wi(e),e))).catch((e=>{throw l=$i(e),e})))}let c,l=a(e.default)?i(e.default):Gi(e.default)?"loading"===e.default.state?i(e.default.contents):e.default:Wi(co(e.default));h(l.contents);const u=new Map;function h(e){return e}function d(e,r){var n,s;return null!==(n=null!==(s=r.atomValues.get(t))&&void 0!==s?s:c)&&void 0!==n?n:l}const f=to({key:t,nodeType:"atom",peek:d,get:function(e,n){if(n.atomValues.has(t))return A(n.atomValues.get(t));if(n.nonvalidatedAtoms.has(t)){if(null!=c)return c;if(null==r)return Z(`Tried to restore a persisted value for atom ${t} but it has no persistence settings.`),l;const e=n.nonvalidatedAtoms.get(t),s=r.validator(e,Ji),i=s instanceof Zi?l:Wi(s);return c=i,c}return l},set:function(e,r,n){if(r.atomValues.has(t)){const e=A(r.atomValues.get(t));if("hasValue"===e.state&&n===e.contents)return new Map}else if(!r.nonvalidatedAtoms.has(t)&&n instanceof Zi)return new Map;return c=void 0,(new Map).set(t,Wi(n))},init:function(r,n,i){var A;if(s++,r.getState().knownAtoms.add(t),"loading"===l.state){const g=()=>{var e;(null!==(e=r.getState().nextTree)&&void 0!==e?e:r.getState().currentTree).atomValues.has(t)||io(r,f)};l.contents.finally(g)}const c=null!==(A=e.effects)&&void 0!==A?A:e.effects_UNSTABLE;if(null!=c){let y=Ji,w=!0,m=!1,b=null;function E(e){if(w&&e.key===t){const e=y;return e instanceof Zi?d(r,n):a(e)?qi(e.then((e=>e instanceof Zi?l.toPromise():e))):Wi(e)}return so(r,e)}function v(e){return E(e).toPromise()}function B(e){var n;const s=Xi(r,null!==(n=r.getState().nextTree)&&void 0!==n?n:r.getState().currentTree,e.key);return!w||e.key!==t||y instanceof Zi?s:{...s,isSet:!0,loadable:E(e)}}const _=e=>t=>{if(w){const r=E(f),n="hasValue"===r.state?r.contents:Ji;y="function"==typeof t?t(n):t,a(y)&&(y=y.then((t=>(b={effect:e,value:t},t))))}else{if(a(t))throw o("Setting atoms to async values is not implemented.");"function"!=typeof t&&(b={effect:e,value:co(t)}),oo(r,f,"function"==typeof t?r=>{const n=co(t(r));return b={effect:e,value:n},n}:co(t))}},C=e=>()=>_(e)(Ji),S=e=>n=>{var s;const{release:i}=r.subscribeToTransactions((r=>{var s;let{currentTree:i,previousTree:o}=r.getState();o||(O("Transaction subscribers notified without a next tree being present -- this is a bug in Recoil"),o=i);const a=null!==(s=i.atomValues.get(t))&&void 0!==s?s:l;if("hasValue"===a.state){var A,c,u,h;const r=a.contents,s=null!==(A=o.atomValues.get(t))&&void 0!==A?A:l,d="hasValue"===s.state?s.contents:Ji;(null===(c=b)||void 0===c?void 0:c.effect)!==e||(null===(u=b)||void 0===u?void 0:u.value)!==r?n(r,d,!i.atomValues.has(t)):(null===(h=b)||void 0===h?void 0:h.effect)===e&&(b=null)}}),t);u.set(r,[...null!==(s=u.get(r))&&void 0!==s?s:[],i])};for(const I of c)try{const T=I({node:f,storeID:r.storeID,parentStoreID_UNSTABLE:r.parentStoreID,trigger:i,setSelf:_(I),resetSelf:C(I),onSet:S(I),getPromise:v,getLoadable:E,getInfo_UNSTABLE:B});var h;if(null!=T)u.set(r,[...null!==(h=u.get(r))&&void 0!==h?h:[],T])}catch(R){y=R,m=!0}if(w=!1,!(y instanceof Zi)){var p;const k=m?$i(y):a(y)?qi(function(e,r){const n=r.then((r=>{var s,i;return(null===(i=(null!==(s=e.getState().nextTree)&&void 0!==s?s:e.getState().currentTree).atomValues.get(t))||void 0===i?void 0:i.contents)===n&&oo(e,f,r),r})).catch((r=>{var s,i;throw(null===(i=(null!==(s=e.getState().nextTree)&&void 0!==s?s:e.getState().currentTree).atomValues.get(t))||void 0===i?void 0:i.contents)===n&&ao(e,f,$i(r)),r}));return n}(r,y)):Wi(co(y));k.contents,n.atomValues.set(t,k),null===(p=r.getState().nextTree)||void 0===p||p.atomValues.set(t,k)}}return()=>{var e;s--,null===(e=u.get(r))||void 0===e||e.forEach((e=>e())),u.delete(r)}},invalidate:function(){c=void 0},shouldDeleteConfigOnRelease:function(){return void 0!==eo(t)&&s<=0},dangerouslyAllowMutability:e.dangerouslyAllowMutability,persistence_UNSTABLE:e.persistence_UNSTABLE?{type:e.persistence_UNSTABLE.type,backButton:e.persistence_UNSTABLE.backButton}:void 0,shouldRestoreFromSnapshots:!0,retainedBy:n});return f}function uo(e){const{...t}=e,r="default"in e?e.default:new Promise((()=>{}));return no(r)?function(e){const t=uo({...e,default:Ji,persistence_UNSTABLE:void 0===e.persistence_UNSTABLE?void 0:{...e.persistence_UNSTABLE,validator:t=>t instanceof Zi?t:A(e.persistence_UNSTABLE).validator(t,Ji)},effects:e.effects,effects_UNSTABLE:e.effects_UNSTABLE}),r=ji({key:`${e.key}__withFallback`,get:({get:r})=>{const n=r(t);return n instanceof Zi?e.default:n},set:({set:e},r)=>e(t,r),cachePolicy_UNSTABLE:{eviction:"most-recent"},dangerouslyAllowMutability:e.dangerouslyAllowMutability});return ro(r.key,eo(e.key)),r}({...t,default:r}):lo({...t,default:r})}uo.value=e=>new Yi(e);var ho=uo;var fo=class{constructor(e){var t;c(this,"_map",void 0),c(this,"_keyMapper",void 0),this._map=new Map,this._keyMapper=null!==(t=null==e?void 0:e.mapKey)&&void 0!==t?t:e=>e}size(){return this._map.size}has(e){return this._map.has(this._keyMapper(e))}get(e){return this._map.get(this._keyMapper(e))}set(e,t){this._map.set(this._keyMapper(e),t)}delete(e){this._map.delete(this._keyMapper(e))}clear(){this._map.clear()}},po=Object.freeze({__proto__:null,MapCache:fo});const{LRUCache:go}=ci,{MapCache:yo}=po,wo={equality:"reference",eviction:"none",maxSize:1/0};var mo=function({equality:e=wo.equality,eviction:t=wo.eviction,maxSize:r=wo.maxSize}=wo){const n=function(e){switch(e){case"reference":return e=>e;case"value":return e=>fi(e)}throw o(`Unrecognized equality policy ${e}`)}(e);return function(e,t,r){switch(e){case"keep-all":return new yo({mapKey:r});case"lru":return new go({mapKey:r,maxSize:A(t)});case"most-recent":return new go({mapKey:r,maxSize:1})}throw o(`Unrecognized eviction policy ${e}`)}(t,r,n)};const{setConfigDeletionHandler:bo}=ce;var Eo=function(e){var t,r;const n=mo({equality:null!==(t=null===(r=e.cachePolicyForParams_UNSTABLE)||void 0===r?void 0:r.equality)&&void 0!==t?t:"value",eviction:"keep-all"});return t=>{var r,s;const i=n.get(t);if(null!=i)return i;const{cachePolicyForParams_UNSTABLE:o,...a}=e,A="default"in e?e.default:new Promise((()=>{})),c=ho({...a,key:`${e.key}__${null!==(r=fi(t))&&void 0!==r?r:"void"}`,default:"function"==typeof A?A(t):A,retainedBy_UNSTABLE:"function"==typeof e.retainedBy_UNSTABLE?e.retainedBy_UNSTABLE(t):e.retainedBy_UNSTABLE,effects:"function"==typeof e.effects?e.effects(t):"function"==typeof e.effects_UNSTABLE?e.effects_UNSTABLE(t):null!==(s=e.effects)&&void 0!==s?s:e.effects_UNSTABLE});return n.set(t,c),bo(c.key,(()=>{n.delete(t)})),c}};const{setConfigDeletionHandler:vo}=ce;let Bo=0;var _o=function(e){var t,r;const n=mo({equality:null!==(t=null===(r=e.cachePolicyForParams_UNSTABLE)||void 0===r?void 0:r.equality)&&void 0!==t?t:"value",eviction:"keep-all"});return t=>{var r;let s;try{s=n.get(t)}catch(t){throw o(`Problem with cache lookup for selector ${e.key}: ${t.message}`)}if(null!=s)return s;const i=`${e.key}__selectorFamily/${null!==(r=fi(t,{allowFunctions:!0}))&&void 0!==r?r:"void"}/${Bo++}`,a=r=>e.get(t)(r),A=e.cachePolicy_UNSTABLE,c="function"==typeof e.retainedBy_UNSTABLE?e.retainedBy_UNSTABLE(t):e.retainedBy_UNSTABLE;let l;if(null!=e.set){const r=e.set;l=ji({key:i,get:a,set:(e,n)=>r(t)(e,n),cachePolicy_UNSTABLE:A,dangerouslyAllowMutability:e.dangerouslyAllowMutability,retainedBy_UNSTABLE:c})}else l=ji({key:i,get:a,cachePolicy_UNSTABLE:A,dangerouslyAllowMutability:e.dangerouslyAllowMutability,retainedBy_UNSTABLE:c});return n.set(t,l),vo(l.key,(()=>{n.delete(t)})),l}};const Co=_o({key:"__constant",get:e=>()=>e,cachePolicyForParams_UNSTABLE:{equality:"reference"}});var So=function(e){return Co(e)};const Io=_o({key:"__error",get:e=>()=>{throw o(e)},cachePolicyForParams_UNSTABLE:{equality:"reference"}});var To=function(e){return Io(e)};var Ro=function(e){return e};const{loadableWithError:ko,loadableWithPromise:Uo,loadableWithValue:Do}=R;function Po(e,t){const r=Array(t.length).fill(void 0),n=Array(t.length).fill(void 0);for(const[s,i]of t.entries())try{r[s]=e(i)}catch(e){n[s]=e}return[r,n]}function Lo(e){return null!=e&&!a(e)}function No(e){return Array.isArray(e)?e:Object.getOwnPropertyNames(e).map((t=>e[t]))}function Oo(e,t){return Array.isArray(e)?t:Object.getOwnPropertyNames(e).reduce(((e,r,n)=>({...e,[r]:t[n]})),{})}function Fo(e,t,r){return Oo(e,r.map(((e,r)=>null==e?Do(t[r]):a(e)?Uo(e):ko(e))))}var Qo={waitForNone:_o({key:"__waitForNone",get:e=>({get:t})=>{const r=No(e),[n,s]=Po(t,r);return Fo(e,n,s)},dangerouslyAllowMutability:!0}),waitForAny:_o({key:"__waitForAny",get:e=>({get:t})=>{const r=No(e),[n,s]=Po(t,r);return s.some((e=>!a(e)))?Fo(e,n,s):new Promise((t=>{for(const[r,i]of s.entries())a(i)&&i.then((i=>{n[r]=i,s[r]=void 0,t(Fo(e,n,s))})).catch((i=>{s[r]=i,t(Fo(e,n,s))}))}))},dangerouslyAllowMutability:!0}),waitForAll:_o({key:"__waitForAll",get:e=>({get:t})=>{const r=No(e),[n,s]=Po(t,r);if(s.every((e=>null==e)))return Oo(e,n);const i=s.find(Lo);if(null!=i)throw i;return Promise.all(s).then((t=>{return Oo(e,(r=n,t.map(((e,t)=>void 0===e?r[t]:e))));var r}))},dangerouslyAllowMutability:!0}),waitForAllSettled:_o({key:"__waitForAllSettled",get:e=>({get:t})=>{const r=No(e),[n,s]=Po(t,r);return s.every((e=>!a(e)))?Fo(e,n,s):Promise.all(s.map(((e,t)=>a(e)?e.then((e=>{n[t]=e,s[t]=void 0})).catch((e=>{n[t]=void 0,s[t]=e})):null))).then((()=>Fo(e,n,s)))},dangerouslyAllowMutability:!0}),noWait:_o({key:"__noWait",get:e=>({get:t})=>{try{return ji.value(Do(t(e)))}catch(e){return ji.value(a(e)?Uo(e):ko(e))}},dangerouslyAllowMutability:!0})};const{RecoilLoadable:xo}=R,{DefaultValue:Mo}=ce,{RecoilRoot:Ho,useRecoilStoreID:Ko}=en,{isRecoilValue:Vo}=J,{retentionZone:zo}=Pe,{freshSnapshot:jo}=yr,{useRecoilState:Go,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:$o,useRecoilStateLoadable:qo,useRecoilValue:Wo,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:Yo,useRecoilValueLoadable:Xo,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:Jo,useResetRecoilState:Zo,useSetRecoilState:ea}=jn,{useGotoRecoilSnapshot:ta,useRecoilSnapshot:ra,useRecoilTransactionObserver:na}=hs,{useRecoilCallback:sa}=$s,{noWait:ia,waitForAll:oa,waitForAllSettled:aa,waitForAny:Aa,waitForNone:ca}=Qo;var la={DefaultValue:Mo,isRecoilValue:Vo,RecoilLoadable:xo,RecoilEnv:V,RecoilRoot:Ho,useRecoilStoreID:Ko,useRecoilBridgeAcrossReactRoots_UNSTABLE:bs,atom:ho,selector:ji,atomFamily:Eo,selectorFamily:_o,constSelector:So,errorSelector:To,readOnlySelector:Ro,noWait:ia,waitForNone:ca,waitForAny:Aa,waitForAll:oa,waitForAllSettled:aa,useRecoilValue:Wo,useRecoilValueLoadable:Xo,useRecoilState:Go,useRecoilStateLoadable:qo,useSetRecoilState:ea,useResetRecoilState:Zo,useGetRecoilValueInfo_UNSTABLE:ps,useRecoilRefresher_UNSTABLE:Xs,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:Jo,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:Yo,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:$o,useRecoilCallback:sa,useRecoilTransaction_UNSTABLE:ti,useGotoRecoilSnapshot:ta,useRecoilSnapshot:ra,useRecoilTransactionObserver_UNSTABLE:na,snapshot_UNSTABLE:jo,useRetain:dn,retentionZone:zo},ua=la.RecoilRoot,ha=la.atom,da=la.selector,fa=la.selectorFamily,pa=la.useRecoilValue,ga=la.useRecoilState},82916:function(e,t,r){"use strict";const n=r(41807);class s{constructor(e,t,r){const s=this;this._started=n(),this._rescheduled=0,this._scheduled=t,this._args=r,this._triggered=!1,this._timerWrapper=()=>{s._rescheduled>0?(s._scheduled=s._rescheduled-(n()-s._started),s._schedule(s._scheduled)):(s._triggered=!0,e.apply(null,s._args))},this._timer=setTimeout(this._timerWrapper,t)}reschedule(e){e||(e=this._scheduled);const t=n();t+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=t,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=n(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}}e.exports=function(){if("function"!=typeof arguments[0])throw new Error("callback needed");if("number"!=typeof arguments[1])throw new Error("timeout needed");let e;if(arguments.length>0){e=new Array(arguments.length-2);for(var t=0;t<e.length;t++)e[t]=arguments[t+2]}return new s(arguments[0],arguments[1],e)}},41807:function(e){"use strict";e.exports=function(){return Date.now()}},29967:function(e,t,r){e.exports=function(e,t,r){if("number"!=typeof t)throw new Error("second argument must be a Number");let s,i,o,a,A,c,l=!0;Array.isArray(e)?(s=[],o=i=e.length):(a=Object.keys(e),s={},o=i=a.length);function u(e){function t(){r&&r(e,s),r=null}l?n(t):t()}function h(t,r,n){if(s[t]=n,r&&(A=!0),0==--o||r)u(r);else if(!A&&c<i){let t;a?(t=a[c],c+=1,e[t]((function(e,r){h(t,e,r)}))):(t=c,c+=1,e[t]((function(e,r){h(t,e,r)})))}}c=t,o?a?a.some((function(r,n){return e[r]((function(e,t){h(r,e,t)})),n===t-1})):e.some((function(e,r){return e((function(e,t){h(r,e,t)})),r===t-1})):u(null);l=!1};const n=r(54375)},89509:function(e,t,r){var n=r(48764),s=n.Buffer;function i(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return s(e,t,r)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?e.exports=n:(i(n,t),t.Buffer=o),o.prototype=Object.create(s.prototype),i(s,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return s(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=s(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return s(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},50202:function(e,t,r){"use strict";var n=r(63700),s=/[\/\?<>\\:\*\|"]/g,i=/[\x00-\x1f\x80-\x9f]/g,o=/^\.+$/,a=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,A=/[\. ]+$/;function c(e,t){if("string"!=typeof e)throw new Error("Input must be string");var r=e.replace(s,t).replace(i,t).replace(o,t).replace(a,t).replace(A,t);return n(r,255)}e.exports=function(e,t){var r=t&&t.replacement||"",n=c(e,r);return""===r?n:c(n,"")}},27695:function(e){"use strict";const t=new Map;e.exports={setDelayedInterval:function(e,r,n){n=n||r;const s=`${Date.now()}:${Math.floor(1e6*Math.random())}`,i=setTimeout((()=>{!async function(e,r,n){for(;t.get(n);){try{await e()}catch(e){setTimeout((()=>{throw e}),1);break}if(!t.get(n))break;await new Promise((e=>{const s=setTimeout(e,r);t.set(n,s)}))}}(e,r,s)}),n);return t.set(s,i),s},clearDelayedInterval:function(e){const r=t.get(e);r&&(clearTimeout(r),t.delete(e))}}},20544:function(e){"use strict";function t(e,t){return e+r(t)}function r(e){let t=e;return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),16843009*(t+(t>>4)&252645135)>>24}function n(e,t){return e[0]-t[0]}function s(e){return e[1]}e.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,t){let r=this._internalPositionFor(e,!1);if(void 0===t)-1!==r&&(this._unsetInternalPos(r),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let n=!1;-1===r?(r=this._data.length,this._setBit(e),this._changedData=!0):n=!0,this._setInternalPos(r,e,t,n),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();const t=this._internalPositionFor(e,!0);if(-1!==t)return this._data[t][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){const e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let t=0;for(;t<this.length;)e(this.get(t),t,this),t++}map(e){let t=0,r=new Array(this.length);for(;t<this.length;)r[t]=e(this.get(t),t,this),t++;return r}reduce(e,t){let r=0,n=t;for(;r<this.length;){n=e(n,this.get(r),r),r++}return n}find(e){let t,r,n=0;for(;n<this.length&&!t;)r=this.get(n),t=e(r),n++;return t?r:void 0}_internalPositionFor(e,n){const s=this._bytePosFor(e,n);if(s>=this._bitArrays.length)return-1;const i=this._bitArrays[s],o=e-7*s;if(!((i&1<<o)>0))return-1;return this._bitArrays.slice(0,s).reduce(t,0)+r(i&~(4294967295<<o+1))-1}_bytePosFor(e,t){const r=Math.floor(e/7),n=r+1;for(;!t&&this._bitArrays.length<n;)this._bitArrays.push(0);return r}_setBit(e){const t=this._bytePosFor(e,!1);this._bitArrays[t]|=1<<e-7*t}_unsetBit(e){const t=this._bytePosFor(e,!1);this._bitArrays[t]&=~(1<<e-7*t)}_setInternalPos(e,t,r,n){const s=this._data,i=[t,r];if(n)this._sortData(),s[e]=i;else{if(s.length)if(s[s.length-1][0]>=t)s.push(i);else if(s[0][0]<=t)s.unshift(i);else{const e=Math.round(s.length/2);this._data=s.slice(0,e).concat(i).concat(s.slice(e))}else this._data.push(i);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(n),this._changedData=!1}bitField(){const e=[];let t,r=8,n=0,s=0;const i=this._bitArrays.slice();for(;i.length||n;){0===n&&(t=i.shift(),n=7);const o=Math.min(n,r);s|=(t&~(255<<o))<<8-r,t>>>=o,n-=o,r-=o,r&&(n||i.length)||(e.push(s),s=0,r=8)}for(var o=e.length-1;o>0;o--){if(0!==e[o])break;e.pop()}return e}compactArray(){return this._sortData(),this._data.map(s)}}},50590:function(e){e.exports=e=>{if(e[Symbol.asyncIterator])return e;if(e.getReader)return async function*(){const t=e.getReader();try{for(;;){const{done:e,value:r}=await t.read();if(e)return;yield r}}finally{t.releaseLock()}}();throw new Error("unknown stream")}},10715:function(e,t,r){"use strict";const{AbortController:n}=globalThis,s=r(82916);class i extends n{constructor(e){super(),this._ms=e,this._timer=s((()=>this.abort()),e),Object.setPrototypeOf(this,i.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=s((()=>this.abort()),this._ms)}}e.exports={TimeoutController:i}},11742:function(e){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,r=[],n=0;n<e.rangeCount;n++)r.push(e.getRangeAt(n));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||r.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},63700:function(e,t,r){"use strict";var n=r(71156),s=r(90793);e.exports=n.bind(null,s)},71156:function(e){"use strict";function t(e){return e>=55296&&e<=56319}function r(e){return e>=56320&&e<=57343}e.exports=function(e,n,s){if("string"!=typeof n)throw new Error("Input must be string");for(var i,o,a=n.length,A=0,c=0;c<a;c+=1){if(i=n.charCodeAt(c),o=n[c],t(i)&&r(n.charCodeAt(c+1))&&(o+=n[c+=1]),(A+=e(o))===s)return n.slice(0,c+1);if(A>s)return n.slice(0,c-o.length+1)}return n}},90793:function(e){"use strict";function t(e){return e>=55296&&e<=56319}function r(e){return e>=56320&&e<=57343}e.exports=function(e){if("string"!=typeof e)throw new Error("Input must be string");for(var n=e.length,s=0,i=null,o=null,a=0;a<n;a++)r(i=e.charCodeAt(a))?null!=o&&t(o)?s+=1:s+=3:i<=127?s+=1:i>=128&&i<=2047?s+=2:i>=2048&&i<=65535&&(s+=3),o=i;return s}},23209:function(e){e.exports=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s}},7089:function(e){e.exports=function e(r,n,s){n=n||[];var i=s=s||0;for(;r>=t;)n[s++]=255&r|128,r/=128;for(;-128&r;)n[s++]=255&r|128,r>>>=7;return n[s]=0|r,e.bytes=s-i+1,n};var t=Math.pow(2,31)},13924:function(e,t,r){e.exports={encode:r(7089),decode:r(23209),encodingLength:r(64146)}},64146:function(e){var t=Math.pow(2,7),r=Math.pow(2,14),n=Math.pow(2,21),s=Math.pow(2,28),i=Math.pow(2,35),o=Math.pow(2,42),a=Math.pow(2,49),A=Math.pow(2,56),c=Math.pow(2,63);e.exports=function(e){return e<t?1:e<r?2:e<n?3:e<s?4:e<i?5:e<o?6:e<a?7:e<A?8:e<c?9:10}},82838:function(e,t,r){"use strict";const n=r(13924);e.exports=e=>{if(!(e instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");const t=[];for(;e.length>0;){const r=n.decode(e);t.push(r),e=e.slice(n.decode.bytes)}return t}},26988:function(e){e.exports=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a||i>49)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s}},1312:function(e){e.exports=function e(r,n,s){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw e.bytes=0,new RangeError("Could not encode varint");n=n||[];var i=s=s||0;for(;r>=t;)n[s++]=255&r|128,r/=128;for(;-128&r;)n[s++]=255&r|128,r>>>=7;return n[s]=0|r,e.bytes=s-i+1,n};var t=Math.pow(2,31)},94676:function(e,t,r){e.exports={encode:r(1312),decode:r(26988),encodingLength:r(10082)}},10082:function(e){var t=Math.pow(2,7),r=Math.pow(2,14),n=Math.pow(2,21),s=Math.pow(2,28),i=Math.pow(2,35),o=Math.pow(2,42),a=Math.pow(2,49),A=Math.pow(2,56),c=Math.pow(2,63);e.exports=function(e){return e<t?1:e<r?2:e<n?3:e<s?4:e<i?5:e<o?6:e<a?7:e<A?8:e<c?9:10}},18237:function(e){function t(e){function r(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return t=function(e){this.s=e,this.n=e.next},t.prototype={s:null,n:null,next:function(){return r(this.n.apply(this.s,arguments))},return:function(e){var t=this.s.return;return void 0===t?Promise.resolve({value:e,done:!0}):r(t.apply(this.s,arguments))},throw:function(e){var t=this.s.return;return void 0===t?Promise.reject(e):r(t.apply(this.s,arguments))}},new t(e)}e.exports=function(e){var r,n,s,i=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,s=Symbol.iterator);i--;){if(n&&null!=(r=e[n]))return r.call(e);if(s&&null!=(r=e[s]))return new t(r.call(e));n="@@asyncIterator",s="@@iterator"}throw new TypeError("Object is not async iterable")},e.exports.__esModule=!0,e.exports.default=e.exports},64482:function(e,t,r){var n,s,i;s=[r(42450)],void 0===(i="function"==typeof(n=function(e){"use strict";var t=e.Reader,r=e.Writer,n=e.util,s=e.roots.default||(e.roots.default={});return s.RPC=function(){function i(e){if(this.subscriptions=[],this.messages=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.subscriptions=n.emptyArray,i.prototype.messages=n.emptyArray,i.prototype.control=null,Object.defineProperty(i.prototype,"_control",{get:n.oneOfGetter(o=["control"]),set:n.oneOfSetter(o)}),i.encode=function(e,t){if(t||(t=r.create()),null!=e.subscriptions&&e.subscriptions.length)for(var n=0;n<e.subscriptions.length;++n)s.RPC.SubOpts.encode(e.subscriptions[n],t.uint32(10).fork()).ldelim();if(null!=e.messages&&e.messages.length)for(n=0;n<e.messages.length;++n)s.RPC.Message.encode(e.messages[n],t.uint32(18).fork()).ldelim();return null!=e.control&&Object.hasOwnProperty.call(e,"control")&&s.RPC.ControlMessage.encode(e.control,t.uint32(26).fork()).ldelim(),t},i.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,i=new s.RPC;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.subscriptions&&i.subscriptions.length||(i.subscriptions=[]),i.subscriptions.push(s.RPC.SubOpts.decode(e,e.uint32()));break;case 2:i.messages&&i.messages.length||(i.messages=[]),i.messages.push(s.RPC.Message.decode(e,e.uint32()));break;case 3:i.control=s.RPC.ControlMessage.decode(e,e.uint32());break;default:e.skipType(7&o)}}return i},i.fromObject=function(e){if(e instanceof s.RPC)return e;var t=new s.RPC;if(e.subscriptions){if(!Array.isArray(e.subscriptions))throw TypeError(".RPC.subscriptions: array expected");t.subscriptions=[];for(var r=0;r<e.subscriptions.length;++r){if("object"!=typeof e.subscriptions[r])throw TypeError(".RPC.subscriptions: object expected");t.subscriptions[r]=s.RPC.SubOpts.fromObject(e.subscriptions[r])}}if(e.messages){if(!Array.isArray(e.messages))throw TypeError(".RPC.messages: array expected");for(t.messages=[],r=0;r<e.messages.length;++r){if("object"!=typeof e.messages[r])throw TypeError(".RPC.messages: object expected");t.messages[r]=s.RPC.Message.fromObject(e.messages[r])}}if(null!=e.control){if("object"!=typeof e.control)throw TypeError(".RPC.control: object expected");t.control=s.RPC.ControlMessage.fromObject(e.control)}return t},i.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.subscriptions=[],r.messages=[]),e.subscriptions&&e.subscriptions.length){r.subscriptions=[];for(var n=0;n<e.subscriptions.length;++n)r.subscriptions[n]=s.RPC.SubOpts.toObject(e.subscriptions[n],t)}if(e.messages&&e.messages.length)for(r.messages=[],n=0;n<e.messages.length;++n)r.messages[n]=s.RPC.Message.toObject(e.messages[n],t);return null!=e.control&&e.hasOwnProperty("control")&&(r.control=s.RPC.ControlMessage.toObject(e.control,t),t.oneofs&&(r._control="control")),r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i.SubOpts=function(){function i(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.subscribe=null,i.prototype.topic=null,Object.defineProperty(i.prototype,"_subscribe",{get:n.oneOfGetter(o=["subscribe"]),set:n.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_topic",{get:n.oneOfGetter(o=["topic"]),set:n.oneOfSetter(o)}),i.encode=function(e,t){return t||(t=r.create()),null!=e.subscribe&&Object.hasOwnProperty.call(e,"subscribe")&&t.uint32(8).bool(e.subscribe),null!=e.topic&&Object.hasOwnProperty.call(e,"topic")&&t.uint32(18).string(e.topic),t},i.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,i=new s.RPC.SubOpts;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.subscribe=e.bool();break;case 2:i.topic=e.string();break;default:e.skipType(7&o)}}return i},i.fromObject=function(e){if(e instanceof s.RPC.SubOpts)return e;var t=new s.RPC.SubOpts;return null!=e.subscribe&&(t.subscribe=Boolean(e.subscribe)),null!=e.topic&&(t.topic=String(e.topic)),t},i.toObject=function(e,t){t||(t={});var r={};return null!=e.subscribe&&e.hasOwnProperty("subscribe")&&(r.subscribe=e.subscribe,t.oneofs&&(r._subscribe="subscribe")),null!=e.topic&&e.hasOwnProperty("topic")&&(r.topic=e.topic,t.oneofs&&(r._topic="topic")),r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.Message=function(){function i(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.from=null,i.prototype.data=null,i.prototype.seqno=null,i.prototype.topic="",i.prototype.signature=null,i.prototype.key=null,Object.defineProperty(i.prototype,"_from",{get:n.oneOfGetter(o=["from"]),set:n.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_data",{get:n.oneOfGetter(o=["data"]),set:n.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_seqno",{get:n.oneOfGetter(o=["seqno"]),set:n.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_signature",{get:n.oneOfGetter(o=["signature"]),set:n.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_key",{get:n.oneOfGetter(o=["key"]),set:n.oneOfSetter(o)}),i.encode=function(e,t){return t||(t=r.create()),null!=e.from&&Object.hasOwnProperty.call(e,"from")&&t.uint32(10).bytes(e.from),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),null!=e.seqno&&Object.hasOwnProperty.call(e,"seqno")&&t.uint32(26).bytes(e.seqno),t.uint32(34).string(e.topic),null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(42).bytes(e.signature),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(50).bytes(e.key),t},i.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,o=new s.RPC.Message;e.pos<i;){var a=e.uint32();switch(a>>>3){case 1:o.from=e.bytes();break;case 2:o.data=e.bytes();break;case 3:o.seqno=e.bytes();break;case 4:o.topic=e.string();break;case 5:o.signature=e.bytes();break;case 6:o.key=e.bytes();break;default:e.skipType(7&a)}}if(!o.hasOwnProperty("topic"))throw n.ProtocolError("missing required 'topic'",{instance:o});return o},i.fromObject=function(e){if(e instanceof s.RPC.Message)return e;var t=new s.RPC.Message;return null!=e.from&&("string"==typeof e.from?n.base64.decode(e.from,t.from=n.newBuffer(n.base64.length(e.from)),0):e.from.length&&(t.from=e.from)),null!=e.data&&("string"==typeof e.data?n.base64.decode(e.data,t.data=n.newBuffer(n.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),null!=e.seqno&&("string"==typeof e.seqno?n.base64.decode(e.seqno,t.seqno=n.newBuffer(n.base64.length(e.seqno)),0):e.seqno.length&&(t.seqno=e.seqno)),null!=e.topic&&(t.topic=String(e.topic)),null!=e.signature&&("string"==typeof e.signature?n.base64.decode(e.signature,t.signature=n.newBuffer(n.base64.length(e.signature)),0):e.signature.length&&(t.signature=e.signature)),null!=e.key&&("string"==typeof e.key?n.base64.decode(e.key,t.key=n.newBuffer(n.base64.length(e.key)),0):e.key.length&&(t.key=e.key)),t},i.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.topic=""),null!=e.from&&e.hasOwnProperty("from")&&(r.from=t.bytes===String?n.base64.encode(e.from,0,e.from.length):t.bytes===Array?Array.prototype.slice.call(e.from):e.from,t.oneofs&&(r._from="from")),null!=e.data&&e.hasOwnProperty("data")&&(r.data=t.bytes===String?n.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data,t.oneofs&&(r._data="data")),null!=e.seqno&&e.hasOwnProperty("seqno")&&(r.seqno=t.bytes===String?n.base64.encode(e.seqno,0,e.seqno.length):t.bytes===Array?Array.prototype.slice.call(e.seqno):e.seqno,t.oneofs&&(r._seqno="seqno")),null!=e.topic&&e.hasOwnProperty("topic")&&(r.topic=e.topic),null!=e.signature&&e.hasOwnProperty("signature")&&(r.signature=t.bytes===String?n.base64.encode(e.signature,0,e.signature.length):t.bytes===Array?Array.prototype.slice.call(e.signature):e.signature,t.oneofs&&(r._signature="signature")),null!=e.key&&e.hasOwnProperty("key")&&(r.key=t.bytes===String?n.base64.encode(e.key,0,e.key.length):t.bytes===Array?Array.prototype.slice.call(e.key):e.key,t.oneofs&&(r._key="key")),r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlMessage=function(){function i(e){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return i.prototype.ihave=n.emptyArray,i.prototype.iwant=n.emptyArray,i.prototype.graft=n.emptyArray,i.prototype.prune=n.emptyArray,i.encode=function(e,t){if(t||(t=r.create()),null!=e.ihave&&e.ihave.length)for(var n=0;n<e.ihave.length;++n)s.RPC.ControlIHave.encode(e.ihave[n],t.uint32(10).fork()).ldelim();if(null!=e.iwant&&e.iwant.length)for(n=0;n<e.iwant.length;++n)s.RPC.ControlIWant.encode(e.iwant[n],t.uint32(18).fork()).ldelim();if(null!=e.graft&&e.graft.length)for(n=0;n<e.graft.length;++n)s.RPC.ControlGraft.encode(e.graft[n],t.uint32(26).fork()).ldelim();if(null!=e.prune&&e.prune.length)for(n=0;n<e.prune.length;++n)s.RPC.ControlPrune.encode(e.prune[n],t.uint32(34).fork()).ldelim();return t},i.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,i=new s.RPC.ControlMessage;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.ihave&&i.ihave.length||(i.ihave=[]),i.ihave.push(s.RPC.ControlIHave.decode(e,e.uint32()));break;case 2:i.iwant&&i.iwant.length||(i.iwant=[]),i.iwant.push(s.RPC.ControlIWant.decode(e,e.uint32()));break;case 3:i.graft&&i.graft.length||(i.graft=[]),i.graft.push(s.RPC.ControlGraft.decode(e,e.uint32()));break;case 4:i.prune&&i.prune.length||(i.prune=[]),i.prune.push(s.RPC.ControlPrune.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return i},i.fromObject=function(e){if(e instanceof s.RPC.ControlMessage)return e;var t=new s.RPC.ControlMessage;if(e.ihave){if(!Array.isArray(e.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");t.ihave=[];for(var r=0;r<e.ihave.length;++r){if("object"!=typeof e.ihave[r])throw TypeError(".RPC.ControlMessage.ihave: object expected");t.ihave[r]=s.RPC.ControlIHave.fromObject(e.ihave[r])}}if(e.iwant){if(!Array.isArray(e.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");for(t.iwant=[],r=0;r<e.iwant.length;++r){if("object"!=typeof e.iwant[r])throw TypeError(".RPC.ControlMessage.iwant: object expected");t.iwant[r]=s.RPC.ControlIWant.fromObject(e.iwant[r])}}if(e.graft){if(!Array.isArray(e.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");for(t.graft=[],r=0;r<e.graft.length;++r){if("object"!=typeof e.graft[r])throw TypeError(".RPC.ControlMessage.graft: object expected");t.graft[r]=s.RPC.ControlGraft.fromObject(e.graft[r])}}if(e.prune){if(!Array.isArray(e.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");for(t.prune=[],r=0;r<e.prune.length;++r){if("object"!=typeof e.prune[r])throw TypeError(".RPC.ControlMessage.prune: object expected");t.prune[r]=s.RPC.ControlPrune.fromObject(e.prune[r])}}return t},i.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.ihave=[],r.iwant=[],r.graft=[],r.prune=[]),e.ihave&&e.ihave.length){r.ihave=[];for(var n=0;n<e.ihave.length;++n)r.ihave[n]=s.RPC.ControlIHave.toObject(e.ihave[n],t)}if(e.iwant&&e.iwant.length)for(r.iwant=[],n=0;n<e.iwant.length;++n)r.iwant[n]=s.RPC.ControlIWant.toObject(e.iwant[n],t);if(e.graft&&e.graft.length)for(r.graft=[],n=0;n<e.graft.length;++n)r.graft[n]=s.RPC.ControlGraft.toObject(e.graft[n],t);if(e.prune&&e.prune.length)for(r.prune=[],n=0;n<e.prune.length;++n)r.prune[n]=s.RPC.ControlPrune.toObject(e.prune[n],t);return r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlIHave=function(){function i(e){if(this.messageIDs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.topicID=null,i.prototype.messageIDs=n.emptyArray,Object.defineProperty(i.prototype,"_topicID",{get:n.oneOfGetter(o=["topicID"]),set:n.oneOfSetter(o)}),i.encode=function(e,t){if(t||(t=r.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),null!=e.messageIDs&&e.messageIDs.length)for(var n=0;n<e.messageIDs.length;++n)t.uint32(18).bytes(e.messageIDs[n]);return t},i.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,i=new s.RPC.ControlIHave;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.topicID=e.string();break;case 2:i.messageIDs&&i.messageIDs.length||(i.messageIDs=[]),i.messageIDs.push(e.bytes());break;default:e.skipType(7&o)}}return i},i.fromObject=function(e){if(e instanceof s.RPC.ControlIHave)return e;var t=new s.RPC.ControlIHave;if(null!=e.topicID&&(t.topicID=String(e.topicID)),e.messageIDs){if(!Array.isArray(e.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");t.messageIDs=[];for(var r=0;r<e.messageIDs.length;++r)"string"==typeof e.messageIDs[r]?n.base64.decode(e.messageIDs[r],t.messageIDs[r]=n.newBuffer(n.base64.length(e.messageIDs[r])),0):e.messageIDs[r].length&&(t.messageIDs[r]=e.messageIDs[r])}return t},i.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.messageIDs=[]),null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID,t.oneofs&&(r._topicID="topicID")),e.messageIDs&&e.messageIDs.length){r.messageIDs=[];for(var s=0;s<e.messageIDs.length;++s)r.messageIDs[s]=t.bytes===String?n.base64.encode(e.messageIDs[s],0,e.messageIDs[s].length):t.bytes===Array?Array.prototype.slice.call(e.messageIDs[s]):e.messageIDs[s]}return r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlIWant=function(){function i(e){if(this.messageIDs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return i.prototype.messageIDs=n.emptyArray,i.encode=function(e,t){if(t||(t=r.create()),null!=e.messageIDs&&e.messageIDs.length)for(var n=0;n<e.messageIDs.length;++n)t.uint32(10).bytes(e.messageIDs[n]);return t},i.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,i=new s.RPC.ControlIWant;e.pos<n;){var o=e.uint32();o>>>3==1?(i.messageIDs&&i.messageIDs.length||(i.messageIDs=[]),i.messageIDs.push(e.bytes())):e.skipType(7&o)}return i},i.fromObject=function(e){if(e instanceof s.RPC.ControlIWant)return e;var t=new s.RPC.ControlIWant;if(e.messageIDs){if(!Array.isArray(e.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");t.messageIDs=[];for(var r=0;r<e.messageIDs.length;++r)"string"==typeof e.messageIDs[r]?n.base64.decode(e.messageIDs[r],t.messageIDs[r]=n.newBuffer(n.base64.length(e.messageIDs[r])),0):e.messageIDs[r].length&&(t.messageIDs[r]=e.messageIDs[r])}return t},i.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.messageIDs=[]),e.messageIDs&&e.messageIDs.length){r.messageIDs=[];for(var s=0;s<e.messageIDs.length;++s)r.messageIDs[s]=t.bytes===String?n.base64.encode(e.messageIDs[s],0,e.messageIDs[s].length):t.bytes===Array?Array.prototype.slice.call(e.messageIDs[s]):e.messageIDs[s]}return r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlGraft=function(){function i(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.topicID=null,Object.defineProperty(i.prototype,"_topicID",{get:n.oneOfGetter(o=["topicID"]),set:n.oneOfSetter(o)}),i.encode=function(e,t){return t||(t=r.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),t},i.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,i=new s.RPC.ControlGraft;e.pos<n;){var o=e.uint32();o>>>3==1?i.topicID=e.string():e.skipType(7&o)}return i},i.fromObject=function(e){if(e instanceof s.RPC.ControlGraft)return e;var t=new s.RPC.ControlGraft;return null!=e.topicID&&(t.topicID=String(e.topicID)),t},i.toObject=function(e,t){t||(t={});var r={};return null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID,t.oneofs&&(r._topicID="topicID")),r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlPrune=function(){function i(e){if(this.peers=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.topicID=null,i.prototype.peers=n.emptyArray,i.prototype.backoff=null,Object.defineProperty(i.prototype,"_topicID",{get:n.oneOfGetter(o=["topicID"]),set:n.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_backoff",{get:n.oneOfGetter(o=["backoff"]),set:n.oneOfSetter(o)}),i.encode=function(e,t){if(t||(t=r.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),null!=e.peers&&e.peers.length)for(var n=0;n<e.peers.length;++n)s.RPC.PeerInfo.encode(e.peers[n],t.uint32(18).fork()).ldelim();return null!=e.backoff&&Object.hasOwnProperty.call(e,"backoff")&&t.uint32(24).uint64(e.backoff),t},i.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,i=new s.RPC.ControlPrune;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.topicID=e.string();break;case 2:i.peers&&i.peers.length||(i.peers=[]),i.peers.push(s.RPC.PeerInfo.decode(e,e.uint32()));break;case 3:i.backoff=e.uint64();break;default:e.skipType(7&o)}}return i},i.fromObject=function(e){if(e instanceof s.RPC.ControlPrune)return e;var t=new s.RPC.ControlPrune;if(null!=e.topicID&&(t.topicID=String(e.topicID)),e.peers){if(!Array.isArray(e.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");t.peers=[];for(var r=0;r<e.peers.length;++r){if("object"!=typeof e.peers[r])throw TypeError(".RPC.ControlPrune.peers: object expected");t.peers[r]=s.RPC.PeerInfo.fromObject(e.peers[r])}}return null!=e.backoff&&(n.Long?(t.backoff=n.Long.fromValue(e.backoff)).unsigned=!0:"string"==typeof e.backoff?t.backoff=parseInt(e.backoff,10):"number"==typeof e.backoff?t.backoff=e.backoff:"object"==typeof e.backoff&&(t.backoff=new n.LongBits(e.backoff.low>>>0,e.backoff.high>>>0).toNumber(!0))),t},i.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.peers=[]),null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID,t.oneofs&&(r._topicID="topicID")),e.peers&&e.peers.length){r.peers=[];for(var i=0;i<e.peers.length;++i)r.peers[i]=s.RPC.PeerInfo.toObject(e.peers[i],t)}return null!=e.backoff&&e.hasOwnProperty("backoff")&&("number"==typeof e.backoff?r.backoff=t.longs===String?String(e.backoff):e.backoff:r.backoff=t.longs===String?n.Long.prototype.toString.call(e.backoff):t.longs===Number?new n.LongBits(e.backoff.low>>>0,e.backoff.high>>>0).toNumber(!0):e.backoff,t.oneofs&&(r._backoff="backoff")),r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.PeerInfo=function(){function i(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.peerID=null,i.prototype.signedPeerRecord=null,Object.defineProperty(i.prototype,"_peerID",{get:n.oneOfGetter(o=["peerID"]),set:n.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_signedPeerRecord",{get:n.oneOfGetter(o=["signedPeerRecord"]),set:n.oneOfSetter(o)}),i.encode=function(e,t){return t||(t=r.create()),null!=e.peerID&&Object.hasOwnProperty.call(e,"peerID")&&t.uint32(10).bytes(e.peerID),null!=e.signedPeerRecord&&Object.hasOwnProperty.call(e,"signedPeerRecord")&&t.uint32(18).bytes(e.signedPeerRecord),t},i.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,i=new s.RPC.PeerInfo;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.peerID=e.bytes();break;case 2:i.signedPeerRecord=e.bytes();break;default:e.skipType(7&o)}}return i},i.fromObject=function(e){if(e instanceof s.RPC.PeerInfo)return e;var t=new s.RPC.PeerInfo;return null!=e.peerID&&("string"==typeof e.peerID?n.base64.decode(e.peerID,t.peerID=n.newBuffer(n.base64.length(e.peerID)),0):e.peerID.length&&(t.peerID=e.peerID)),null!=e.signedPeerRecord&&("string"==typeof e.signedPeerRecord?n.base64.decode(e.signedPeerRecord,t.signedPeerRecord=n.newBuffer(n.base64.length(e.signedPeerRecord)),0):e.signedPeerRecord.length&&(t.signedPeerRecord=e.signedPeerRecord)),t},i.toObject=function(e,t){t||(t={});var r={};return null!=e.peerID&&e.hasOwnProperty("peerID")&&(r.peerID=t.bytes===String?n.base64.encode(e.peerID,0,e.peerID.length):t.bytes===Array?Array.prototype.slice.call(e.peerID):e.peerID,t.oneofs&&(r._peerID="peerID")),null!=e.signedPeerRecord&&e.hasOwnProperty("signedPeerRecord")&&(r.signedPeerRecord=t.bytes===String?n.base64.encode(e.signedPeerRecord,0,e.signedPeerRecord.length):t.bytes===Array?Array.prototype.slice.call(e.signedPeerRecord):e.signedPeerRecord,t.oneofs&&(r._signedPeerRecord="signedPeerRecord")),r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i}(),s})?n.apply(t,s):n)||(e.exports=i)},79297:function(e){!function(){e.exports=g;var t=86400,r=3200,n=1168776,s=t*n,i=1e3*s,o=864e13,a=4294967296,A=1e6,c="000000000",l=Math.trunc||function(e){var t=e-e%1;return 0==t&&(e<0||0===e&&1/e!=1/0)?-0:t},u=g.prototype,h=(g.fromDate=function(e){return new g(+e)},g.fromInt64BE=E(0,1,2,3,0,4),g.fromInt64LE=E(3,2,1,0,4,0),g.fromString=function(e){var t,r=new g;e=(e+="").replace(/^\s*[+\-]?\d+/,(function(e){var t=1970+((e=+e)-1970)%400;return r.year=e-t,t})).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,(function(e,r,n){return r<0&&(n*=-1),t=6e4*(60*+r+ +n),""})).replace(/\.\d+$/,(function(e){return r.nano=+(e+c).substr(1,9),""})).split(/\D+/);if(1<e.length?e[1]--:e[1]=0,r.time=t=Date.UTC.apply(Date,e)-(t||0),isNaN(t))throw new TypeError("Invalid Date");return y(r)},g.fromTimeT=function(e){return m(e,0)},u.year=0,u.time=0,u.nano=0,u.addNano=function(e){return this.nano+=+e||0,this},u.getNano=function(){var e=y(this);return(e.time%1e3*A+ +e.nano+1e9)%1e9},u.getTimeT=function(){var e=y(this),s=Math.floor(e.time/1e3);return(e=e.year)&&(s+=e*n*t/r),s},u.getYear=function(){return this.toDate().getUTCFullYear()+this.year},u.toDate=function(){return w(y(this).time)},u.toJSON=function(){return this.toString().replace(/0{1,6}Z$/,"Z")},u.toString=function(e){var t=this,r=t.toDate(),n={H:function(){return B(r.getUTCHours())},L:function(){return _(r.getUTCMilliseconds(),3)},M:function(){return B(r.getUTCMinutes())},N:function(){return _(t.getNano(),9)},S:function(){return B(r.getUTCSeconds())},Y:function(){var e=t.getYear();return 999999<e?"+"+e:9999<e?"+"+_(e,6):0<=e?_(e,4):-999999<=e?"-"+_(-e,6):e},a:function(){return f[r.getUTCDay()]},b:function(){return d[r.getUTCMonth()]},d:function(){return B(r.getUTCDate())},e:function(){return function(e){return(9<e?"":" ")+(0|e)}(r.getUTCDate())},m:function(){return B(r.getUTCMonth()+1)}};return function e(t){return t.replace(/%./g,(function(t){var r=t[1],s=p[r];r=n[r];return s?e(s):r?r():t}))}(e||h)},u.writeInt64BE=b(0,1,2,3,0,4),u.writeInt64LE=b(3,2,1,0,4,0),"%Y-%m-%dT%H:%M:%S.%NZ"),d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],p={"%":"%",F:"%Y-%m-%d",n:"\n",R:"%H:%M",T:"%H:%M:%S",t:"\t",X:"%T",Z:"GMT",z:"+0000"};return g;function g(e,t,r){var n=this;if(!(n instanceof g))return new g(e,t,r);n.time=+e||0,n.nano=+t||0,n.year=+r||0,y(n)}function y(e){var t,n,s,a=e.year,c=e.time,u=e.nano,h=((u<0||A<=u)&&(u-=(n=Math.floor(u/A))*A,c+=n,n=1),a%r);return(c<-o||o<c||h)&&((t=l(c/i))&&(a+=t*r,c-=t*i),(s=w(c)).setUTCFullYear(h+s.getUTCFullYear()),s=(c=+s)+(t=l((a-=h)/r))*i,t&&-o<=s&&s<=o&&(a-=t*r,c=s),n=1),n&&(e.year=a,e.time=c,e.nano=u),e}function w(e){var t=new Date(0);return t.setTime(e),t}function m(e,t){e=+e||0;var n=l((t=(0|t)*a)/s)+l(e/s);return(e=l((t=t%s+e%s)/s))&&(n+=e,t-=e*s),new g(1e3*t,0,n*r)}function b(e,s,i,o,A,c){return function(e,s){var i=y(this);v(e=e||new Array(8),s|=0);var o=Math.floor(i.time/1e3),h=(i=i.year*(n*t/r),l(i/a)+l(o/a));i=i%a+o%a;return(o=Math.floor(i/a))&&(h+=o,i-=o*a),u(e,s+A,h),u(e,s+c,i),e};function u(t,r,n){t[r+e]=n>>24&255,t[r+s]=n>>16&255,t[r+i]=n>>8&255,t[r+o]=255&n}}function E(e,t,r,n,s,i){return function(e,t){v(e,t|=0);var r=o(e,t+s);return m(o(e,t+i),r)};function o(s,i){return 16777216*s[i+e]+(s[i+t]<<16|s[i+r]<<8|s[i+n])}}function v(e,t){if(null==(e=e&&e.length))throw new TypeError("Invalid Buffer");if(e<t+8)throw new RangeError("Out of range")}function B(e){return(9<e?"":"0")+(0|e)}function _(e,t){return(c+(0|e)).substr(-t)}}()},24749:function(e,t,r){"use strict";r.d(t,{Ue:function(){return dx}});var n={};r.r(n),r.d(n,{base58btc:function(){return V},base58flickr:function(){return z}});var s={};r.r(s),r.d(s,{base32:function(){return j},base32hex:function(){return W},base32hexpad:function(){return X},base32hexpadupper:function(){return J},base32hexupper:function(){return Y},base32pad:function(){return $},base32padupper:function(){return q},base32upper:function(){return G},base32z:function(){return Z}});var i={};r.r(i),r.d(i,{base64:function(){return ee},base64pad:function(){return te},base64url:function(){return re},base64urlpad:function(){return ne}});var o={};r.r(o),r.d(o,{code:function(){return Et},createLink:function(){return mt},createNode:function(){return wt},decode:function(){return Bt},encode:function(){return vt},name:function(){return bt},prepare:function(){return gt},validate:function(){return yt}});var a={};r.r(a),r.d(a,{code:function(){return Jr},decode:function(){return en},encode:function(){return Zr},name:function(){return Xr}});var A={};r.r(A),r.d(A,{code:function(){return hn},decode:function(){return fn},encode:function(){return dn},format:function(){return pn},name:function(){return un},parse:function(){return yn},stringify:function(){return pn}});var c={};r.r(c),r.d(c,{code:function(){return Sn},decode:function(){return Un},encode:function(){return kn},name:function(){return Cn},toGeneral:function(){return Rn}});var l={};r.r(l),r.d(l,{identity:function(){return Pn}});var u={};r.r(u),r.d(u,{identity:function(){return Ln}});var h={};r.r(h),r.d(h,{base2:function(){return Nn}});var d={};r.r(d),r.d(d,{base8:function(){return On}});var f={};r.r(f),r.d(f,{base10:function(){return Fn}});var p={};r.r(p),r.d(p,{base16:function(){return Qn},base16upper:function(){return xn}});var g={};r.r(g),r.d(g,{base36:function(){return Mn},base36upper:function(){return Hn}});var y={};r.r(y),r.d(y,{base256emoji:function(){return jn}});var w={};r.r(w),r.d(w,{sha256:function(){return $n},sha512:function(){return qn}});var m={};r.r(m),r.d(m,{code:function(){return Yn},decode:function(){return Jn},encode:function(){return Xn},name:function(){return Wn}});var b={};r.r(b),r.d(b,{code:function(){return rs},decode:function(){return ss},encode:function(){return ns},name:function(){return ts}});var E={};r.r(E),r.d(E,{RsaPrivateKey:function(){return Tc},RsaPublicKey:function(){return Ic},fromJwk:function(){return Uc},generateKeyPair:function(){return Dc},unmarshalRsaPrivateKey:function(){return Rc},unmarshalRsaPublicKey:function(){return kc}});var v={};r.r(v),r.d(v,{Ed25519PrivateKey:function(){return Ol},Ed25519PublicKey:function(){return Nl},generateKeyPair:function(){return xl},generateKeyPairFromSeed:function(){return Ml},unmarshalEd25519PrivateKey:function(){return Fl},unmarshalEd25519PublicKey:function(){return Ql}});var B={};r.r(B),r.d(B,{Secp256k1PrivateKey:function(){return Gl},Secp256k1PublicKey:function(){return jl},generateKeyPair:function(){return Wl},unmarshalSecp256k1PrivateKey:function(){return $l},unmarshalSecp256k1PublicKey:function(){return ql}});var _={};r.r(_),r.d(_,{InvalidValueError:function(){return nB},MissingRepoOptionsError:function(){return sB},NonReversibleMigrationError:function(){return eB},NotInitializedRepoError:function(){return tB},RequiredParameterError:function(){return rB}});var C={};r.r(C),r.d(C,{Decoder:function(){return Vk},Encoder:function(){return Kk},PacketType:function(){return Hk},protocol:function(){return Mk}});var S={};r.r(S),r.d(S,{abortedError:function(){return ZQ},notFoundError:function(){return JQ}});var I=r(70942),T=r(106),R=r(32660);var k=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,A=e.charAt(0),c=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===A;)n++,t++;for(var i=(e.length-t)*c+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,h=i-1;(0!==l||u<s)&&-1!==h;h--,u++)l+=a*o[h]>>>0,o[h]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var d=i-s;d!==i&&0===o[d];)d++;for(var f=new Uint8Array(n+(i-d)),p=n;d!==i;)f[p++]=o[d++];return f}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,c=new Uint8Array(o);s!==i;){for(var u=t[s],h=0,d=o-1;(0!==u||h<n)&&-1!==d;d--,h++)u+=256*c[d]>>>0,c[d]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=h,s++}for(var f=o-n;f!==o&&0===c[f];)f++;for(var p=A.repeat(r);f<o;++f)p+=e.charAt(c[f]);return p},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}},U=k;const D=new Uint8Array(0),P=e=>{const t=e.match(/../g);return t?new Uint8Array(t.map((e=>parseInt(e,16)))):D},L=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class N{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class O{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Q(this,e)}}class F{constructor(e){this.decoders=e}or(e){return Q(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Q=(e,t)=>new F({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class x{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new N(e,t,r),this.decoder=new O(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const M=({name:e,prefix:t,encode:r,decode:n})=>new x(e,t,r,n),H=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=U(r,t);return M({prefix:e,name:t,encode:n,decode:e=>L(s(e))})},K=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>M({prefix:t,name:e,encode(e){return((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r)},decode(t){return((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,A=0,c=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);A=A<<r|i,a+=r,a>=8&&(a-=8,o[c++]=255&A>>a)}if(a>=r||255&A<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}}),V=H({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),z=H({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),j=K({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),G=K({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),$=K({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),q=K({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),W=K({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Y=K({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),X=K({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),J=K({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Z=K({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),ee=K({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),te=K({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),re=K({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ne=K({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function se(e){return Object.assign(R(e),{error:R(`${e}:error`),trace:R(`${e}:trace`)})}R.formatters.b=e=>null==e?"undefined":V.baseEncode(e),R.formatters.t=e=>null==e?"undefined":j.baseEncode(e),R.formatters.m=e=>null==e?"undefined":ee.baseEncode(e),R.formatters.p=e=>null==e?"undefined":e.toString(),R.formatters.c=e=>null==e?"undefined":e.toString(),R.formatters.k=e=>null==e?"undefined":e.toString();var ie=r(32114),oe=r(62100);const ae=oe.Reader,Ae=oe.Writer,ce=oe.util,le=oe.roots["ipfs-unixfs"]||(oe.roots["ipfs-unixfs"]={}),ue=le.Data=(()=>{function e(e){if(this.blocksizes=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.Type=0,e.prototype.Data=ce.newBuffer([]),e.prototype.filesize=ce.Long?ce.Long.fromBits(0,0,!0):0,e.prototype.blocksizes=ce.emptyArray,e.prototype.hashType=ce.Long?ce.Long.fromBits(0,0,!0):0,e.prototype.fanout=ce.Long?ce.Long.fromBits(0,0,!0):0,e.prototype.mode=0,e.prototype.mtime=null,e.encode=function(e,t){if(t||(t=Ae.create()),t.uint32(8).int32(e.Type),null!=e.Data&&Object.hasOwnProperty.call(e,"Data")&&t.uint32(18).bytes(e.Data),null!=e.filesize&&Object.hasOwnProperty.call(e,"filesize")&&t.uint32(24).uint64(e.filesize),null!=e.blocksizes&&e.blocksizes.length)for(var r=0;r<e.blocksizes.length;++r)t.uint32(32).uint64(e.blocksizes[r]);return null!=e.hashType&&Object.hasOwnProperty.call(e,"hashType")&&t.uint32(40).uint64(e.hashType),null!=e.fanout&&Object.hasOwnProperty.call(e,"fanout")&&t.uint32(48).uint64(e.fanout),null!=e.mode&&Object.hasOwnProperty.call(e,"mode")&&t.uint32(56).uint32(e.mode),null!=e.mtime&&Object.hasOwnProperty.call(e,"mtime")&&le.UnixTime.encode(e.mtime,t.uint32(66).fork()).ldelim(),t},e.decode=function(e,t){e instanceof ae||(e=ae.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new le.Data;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.Type=e.int32();break;case 2:n.Data=e.bytes();break;case 3:n.filesize=e.uint64();break;case 4:if(n.blocksizes&&n.blocksizes.length||(n.blocksizes=[]),2==(7&s))for(var i=e.uint32()+e.pos;e.pos<i;)n.blocksizes.push(e.uint64());else n.blocksizes.push(e.uint64());break;case 5:n.hashType=e.uint64();break;case 6:n.fanout=e.uint64();break;case 7:n.mode=e.uint32();break;case 8:n.mtime=le.UnixTime.decode(e,e.uint32());break;default:e.skipType(7&s)}}if(!n.hasOwnProperty("Type"))throw ce.ProtocolError("missing required 'Type'",{instance:n});return n},e.fromObject=function(e){if(e instanceof le.Data)return e;var t=new le.Data;switch(e.Type){case"Raw":case 0:t.Type=0;break;case"Directory":case 1:t.Type=1;break;case"File":case 2:t.Type=2;break;case"Metadata":case 3:t.Type=3;break;case"Symlink":case 4:t.Type=4;break;case"HAMTShard":case 5:t.Type=5}if(null!=e.Data&&("string"==typeof e.Data?ce.base64.decode(e.Data,t.Data=ce.newBuffer(ce.base64.length(e.Data)),0):e.Data.length&&(t.Data=e.Data)),null!=e.filesize&&(ce.Long?(t.filesize=ce.Long.fromValue(e.filesize)).unsigned=!0:"string"==typeof e.filesize?t.filesize=parseInt(e.filesize,10):"number"==typeof e.filesize?t.filesize=e.filesize:"object"==typeof e.filesize&&(t.filesize=new ce.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0))),e.blocksizes){if(!Array.isArray(e.blocksizes))throw TypeError(".Data.blocksizes: array expected");t.blocksizes=[];for(var r=0;r<e.blocksizes.length;++r)ce.Long?(t.blocksizes[r]=ce.Long.fromValue(e.blocksizes[r])).unsigned=!0:"string"==typeof e.blocksizes[r]?t.blocksizes[r]=parseInt(e.blocksizes[r],10):"number"==typeof e.blocksizes[r]?t.blocksizes[r]=e.blocksizes[r]:"object"==typeof e.blocksizes[r]&&(t.blocksizes[r]=new ce.LongBits(e.blocksizes[r].low>>>0,e.blocksizes[r].high>>>0).toNumber(!0))}if(null!=e.hashType&&(ce.Long?(t.hashType=ce.Long.fromValue(e.hashType)).unsigned=!0:"string"==typeof e.hashType?t.hashType=parseInt(e.hashType,10):"number"==typeof e.hashType?t.hashType=e.hashType:"object"==typeof e.hashType&&(t.hashType=new ce.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0))),null!=e.fanout&&(ce.Long?(t.fanout=ce.Long.fromValue(e.fanout)).unsigned=!0:"string"==typeof e.fanout?t.fanout=parseInt(e.fanout,10):"number"==typeof e.fanout?t.fanout=e.fanout:"object"==typeof e.fanout&&(t.fanout=new ce.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0))),null!=e.mode&&(t.mode=e.mode>>>0),null!=e.mtime){if("object"!=typeof e.mtime)throw TypeError(".Data.mtime: object expected");t.mtime=le.UnixTime.fromObject(e.mtime)}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.blocksizes=[]),t.defaults){if(r.Type=t.enums===String?"Raw":0,t.bytes===String?r.Data="":(r.Data=[],t.bytes!==Array&&(r.Data=ce.newBuffer(r.Data))),ce.Long){var n=new ce.Long(0,0,!0);r.filesize=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.filesize=t.longs===String?"0":0;if(ce.Long){n=new ce.Long(0,0,!0);r.hashType=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.hashType=t.longs===String?"0":0;if(ce.Long){n=new ce.Long(0,0,!0);r.fanout=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.fanout=t.longs===String?"0":0;r.mode=0,r.mtime=null}if(null!=e.Type&&e.hasOwnProperty("Type")&&(r.Type=t.enums===String?le.Data.DataType[e.Type]:e.Type),null!=e.Data&&e.hasOwnProperty("Data")&&(r.Data=t.bytes===String?ce.base64.encode(e.Data,0,e.Data.length):t.bytes===Array?Array.prototype.slice.call(e.Data):e.Data),null!=e.filesize&&e.hasOwnProperty("filesize")&&("number"==typeof e.filesize?r.filesize=t.longs===String?String(e.filesize):e.filesize:r.filesize=t.longs===String?ce.Long.prototype.toString.call(e.filesize):t.longs===Number?new ce.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0):e.filesize),e.blocksizes&&e.blocksizes.length){r.blocksizes=[];for(var s=0;s<e.blocksizes.length;++s)"number"==typeof e.blocksizes[s]?r.blocksizes[s]=t.longs===String?String(e.blocksizes[s]):e.blocksizes[s]:r.blocksizes[s]=t.longs===String?ce.Long.prototype.toString.call(e.blocksizes[s]):t.longs===Number?new ce.LongBits(e.blocksizes[s].low>>>0,e.blocksizes[s].high>>>0).toNumber(!0):e.blocksizes[s]}return null!=e.hashType&&e.hasOwnProperty("hashType")&&("number"==typeof e.hashType?r.hashType=t.longs===String?String(e.hashType):e.hashType:r.hashType=t.longs===String?ce.Long.prototype.toString.call(e.hashType):t.longs===Number?new ce.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0):e.hashType),null!=e.fanout&&e.hasOwnProperty("fanout")&&("number"==typeof e.fanout?r.fanout=t.longs===String?String(e.fanout):e.fanout:r.fanout=t.longs===String?ce.Long.prototype.toString.call(e.fanout):t.longs===Number?new ce.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0):e.fanout),null!=e.mode&&e.hasOwnProperty("mode")&&(r.mode=e.mode),null!=e.mtime&&e.hasOwnProperty("mtime")&&(r.mtime=le.UnixTime.toObject(e.mtime,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,oe.util.toJSONOptions)},e.DataType=function(){const e={},t=Object.create(e);return t[e[0]="Raw"]=0,t[e[1]="Directory"]=1,t[e[2]="File"]=2,t[e[3]="Metadata"]=3,t[e[4]="Symlink"]=4,t[e[5]="HAMTShard"]=5,t}(),e})(),he=(le.UnixTime=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.Seconds=ce.Long?ce.Long.fromBits(0,0,!1):0,e.prototype.FractionalNanoseconds=0,e.encode=function(e,t){return t||(t=Ae.create()),t.uint32(8).int64(e.Seconds),null!=e.FractionalNanoseconds&&Object.hasOwnProperty.call(e,"FractionalNanoseconds")&&t.uint32(21).fixed32(e.FractionalNanoseconds),t},e.decode=function(e,t){e instanceof ae||(e=ae.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new le.UnixTime;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.Seconds=e.int64();break;case 2:n.FractionalNanoseconds=e.fixed32();break;default:e.skipType(7&s)}}if(!n.hasOwnProperty("Seconds"))throw ce.ProtocolError("missing required 'Seconds'",{instance:n});return n},e.fromObject=function(e){if(e instanceof le.UnixTime)return e;var t=new le.UnixTime;return null!=e.Seconds&&(ce.Long?(t.Seconds=ce.Long.fromValue(e.Seconds)).unsigned=!1:"string"==typeof e.Seconds?t.Seconds=parseInt(e.Seconds,10):"number"==typeof e.Seconds?t.Seconds=e.Seconds:"object"==typeof e.Seconds&&(t.Seconds=new ce.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber())),null!=e.FractionalNanoseconds&&(t.FractionalNanoseconds=e.FractionalNanoseconds>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(ce.Long){var n=new ce.Long(0,0,!1);r.Seconds=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.Seconds=t.longs===String?"0":0;r.FractionalNanoseconds=0}return null!=e.Seconds&&e.hasOwnProperty("Seconds")&&("number"==typeof e.Seconds?r.Seconds=t.longs===String?String(e.Seconds):e.Seconds:r.Seconds=t.longs===String?ce.Long.prototype.toString.call(e.Seconds):t.longs===Number?new ce.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber():e.Seconds),null!=e.FractionalNanoseconds&&e.hasOwnProperty("FractionalNanoseconds")&&(r.FractionalNanoseconds=e.FractionalNanoseconds),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,oe.util.toJSONOptions)},e})(),le.Metadata=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.MimeType="",e.encode=function(e,t){return t||(t=Ae.create()),null!=e.MimeType&&Object.hasOwnProperty.call(e,"MimeType")&&t.uint32(10).string(e.MimeType),t},e.decode=function(e,t){e instanceof ae||(e=ae.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new le.Metadata;e.pos<r;){var s=e.uint32();if(s>>>3==1)n.MimeType=e.string();else e.skipType(7&s)}return n},e.fromObject=function(e){if(e instanceof le.Metadata)return e;var t=new le.Metadata;return null!=e.MimeType&&(t.MimeType=String(e.MimeType)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.MimeType=""),null!=e.MimeType&&e.hasOwnProperty("MimeType")&&(r.MimeType=e.MimeType),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,oe.util.toJSONOptions)},e})(),ue),de=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],fe=["directory","hamt-sharded-directory"],pe=parseInt("0644",8),ge=parseInt("0755",8);function ye(e){if(null!=e)return"number"==typeof e?4095&e:"0"===(e=e.toString()).substring(0,1)?4095&parseInt(e,8):4095&parseInt(e,10)}function we(e){if(null==e)return;let t;if(null!=e.secs&&(t={secs:e.secs,nsecs:e.nsecs}),null!=e.Seconds&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){const r=e.getTime(),n=Math.floor(r/1e3);t={secs:n,nsecs:1e3*(r-1e3*n)}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(null!=t&&null!=t.nsecs&&(t.nsecs<0||t.nsecs>999999999))throw ie(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}class me{static unmarshal(e){const t=he.decode(e),r=he.toObject(t,{defaults:!1,arrays:!0,longs:Number,objects:!1}),n=new me({type:de[r.Type],data:r.Data,blockSizes:r.blocksizes,mode:r.mode,mtime:r.mtime?{secs:r.mtime.Seconds,nsecs:r.mtime.FractionalNanoseconds}:void 0});return n._originalMode=r.mode||0,n}constructor(e={type:"file"}){const{type:t,data:r,blockSizes:n,hashType:s,fanout:i,mtime:o,mode:a}=e;if(t&&!de.includes(t))throw ie(new Error("Type: "+t+" is not valid"),"ERR_INVALID_TYPE");this.type=t||"file",this.data=r,this.hashType=s,this.fanout=i,this.blockSizes=n||[],this._originalMode=0,this.mode=ye(a),o&&(this.mtime=we(o),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(e){this._mode=this.isDirectory()?ge:pe;const t=ye(e);void 0!==t&&(this._mode=t)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&fe.includes(this.type))}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0;let e=0;return this.blockSizes.forEach((t=>{e+=t})),this.data&&(e+=this.data.length),e}marshal(){let e;switch(this.type){case"raw":e=he.DataType.Raw;break;case"directory":e=he.DataType.Directory;break;case"file":e=he.DataType.File;break;case"metadata":e=he.DataType.Metadata;break;case"symlink":e=he.DataType.Symlink;break;case"hamt-sharded-directory":e=he.DataType.HAMTShard;break;default:throw ie(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE")}let t,r,n=this.data;if(this.data&&this.data.length||(n=void 0),null!=this.mode&&(t=4294963200&this._originalMode|(ye(this.mode)||0),t!==pe||this.isDirectory()||(t=void 0),t===ge&&this.isDirectory()&&(t=void 0)),null!=this.mtime){const e=we(this.mtime);e&&(r={Seconds:e.secs,FractionalNanoseconds:e.nsecs},0===r.FractionalNanoseconds&&delete r.FractionalNanoseconds)}const s={Type:e,Data:n,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:t,mtime:r};return he.encode(s).finish()}}var be=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=Ee;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},Ee=Math.pow(2,31);var ve=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var Be=Math.pow(2,7),_e=Math.pow(2,14),Ce=Math.pow(2,21),Se=Math.pow(2,28),Ie=Math.pow(2,35),Te=Math.pow(2,42),Re=Math.pow(2,49),ke=Math.pow(2,56),Ue=Math.pow(2,63),De={encode:be,decode:ve,encodingLength:function(e){return e<Be?1:e<_e?2:e<Ce?3:e<Se?4:e<Ie?5:e<Te?6:e<Re?7:e<ke?8:e<Ue?9:10}},Pe=De;const Le=(e,t=0)=>[Pe.decode(e,t),Pe.decode.bytes],Ne=(e,t,r=0)=>(Pe.encode(e,t,r),t),Oe=e=>Pe.encodingLength(e),Fe=(e,t)=>{const r=t.byteLength,n=Oe(e),s=n+Oe(r),i=new Uint8Array(s+r);return Ne(e,i,0),Ne(r,i,n),i.set(t,s),new xe(e,r,t,i)},Qe=e=>{const t=L(e),[r,n]=Le(t),[s,i]=Le(t.subarray(n)),o=t.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new xe(r,s,o,t)};class xe{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const Me=(e,t)=>{const{bytes:r,version:n}=e;return 0===n?je(r,Ke(e),t||V.encoder):Ge(r,Ke(e),t||j.encoder)},He=new WeakMap,Ke=e=>{const t=He.get(e);if(null==t){const t=new Map;return He.set(e,t),t}return t};class Ve{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==$e)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==qe)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Ve.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Fe(e,t);return Ve.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Ve.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return Me(this,e)}toJSON(){return{"/":Me(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Ve)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new Ve(e,r,n,s||We(e,r,n.bytes))}if(!0===t[Ye]){const{version:e,multihash:r,code:n}=t,s=Qe(r);return Ve.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==$e)throw new Error(`Version 0 CID must use dag-pb (code: ${$e}) block encoding`);return new Ve(e,t,r,r.bytes);case 1:{const n=We(e,t,r.bytes);return new Ve(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Ve.create(0,$e,e)}static createV1(e,t){return Ve.create(1,e,t)}static decode(e){const[t,r]=Ve.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Ve.inspectBytes(e),r=t.size-t.multihashSize,n=L(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new xe(t.multihashCode,t.digestSize,s,n);return[0===t.version?Ve.createV0(i):Ve.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=Le(e.subarray(t));return t+=n,r};let n=r(),s=$e;if(18===n?(n=0,t=0):s=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),A=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:A-i,size:A}}static parse(e,t){const[r,n]=ze(e,t),s=Ve.decode(n);if(0===s.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return Ke(s).set(r,e),s}}const ze=(e,t)=>{switch(e[0]){case"Q":{const r=t||V;return[V.prefix,r.decode(`${V.prefix}${e}`)]}case V.prefix:{const r=t||V;return[V.prefix,r.decode(e)]}case j.prefix:{const r=t||j;return[j.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},je=(e,t,r)=>{const{prefix:n}=r;if(n!==V.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},Ge=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},$e=112,qe=18,We=(e,t,r)=>{const n=Oe(e),s=n+Oe(t),i=new Uint8Array(s+r.byteLength);return Ne(e,i,0),Ne(t,i,n),i.set(r,s),i},Ye=Symbol.for("@ipld/js-cid/CID"),Xe=new TextDecoder;function Je(e,t){let r=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(t>=e.length)throw new Error("protobuf: unexpected end of data");const s=e[t++];if(r+=n<28?(127&s)<<n:(127&s)*2**n,s<128)break}return[r,t]}function Ze(e,t){let r;[r,t]=Je(e,t);const n=t+r;if(r<0||n<0)throw new Error("protobuf: invalid length");if(n>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(t,n),n]}function et(e,t){let r;return[r,t]=Je(e,t),[7&r,r>>3,t]}function tt(e){const t={},r=e.length;let n=0;for(;n<r;){let r,s;if([r,s,n]=et(e,n),1===s){if(t.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(2!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Hash`);if(void 0!==t.Name)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[t.Hash,n]=Ze(e,n)}else if(2===s){if(void 0!==t.Name)throw new Error("protobuf: (PBLink) duplicate Name section");if(2!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Name`);if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let s;[s,n]=Ze(e,n),t.Name=Xe.decode(s)}else{if(3!==s)throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${s}`);if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(0!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Tsize`);[t.Tsize,n]=Je(e,n)}}if(n>r)throw new Error("protobuf: (PBLink) unexpected end of data");return t}const rt=new TextEncoder,nt=2**32;function st(e,t){let r=t.length;if("number"==typeof e.Tsize){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");r=at(t,r,e.Tsize)-1,t[r]=24}if("string"==typeof e.Name){const n=rt.encode(e.Name);r-=n.length,t.set(n,r),r=at(t,r,n.length)-1,t[r]=18}return e.Hash&&(r-=e.Hash.length,t.set(e.Hash,r),r=at(t,r,e.Hash.length)-1,t[r]=10),t.length-r}function it(e){const t=function(e){let t=0;if(e.Data){const r=e.Data.length;t+=1+r+At(r)}if(e.Links)for(const r of e.Links){const e=ot(r);t+=1+e+At(e)}return t}(e),r=new Uint8Array(t);let n=t;if(e.Data&&(n-=e.Data.length,r.set(e.Data,n),n=at(r,n,e.Data.length)-1,r[n]=10),e.Links)for(let t=e.Links.length-1;t>=0;t--){const s=st(e.Links[t],r.subarray(0,n));n-=s,n=at(r,n,s)-1,r[n]=18}return r}function ot(e){let t=0;if(e.Hash){const r=e.Hash.length;t+=1+r+At(r)}if("string"==typeof e.Name){const r=rt.encode(e.Name).length;t+=1+r+At(r)}return"number"==typeof e.Tsize&&(t+=1+At(e.Tsize)),t}function at(e,t,r){const n=t-=At(r);for(;r>=2147483648;)e[t++]=127&r|128,r/=128;for(;r>=128;)e[t++]=127&r|128,r>>>=7;return e[t]=r,n}function At(e){return e%2==0&&e++,Math.floor((function(e){let t=0;e>=nt&&(e=Math.floor(e/nt),t=32);e>=65536&&(e>>>=16,t+=16);e>=256&&(e>>>=8,t+=8);return t+ct[e]}(e)+6)/7)}const ct=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],lt=["Data","Links"],ut=["Hash","Name","Tsize"],ht=new TextEncoder;function dt(e,t){if(e===t)return 0;const r=e.Name?ht.encode(e.Name):[],n=t.Name?ht.encode(t.Name):[];let s=r.length,i=n.length;for(let e=0,t=Math.min(s,i);e<t;++e)if(r[e]!==n[e]){s=r[e],i=n[e];break}return s<i?-1:i<s?1:0}function ft(e,t){return!Object.keys(e).some((e=>!t.includes(e)))}function pt(e){if("object"==typeof e.asCID){const t=Ve.asCID(e);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if("object"!=typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(e.Hash){let r=Ve.asCID(e.Hash);try{r||("string"==typeof e.Hash?r=Ve.parse(e.Hash):e.Hash instanceof Uint8Array&&(r=Ve.decode(e.Hash)))}catch(e){throw new TypeError(`Invalid DAG-PB form: ${e.message}`)}r&&(t.Hash=r)}if(!t.Hash)throw new TypeError("Invalid DAG-PB form");return"string"==typeof e.Name&&(t.Name=e.Name),"number"==typeof e.Tsize&&(t.Tsize=e.Tsize),t}function gt(e){if((e instanceof Uint8Array||"string"==typeof e)&&(e={Data:e}),"object"!=typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(void 0!==e.Data)if("string"==typeof e.Data)t.Data=ht.encode(e.Data);else{if(!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form");t.Data=e.Data}if(void 0!==e.Links){if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form");t.Links=e.Links.map(pt),t.Links.sort(dt)}else t.Links=[];return t}function yt(e){if(!e||"object"!=typeof e||Array.isArray(e)||e instanceof Uint8Array||e["/"]&&e["/"]===e.bytes)throw new TypeError("Invalid DAG-PB form");if(!ft(e,lt))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(void 0!==e.Data&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let t=0;t<e.Links.length;t++){const r=e.Links[t];if(!r||"object"!=typeof r||Array.isArray(r)||r instanceof Uint8Array||r["/"]&&r["/"]===r.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!ft(r,ut))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(void 0===r.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(null==r.Hash||!r.Hash["/"]||r.Hash["/"]!==r.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(void 0!==r.Name&&"string"!=typeof r.Name)throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(void 0!==r.Tsize){if("number"!=typeof r.Tsize||r.Tsize%1!=0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(r.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(t>0&&-1===dt(r,e.Links[t-1]))throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function wt(e,t=[]){return gt({Data:e,Links:t})}function mt(e,t,r){return pt({Hash:r,Name:e,Tsize:t})}const bt="dag-pb",Et=112;function vt(e){yt(e);const t={};return e.Links&&(t.Links=e.Links.map((e=>{const t={};return e.Hash&&(t.Hash=e.Hash.bytes),void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),e.Data&&(t.Data=e.Data),it(t)}function Bt(e){const t=function(e){const t=e.length;let r,n,s=0,i=!1;for(;s<t;){let t,o;if([t,o,s]=et(e,s),2!==t)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${t}`);if(1===o){if(n)throw new Error("protobuf: (PBNode) duplicate Data section");[n,s]=Ze(e,s),r&&(i=!0)}else{if(2!==o)throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${o}`);{if(i)throw new Error("protobuf: (PBNode) duplicate Links section");let t;r||(r=[]),[t,s]=Ze(e,s),r.push(tt(t))}}}if(s>t)throw new Error("protobuf: (PBNode) unexpected end of data");const o={};return n&&(o.Data=n),o.Links=r||[],o}(e),r={};return t.Data&&(r.Data=t.Data),t.Links&&(r.Links=t.Links.map((e=>{const t={};try{t.Hash=Ve.decode(e.Hash)}catch(e){}if(!t.Hash)throw new Error("Invalid Hash field found in link, expected CID");return void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),r}const _t=["string","number","bigint","symbol"],Ct=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function St(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";const t=typeof e;if(_t.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(function(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}(e))return"Buffer";const r=function(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(Ct.includes(t))return t;return}(e);return r||"Object"}class It{constructor(e,t,r){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}It.uint=new It(0,"uint",!0),It.negint=new It(1,"negint",!0),It.bytes=new It(2,"bytes",!0),It.string=new It(3,"string",!0),It.array=new It(4,"array",!1),It.map=new It(5,"map",!1),It.tag=new It(6,"tag",!1),It.float=new It(7,"float",!0),It.false=new It(7,"false",!0),It.true=new It(7,"true",!0),It.null=new It(7,"null",!0),It.undefined=new It(7,"undefined",!0),It.break=new It(7,"break",!0);class Tt{constructor(e,t,r){this.type=e,this.value=t,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const Rt=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"==typeof globalThis.Buffer.isBuffer,kt=new TextDecoder,Ut=new TextEncoder;function Dt(e){return Rt&&globalThis.Buffer.isBuffer(e)}function Pt(e){return e instanceof Uint8Array?Dt(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const Lt=Rt?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):Ht(e,t,r):(e,t,r)=>r-t>64?kt.decode(e.subarray(t,r)):Ht(e,t,r),Nt=Rt?e=>e.length>64?globalThis.Buffer.from(e):Mt(e):e=>e.length>64?Ut.encode(e):Mt(e),Ot=e=>Uint8Array.from(e),Ft=Rt?(e,t,r)=>Dt(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),Qt=Rt?(e,t)=>(e=e.map((e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e))),Pt(globalThis.Buffer.concat(e,t))):(e,t)=>{const r=new Uint8Array(t);let n=0;for(let t of e)n+t.length>r.length&&(t=t.subarray(0,r.length-n)),r.set(t,n),n+=t.length;return r},xt=Rt?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function Mt(e,t=1/0){let r;const n=e.length;let s=null;const i=[];for(let o=0;o<n;++o){if(r=e.charCodeAt(o),r>55295&&r<57344){if(!s){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&i.push(239,191,189);continue}s=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),s=r;continue}r=65536+(s-55296<<10|r-56320)}else s&&(t-=3)>-1&&i.push(239,191,189);if(s=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function Ht(e,t,r){const n=[];for(;t<r;){const s=e[t];let i=null,o=s>239?4:s>223?3:s>191?2:1;if(t+o<=r){let r,n,a,A;switch(o){case 1:s<128&&(i=s);break;case 2:r=e[t+1],128==(192&r)&&(A=(31&s)<<6|63&r,A>127&&(i=A));break;case 3:r=e[t+1],n=e[t+2],128==(192&r)&&128==(192&n)&&(A=(15&s)<<12|(63&r)<<6|63&n,A>2047&&(A<55296||A>57343)&&(i=A));break;case 4:r=e[t+1],n=e[t+2],a=e[t+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(A=(15&s)<<18|(63&r)<<12|(63&n)<<6|63&a,A>65535&&A<1114112&&(i=A))}}null===i?(i=65533,o=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),t+=o}return Kt(n)}function Kt(e){const t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=4096));return r}class Vt{constructor(e=256){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const r=t.length-(this.maxCursor-this.cursor)-1;t.set(e,r)}else{if(t){const e=t.length-(this.maxCursor-this.cursor)-1;e<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=xt(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(1===this.chunks.length){const r=this.chunks[0];e&&this.cursor>r.length/2?(t=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=Ft(r,0,this.cursor)}else t=Qt(this.chunks,this.cursor);return e&&this.reset(),t}}const zt="CBOR decode error:",jt="CBOR encode error:",Gt=[];function $t(e,t,r){if(e.length-t<r)throw new Error(`${zt} not enough data for type`)}Gt[23]=1,Gt[24]=2,Gt[25]=3,Gt[26]=5,Gt[27]=9;const qt=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Wt(e,t,r){$t(e,t,1);const n=e[t];if(!0===r.strict&&n<qt[0])throw new Error(`${zt} integer encoded in more bytes than necessary (strict decode)`);return n}function Yt(e,t,r){$t(e,t,2);const n=e[t]<<8|e[t+1];if(!0===r.strict&&n<qt[1])throw new Error(`${zt} integer encoded in more bytes than necessary (strict decode)`);return n}function Xt(e,t,r){$t(e,t,4);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===r.strict&&n<qt[2])throw new Error(`${zt} integer encoded in more bytes than necessary (strict decode)`);return n}function Jt(e,t,r){$t(e,t,8);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],s=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],i=(BigInt(n)<<BigInt(32))+BigInt(s);if(!0===r.strict&&i<qt[3])throw new Error(`${zt} integer encoded in more bytes than necessary (strict decode)`);if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(!0===r.allowBigInt)return i;throw new Error(`${zt} integers outside of the safe integer range are not supported`)}function Zt(e,t){return er(e,0,t.value)}function er(e,t,r){if(r<qt[0]){const n=Number(r);e.push([t|n])}else if(r<qt[1]){const n=Number(r);e.push([24|t,n])}else if(r<qt[2]){const n=Number(r);e.push([25|t,n>>>8,255&n])}else if(r<qt[3]){const n=Number(r);e.push([26|t,n>>>24&255,n>>>16&255,n>>>8&255,255&n])}else{const n=BigInt(r);if(!(n<qt[4]))throw new Error(`${zt} encountered BigInt larger than allowable range`);{const r=[27|t,0,0,0,0,0,0,0];let s=Number(n&BigInt(4294967295)),i=Number(n>>BigInt(32)&BigInt(4294967295));r[8]=255&s,s>>=8,r[7]=255&s,s>>=8,r[6]=255&s,s>>=8,r[5]=255&s,r[4]=255&i,i>>=8,r[3]=255&i,i>>=8,r[2]=255&i,i>>=8,r[1]=255&i,e.push(r)}}}Zt.encodedSize=function(e){return er.encodedSize(e.value)},er.encodedSize=function(e){return e<qt[0]?1:e<qt[1]?2:e<qt[2]?3:e<qt[3]?5:9},Zt.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};const tr=BigInt(-1),rr=BigInt(1);function nr(e,t){const r=t.value,n="bigint"==typeof r?r*tr-rr:-1*r-1;er(e,t.type.majorEncoded,n)}function sr(e,t,r,n){$t(e,t,r+n);const s=Ft(e,t+r,t+r+n);return new Tt(It.bytes,s,r+n)}function ir(e,t,r,n){return sr(e,t,1,r)}function or(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===It.string?Nt(e.value):e.value),e.encodedBytes}function ar(e,t){const r=or(t);er(e,t.type.majorEncoded,r.length),e.push(r)}function Ar(e,t,r,n,s){const i=r+n;$t(e,t,i);const o=new Tt(It.string,Lt(e,t+r,t+i),i);return!0===s.retainStringBytes&&(o.byteValue=Ft(e,t+r,t+i)),o}function cr(e,t,r,n){return Ar(e,t,1,r,n)}nr.encodedSize=function(e){const t=e.value,r="bigint"==typeof t?t*tr-rr:-1*t-1;return r<qt[0]?1:r<qt[1]?2:r<qt[2]?3:r<qt[3]?5:9},nr.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0},ar.encodedSize=function(e){const t=or(e);return er.encodedSize(t.length)+t.length},ar.compareTokens=function(e,t){return r=or(e),n=or(t),r.length<n.length?-1:r.length>n.length?1:function(e,t){if(Dt(e)&&Dt(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}(r,n);var r,n};const lr=ar;function ur(e,t,r,n){return new Tt(It.array,n,r)}function hr(e,t,r,n){return ur(0,0,1,r)}function dr(e,t){er(e,It.array.majorEncoded,t.value)}function fr(e,t,r,n){return new Tt(It.map,n,r)}function pr(e,t,r,n){return fr(0,0,1,r)}function gr(e,t){er(e,It.map.majorEncoded,t.value)}function yr(e,t,r,n){return new Tt(It.tag,r,1)}function wr(e,t){er(e,It.tag.majorEncoded,t.value)}dr.compareTokens=Zt.compareTokens,dr.encodedSize=function(e){return er.encodedSize(e.value)},gr.compareTokens=Zt.compareTokens,gr.encodedSize=function(e){return er.encodedSize(e.value)},wr.compareTokens=Zt.compareTokens,wr.encodedSize=function(e){return er.encodedSize(e.value)};function mr(e,t,r){if(r){if(!1===r.allowNaN&&Number.isNaN(e))throw new Error(`${zt} NaN values are not supported`);if(!1===r.allowInfinity&&(e===1/0||e===-1/0))throw new Error(`${zt} Infinity values are not supported`)}return new Tt(It.float,e,t)}function br(e,t,r){const n=t.value;if(!1===n)e.push([20|It.float.majorEncoded]);else if(!0===n)e.push([21|It.float.majorEncoded]);else if(null===n)e.push([22|It.float.majorEncoded]);else if(void 0===n)e.push([23|It.float.majorEncoded]);else{let t,i=!1;r&&!0===r.float64||(_r(n),t=Cr(Br,1),n===t||Number.isNaN(n)?(Br[0]=249,e.push(Br.slice(0,3)),i=!0):(Sr(n),t=Ir(Br,1),n===t&&(Br[0]=250,e.push(Br.slice(0,5)),i=!0))),i||(s=n,vr.setFloat64(0,s,!1),t=Tr(Br,1),Br[0]=251,e.push(Br.slice(0,9)))}var s}br.encodedSize=function(e,t){const r=e.value;if(!1===r||!0===r||null==r)return 1;if(!t||!0!==t.float64){_r(r);let e=Cr(Br,1);if(r===e||Number.isNaN(r))return 3;if(Sr(r),e=Ir(Br,1),r===e)return 5}return 9};const Er=new ArrayBuffer(9),vr=new DataView(Er,1),Br=new Uint8Array(Er,0);function _r(e){if(e===1/0)vr.setUint16(0,31744,!1);else if(e===-1/0)vr.setUint16(0,64512,!1);else if(Number.isNaN(e))vr.setUint16(0,32256,!1);else{vr.setFloat32(0,e);const t=vr.getUint32(0),r=(2139095040&t)>>23,n=8388607&t;if(255===r)vr.setUint16(0,31744,!1);else if(0===r)vr.setUint16(0,(2147483648&e)>>16|n>>13,!1);else{const e=r-127;e<-24?vr.setUint16(0,0):e<-14?vr.setUint16(0,(2147483648&t)>>16|1<<24+e,!1):vr.setUint16(0,(2147483648&t)>>16|e+15<<10|n>>13,!1)}}}function Cr(e,t){if(e.length-t<2)throw new Error(`${zt} not enough data for float16`);const r=(e[t]<<8)+e[t+1];if(31744===r)return 1/0;if(64512===r)return-1/0;if(32256===r)return NaN;const n=r>>10&31,s=1023&r;let i;return i=0===n?s*2**-24:31!==n?(s+1024)*2**(n-25):0===s?1/0:NaN,32768&r?-i:i}function Sr(e){vr.setFloat32(0,e,!1)}function Ir(e,t){if(e.length-t<4)throw new Error(`${zt} not enough data for float32`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function Tr(e,t){if(e.length-t<8)throw new Error(`${zt} not enough data for float64`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}function Rr(e,t,r){throw new Error(`${zt} encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function kr(e){return()=>{throw new Error(`${zt} ${e}`)}}br.compareTokens=Zt.compareTokens;const Ur=[];for(let e=0;e<=23;e++)Ur[e]=Rr;Ur[24]=function(e,t,r,n){return new Tt(It.uint,Wt(e,t+1,n),2)},Ur[25]=function(e,t,r,n){return new Tt(It.uint,Yt(e,t+1,n),3)},Ur[26]=function(e,t,r,n){return new Tt(It.uint,Xt(e,t+1,n),5)},Ur[27]=function(e,t,r,n){return new Tt(It.uint,Jt(e,t+1,n),9)},Ur[28]=Rr,Ur[29]=Rr,Ur[30]=Rr,Ur[31]=Rr;for(let e=32;e<=55;e++)Ur[e]=Rr;Ur[56]=function(e,t,r,n){return new Tt(It.negint,-1-Wt(e,t+1,n),2)},Ur[57]=function(e,t,r,n){return new Tt(It.negint,-1-Yt(e,t+1,n),3)},Ur[58]=function(e,t,r,n){return new Tt(It.negint,-1-Xt(e,t+1,n),5)},Ur[59]=function(e,t,r,n){const s=Jt(e,t+1,n);if("bigint"!=typeof s){const e=-1-s;if(e>=Number.MIN_SAFE_INTEGER)return new Tt(It.negint,e,9)}if(!0!==n.allowBigInt)throw new Error(`${zt} integers outside of the safe integer range are not supported`);return new Tt(It.negint,tr-BigInt(s),9)},Ur[60]=Rr,Ur[61]=Rr,Ur[62]=Rr,Ur[63]=Rr;for(let e=64;e<=87;e++)Ur[e]=ir;Ur[88]=function(e,t,r,n){return sr(e,t,2,Wt(e,t+1,n))},Ur[89]=function(e,t,r,n){return sr(e,t,3,Yt(e,t+1,n))},Ur[90]=function(e,t,r,n){return sr(e,t,5,Xt(e,t+1,n))},Ur[91]=function(e,t,r,n){const s=Jt(e,t+1,n);if("bigint"==typeof s)throw new Error(`${zt} 64-bit integer bytes lengths not supported`);return sr(e,t,9,s)},Ur[92]=Rr,Ur[93]=Rr,Ur[94]=Rr,Ur[95]=kr("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)Ur[e]=cr;Ur[120]=function(e,t,r,n){return Ar(e,t,2,Wt(e,t+1,n),n)},Ur[121]=function(e,t,r,n){return Ar(e,t,3,Yt(e,t+1,n),n)},Ur[122]=function(e,t,r,n){return Ar(e,t,5,Xt(e,t+1,n),n)},Ur[123]=function(e,t,r,n){const s=Jt(e,t+1,n);if("bigint"==typeof s)throw new Error(`${zt} 64-bit integer string lengths not supported`);return Ar(e,t,9,s,n)},Ur[124]=Rr,Ur[125]=Rr,Ur[126]=Rr,Ur[127]=kr("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)Ur[e]=hr;Ur[152]=function(e,t,r,n){return ur(0,0,2,Wt(e,t+1,n))},Ur[153]=function(e,t,r,n){return ur(0,0,3,Yt(e,t+1,n))},Ur[154]=function(e,t,r,n){return ur(0,0,5,Xt(e,t+1,n))},Ur[155]=function(e,t,r,n){const s=Jt(e,t+1,n);if("bigint"==typeof s)throw new Error(`${zt} 64-bit integer array lengths not supported`);return ur(0,0,9,s)},Ur[156]=Rr,Ur[157]=Rr,Ur[158]=Rr,Ur[159]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${zt} indefinite length items not allowed`);return ur(0,0,1,1/0)};for(let e=160;e<=183;e++)Ur[e]=pr;Ur[184]=function(e,t,r,n){return fr(0,0,2,Wt(e,t+1,n))},Ur[185]=function(e,t,r,n){return fr(0,0,3,Yt(e,t+1,n))},Ur[186]=function(e,t,r,n){return fr(0,0,5,Xt(e,t+1,n))},Ur[187]=function(e,t,r,n){const s=Jt(e,t+1,n);if("bigint"==typeof s)throw new Error(`${zt} 64-bit integer map lengths not supported`);return fr(0,0,9,s)},Ur[188]=Rr,Ur[189]=Rr,Ur[190]=Rr,Ur[191]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${zt} indefinite length items not allowed`);return fr(0,0,1,1/0)};for(let e=192;e<=215;e++)Ur[e]=yr;Ur[216]=function(e,t,r,n){return new Tt(It.tag,Wt(e,t+1,n),2)},Ur[217]=function(e,t,r,n){return new Tt(It.tag,Yt(e,t+1,n),3)},Ur[218]=function(e,t,r,n){return new Tt(It.tag,Xt(e,t+1,n),5)},Ur[219]=function(e,t,r,n){return new Tt(It.tag,Jt(e,t+1,n),9)},Ur[220]=Rr,Ur[221]=Rr,Ur[222]=Rr,Ur[223]=Rr;for(let e=224;e<=243;e++)Ur[e]=kr("simple values are not supported");Ur[244]=Rr,Ur[245]=Rr,Ur[246]=Rr,Ur[247]=function(e,t,r,n){if(!1===n.allowUndefined)throw new Error(`${zt} undefined values are not supported`);return!0===n.coerceUndefinedToNull?new Tt(It.null,null,1):new Tt(It.undefined,void 0,1)},Ur[248]=kr("simple values are not supported"),Ur[249]=function(e,t,r,n){return mr(Cr(e,t+1),3,n)},Ur[250]=function(e,t,r,n){return mr(Ir(e,t+1),5,n)},Ur[251]=function(e,t,r,n){return mr(Tr(e,t+1),9,n)},Ur[252]=Rr,Ur[253]=Rr,Ur[254]=Rr,Ur[255]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${zt} indefinite length items not allowed`);return new Tt(It.break,void 0,1)};const Dr=[];for(let e=0;e<24;e++)Dr[e]=new Tt(It.uint,e,1);for(let e=-1;e>=-24;e--)Dr[31-e]=new Tt(It.negint,e,1);Dr[64]=new Tt(It.bytes,new Uint8Array(0),1),Dr[96]=new Tt(It.string,"",1),Dr[128]=new Tt(It.array,0,1),Dr[160]=new Tt(It.map,0,1),Dr[244]=new Tt(It.false,!1,1),Dr[245]=new Tt(It.true,!0,1),Dr[246]=new Tt(It.null,null,1);const Pr={float64:!1,mapSorter:function(e,t){const r=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(t[0])?t[0][0]:t[0];if(r.type!==n.type)return r.type.compare(n.type);const s=r.type.major,i=Lr[s].compareTokens(r,n);0===i&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone");return i},quickEncodeToken:function(e){switch(e.type){case It.false:return Ot([244]);case It.true:return Ot([245]);case It.null:return Ot([246]);case It.bytes:return e.value.length?void 0:Ot([64]);case It.string:return""===e.value?Ot([96]):void 0;case It.array:return 0===e.value?Ot([128]):void 0;case It.map:return 0===e.value?Ot([160]):void 0;case It.uint:return e.value<24?Ot([Number(e.value)]):void 0;case It.negint:if(e.value>=-24)return Ot([31-Number(e.value)])}}};const Lr=function(){const e=[];return e[It.uint.major]=Zt,e[It.negint.major]=nr,e[It.bytes.major]=ar,e[It.string.major]=lr,e[It.array.major]=dr,e[It.map.major]=gr,e[It.tag.major]=wr,e[It.float.major]=br,e}(),Nr=new Vt;class Or{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${jt} object contains circular references`);return new Or(t,e)}}const Fr={null:new Tt(It.null,null),undefined:new Tt(It.undefined,void 0),true:new Tt(It.true,!0),false:new Tt(It.false,!1),emptyArray:new Tt(It.array,0),emptyMap:new Tt(It.map,0)},Qr={number(e,t,r,n){return Number.isInteger(e)&&Number.isSafeInteger(e)?new Tt(e>=0?It.uint:It.negint,e):new Tt(It.float,e)},bigint(e,t,r,n){return e>=BigInt(0)?new Tt(It.uint,e):new Tt(It.negint,e)},Uint8Array(e,t,r,n){return new Tt(It.bytes,e)},string(e,t,r,n){return new Tt(It.string,e)},boolean(e,t,r,n){return e?Fr.true:Fr.false},null(e,t,r,n){return Fr.null},undefined(e,t,r,n){return Fr.undefined},ArrayBuffer(e,t,r,n){return new Tt(It.bytes,new Uint8Array(e))},DataView(e,t,r,n){return new Tt(It.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,r,n){if(!e.length)return!0===r.addBreakTokens?[Fr.emptyArray,new Tt(It.break)]:Fr.emptyArray;n=Or.createCheck(n,e);const s=[];let i=0;for(const t of e)s[i++]=xr(t,r,n);return r.addBreakTokens?[new Tt(It.array,e.length),s,new Tt(It.break)]:[new Tt(It.array,e.length),s]},Object(e,t,r,n){const s="Object"!==t,i=s?e.keys():Object.keys(e),o=s?e.size:i.length;if(!o)return!0===r.addBreakTokens?[Fr.emptyMap,new Tt(It.break)]:Fr.emptyMap;n=Or.createCheck(n,e);const a=[];let A=0;for(const t of i)a[A++]=[xr(t,r,n),xr(s?e.get(t):e[t],r,n)];return function(e,t){t.mapSorter&&e.sort(t.mapSorter)}(a,r),r.addBreakTokens?[new Tt(It.map,o),a,new Tt(It.break)]:[new Tt(It.map,o),a]}};Qr.Map=Qr.Object,Qr.Buffer=Qr.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Qr[`${e}Array`]=Qr.DataView;function xr(e,t={},r){const n=St(e),s=t&&t.typeEncoders&&t.typeEncoders[n]||Qr[n];if("function"==typeof s){const i=s(e,n,t,r);if(null!=i)return i}const i=Qr[n];if(!i)throw new Error(`${jt} unsupported type: ${n}`);return i(e,n,t,r)}function Mr(e,t,r,n){if(Array.isArray(t))for(const s of t)Mr(e,s,r,n);else r[t.type.major](e,t,n)}function Hr(e,t,r){const n=xr(e,r);if(!Array.isArray(n)&&r.quickEncodeToken){const e=r.quickEncodeToken(n);if(e)return e;const s=t[n.type.major];if(s.encodedSize){const e=s.encodedSize(n,r),t=new Vt(e);if(s(t,n,r),1!==t.chunks.length)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return Pt(t.chunks[0])}}return Nr.reset(),Mr(Nr,n,t,r),Nr.toBytes(!0)}function Kr(e,t){return t=Object.assign({},Pr,t),Hr(e,Lr,t)}const Vr={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class zr{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){const e=this.data[this.pos];let t=Dr[e];if(void 0===t){const r=Ur[e];if(!r)throw new Error(`${zt} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);const n=31&e;t=r(this.data,this.pos,n,this.options)}return this.pos+=t.encodedLength,t}}const jr=Symbol.for("DONE"),Gr=Symbol.for("BREAK");function $r(e,t){if(e.done())return jr;const r=e.next();if(r.type===It.break)return Gr;if(r.type.terminal)return r.value;if(r.type===It.array)return function(e,t,r){const n=[];for(let s=0;s<e.value;s++){const i=$r(t,r);if(i===Gr){if(e.value===1/0)break;throw new Error(`${zt} got unexpected break to lengthed array`)}if(i===jr)throw new Error(`${zt} found array but not enough entries (got ${s}, expected ${e.value})`);n[s]=i}return n}(r,e,t);if(r.type===It.map)return function(e,t,r){const n=!0===r.useMaps,s=n?void 0:{},i=n?new Map:void 0;for(let o=0;o<e.value;o++){const a=$r(t,r);if(a===Gr){if(e.value===1/0)break;throw new Error(`${zt} got unexpected break to lengthed map`)}if(a===jr)throw new Error(`${zt} found map but not enough entries (got ${o} [no key], expected ${e.value})`);if(!0!==n&&"string"!=typeof a)throw new Error(`${zt} non-string keys not supported (got ${typeof a})`);if(!0===r.rejectDuplicateMapKeys&&(n&&i.has(a)||!n&&a in s))throw new Error(`${zt} found repeat map key "${a}"`);const A=$r(t,r);if(A===jr)throw new Error(`${zt} found map but not enough entries (got ${o} [no value], expected ${e.value})`);n?i.set(a,A):s[a]=A}return n?i:s}(r,e,t);if(r.type===It.tag){if(t.tags&&"function"==typeof t.tags[r.value]){const n=$r(e,t);return t.tags[r.value](n)}throw new Error(`${zt} tag not supported (${r.value})`)}throw new Error("unsupported")}function qr(e,t){if(!(e instanceof Uint8Array))throw new Error(`${zt} data to decode must be a Uint8Array`);const r=(t=Object.assign({},Vr,t)).tokenizer||new zr(e,t),n=$r(r,t);if(n===jr)throw new Error(`${zt} did not find any content to decode`);if(n===Gr)throw new Error(`${zt} got unexpected break`);if(!r.done())throw new Error(`${zt} too many terminals, data makes no sense`);return n}const Wr={float64:!0,typeEncoders:{Object:function(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const t=Ve.asCID(e);if(!t)return null;const r=new Uint8Array(t.bytes.byteLength+1);return r.set(t.bytes,1),[new Tt(It.tag,42),new Tt(It.bytes,r)]},undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}};const Yr={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};Yr.tags[42]=function(e){if(0!==e[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return Ve.decode(e.subarray(1))};const Xr="dag-cbor",Jr=113,Zr=e=>Kr(e,Wr),en=e=>qr(e,Yr),tn=({name:e,code:t,encode:r})=>new rn(e,t,r);class rn{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Fe(this.code,t):t.then((e=>Fe(this.code,e)))}throw Error("Unknown type, must be binary type")}}class nn extends Array{constructor(){super(),this.inRecursive=[]}prefix(e){const t=this.inRecursive[this.inRecursive.length-1];t&&(t.type===It.array&&(t.elements++,1!==t.elements&&e.push([44])),t.type===It.map&&(t.elements++,1!==t.elements&&(t.elements%2==1?e.push([44]):e.push([58]))))}[It.uint.major](e,t){this.prefix(e);const r=String(t.value),n=[];for(let e=0;e<r.length;e++)n[e]=r.charCodeAt(e);e.push(n)}[It.negint.major](e,t){this[It.uint.major](e,t)}[It.bytes.major](e,t){throw new Error(`${jt} unsupported type: Uint8Array`)}[It.string.major](e,t){this.prefix(e);const r=Nt(JSON.stringify(t.value));e.push(r.length>32?Pt(r):r)}[It.array.major](e,t){this.prefix(e),this.inRecursive.push({type:It.array,elements:0}),e.push([91])}[It.map.major](e,t){this.prefix(e),this.inRecursive.push({type:It.map,elements:0}),e.push([123])}[It.tag.major](e,t){}[It.float.major](e,t){if("break"===t.type.name){const t=this.inRecursive.pop();if(t){if(t.type===It.array)e.push([93]);else{if(t.type!==It.map)throw new Error("Unexpected recursive type; this should not happen!");e.push([125])}return}throw new Error("Unexpected break; this should not happen!")}if(void 0===t.value)throw new Error(`${jt} unsupported type: undefined`);if(this.prefix(e),"true"===t.type.name)return void e.push([116,114,117,101]);if("false"===t.type.name)return void e.push([102,97,108,115,101]);if("null"===t.type.name)return void e.push([110,117,108,108]);const r=String(t.value),n=[];let s=!1;for(let e=0;e<r.length;e++)n[e]=r.charCodeAt(e),s||46!==n[e]&&101!==n[e]&&69!==n[e]||(s=!0);s||(n.push(46),n.push(48)),e.push(n)}}const sn={addBreakTokens:!0,mapSorter:function(e,t){if(Array.isArray(e[0])||Array.isArray(t[0]))throw new Error(`${jt} complex map keys are not supported`);const r=e[0],n=t[0];if(r.type!==It.string||n.type!==It.string)throw new Error(`${jt} non-string map keys are not supported`);if(r<n)return-1;if(r>n)return 1;throw new Error(`${jt} unexpected duplicate map keys, this is not supported`)}};class on{constructor(e,t={}){this.pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;32===e||9===e||13===e||10===e;)e=this.data[++this.pos]}expect(e){if(this.data.length-this.pos<e.length)throw new Error(`${zt} unexpected end of input at position ${this.pos}`);for(let t=0;t<e.length;t++)if(this.data[this.pos++]!==e[t])throw new Error(`${zt} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){const e=this.pos;let t=!1,r=!1;const n=e=>{for(;!this.done();){const t=this.ch();if(!e.includes(t))break;this.pos++}};if(45===this.ch()&&(t=!0,this.pos++),48===this.ch()){if(this.pos++,46!==this.ch())return new Tt(It.uint,0,this.pos-e);this.pos++,r=!0}if(n([48,49,50,51,52,53,54,55,56,57]),t&&this.pos===e+1)throw new Error(`${zt} unexpected token at position ${this.pos}`);if(!this.done()&&46===this.ch()){if(r)throw new Error(`${zt} unexpected token at position ${this.pos}`);r=!0,this.pos++,n([48,49,50,51,52,53,54,55,56,57])}this.done()||101!==this.ch()&&69!==this.ch()||(r=!0,this.pos++,this.done()||43!==this.ch()&&45!==this.ch()||this.pos++,n([48,49,50,51,52,53,54,55,56,57]));const s=String.fromCharCode.apply(null,this.data.subarray(e,this.pos)),i=parseFloat(s);return r?new Tt(It.float,i,this.pos-e):!0!==this.options.allowBigInt||Number.isSafeInteger(i)?new Tt(i>=0?It.uint:It.negint,i,this.pos-e):new Tt(i>=0?It.uint:It.negint,BigInt(s),this.pos-e)}parseString(){if(34!==this.ch())throw new Error(`${zt} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let e=this.pos,t=0;e<this.data.length&&t<65536;e++,t++){const r=this.data[e];if(92===r||r<32||r>=128)break;if(34===r){const r=String.fromCharCode.apply(null,this.data.subarray(this.pos,e));return this.pos=e+1,new Tt(It.string,r,t)}}const e=this.pos,t=[],r=()=>{if(this.pos+4>=this.data.length)throw new Error(`${zt} unexpected end of unicode escape sequence at position ${this.pos}`);let e=0;for(let t=0;t<4;t++){let t=this.ch();if(t>=48&&t<=57)t-=48;else if(t>=97&&t<=102)t=t-97+10;else{if(!(t>=65&&t<=70))throw new Error(`${zt} unexpected unicode escape character at position ${this.pos}`);t=t-65+10}e=16*e+t,this.pos++}return e},n=()=>{const e=this.ch();let r,n,s,i,o=null,a=e>239?4:e>223?3:e>191?2:1;if(this.pos+a>this.data.length)throw new Error(`${zt} unexpected unicode sequence at position ${this.pos}`);switch(a){case 1:e<128&&(o=e);break;case 2:r=this.data[this.pos+1],128==(192&r)&&(i=(31&e)<<6|63&r,i>127&&(o=i));break;case 3:r=this.data[this.pos+1],n=this.data[this.pos+2],128==(192&r)&&128==(192&n)&&(i=(15&e)<<12|(63&r)<<6|63&n,i>2047&&(i<55296||i>57343)&&(o=i));break;case 4:r=this.data[this.pos+1],n=this.data[this.pos+2],s=this.data[this.pos+3],128==(192&r)&&128==(192&n)&&128==(192&s)&&(i=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&s,i>65535&&i<1114112&&(o=i))}null===o?(o=65533,a=1):o>65535&&(o-=65536,t.push(o>>>10&1023|55296),o=56320|1023&o),t.push(o),this.pos+=a};for(;!this.done();){const s=this.ch();let i;switch(s){case 92:if(this.pos++,this.done())throw new Error(`${zt} unexpected string termination at position ${this.pos}`);switch(i=this.ch(),this.pos++,i){case 34:case 39:case 92:case 47:t.push(i);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(r());break;default:throw new Error(`${zt} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new Tt(It.string,Kt(t),this.pos-e);default:if(s<32)throw new Error(`${zt} invalid control character at position ${this.pos}`);s<128?(t.push(s),this.pos++):n()}}throw new Error(`${zt} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new Tt(It.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new Tt(It.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new Tt(It.null,null,4);case 102:return this.expect([102,97,108,115,101]),new Tt(It.false,!1,5);case 116:return this.expect([116,114,117,101]),new Tt(It.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${zt} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":if(this.modeStack.pop(),93===this.ch())return this.pos++,this.skipWhitespace(),new Tt(It.break,void 0,1);if(44!==this.ch())throw new Error(`${zt} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue();case"array-start":return this.modeStack.pop(),93===this.ch()?(this.pos++,this.skipWhitespace(),new Tt(It.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(125===this.ch())return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new Tt(It.break,void 0,1);if(44!==this.ch())throw new Error(`${zt} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),125===this.ch())return this.pos++,this.skipWhitespace(),new Tt(It.break,void 0,1);const e=this.parseString();if(this.skipWhitespace(),58!==this.ch())throw new Error(`${zt} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${zt} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}}function an(e){const t=ee.encode(e).slice(1);return[new Tt(It.map,1/0,1),new Tt(It.string,"/",1),new Tt(It.map,1/0,1),new Tt(It.string,"bytes",5),new Tt(It.string,t,t.length),new Tt(It.break,void 0,1),new Tt(It.break,void 0,1)]}const An={typeEncoders:{Object:function(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const t=Ve.asCID(e);if(!t)return null;const r=t.toString();return[new Tt(It.map,1/0,1),new Tt(It.string,"/",1),new Tt(It.string,r,r.length),new Tt(It.break,void 0,1)]},Uint8Array:an,Buffer:an,undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}};class cn extends on{constructor(e,t){super(e,t),this.tokenBuffer=[]}done(){return 0===this.tokenBuffer.length&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const e=this._next();if(e.type===It.map){const e=this._next();if(e.type===It.string&&"/"===e.value){const e=this._next();if(e.type===It.string){if(this._next().type!==It.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(e),new Tt(It.tag,42,0)}if(e.type===It.map){const e=this._next();if(e.type===It.string&&"bytes"===e.value){const e=this._next();if(e.type===It.string){for(let e=0;e<2;e++){if(this._next().type!==It.break)throw new Error("Invalid encoded Bytes form")}const t=ee.decode(`m${e.value}`);return new Tt(It.bytes,t,e.value.length)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}return e}}const ln={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};ln.tags[42]=Ve.parse;const un="dag-json",hn=297,dn=e=>{return t=e,r=An,r=Object.assign({},sn,r),Hr(t,new nn,r);var t,r},fn=e=>function(e,t){return qr(e,t=Object.assign({tokenizer:new on(e,t)},t))}(e,Object.assign(ln,{tokenizer:new cn(e,ln)})),pn=e=>gn.decode(dn(e)),gn=new TextDecoder,yn=e=>fn(wn.encode(e)),wn=new TextEncoder;function mn(e){return re.encode(e).slice(1)}function bn(e){return re.decode(`u${e}`)}function En(e){const t={signature:bn(e.signature)};return e.header&&(t.header=e.header),e.protected&&(t.protected=bn(e.protected)),t}function vn(e){const t={signature:mn(e.signature)};return e.header&&(t.header=e.header),e.protected&&(t.protected=mn(e.protected)),t}function Bn(e){const t={};return e.encrypted_key&&(t.encrypted_key=bn(e.encrypted_key)),e.header&&(t.header=e.header),t}function _n(e){const t={};return e.encrypted_key&&(t.encrypted_key=mn(e.encrypted_key)),e.header&&(t.header=e.header),t}const Cn="dag-jose",Sn=133;function In(e){return"payload"in e&&"string"==typeof e.payload&&"signatures"in e&&Array.isArray(e.signatures)}function Tn(e){return"ciphertext"in e&&"string"==typeof e.ciphertext&&"iv"in e&&"string"==typeof e.iv&&"protected"in e&&"string"==typeof e.protected&&"tag"in e&&"string"==typeof e.tag}function Rn(e){if("string"==typeof e){const t=e.split(".");if(3===t.length)return function(e){const[t,r,n]=e;return{payload:r,signatures:[{protected:t,signature:n}],link:Ve.decode(bn(r))}}(t);if(5===t.length)return function(e){const[t,r,n,s,i]=e,o={ciphertext:s,iv:n,protected:t,tag:i};return r&&(o.recipients=[{encrypted_key:r}]),o}(t);throw new Error("Not a valid JOSE string")}if(In(e)||Tn(e))return e;throw new Error("Not a valid unencoded JOSE object")}function kn(e){let t;if("string"==typeof e&&(e=Rn(e)),In(e))t=function(e){const t=bn(e.payload);try{Ve.decode(t)}catch(e){throw new Error("Not a valid DagJWS")}return{payload:t,signatures:e.signatures.map(En)}}(e);else{if(!Tn(e))throw new Error("Not a valid JOSE object");t=function(e){const t={ciphertext:bn(e.ciphertext),protected:bn(e.protected),iv:bn(e.iv),tag:bn(e.tag)};return e.aad&&(t.aad=bn(e.aad)),e.recipients&&(t.recipients=e.recipients.map(Bn)),e.unprotected&&(t.unprotected=e.unprotected),t}(e)}return new Uint8Array(Zr(t))}function Un(e){let t;try{t=en(e)}catch(e){throw new Error("Not a valid DAG-JOSE object")}if("payload"in(r=t)&&r.payload instanceof Uint8Array&&"signatures"in r&&Array.isArray(r.signatures))return function(e){const t={payload:mn(e.payload),signatures:e.signatures.map(vn)};return t.link=Ve.decode(new Uint8Array(e.payload)),t}(t);if(function(e){return"ciphertext"in e&&e.ciphertext instanceof Uint8Array&&"iv"in e&&e.iv instanceof Uint8Array&&"protected"in e&&e.protected instanceof Uint8Array&&"tag"in e&&e.tag instanceof Uint8Array}(t))return function(e){const t={ciphertext:mn(e.ciphertext),protected:mn(e.protected),iv:mn(e.iv),tag:mn(e.tag)};return e.aad&&(t.aad=mn(e.aad)),e.recipients&&(t.recipients=e.recipients.map(_n)),e.unprotected&&(t.unprotected=e.unprotected),t}(t);throw new Error("Not a valid DAG-JOSE object");var r}const Dn=L,Pn={code:0,name:"identity",encode:Dn,digest:e=>Fe(0,Dn(e))},Ln=M({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),Nn=K({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),On=K({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Fn=H({prefix:"9",name:"base10",alphabet:"0123456789"}),Qn=K({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),xn=K({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Mn=H({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Hn=H({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Kn=Array.from(""),Vn=Kn.reduce(((e,t,r)=>(e[r]=t,e)),[]),zn=Kn.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const jn=M({prefix:"",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=Vn[t]),"")},decode:function(e){const t=[];for(const r of e){const e=zn[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}}),Gn=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),$n=tn({name:"sha2-256",code:18,encode:Gn("SHA-256")}),qn=tn({name:"sha2-512",code:19,encode:Gn("SHA-512")}),Wn="raw",Yn=85,Xn=e=>L(e),Jn=e=>L(e),Zn=new TextEncoder,es=new TextDecoder,ts="json",rs=512,ns=e=>Zn.encode(JSON.stringify(e)),ss=e=>JSON.parse(es.decode(e)),is={...u,...h,...d,...f,...p,...s,...g,...n,...i,...y},os={...w,...l},as={raw:m,json:b};class As extends Error{constructor(e="not initialized"){super(e),this.name="NotInitializedError",this.code=As.code}}As.code="ERR_NOT_INITIALIZED";class cs extends Error{constructor(e="cannot initialize an initializing node"){super(e),this.name="AlreadyInitializingError",this.code=ls.code}}cs.code="ERR_ALREADY_INITIALIZING";class ls extends Error{constructor(e="cannot re-initialize an initialized node"){super(e),this.name="AlreadyInitializedError",this.code=ls.code}}ls.code="ERR_ALREADY_INITIALIZED";class us extends Error{constructor(e="not started"){super(e),this.name="NotStartedError",this.code=us.code}}us.code="ERR_NOT_STARTED";class hs extends Error{constructor(e="cannot start, already startin"){super(e),this.name="AlreadyStartingError",this.code=hs.code}}hs.code="ERR_ALREADY_STARTING";class ds extends Error{constructor(e="cannot start, already started"){super(e),this.name="AlreadyStartedError",this.code=ds.code}}ds.code="ERR_ALREADY_STARTED";class fs extends Error{constructor(e="not enabled"){super(e),this.name="NotEnabledError",this.code=fs.code}}function ps(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function gs(e=0){return null!=globalThis.Buffer?.alloc?ps(globalThis.Buffer.alloc(e)):new Uint8Array(e)}function ys(e=0){return null!=globalThis.Buffer?.allocUnsafe?ps(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function ws(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}fs.code="ERR_NOT_ENABLED";const ms=ws("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),bs=ws("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=ys((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}));var Es={utf8:ms,"utf-8":ms,hex:is.base16,latin1:bs,ascii:bs,binary:bs,...is};function vs(e,t="utf8"){const r=Es[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):ps(globalThis.Buffer.from(e,"utf-8"))}var Bs=r(10715);const _s=new class{index=0;input="";new(e){return this.index=0,this.input=e,this}readAtomically(e){const t=this.index,r=e();return void 0===r&&(this.index=t),r}parseWith(e){const t=e();if(this.index===this.input.length)return t}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically((()=>{const t=this.readChar();if(t===e)return t}))}readSeparator(e,t,r){return this.readAtomically((()=>{if(!(t>0&&void 0===this.readGivenChar(e)))return r()}))}readNumber(e,t,r,n){return this.readAtomically((()=>{let s=0,i=0;const o=this.peekChar();if(void 0===o)return;const a="0"===o,A=2**(8*n)-1;for(;;){const r=this.readAtomically((()=>{const t=this.readChar();if(void 0===t)return;const r=Number.parseInt(t,e);return Number.isNaN(r)?void 0:r}));if(void 0===r)break;if(s*=e,s+=r,s>A)return;if(i+=1,void 0!==t&&i>t)return}return 0===i||!r&&a&&i>1?void 0:s}))}readIPv4Addr(){return this.readAtomically((()=>{const e=new Uint8Array(4);for(let t=0;t<e.length;t++){const r=this.readSeparator(".",t,(()=>this.readNumber(10,3,!1,1)));if(void 0===r)return;e[t]=r}return e}))}readIPv6Addr(){const e=e=>{for(let t=0;t<e.length/2;t++){const r=2*t;if(t<e.length-3){const n=this.readSeparator(":",t,(()=>this.readIPv4Addr()));if(void 0!==n)return e[r]=n[0],e[r+1]=n[1],e[r+2]=n[2],e[r+3]=n[3],[r+4,!0]}const n=this.readSeparator(":",t,(()=>this.readNumber(16,4,!0,2)));if(void 0===n)return[r,!1];e[r]=n>>8,e[r+1]=255&n}return[e.length,!1]};return this.readAtomically((()=>{const t=new Uint8Array(16),[r,n]=e(t);if(16===r)return t;if(n)return;if(void 0===this.readGivenChar(":"))return;if(void 0===this.readGivenChar(":"))return;const s=new Uint8Array(14),i=16-(r+2),[o]=e(s.subarray(0,i));return t.set(s.subarray(0,o),16-o),t}))}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};function Cs(e){return Boolean(function(e){if(!(e.length>15))return _s.new(e).parseWith((()=>_s.readIPv4Addr()))}(e))}function Ss(e){return Boolean(function(e){if(!(e.length>45))return _s.new(e).parseWith((()=>_s.readIPv6Addr()))}(e))}function Is(e){return Boolean(function(e){if(!(e.length>45))return _s.new(e).parseWith((()=>_s.readIPAddr()))}(e))}function Ts(e,t="utf8"){const r=Es[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}const Rs=Cs,ks=Ss,Us=function(e){let t=0;if(e=e.toString().trim(),Rs(e)){const r=new Uint8Array(t+4);return e.split(/\./g).forEach((e=>{r[t++]=255&parseInt(e,10)})),r}if(ks(e)){const r=e.split(":",8);let n;for(n=0;n<r.length;n++){let e;Rs(r[n])&&(e=Us(r[n]),r[n]=Ts(e.slice(0,2),"base16")),null!=e&&++n<8&&r.splice(n,0,Ts(e.slice(2,4),"base16"))}if(""===r[0])for(;r.length<8;)r.unshift("0");else if(""===r[r.length-1])for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&""!==r[n];n++);const e=[n,1];for(n=9-r.length;n>0;n--)e.push("0");r.splice.apply(r,e)}const s=new Uint8Array(t+16);for(n=0;n<r.length;n++){const e=parseInt(r[n],16);s[t++]=e>>8&255,s[t++]=255&e}return s}throw new Error("invalid ip address")},Ds=-1,Ps={},Ls={};function Ns(e){if("number"==typeof e){if(null!=Ls[e])return Ls[e];throw new Error(`no protocol with code: ${e}`)}if("string"==typeof e){if(null!=Ps[e])return Ps[e];throw new Error(`no protocol with name: ${e}`)}throw new Error("invalid protocol id type: "+typeof e)}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,Ds,"ip6zone"],[43,8,"ipcidr"],[53,Ds,"dns",!0],[54,Ds,"dns4",!0],[55,Ds,"dns6",!0],[56,Ds,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[281,0,"webrtc-w3c"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,Ds,"unix",!1,!0],[421,Ds,"ipfs"],[421,Ds,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,Ds,"garlic64"],[448,0,"tls"],[449,Ds,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,Ds,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,Ds,"memory"]].forEach((e=>{const t=function(e,t,r,n,s){return{code:e,size:t,name:r,resolvable:Boolean(n),path:Boolean(s)}}(...e);Ls[t.code]=t,Ps[t.name]=t}));var Os=r(94676);function Fs(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=ys(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return ps(r)}function Qs(e,t){switch(Ns(e).code){case 4:case 41:return function(e){const t=function(e,t=0,r){t=~~t,r=r??e.length-t;const n=new DataView(e.buffer);if(4===r){const n=[];for(let s=0;s<r;s++)n.push(e[t+s]);return n.join(".")}if(16===r){const e=[];for(let s=0;s<r;s+=2)e.push(n.getUint16(t+s).toString(16));return e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""}(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!Is(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Gs(t);case 6:case 273:case 33:case 132:return zs(t).toString();case 421:return function(e){const t=Os.decode(e),r=e.slice(Os.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return Ts(r,"base58btc")}(t);case 444:case 445:return $s(t);case 466:return function(e){const t=Os.decode(e),r=e.slice(Os.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return"u"+Ts(r,"base64url")}(t);default:return Ts(t,"base16")}}function xs(e,t){switch(Ns(e).code){case 4:case 41:return Ks(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return js(t);case 6:case 273:case 33:case 132:return Vs(parseInt(t,10));case 421:return function(e){let t;t="Q"===e[0]||"1"===e[0]?Qe(V.decode(`z${e}`)).bytes:Ve.parse(e).multihash.bytes;const r=Uint8Array.from(Os.encode(t.length));return Fs([r,t],r.length+t.length)}(t);case 444:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(16!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const r=j.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const s=Vs(n);return Fs([r,s],r.length+s.length)}(t);case 445:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(56!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const r=j.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const s=Vs(n);return Fs([r,s],r.length+s.length)}(t);case 466:return function(e){const t=Hs.decode(e),r=Uint8Array.from(Os.encode(t.length));return Fs([r,t],r.length+t.length)}(t);default:return vs(t,"base16")}}const Ms=Object.values(is).map((e=>e.decoder)),Hs=function(){let e=Ms[0].or(Ms[1]);return Ms.slice(2).forEach((t=>e=e.or(t))),e}();function Ks(e){if(!Is(e))throw new Error("invalid ip address");return Us(e)}function Vs(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function zs(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function js(e){const t=vs(e),r=Uint8Array.from(Os.encode(t.length));return Fs([r,t],r.length+t.length)}function Gs(e){const t=Os.decode(e);if((e=e.slice(Os.decode.bytes)).length!==t)throw new Error("inconsistent lengths");return Ts(e)}function $s(e){const t=e.slice(0,e.length-2),r=e.slice(e.length-2);return`${Ts(t,"base32")}:${zs(r)}`}function qs(e){return e.map((e=>{const t=si(e);return null!=e[1]?[t.code,Qs(t.code,e[1])]:[t.code]}))}function Ws(e){return ei(Fs(e.map((e=>{const t=si(e);let r=Uint8Array.from(Os.encode(t.code));return e.length>1&&null!=e[1]&&(r=Fs([r,e[1]])),r}))))}function Ys(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;return Os.decode(t)+(Os.decode.bytes??0)}function Xs(e){const t=[];let r=0;for(;r<e.length;){const n=Os.decode(e,r),s=Os.decode.bytes??0,i=Ys(Ns(n),e.slice(r+s));if(0===i){t.push([n]),r+=s;continue}const o=e.slice(r+s,r+s+i);if(r+=i+s,r>e.length)throw ni("Invalid address Uint8Array: "+Ts(e,"base16"));t.push([n,o])}return t}function Js(e){return function(e){const t=[];return e.map((e=>{const r=si(e);return t.push(r.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),ri(t.join("/"))}(qs(Xs(e)))}function Zs(e){const t=function(e){const t=[],r=e.split("/").slice(1);if(1===r.length&&""===r[0])return[];for(let n=0;n<r.length;n++){const s=r[n],i=Ns(s);if(0!==i.size){if(n++,n>=r.length)throw ni("invalid address: "+e);if(!0===i.path){t.push([s,ri(r.slice(n).join("/"))]);break}t.push([s,r[n]])}else t.push([s])}return t}(e=ri(e));return Ws(t.map((e=>{Array.isArray(e)||(e=[e]);const t=si(e);return e.length>1?[t.code,xs(t.code,e[1])]:[t.code]})))}function ei(e){const t=ti(e);if(null!=t)throw t;return Uint8Array.from(e)}function ti(e){try{Xs(e)}catch(e){return e}}function ri(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}function ni(e){return new Error("Error parsing address: "+e)}function si(e){return Ns(e[0])}function ii(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var oi,ai,Ai,ci,li=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},ui=function(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r};const hi=Symbol.for("nodejs.util.inspect.custom"),di=[Ns("dns").code,Ns("dns4").code,Ns("dns6").code,Ns("dnsaddr").code],fi=new Map,pi=Symbol.for("@multiformats/js-multiaddr/multiaddr");function gi(e,t){if(null==e)throw new Error("requires node address object");if(null==t)throw new Error("requires transport protocol");let r,n=e.address;switch(e.family){case 4:r="ip4";break;case 6:if(r="ip6",n.includes("%")){const e=n.split("%");if(2!==e.length)throw Error("Multiple ip6 zones in multiaddr");n=e[0];r=`/ip6zone/${e[1]}/ip6`}break;default:throw Error("Invalid addr family, should be 4 or 6.")}return new wi("/"+[r,n,t,e.port].join("/"))}function yi(e){return Boolean(e?.[pi])}class wi{constructor(e){if(oi.set(this,void 0),ai.set(this,void 0),Ai.set(this,void 0),this[ci]=!0,null==e&&(e=""),e instanceof Uint8Array)this.bytes=ei(e);else if("string"==typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=Zs(e)}else{if(!yi(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=ei(e.bytes)}}toString(){return null==li(this,oi,"f")&&ui(this,oi,Js(this.bytes),"f"),li(this,oi,"f")}toJSON(){return this.toString()}toOptions(){let e,t,r,n,s="";const i=Ns("tcp"),o=Ns("udp"),a=Ns("ip4"),A=Ns("ip6"),c=Ns("dns6"),l=Ns("ip6zone");for(const[u,h]of this.stringTuples())u===l.code&&(s=`%${h??""}`),di.includes(u)&&(t=i.name,n=443,r=`${h??""}${s}`,e=u===c.code?6:4),u!==i.code&&u!==o.code||(t=Ns(u).name,n=parseInt(h??"")),u!==a.code&&u!==A.code||(t=Ns(u).name,r=`${h??""}${s}`,e=u===A.code?6:4);if(null==e||null==t||null==r||null==n)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:r,transport:t,port:n}}protos(){return this.protoCodes().map((e=>Object.assign({},Ns(e))))}protoCodes(){const e=[],t=this.bytes;let r=0;for(;r<t.length;){const n=Os.decode(t,r),s=Os.decode.bytes??0;r+=Ys(Ns(n),t.slice(r+s))+s,e.push(n)}return e}protoNames(){return this.protos().map((e=>e.name))}tuples(){return null==li(this,ai,"f")&&ui(this,ai,Xs(this.bytes),"f"),li(this,ai,"f")}stringTuples(){return null==li(this,Ai,"f")&&ui(this,Ai,qs(this.tuples()),"f"),li(this,Ai,"f")}encapsulate(e){return e=new wi(e),new wi(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),r=this.toString(),n=r.lastIndexOf(t);if(n<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new wi(r.slice(0,n))}decapsulateCode(e){const t=this.tuples();for(let r=t.length-1;r>=0;r--)if(t[r][0]===e)return new wi(Ws(t.slice(0,r)));return this}getPeerId(){try{const e=this.stringTuples().filter((e=>e[0]===Ps.ipfs.code)),t=e.pop();if(null!=t?.[1]){const e=t[1];return"Q"===e[0]||"1"===e[0]?Ts(V.decode(`z${e}`),"base58btc"):Ts(Ve.parse(e).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter((e=>!0===Ns(e[0]).path))[0][1],null==e&&(e=null)}catch{e=null}return e}equals(e){return ii(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find((e=>e.resolvable));if(null==t)return[this];const r=fi.get(t.name);if(null==r)throw ie(new Error(`no available resolver for ${t.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await r(this,e)).map((e=>new wi(e)))}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(e??this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}[(oi=new WeakMap,ai=new WeakMap,Ai=new WeakMap,ci=pi,hi)](){return`Multiaddr(${Js(this.bytes)})`}}function mi(e){return new wi(e)}const bi=$i("dns4"),Ei=$i("dns6"),vi=$i("dnsaddr"),Bi=Gi($i("dns"),vi,bi,Ei),_i=Gi($i("ip4"),$i("ip6")),Ci=Gi(ji(_i,$i("tcp")),ji(Bi,$i("tcp"))),Si=ji(_i,$i("udp")),Ii=ji(Si,$i("utp")),Ti=ji(Si,$i("quic")),Ri=Gi(ji(Ci,$i("ws")),ji(Bi,$i("ws"))),ki=Gi(ji(Ci,$i("wss")),ji(Bi,$i("wss")),ji(Ci,$i("tls"),$i("ws")),ji(Bi,$i("tls"),$i("ws"))),Ui=Gi(ji(Ci,$i("http")),ji(_i,$i("http")),ji(Bi,$i("http"))),Di=Gi(ji(Ci,$i("https")),ji(_i,$i("https")),ji(Bi,$i("https"))),Pi=ji(Si,$i("webrtc"),$i("certhash")),Li=Gi(ji(Pi,$i("p2p")),Pi),Ni=Gi(ji(Ri,$i("p2p-webrtc-star"),$i("p2p")),ji(ki,$i("p2p-webrtc-star"),$i("p2p")),ji(Ri,$i("p2p-webrtc-star")),ji(ki,$i("p2p-webrtc-star"))),Oi=(Gi(ji(Ri,$i("p2p-websocket-star"),$i("p2p")),ji(ki,$i("p2p-websocket-star"),$i("p2p")),ji(Ri,$i("p2p-websocket-star")),ji(ki,$i("p2p-websocket-star"))),Gi(ji(Ui,$i("p2p-webrtc-direct"),$i("p2p")),ji(Di,$i("p2p-webrtc-direct"),$i("p2p")),ji(Ui,$i("p2p-webrtc-direct")),ji(Di,$i("p2p-webrtc-direct")))),Fi=Gi(Ri,ki,Ui,Di,Ni,Oi,Ci,Ii,Ti,Bi,Li),Qi=(Gi(ji(Fi,$i("p2p-stardust"),$i("p2p")),ji(Fi,$i("p2p-stardust"))),Gi(ji(Fi,$i("p2p")),Ni,Oi,Li,$i("p2p"))),xi=Gi(ji(Qi,$i("p2p-circuit"),Qi),ji(Qi,$i("p2p-circuit")),ji($i("p2p-circuit"),Qi),ji(Fi,$i("p2p-circuit")),ji($i("p2p-circuit"),Fi),$i("p2p-circuit")),Mi=()=>Gi(ji(xi,Mi),xi),Hi=Mi(),Ki=Gi(ji(Hi,Qi,Hi),ji(Qi,Hi),ji(Hi,Qi),Hi,Qi),Vi=Ki;function zi(e){return function(t){let r;try{r=mi(t)}catch(e){return!1}const n=e(r.protoNames());return null!==n&&(!0===n||!1===n?n:0===n.length)}}function ji(...e){function t(t){if(t.length<e.length)return null;let r=t;return e.some((e=>(r="function"==typeof e?e().partialMatch(t):e.partialMatch(t),Array.isArray(r)&&(t=r),null===r))),r}return{toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:zi(t),partialMatch:t}}function Gi(...e){function t(t){let r=null;return e.some((e=>{const n="function"==typeof e?e().partialMatch(t):e.partialMatch(t);return null!=n&&(r=n,!0)})),r}return{toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:zi(t),partialMatch:t}}function $i(e){const t=e;return{toString:function(){return t},matches:function(e){let r;try{r=mi(e)}catch(e){return!1}const n=r.protoNames();return 1===n.length&&n[0]===t},partialMatch:function(e){return 0===e.length?null:e[0]===t?e.slice(1):null}}}var qi=r(17745);const Wi=/^\/(ip[fn]s)\/([^/?#]+)/,Yi=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,Xi=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function Ji(e){try{return to(e)?Boolean(Ve.parse(e)):e instanceof Uint8Array?Boolean(Ve.decode(e)):Boolean(Ve.asCID(e))}catch{return!1}}function Zi(e,t,r=1,n=2){const s=ro(e);if(!1===s)return!1;const i=s.match(t);if(null==i)return!1;if("ipfs"!==i[r])return!1;let o=i[n];return null!=o&&t===Yi&&(o=o.toLowerCase()),Ji(o)}function eo(e,t,r=1,n=2){const s=ro(e);if(!1===s)return!1;const i=s.match(t);if(null==i)return!1;if("ipns"!==i[r])return!1;let o=i[n];if(null!=o&&t===Yi){if(o=o.toLowerCase(),Ji(o))return!0;try{!o.includes(".")&&o.includes("-")&&(o=o.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));const{hostname:e}=new qi.URL(`http://${o}`);return Xi.test(e)}catch(e){return!1}}return!0}function to(e){return"string"==typeof e}function ro(e){return e instanceof Uint8Array?Ts(e,"base58btc"):!!to(e)&&e}const no=e=>Zi(e,Wi)||eo(e,Wi),so=e=>eo(e,Wi);const io="/",oo=(new TextEncoder).encode(io),ao=oo[0];class Ao{constructor(e,t){if("string"==typeof e)this._buf=vs(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==ao)throw new Error("Invalid key")}toString(e="utf8"){return Ts(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new Ao(e.join(io))}static random(){return new Ao(((e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),""))().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||"string"==typeof e?new Ao(e):"function"==typeof e.uint8Array?new Ao(e.uint8Array()):null}clean(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=oo),this._buf[0]!==ao){const e=new Uint8Array(this._buf.byteLength+1);e.fill(ao,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===ao;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),r=e.list();for(let e=0;e<t.length;e++){if(r.length<e+1)return!1;const n=t[e],s=r[e];if(n<s)return!0;if(n>s)return!1}return t.length<r.length}reverse(){return Ao.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(io).slice(1)}type(){return function(e){const t=e.split(":");if(t.length<2)return"";return t.slice(0,-1).join(":")}(this.baseNamespace())}name(){return function(e){const t=e.split(":");return t[t.length-1]}(this.baseNamespace())}instance(e){return new Ao(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(io)||(e+=io),e+=this.type(),new Ao(e)}parent(){const e=this.list();return 1===e.length?new Ao(io):new Ao(e.slice(0,-1).join(io))}child(e){return this.toString()===io?e:e.toString()===io?this:new Ao(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(...e){return Ao.withNamespaces([...this.namespaces(),...(t=e.map((e=>e.namespaces())),[].concat(...t))]);var t}}var co=r(32044);let lo=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/giu;function uo(e="",t="ms"){var r=null;return(e=(e+"").replace(/(\d)[,_](\d)/g,"$1$2")).replace(lo,(function(e,t,n){(n=ho(n))&&(r=(r||0)+parseFloat(t,10)*n)})),r&&r/(ho(t)||1)}function ho(e){return uo[e]||uo[e.toLowerCase().replace(/s$/,"")]}uo.nanosecond=uo.ns=1e-6,uo["s"]=uo["s"]=uo.us=uo.microsecond=.001,uo.millisecond=uo.ms=uo[""]=1,uo.second=uo.sec=uo.s=1e3*uo.ms,uo.minute=uo.min=uo.m=60*uo.s,uo.hour=uo.hr=uo.h=60*uo.m,uo.day=uo.d=24*uo.h,uo.week=uo.wk=uo.w=7*uo.d,uo.month=uo.b=30.4375*uo.d,uo.year=uo.yr=uo.y=365.25*uo.d;var fo=uo;class po extends Error{constructor(e="request timed out"){super(e),this.name="TimeoutError",this.code=po.code}}function go(e,t){return(...r)=>{const n=r[null==t?r.length-1:t];if(!n||!n.timeout)return e(...r);const s="string"==typeof n.timeout?fo(n.timeout):n.timeout,i=new Bs.TimeoutController(s);n.signal=(0,co.anySignal)([n.signal,i.signal]);const o=e(...r),a=new Promise(((e,t)=>{i.signal.addEventListener("abort",(()=>{t(new po)}))})),A=Date.now(),c=()=>{if(i.signal.aborted)throw new po;if(Date.now()-A>s)throw i.abort(),new po};return o[Symbol.asyncIterator]?async function*(){const e=o[Symbol.asyncIterator]();try{for(;;){const{value:t,done:r}=await Promise.race([e.next(),a]);if(r)break;c(),yield t}}catch(e){throw c(),e}finally{i.clear(),e.return&&e.return()}}():(async()=>{try{const e=await Promise.race([o,a]);return c(),e}catch(e){throw c(),e}finally{i.clear()}})()}}po.code="ERR_TIMEOUT";const yo="/ipfs/";function wo(e){if(e instanceof Uint8Array)try{e=Ve.decode(e)}catch(e){throw ie(e,"ERR_INVALID_CID")}let t=Ve.asCID(e);if(t)return{cid:t,path:void 0};(e=e.toString()).startsWith(yo)&&(e=e.substring(yo.length));const r=e.split("/");let n;try{t=Ve.parse(r.shift()||"")}catch(e){throw ie(e,"ERR_INVALID_CID")}return r.length&&(n=`/${r.join("/")}`),{cid:t,path:n}}const mo="This command must be run in online mode. Try running 'ipfs daemon' first.",bo=new Ao("/local/filesroot"),Eo=e=>e instanceof Uint8Array?Ve.decode(e).toString():(0===(e=e.toString()).indexOf("/ipfs/")&&(e=e.substring("/ipfs/".length)),"/"===e.charAt(e.length-1)&&(e=e.substring(0,e.length-1)),e),vo=async function(e,t,r,n={}){const{cid:s,path:i}=wo(r);i&&(n.path=i);let o=s,a=n.path||"";if(a.startsWith("/")&&(a=a.substring(1)),n.path)try{for await(const{value:r,remainderPath:i}of Co(s,n.path,t,e,{signal:n.signal})){if(!Ve.asCID(r))break;a=i,o=r}}catch(e){throw e.message.startsWith("Object has no property")&&(e.message=`no link named "${a.split("/")[0]}" under ${o}`,e.code="ERR_NO_LINK"),e}return{cid:o,remainderPath:a||""}},Bo=e=>{if("file"!==e.type&&"directory"!==e.type&&"raw"!==e.type)throw new Error(`Unknown node type '${e.type}'`);const t={cid:e.cid,path:e.path,name:e.name,size:e.size,type:"file"};return"directory"===e.type&&(t.type="dir"),"file"===e.type&&(t.size=e.unixfs.fileSize()),"file"!==e.type&&"directory"!==e.type||(t.mode=e.unixfs.mode,void 0!==e.unixfs.mtime&&(t.mtime=e.unixfs.mtime)),t},_o=go((async(e,t)=>await e)),Co=async function*(e,t,r,n,s){const i=async e=>{const t=await r.getCodec(e.code),i=await n.blocks.get(e,s);return t.decode(i)},o=t.split("/").filter(Boolean);let a=await i(e),A=e;for(;o.length;){const r=o.shift();if(!r)throw ie(new Error(`Could not resolve path "${t}"`),"ERR_INVALID_PATH");if(e.code===Et&&Array.isArray(a.Links)){const e=a.Links.find((e=>e.Name===r));if(e){yield{value:e.Hash,remainderPath:o.join("/")},a=await i(e.Hash),A=e.Hash;continue}}if(!Object.prototype.hasOwnProperty.call(a,r))throw ie(new Error(`no link named "${r}" under ${A}`),"ERR_NO_LINK");a=a[r],yield{value:a,remainderPath:o.join("/")},Ve.asCID(a)&&(A=a,a=await i(a))}yield{value:a,remainderPath:""}};class So{static create({start:e,stop:t}){return new So(e,t)}static async start(e,t){const{state:r,activate:n}=e;switch(r.status){case"stopped":try{const r=n(t);e.state={status:"starting",ready:r};const s=await r;return e.state={status:"started",value:s},s}catch(t){throw e.state={status:"stopped"},t}case"starting":throw new hs;case"started":throw new ds;case"stopping":return await r.ready,await So.start(e,t);default:return So.panic(e)}}static async stop(e){const{state:t,deactivate:r}=e;switch(t.status){case"stopped":break;case"starting":try{await t.ready}catch(e){}return await So.stop(e);case"stopping":return await t.ready;case"started":r&&await r(t.value),e.state={status:"stopped"};break;default:So.panic(t)}}static try({state:e}){return"started"===e.status?e.value:null}static async use({state:e},t){switch(e.status){case"started":return e.value;case"starting":return await _o(e.ready,t);default:throw new us}}static panic({state:e}){const t=JSON.stringify({status:e.status});throw RangeError(`Service in invalid state ${t}, should never happen if you see this please report a bug`)}constructor(e,t){this.activate=e,this.deactivate=t,this.state={status:"stopped"}}async use(e){return await So.use(this,e)}try(){return So.try(this)}}var Io=r(70248);var To=r(26729);class Ro extends Error{constructor(e){super(e),this.name="TimeoutError"}}class ko extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const Uo=e=>void 0===globalThis.DOMException?new ko(e):new DOMException(e),Do=e=>{const t=void 0===e.reason?Uo("This operation was aborted."):e.reason;return t instanceof Error?t:Uo(t)};var Po,Lo=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};class No{constructor(){Po.set(this,[])}enqueue(e,t){const r={priority:(t={priority:0,...t}).priority,run:e};if(this.size&&Lo(this,Po,"f")[this.size-1].priority>=t.priority)return void Lo(this,Po,"f").push(r);const n=function(e,t,r){let n=0,s=e.length;for(;s>0;){const i=Math.trunc(s/2);let o=n+i;r(e[o],t)<=0?(n=++o,s-=i+1):s=i}return n}(Lo(this,Po,"f"),r,((e,t)=>t.priority-e.priority));Lo(this,Po,"f").splice(n,0,r)}dequeue(){const e=Lo(this,Po,"f").shift();return null==e?void 0:e.run}filter(e){return Lo(this,Po,"f").filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return Lo(this,Po,"f").length}}Po=new WeakMap;var Oo,Fo,Qo,xo,Mo,Ho,Ko,Vo,zo,jo,Go,$o,qo,Wo,Yo,Xo,Jo,Zo,ea,ta,ra,na,sa,ia,oa,aa,Aa=function(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r},ca=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};class la extends Error{}class ua extends To{constructor(e){var t,r,n,s;if(super(),Oo.add(this),Fo.set(this,void 0),Qo.set(this,void 0),xo.set(this,0),Mo.set(this,void 0),Ho.set(this,void 0),Ko.set(this,0),Vo.set(this,void 0),zo.set(this,void 0),jo.set(this,void 0),Go.set(this,void 0),$o.set(this,0),qo.set(this,void 0),Wo.set(this,void 0),Yo.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!("number"==typeof(e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:No,...e}).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(r=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==r?r:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(s=null===(n=e.interval)||void 0===n?void 0:n.toString())&&void 0!==s?s:""}\` (${typeof e.interval})`);Aa(this,Fo,e.carryoverConcurrencyCount,"f"),Aa(this,Qo,e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,"f"),Aa(this,Mo,e.intervalCap,"f"),Aa(this,Ho,e.interval,"f"),Aa(this,jo,new e.queueClass,"f"),Aa(this,Go,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,Aa(this,Yo,!0===e.throwOnTimeout,"f"),Aa(this,Wo,!1===e.autoStart,"f")}get concurrency(){return ca(this,qo,"f")}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);Aa(this,qo,e,"f"),ca(this,Oo,"m",ia).call(this)}async add(e,t={}){return t={timeout:this.timeout,throwOnTimeout:ca(this,Yo,"f"),...t},new Promise(((r,n)=>{ca(this,jo,"f").enqueue((async()=>{var s,i,o;Aa(this,$o,(i=ca(this,$o,"f"),++i),"f"),Aa(this,xo,(o=ca(this,xo,"f"),++o),"f");try{if(null===(s=t.signal)||void 0===s?void 0:s.aborted)throw new la("The task was aborted.");let n=e({signal:t.signal});t.timeout&&(n=function(e,t,r,n){let s;const i=new Promise(((i,o)=>{if("number"!=typeof t||1!==Math.sign(t))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t!==Number.POSITIVE_INFINITY){if((n={customTimers:{setTimeout:setTimeout,clearTimeout:clearTimeout},...n}).signal){const{signal:e}=n;e.aborted&&o(Do(e)),e.addEventListener("abort",(()=>{o(Do(e))}))}s=n.customTimers.setTimeout.call(void 0,(()=>{if("function"==typeof r){try{i(r())}catch(e){o(e)}return}const n=r instanceof Error?r:new Ro("string"==typeof r?r:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),o(n)}),t),(async()=>{try{i(await e)}catch(e){o(e)}finally{n.customTimers.clearTimeout.call(void 0,s)}})()}else i(e)}));return i.clear=()=>{clearTimeout(s),s=void 0},i}(Promise.resolve(n),t.timeout)),t.signal&&(n=Promise.race([n,ca(this,Oo,"m",oa).call(this,t.signal)]));const i=await n;r(i),this.emit("completed",i)}catch(e){if(e instanceof Ro&&!t.throwOnTimeout)return void r();n(e),this.emit("error",e)}finally{ca(this,Oo,"m",Zo).call(this)}}),t),this.emit("add"),ca(this,Oo,"m",ra).call(this)}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return ca(this,Wo,"f")?(Aa(this,Wo,!1,"f"),ca(this,Oo,"m",ia).call(this),this):this}pause(){Aa(this,Wo,!0,"f")}clear(){Aa(this,jo,new(ca(this,Go,"f")),"f")}async onEmpty(){0!==ca(this,jo,"f").size&&await ca(this,Oo,"m",aa).call(this,"empty")}async onSizeLessThan(e){ca(this,jo,"f").size<e||await ca(this,Oo,"m",aa).call(this,"next",(()=>ca(this,jo,"f").size<e))}async onIdle(){0===ca(this,$o,"f")&&0===ca(this,jo,"f").size||await ca(this,Oo,"m",aa).call(this,"idle")}get size(){return ca(this,jo,"f").size}sizeBy(e){return ca(this,jo,"f").filter(e).length}get pending(){return ca(this,$o,"f")}get isPaused(){return ca(this,Wo,"f")}}Fo=new WeakMap,Qo=new WeakMap,xo=new WeakMap,Mo=new WeakMap,Ho=new WeakMap,Ko=new WeakMap,Vo=new WeakMap,zo=new WeakMap,jo=new WeakMap,Go=new WeakMap,$o=new WeakMap,qo=new WeakMap,Wo=new WeakMap,Yo=new WeakMap,Oo=new WeakSet,Xo=function(){return ca(this,Qo,"f")||ca(this,xo,"f")<ca(this,Mo,"f")},Jo=function(){return ca(this,$o,"f")<ca(this,qo,"f")},Zo=function(){var e;Aa(this,$o,(e=ca(this,$o,"f"),--e),"f"),ca(this,Oo,"m",ra).call(this),this.emit("next")},ea=function(){ca(this,Oo,"m",sa).call(this),ca(this,Oo,"m",na).call(this),Aa(this,zo,void 0,"f")},ta=function(){const e=Date.now();if(void 0===ca(this,Vo,"f")){const t=ca(this,Ko,"f")-e;if(!(t<0))return void 0===ca(this,zo,"f")&&Aa(this,zo,setTimeout((()=>{ca(this,Oo,"m",ea).call(this)}),t),"f"),!0;Aa(this,xo,ca(this,Fo,"f")?ca(this,$o,"f"):0,"f")}return!1},ra=function(){if(0===ca(this,jo,"f").size)return ca(this,Vo,"f")&&clearInterval(ca(this,Vo,"f")),Aa(this,Vo,void 0,"f"),this.emit("empty"),0===ca(this,$o,"f")&&this.emit("idle"),!1;if(!ca(this,Wo,"f")){const e=!ca(this,Oo,"a",ta);if(ca(this,Oo,"a",Xo)&&ca(this,Oo,"a",Jo)){const t=ca(this,jo,"f").dequeue();return!!t&&(this.emit("active"),t(),e&&ca(this,Oo,"m",na).call(this),!0)}}return!1},na=function(){ca(this,Qo,"f")||void 0!==ca(this,Vo,"f")||(Aa(this,Vo,setInterval((()=>{ca(this,Oo,"m",sa).call(this)}),ca(this,Ho,"f")),"f"),Aa(this,Ko,Date.now()+ca(this,Ho,"f"),"f"))},sa=function(){0===ca(this,xo,"f")&&0===ca(this,$o,"f")&&ca(this,Vo,"f")&&(clearInterval(ca(this,Vo,"f")),Aa(this,Vo,void 0,"f")),Aa(this,xo,ca(this,Fo,"f")?ca(this,$o,"f"):0,"f"),ca(this,Oo,"m",ia).call(this)},ia=function(){for(;ca(this,Oo,"m",ra).call(this););},oa=async function(e){return new Promise(((t,r)=>{e.addEventListener("abort",(()=>{r(new la("The task was aborted."))}),{once:!0})}))},aa=async function(e,t){return new Promise((r=>{const n=()=>{t&&!t()||(this.off(e,n),r())};this.on(e,n)}))};var ha=r(67137);const da=new class{constructor(e){this.lru=Io(e)}get(e){const t=this.lru.get(e);if(t)return t.expire&&t.expire<Date.now()?void this.lru.remove(e):t.value}set(e,t,r){this.lru.set(e,{value:t,expire:Date.now()+r})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}}(1e3),fa=new(ua.default?ua.default:ua)({concurrency:4}),pa=e=>{if(e.Path)return e.Path;throw new Error(e.Message)};function ga(){return go((async(e,t={recursive:!0})=>{if("string"!=typeof e)throw new Error("Invalid arguments, domain must be a string");return async function(e,t){return(async(e,t={})=>{const r=new URLSearchParams(t);r.set("arg",e);const n=r.toString();if(!t.nocache&&da.has(n)){const e=da.get(n);return pa(e)}const s=await fa.add((async()=>{const e=await ha.get("https://ipfs.io/api/v0/dns",{searchParams:r}),t=new URL(e.url).search.slice(1),n=await e.json();return da.set(t,n,6e4),n}));return pa(s)})(e,t)}(e=function(e){return e.endsWith(".eth")&&(e=e.replace(/.eth$/,".eth.link")),e}(e),t)}))}class ya extends Error{constructor(e="The operation was aborted"){super(e),this.code=ya.code,this.type=ya.type}static get code(){return"ABORT_ERR"}static get type(){return"aborted"}}class wa extends Error{constructor(e,t,r){super(e),this.code=t,this.name=r?.name??"CodeError",this.props=r??{}}}const ma=Symbol.for("@libp2p/peer-id");function ba(e){return null!=e&&Boolean(e[ma])}const Ea=Symbol.for("nodejs.util.inspect.custom"),va=Object.values(is).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),is.identity.decoder);class Ba{constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[ma](){return!0}toString(){return null==this.string&&(this.string=V.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return Ve.createV1(114,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return ii(this.multihash.bytes,e);if("string"==typeof e)return Ta(e).equals(this);if(null!=e?.multihash?.bytes)return ii(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[Ea](){return`PeerId(${this.toString()})`}}class _a extends Ba{constructor(e){super({...e,type:"RSA"}),this.type="RSA",this.publicKey=e.publicKey}}class Ca extends Ba{constructor(e){super({...e,type:"Ed25519"}),this.type="Ed25519",this.publicKey=e.multihash.digest}}class Sa extends Ba{constructor(e){super({...e,type:"secp256k1"}),this.type="secp256k1",this.publicKey=e.multihash.digest}}function Ia(e){if("RSA"===e.type)return new _a(e);if("Ed25519"===e.type)return new Ca(e);if("secp256k1"===e.type)return new Sa(e);throw new wa("Not a PeerId","ERR_INVALID_PARAMETERS")}function Ta(e,t){if(t=t??va,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=Qe(V.decode(`z${e}`));return e.startsWith("12D")?new Ca({multihash:t}):e.startsWith("16U")?new Sa({multihash:t}):new _a({multihash:t})}return Ra(va.decode(e))}function Ra(e){try{const t=Qe(e);if(t.code===Pn.code){if(36===t.digest.length)return new Ca({multihash:t});if(37===t.digest.length)return new Sa({multihash:t})}if(t.code===$n.code)return new _a({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&114!==e.code)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===$n.code)return new _a({multihash:e.multihash});if(t.code===Pn.code){if(36===t.digest.length)return new Ca({multihash:e.multihash});if(37===t.digest.length)return new Sa({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(Ve.decode(e))}throw new Error("Supplied PeerID CID is invalid")}async function ka(e,t){return 36===e.length?new Ca({multihash:Fe(Pn.code,e),privateKey:t}):37===e.length?new Sa({multihash:Fe(Pn.code,e),privateKey:t}):new _a({multihash:await $n.digest(e),publicKey:e,privateKey:t})}function Ua({repo:e,codecs:t,bases:r,name:n}){return go((async function(s,i={}){if(!no(s))throw new Error("invalid argument "+s);if(so(s))for await(const e of n.resolve(s,i))s=e;const[,o,a,...A]=s.split("/"),c=i.cidBase?await r.getBase(i.cidBase):void 0,l=function(e){try{return Ta(e).toBytes()}catch{return Ve.parse(e).bytes}}(a);if(0===A.length){return`/${o}/${c?c.encoder.encode(l):a}`}const u=Ve.decode(l);s=A.join("/");const h=Co(u,s,t,e,i);let d=u,f=s;for await(const e of h)Ve.asCID(e.value)&&(d=e.value,f=e.remainderPath);return`/ipfs/${d.toString(c&&c.encoder)}${f?"/"+f:""}`}))}async function Da(e){let t;for await(const r of e)t=r;return t}function Pa(e){return null!=Ve.asCID(e)}async function*La(e){if(null==e)throw ie(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");const t=Ve.asCID(e);if(t)yield Na({cid:t});else{if(!(e instanceof String||"string"==typeof e)){if(null!=e.cid||null!=e.path)return yield Na(e);if(r=e,Symbol.iterator in r){const t=e[Symbol.iterator](),r=t.next();if(r.done)return t;if(Pa(r.value)){yield Na({cid:r.value});for(const e of t)yield Na({cid:e});return}if(r.value instanceof String||"string"==typeof r.value){yield Na({path:r.value});for(const e of t)yield Na({path:e});return}if(null!=r.value.cid||null!=r.value.path){yield Na(r.value);for(const e of t)yield Na(e);return}throw ie(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}var r;if(function(e){return Symbol.asyncIterator in e}(e)){const t=e[Symbol.asyncIterator](),r=await t.next();if(r.done)return t;if(Pa(r.value)){yield Na({cid:r.value});for await(const e of t)yield Na({cid:e});return}if(r.value instanceof String||"string"==typeof r.value){yield Na({path:r.value});for await(const e of t)yield Na({path:e});return}if(null!=r.value.cid||null!=r.value.path){yield Na(r.value);for await(const e of t)yield Na(e);return}throw ie(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}throw ie(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}yield Na({path:e})}}function Na(e){const t=e.cid||`${e.path}`;if(!t)throw ie(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");const r={path:t,recursive:!1!==e.recursive};return null!=e.metadata&&(r.metadata=e.metadata),r}const Oa={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"};function Fa(e,t,r){const n={type:e,cid:t};return r&&(n.metadata=r),n}class Qa{constructor({codecs:e,repo:t}){const r=function({repo:e,codecs:t}){return go((async function*(r,n={}){const s=async function*(){for await(const{path:n,recursive:s,metadata:i}of La(r)){const{cid:r}=await vo(e,t,n),{reason:o}=await e.pins.isPinnedWithType(r,[Oa.recursive,Oa.direct]);if("recursive"===o&&!s)throw new Error(`${r} already pinned recursively`);s?await e.pins.pinRecursively(r,{metadata:i}):await e.pins.pinDirectly(r,{metadata:i}),yield r}};if(!Boolean(n.lock))return void(yield*s());const i=await e.gcLock.readLock();try{yield*s()}finally{i()}}))}({codecs:e,repo:t});this.addAll=r,this.add=function({addAll:e}){return(t,r={})=>{let n;const s=Ve.asCID(t);return n=e(s?[{cid:s,...r}]:[{path:t.toString(),...r}],r),Da(n)}}({addAll:r});const n=function({repo:e,codecs:t}){return go((async function*(r,n={}){const s=await e.gcLock.readLock();try{for await(const{path:n,recursive:s}of La(r)){const{cid:r}=await vo(e,t,n),{pinned:i,reason:o}=await e.pins.isPinnedWithType(r,Oa.all);if(!i)throw new Error(`${r} is not pinned`);switch(o){case Oa.recursive:if(!s)throw new Error(`${r} is pinned recursively`);await e.pins.unpin(r),yield r;break;case Oa.direct:await e.pins.unpin(r),yield r;break;default:throw new Error(`${r} is pinned indirectly under ${o}`)}}}finally{s()}}))}({codecs:e,repo:t});this.rmAll=n,this.rm=function({rmAll:e}){return async function(t,r={}){const n=await Da(e([{path:t,...r}],r));if(!n)throw new Error("CID expected");return n}}({rmAll:n}),this.ls=function({repo:e,codecs:t}){return go((async function*(r={}){let n=Oa.all;if(r.type&&(n=r.type,!Object.keys(Oa).includes(n)))throw ie(new Error("Invalid pin type"),"ERR_INVALID_PIN_TYPE");if(r.paths){let s=!1;for await(const{path:i}of La(r.paths)){const{cid:r}=await vo(e,t,i),{reason:o,pinned:a,parent:A,metadata:c}=await e.pins.isPinnedWithType(r,n);if(!a)throw ie(new Error(`path '${i}' is not pinned`),"ERR_NOT_PINNED");switch(o){case Oa.direct:case Oa.recursive:s=!0,yield Fa(o,r,c);break;default:s=!0,yield Fa(`${Oa.indirect} through ${A}`,r,c)}}if(!s)throw new Error("No match found")}else{if(n===Oa.recursive||n===Oa.all)for await(const{cid:t,metadata:r}of e.pins.recursiveKeys())yield Fa(Oa.recursive,t,r);if(n===Oa.indirect||n===Oa.all)for await(const t of e.pins.indirectKeys(r))yield Fa(Oa.indirect,t);if(n===Oa.direct||n===Oa.all)for await(const{cid:t,metadata:r}of e.pins.directKeys())yield Fa(Oa.direct,t,r)}}))}({codecs:e,repo:t}),this.remote={add:(e,t={})=>Promise.reject(new Error("Not implemented")),ls:async function*(e,t={}){return Promise.reject(new Error("Not implemented"))},rm:(e,t={})=>Promise.reject(new Error("Not implemented")),rmAll:(e,t={})=>Promise.reject(new Error("Not implemented")),service:{add:(e,t)=>Promise.reject(new Error("Not implemented")),rm:(e,t={})=>Promise.reject(new Error("Not implemented")),ls:(e={})=>Promise.reject(new Error("Not implemented"))}}}}function xa(e){return e=e||new Error("Cannot open database"),ie(e,"ERR_DB_OPEN_FAILED")}function Ma(e){return e=e||new Error("Delete failed"),ie(e,"ERR_DB_DELETE_FAILED")}function Ha(e){return e=e||new Error("Write failed"),ie(e,"ERR_DB_WRITE_FAILED")}function Ka(e){return e=e||new Error("Not Found"),ie(e,"ERR_NOT_FOUND")}var Va=r(79297),za=r(51408),ja=r(50593),Ga=r(41173),$a=r(43155),qa=r(99693);qa._configure(),za._configure(ja),Ga._configure($a);const Wa=["uint64","int64","sint64","fixed64","sfixed64"];function Ya(e){return function(e){for(const t of Wa){if(null==e[t])continue;const r=e[t];e[t]=function(){return BigInt(r.call(this).toString())}}return e}(new za(e))}function Xa(){return function(e){for(const t of Wa){if(null==e[t])continue;const r=e[t];e[t]=function(e){return r.call(this,e.toString())}}return e}(Ga.create())}function Ja(e,t){const r=Ya(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}function Za(e,t){const r=Xa();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var eA,tA,rA,nA,sA;function iA(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function oA(e){function t(t){if(null==e[t.toString()])throw new Error("Invalid enum value");return e[t]}return iA("enum",eA.VARINT,(function(e,r){const n=t(e);r.int32(n)}),(function(e){return t(e.int32())}))}function aA(e,t){return iA("message",eA.LENGTH_DELIMITED,e,t)}!function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"}(eA||(eA={})),function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(tA||(tA={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(rA||(rA={})),function(e){e.codec=()=>oA(rA)}(tA||(tA={})),function(e){let t;e.codec=()=>(null==t&&(t=aA(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),tA.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.Type=tA.codec().decode(e);break;case 2:r.Data=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>Za(t,e.codec()),e.decode=t=>Ja(t,e.codec())}(nA||(nA={})),function(e){let t;e.codec=()=>(null==t&&(t=aA(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),tA.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.Type=tA.codec().decode(e);break;case 2:r.Data=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>Za(t,e.codec()),e.decode=t=>Ja(t,e.codec())}(sA||(sA={}));r(3068),r(97450);var AA=r(3832),cA={get(e=globalThis){const t=e.crypto;if(null==t||null==t.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}};var lA=r(97116);r(15764);function uA(e,t){let r=Uint8Array.from(e.abs().toByteArray());if(r=0===r[0]?r.subarray(1):r,null!=t){if(r.length>t)throw new Error("byte array longer than desired length");r=Fs([new Uint8Array(t-r.length),r])}return Ts(r,"base64url")}function hA(e){const t=dA(e);return new AA.jsbn.BigInteger(Ts(t,"base16"),16)}function dA(e,t){let r=vs(e,"base64urlpad");if(null!=t){if(r.length>t)throw new Error("byte array longer than desired length");r=Fs([new Uint8Array(t-r.length),r])}return r}const fA={"P-256":256,"P-384":384,"P-521":521};Object.keys(fA).join(" / ");function pA(e){const t=e?.algorithm??"AES-GCM";let r=e?.keyLength??16;const n=e?.nonceLength??12,s=e?.digest??"SHA-256",i=e?.saltLength??16,o=e?.iterations??32767,a=cA.get();r*=8;return{encrypt:async function(e,A){const c=a.getRandomValues(new Uint8Array(i)),l=a.getRandomValues(new Uint8Array(n)),u={name:t,iv:l};"string"==typeof A&&(A=vs(A));const h={name:"PBKDF2",salt:c,iterations:o,hash:{name:s}},d=await a.subtle.importKey("raw",A,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),f=await a.subtle.deriveKey(h,d,{name:t,length:r},!0,["encrypt"]),p=await a.subtle.encrypt(u,f,e);return Fs([c,u.iv,new Uint8Array(p)])},decrypt:async function(e,A){const c=e.subarray(0,i),l=e.subarray(i,i+n),u=e.subarray(i+n),h={name:t,iv:l};"string"==typeof A&&(A=vs(A));const d={name:"PBKDF2",salt:c,iterations:o,hash:{name:s}},f=await a.subtle.importKey("raw",A,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),p=await a.subtle.deriveKey(d,f,{name:t,length:r},!0,["decrypt"]),g=await a.subtle.decrypt(h,p,u);return new Uint8Array(g)}}}r(63219);var gA=r(95856),yA=r.t(gA,2);const wA=BigInt(0),mA=BigInt(1),bA=BigInt(2),EA=BigInt(3),vA=BigInt(8),BA=Object.freeze({a:wA,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:mA,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),_A=(e,t)=>(e+t/bA)/t,CA={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(e){const{n:t}=BA,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-mA*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=r,o=BigInt("0x100000000000000000000000000000000"),a=_A(i*e,t),A=_A(-n*e,t);let c=XA(e-a*r-A*s,t),l=XA(-a*n-A*i,t);const u=c>o,h=l>o;if(u&&(c=t-c),h&&(l=t-l),c>o||l>o)throw new Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:u,k1:c,k2neg:h,k2:l}}},SA=32,IA=32;function TA(e){const{a:t,b:r}=BA,n=XA(e*e),s=XA(n*e);return XA(s+t*e+r)}const RA=BA.a===wA;class kA extends Error{constructor(e){super(e)}}function UA(e){if(!(e instanceof DA))throw new TypeError("JacobianPoint expected")}class DA{constructor(e,t,r){this.x=e,this.y=t,this.z=r}static fromAffine(e){if(!(e instanceof NA))throw new TypeError("JacobianPoint#fromAffine: expected Point");return e.equals(NA.ZERO)?DA.ZERO:new DA(e.x,e.y,mA)}static toAffineBatch(e){const t=function(e,t=BA.P){const r=new Array(e.length),n=e.reduce(((e,n,s)=>n===wA?e:(r[s]=e,XA(e*n,t))),mA),s=ZA(n,t);return e.reduceRight(((e,n,s)=>n===wA?e:(r[s]=XA(e*r[s],t),XA(e*n,t))),s),r}(e.map((e=>e.z)));return e.map(((e,r)=>e.toAffine(t[r])))}static normalizeZ(e){return DA.toAffineBatch(e).map(DA.fromAffine)}equals(e){UA(e);const{x:t,y:r,z:n}=this,{x:s,y:i,z:o}=e,a=XA(n*n),A=XA(o*o),c=XA(t*A),l=XA(s*a),u=XA(XA(r*o)*A),h=XA(XA(i*n)*a);return c===l&&u===h}negate(){return new DA(this.x,XA(-this.y),this.z)}double(){const{x:e,y:t,z:r}=this,n=XA(e*e),s=XA(t*t),i=XA(s*s),o=e+s,a=XA(bA*(XA(o*o)-n-i)),A=XA(EA*n),c=XA(A*A),l=XA(c-bA*a),u=XA(A*(a-l)-vA*i),h=XA(bA*t*r);return new DA(l,u,h)}add(e){UA(e);const{x:t,y:r,z:n}=this,{x:s,y:i,z:o}=e;if(s===wA||i===wA)return this;if(t===wA||r===wA)return e;const a=XA(n*n),A=XA(o*o),c=XA(t*A),l=XA(s*a),u=XA(XA(r*o)*A),h=XA(XA(i*n)*a),d=XA(l-c),f=XA(h-u);if(d===wA)return f===wA?this.double():DA.ZERO;const p=XA(d*d),g=XA(d*p),y=XA(c*p),w=XA(f*f-g-bA*y),m=XA(f*(y-w)-u*g),b=XA(n*o*d);return new DA(w,m,b)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){const t=DA.ZERO;if("bigint"==typeof e&&e===wA)return t;let r=YA(e);if(r===mA)return this;if(!RA){let e=t,n=this;for(;r>wA;)r&mA&&(e=e.add(n)),n=n.double(),r>>=mA;return e}let{k1neg:n,k1:s,k2neg:i,k2:o}=CA.splitScalar(r),a=t,A=t,c=this;for(;s>wA||o>wA;)s&mA&&(a=a.add(c)),o&mA&&(A=A.add(c)),c=c.double(),s>>=mA,o>>=mA;return n&&(a=a.negate()),i&&(A=A.negate()),A=new DA(XA(A.x*CA.beta),A.y,A.z),a.add(A)}precomputeWindow(e){const t=RA?128/e+1:256/e+1,r=[];let n=this,s=n;for(let i=0;i<t;i++){s=n,r.push(s);for(let t=1;t<2**(e-1);t++)s=s.add(n),r.push(s);n=s.double()}return r}wNAF(e,t){!t&&this.equals(DA.BASE)&&(t=NA.BASE);const r=t&&t._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=t&&LA.get(t);n||(n=this.precomputeWindow(r),t&&1!==r&&(n=DA.normalizeZ(n),LA.set(t,n)));let s=DA.ZERO,i=DA.BASE;const o=1+(RA?128/r:256/r),a=2**(r-1),A=BigInt(2**r-1),c=2**r,l=BigInt(r);for(let t=0;t<o;t++){const r=t*a;let o=Number(e&A);e>>=l,o>a&&(o-=c,e+=mA);const u=r,h=r+Math.abs(o)-1,d=t%2!=0,f=o<0;0===o?i=i.add(PA(d,n[u])):s=s.add(PA(f,n[h]))}return{p:s,f:i}}multiply(e,t){let r,n,s=YA(e);if(RA){const{k1neg:e,k1:i,k2neg:o,k2:a}=CA.splitScalar(s);let{p:A,f:c}=this.wNAF(i,t),{p:l,f:u}=this.wNAF(a,t);A=PA(e,A),l=PA(o,l),l=new DA(XA(l.x*CA.beta),l.y,l.z),r=A.add(l),n=c.add(u)}else{const{p:e,f:i}=this.wNAF(s,t);r=e,n=i}return DA.normalizeZ([r,n])[0]}toAffine(e){const{x:t,y:r,z:n}=this,s=this.equals(DA.ZERO);null==e&&(e=s?vA:ZA(n));const i=e,o=XA(i*i),a=XA(o*i),A=XA(t*o),c=XA(r*a),l=XA(n*i);if(s)return NA.ZERO;if(l!==mA)throw new Error("invZ was invalid");return new NA(A,c)}}function PA(e,t){const r=t.negate();return e?r:t}DA.BASE=new DA(BA.Gx,BA.Gy,mA),DA.ZERO=new DA(wA,mA,wA);const LA=new WeakMap;class NA{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,LA.delete(this)}hasEvenY(){return this.y%bA===wA}static fromCompressedHex(e){const t=32===e.length,r=qA(t?e:e.subarray(1));if(!ic(r))throw new Error("Point is not on curve");let n=function(e){const{P:t}=BA,r=BigInt(6),n=BigInt(11),s=BigInt(22),i=BigInt(23),o=BigInt(44),a=BigInt(88),A=e*e*e%t,c=A*A*e%t,l=JA(c,EA)*c%t,u=JA(l,EA)*c%t,h=JA(u,bA)*A%t,d=JA(h,n)*h%t,f=JA(d,s)*d%t,p=JA(f,o)*f%t,g=JA(p,a)*p%t,y=JA(g,o)*f%t,w=JA(y,EA)*c%t,m=JA(w,i)*d%t,b=JA(m,r)*A%t,E=JA(b,bA);if(E*E%t!==e)throw new Error("Cannot find square root");return E}(TA(r));const s=(n&mA)===mA;if(t)s&&(n=XA(-n));else{1==(1&e[0])!==s&&(n=XA(-n))}const i=new NA(r,n);return i.assertValidity(),i}static fromUncompressedHex(e){const t=qA(e.subarray(1,33)),r=qA(e.subarray(33,65)),n=new NA(t,r);return n.assertValidity(),n}static fromHex(e){const t=WA(e),r=t.length,n=t[0];if(r===SA)return this.fromCompressedHex(t);if(33===r&&(2===n||3===n))return this.fromCompressedHex(t);if(65===r&&4===n)return this.fromUncompressedHex(t);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${r}`)}static fromPrivateKey(e){return NA.BASE.multiply(ac(e))}static fromSignature(e,t,r){const{r:n,s:s}=cc(t);if(![0,1,2,3].includes(r))throw new Error("Cannot recover: invalid recovery bit");const i=ec(WA(e)),{n:o}=BA,a=2===r||3===r?n+o:n,A=ZA(a,o),c=XA(-i*A,o),l=XA(s*A,o),u=1&r?"03":"02",h=NA.fromHex(u+VA(a)),d=NA.BASE.multiplyAndAddUnsafe(h,c,l);if(!d)throw new Error("Cannot recover signature: point at infinify");return d.assertValidity(),d}toRawBytes(e=!1){return $A(this.toHex(e))}toHex(e=!1){const t=VA(this.x);if(e){return`${this.hasEvenY()?"02":"03"}${t}`}return`04${t}${VA(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){const e="Point is not on elliptic curve",{x:t,y:r}=this;if(!ic(t)||!ic(r))throw new Error(e);const n=XA(r*r);if(XA(n-TA(t))!==wA)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new NA(this.x,XA(-this.y))}double(){return DA.fromAffine(this).double().toAffine()}add(e){return DA.fromAffine(this).add(DA.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return DA.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,t,r){const n=DA.fromAffine(this),s=t===wA||t===mA||this!==NA.BASE?n.multiplyUnsafe(t):n.multiply(t),i=DA.fromAffine(e).multiplyUnsafe(r),o=s.add(i);return o.equals(DA.ZERO)?void 0:o.toAffine()}}function OA(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function FA(e){if(e.length<2||2!==e[0])throw new Error(`Invalid signature integer tag: ${HA(e)}`);const t=e[1],r=e.subarray(2,t+2);if(!t||r.length!==t)throw new Error("Invalid signature integer: wrong length");if(0===r[0]&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:qA(r),left:e.subarray(t+2)}}NA.BASE=new NA(BA.Gx,BA.Gy),NA.ZERO=new NA(wA,wA);class QA{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromCompact(e){const t=e instanceof Uint8Array,r="Signature.fromCompact";if("string"!=typeof e&&!t)throw new TypeError(`${r}: Expected string or Uint8Array`);const n=t?HA(e):e;if(128!==n.length)throw new Error(`${r}: Expected 64-byte hex`);return new QA(GA(n.slice(0,64)),GA(n.slice(64,128)))}static fromDER(e){const t=e instanceof Uint8Array;if("string"!=typeof e&&!t)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");const{r:r,s:n}=function(e){if(e.length<2||48!=e[0])throw new Error(`Invalid signature tag: ${HA(e)}`);if(e[1]!==e.length-2)throw new Error("Invalid signature: incorrect length");const{data:t,left:r}=FA(e.subarray(2)),{data:n,left:s}=FA(r);if(s.length)throw new Error(`Invalid signature: left bytes after parsing: ${HA(s)}`);return{r:t,s:n}}(t?e:$A(e));return new QA(r,n)}static fromHex(e){return this.fromDER(e)}assertValidity(){const{r:e,s:t}=this;if(!sc(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!sc(t))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){const e=BA.n>>mA;return this.s>e}normalizeS(){return this.hasHighS()?new QA(this.r,XA(-this.s,BA.n)):this}toDERRawBytes(){return $A(this.toDERHex())}toDERHex(){const e=OA(jA(this.s)),t=OA(jA(this.r)),r=e.length/2,n=t.length/2,s=jA(r),i=jA(n);return`30${jA(n+r+4)}02${i}${t}02${s}${e}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return $A(this.toCompactHex())}toCompactHex(){return VA(this.r)+VA(this.s)}}function xA(...e){if(!e.every((e=>e instanceof Uint8Array)))throw new Error("Uint8Array list expected");if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const s=e[t];r.set(s,n),n+=s.length}return r}const MA=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function HA(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");let t="";for(let r=0;r<e.length;r++)t+=MA[e[r]];return t}const KA=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function VA(e){if("bigint"!=typeof e)throw new Error("Expected bigint");if(!(wA<=e&&e<KA))throw new Error("Expected number 0 <= n < 2^256");return e.toString(16).padStart(64,"0")}function zA(e){const t=$A(VA(e));if(32!==t.length)throw new Error("Error: expected 32 bytes");return t}function jA(e){const t=e.toString(16);return 1&t.length?`0${t}`:t}function GA(e){if("string"!=typeof e)throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function $A(e){if("string"!=typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+e.length);const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){const n=2*r,s=e.slice(n,n+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");t[r]=i}return t}function qA(e){return GA(HA(e))}function WA(e){return e instanceof Uint8Array?Uint8Array.from(e):$A(e)}function YA(e){if("number"==typeof e&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if("bigint"==typeof e&&sc(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function XA(e,t=BA.P){const r=e%t;return r>=wA?r:t+r}function JA(e,t){const{P:r}=BA;let n=e;for(;t-- >wA;)n*=n,n%=r;return n}function ZA(e,t=BA.P){if(e===wA||t<=wA)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=XA(e,t),n=t,s=wA,i=mA,o=mA,a=wA;for(;r!==wA;){const e=n/r,t=n%r,A=s-o*e,c=i-a*e;n=r,r=t,s=o,i=a,o=A,a=c}if(n!==mA)throw new Error("invert: does not exist");return XA(s,t)}function ec(e,t=!1){const r=function(e){const t=8*e.length-256,r=qA(e);return t>0?r>>BigInt(t):r}(e);if(t)return r;const{n:n}=BA;return r>=n?r-n:r}let tc,rc;class nc{constructor(e,t){if(this.hashLen=e,this.qByteLen=t,"number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(e).fill(1),this.k=new Uint8Array(e).fill(0),this.counter=0}hmac(...e){return mc.hmacSha256(this.k,...e)}hmacSync(...e){return rc(this.k,...e)}checkSync(){if("function"!=typeof rc)throw new kA("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),0!==e.length&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),0!==e.length&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){this.incr();let e=0;const t=[];for(;e<this.qByteLen;){this.v=await this.hmac(this.v);const r=this.v.slice();t.push(r),e+=this.v.length}return xA(...t)}generateSync(){this.checkSync(),this.incr();let e=0;const t=[];for(;e<this.qByteLen;){this.v=this.hmacSync(this.v);const r=this.v.slice();t.push(r),e+=this.v.length}return xA(...t)}}function sc(e){return wA<e&&e<BA.n}function ic(e){return wA<e&&e<BA.P}function oc(e,t,r,n=!0){const{n:s}=BA,i=ec(e,!0);if(!sc(i))return;const o=ZA(i,s),a=NA.BASE.multiply(i),A=XA(a.x,s);if(A===wA)return;const c=XA(o*XA(t+r*A,s),s);if(c===wA)return;let l=new QA(A,c),u=(a.x===l.r?0:2)|Number(a.y&mA);return n&&l.hasHighS()&&(l=l.normalizeS(),u^=1),{sig:l,recovery:u}}function ac(e){let t;if("bigint"==typeof e)t=e;else if("number"==typeof e&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if("string"==typeof e){if(64!==e.length)throw new Error("Expected 32 bytes of private key");t=GA(e)}else{if(!(e instanceof Uint8Array))throw new TypeError("Expected valid private key");if(e.length!==IA)throw new Error("Expected 32 bytes of private key");t=qA(e)}if(!sc(t))throw new Error("Expected private key: 0 < key < n");return t}function Ac(e){return e instanceof NA?(e.assertValidity(),e):NA.fromHex(e)}function cc(e){if(e instanceof QA)return e.assertValidity(),e;try{return QA.fromDER(e)}catch(t){return QA.fromCompact(e)}}function lc(e,t=!1){return NA.fromPrivateKey(e).toRawBytes(t)}function uc(e){return qA(e.length>SA?e.slice(0,SA):e)}function hc(e){const t=uc(e),r=XA(t,BA.n);return dc(r<wA?t:r)}function dc(e){return zA(e)}function fc(e,t,r){if(null==e)throw new Error(`sign: expected valid message hash, not "${e}"`);const n=WA(e),s=ac(t),i=[dc(s),hc(n)];if(null!=r){!0===r&&(r=mc.randomBytes(SA));const e=WA(r);if(e.length!==SA)throw new Error("sign: Expected 32 bytes of extra data");i.push(e)}return{seed:xA(...i),m:uc(n),d:s}}function pc(e,t){const{sig:r,recovery:n}=e,{der:s,recovered:i}=Object.assign({canonical:!0,der:!0},t),o=s?r.toDERRawBytes():r.toCompactRawBytes();return i?[o,n]:o}const gc={strict:!0};NA.BASE._setWindowSize(8);const yc={node:yA,web:"object"==typeof self&&"crypto"in self?self.crypto:void 0},wc={},mc={bytesToHex:HA,hexToBytes:$A,concatBytes:xA,mod:XA,invert:ZA,isValidPrivateKey(e){try{return ac(e),!0}catch(e){return!1}},_bigintTo32Bytes:zA,_normalizePrivateKey:ac,hashToPrivateKey:e=>{if((e=WA(e)).length<40||e.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");return zA(XA(qA(e),BA.n-mA)+mA)},randomBytes:(e=32)=>{if(yc.web)return yc.web.getRandomValues(new Uint8Array(e));if(yc.node){const{randomBytes:t}=yc.node;return Uint8Array.from(t(e))}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>mc.hashToPrivateKey(mc.randomBytes(40)),precompute(e=8,t=NA.BASE){const r=t===NA.BASE?t:new NA(t.x,t.y);return r._setWindowSize(e),r.multiply(EA),r},sha256:async(...e)=>{if(yc.web){const t=await yc.web.subtle.digest("SHA-256",xA(...e));return new Uint8Array(t)}if(yc.node){const{createHash:t}=yc.node,r=t("sha256");return e.forEach((e=>r.update(e))),Uint8Array.from(r.digest())}throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if(yc.web){const r=await yc.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=xA(...t),s=await yc.web.subtle.sign("HMAC",r,n);return new Uint8Array(s)}if(yc.node){const{createHmac:r}=yc.node,n=r("sha256",e);return t.forEach((e=>n.update(e))),Uint8Array.from(n.digest())}throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(e,...t)=>{let r=wc[e];if(void 0===r){const t=await mc.sha256(Uint8Array.from(e,(e=>e.charCodeAt(0))));r=xA(t,t),wc[e]=r}return mc.sha256(r,...t)},taggedHashSync:(e,...t)=>{if("function"!=typeof tc)throw new kA("sha256Sync is undefined, you need to set it");let r=wc[e];if(void 0===r){const t=tc(Uint8Array.from(e,(e=>e.charCodeAt(0))));r=xA(t,t),wc[e]=r}return tc(r,...t)},_JacobianPoint:DA};function bc(e){if(isNaN(e)||e<=0)throw new wa("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return mc.randomBytes(e)}Object.defineProperties(mc,{sha256Sync:{configurable:!1,get(){return tc},set(e){tc||(tc=e)}},hmacSha256Sync:{configurable:!1,get(){return rc},set(e){rc||(rc=e)}}});r(28095);function Ec(e,t){return t.map((t=>hA(e[t])))}async function vc(e){const t=[await cA.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await _c(e)],r=await Bc({privateKey:t[0],publicKey:t[1]});return{privateKey:r[0],publicKey:r[1]}}async function Bc(e){if(null==e.privateKey||null==e.publicKey)throw new wa("Private and public key are required","ERR_INVALID_PARAMETERS");return await Promise.all([cA.get().subtle.exportKey("jwk",e.privateKey),cA.get().subtle.exportKey("jwk",e.publicKey)])}async function _c(e){return await cA.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function Cc(e,t,r,n){const s=t?function(e){return AA.pki.setRsaPublicKey(...Ec(e,["n","e"]))}(e):function(e){return AA.pki.setRsaPrivateKey(...Ec(e,["n","e","d","p","q","dp","dq","qi"]))}(e);return vs(n(Ts(Uint8Array.from(r),"ascii"),s),"ascii")}async function Sc(e,t){const r=pA(),n=await r.encrypt(e,t);return ee.encode(n)}class Ic{constructor(e){this._key=e}async verify(e,t){return await async function(e,t,r){const n=await cA.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await cA.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r)}(this._key,t,e)}marshal(){return function(e){if(null==e.n||null==e.e)throw new wa("JWK was missing components","ERR_INVALID_PARAMETERS");const t=AA.pki.publicKeyToAsn1({n:hA(e.n),e:hA(e.e)});return vs(AA.asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return nA.encode({Type:tA.RSA,Data:this.marshal()}).subarray()}encrypt(e){return Cc(this._key,!0,e,((e,t)=>t.encrypt(e)))}equals(e){return ii(this.bytes,e.bytes)}async hash(){const{bytes:e}=await $n.digest(this.bytes);return e}}class Tc{constructor(e,t){this._key=e,this._publicKey=t}genSecret(){return bc(16)}async sign(e){return await async function(e,t){const r=await cA.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await cA.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(t));return new Uint8Array(n,0,n.byteLength)}(this._key,e)}get public(){if(null==this._publicKey)throw new wa("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Ic(this._publicKey)}decrypt(e){return Cc(this._key,!1,e,((e,t)=>t.decrypt(e)))}marshal(){return function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new wa("JWK was missing components","ERR_INVALID_PARAMETERS");const t=AA.pki.privateKeyToAsn1({n:hA(e.n),e:hA(e.e),d:hA(e.d),p:hA(e.p),q:hA(e.q),dP:hA(e.dp),dQ:hA(e.dq),qInv:hA(e.qi)});return vs(AA.asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return sA.encode({Type:tA.RSA,Data:this.marshal()}).subarray()}equals(e){return ii(this.bytes,e.bytes)}async hash(){const{bytes:e}=await $n.digest(this.bytes);return e}async id(){return Ts(await this.public.hash(),"base58btc")}async export(e,t="pkcs-8"){if("pkcs-8"===t){const t=new AA.util.ByteBuffer(this.marshal()),r=AA.asn1.fromDer(t),n=AA.pki.privateKeyFromAsn1(r),s={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return AA.pki.encryptRsaPrivateKey(n,e,s)}if("libp2p-key"===t)return await Sc(this.bytes,e);throw new wa(`export format '${t}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}async function Rc(e){const t=function(e){const t=AA.asn1.fromDer(Ts(e,"ascii")),r=AA.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:uA(r.n),e:uA(r.e),d:uA(r.d),p:uA(r.p),q:uA(r.q),dp:uA(r.dP),dq:uA(r.dQ),qi:uA(r.qInv),alg:"RS256"}}(e),r=await vc(t);return new Tc(r.privateKey,r.publicKey)}function kc(e){const t=function(e){const t=AA.asn1.fromDer(Ts(e,"ascii")),r=AA.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:uA(r.n),e:uA(r.e)}}(e);return new Ic(t)}async function Uc(e){const t=await vc(e);return new Tc(t.privateKey,t.publicKey)}async function Dc(e){const t=await async function(e){const t=await cA.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Bc(t);return{privateKey:r[0],publicKey:r[1]}}(e);return new Tc(t.privateKey,t.publicKey)}var Pc=r(7420),Lc=r.t(Pc,2);const Nc=BigInt(0),Oc=BigInt(1),Fc=BigInt(2),Qc=BigInt(8),xc=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),Mc=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:xc,n:xc,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")}),Hc=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),Kc=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Vc=(BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235")),zc=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),jc=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Gc=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");class $c{constructor(e,t,r,n){this.x=e,this.y=t,this.z=r,this.t=n}static fromAffine(e){if(!(e instanceof el))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(el.ZERO)?$c.ZERO:new $c(e.x,e.y,Oc,hl(e.x*e.y))}static toAffineBatch(e){const t=function(e,t=Mc.P){const r=new Array(e.length),n=e.reduce(((e,n,s)=>n===Nc?e:(r[s]=e,hl(e*n,t))),Oc),s=dl(n,t);return e.reduceRight(((e,n,s)=>n===Nc?e:(r[s]=hl(e*r[s],t),hl(e*n,t))),s),r}(e.map((e=>e.z)));return e.map(((e,r)=>e.toAffine(t[r])))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){Wc(e);const{x:t,y:r,z:n}=this,{x:s,y:i,z:o}=e,a=hl(t*o),A=hl(s*n),c=hl(r*o),l=hl(i*n);return a===A&&c===l}negate(){return new $c(hl(-this.x),this.y,this.z,hl(-this.t))}double(){const{x:e,y:t,z:r}=this,{a:n}=Mc,s=hl(e*e),i=hl(t*t),o=hl(Fc*hl(r*r)),a=hl(n*s),A=e+t,c=hl(hl(A*A)-s-i),l=a+i,u=l-o,h=a-i,d=hl(c*u),f=hl(l*h),p=hl(c*h),g=hl(u*l);return new $c(d,f,g,p)}add(e){Wc(e);const{x:t,y:r,z:n,t:s}=this,{x:i,y:o,z:a,t:A}=e,c=hl((r-t)*(o+i)),l=hl((r+t)*(o-i)),u=hl(l-c);if(u===Nc)return this.double();const h=hl(n*Fc*A),d=hl(s*Fc*a),f=d+h,p=l+c,g=d-h,y=hl(f*u),w=hl(p*g),m=hl(f*g),b=hl(u*p);return new $c(y,w,b,m)}subtract(e){return this.add(e.negate())}precomputeWindow(e){const t=1+256/e,r=[];let n=this,s=n;for(let i=0;i<t;i++){s=n,r.push(s);for(let t=1;t<2**(e-1);t++)s=s.add(n),r.push(s);n=s.double()}return r}wNAF(e,t){!t&&this.equals($c.BASE)&&(t=el.BASE);const r=t&&t._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=t&&Zc.get(t);n||(n=this.precomputeWindow(r),t&&1!==r&&(n=$c.normalizeZ(n),Zc.set(t,n)));let s=$c.ZERO,i=$c.BASE;const o=1+256/r,a=2**(r-1),A=BigInt(2**r-1),c=2**r,l=BigInt(r);for(let t=0;t<o;t++){const r=t*a;let o=Number(e&A);e>>=l,o>a&&(o-=c,e+=Oc);const u=r,h=r+Math.abs(o)-1,d=t%2!=0,f=o<0;0===o?i=i.add(qc(d,n[u])):s=s.add(qc(f,n[h]))}return $c.normalizeZ([s,i])[0]}multiply(e,t){return this.wNAF(bl(e,Mc.l),t)}multiplyUnsafe(e){let t=bl(e,Mc.l,!1);const r=$c.BASE,n=$c.ZERO;if(t===Nc)return n;if(this.equals(n)||t===Oc)return this;if(this.equals(r))return this.wNAF(t);let s=n,i=this;for(;t>Nc;)t&Oc&&(s=s.add(i)),i=i.double(),t>>=Oc;return s}isSmallOrder(){return this.multiplyUnsafe(Mc.h).equals($c.ZERO)}isTorsionFree(){let e=this.multiplyUnsafe(Mc.l/Fc).double();return Mc.l%Fc&&(e=e.add(this)),e.equals($c.ZERO)}toAffine(e){const{x:t,y:r,z:n}=this,s=this.equals($c.ZERO);null==e&&(e=s?Qc:dl(n));const i=hl(t*e),o=hl(r*e),a=hl(n*e);if(s)return el.ZERO;if(a!==Oc)throw new Error("invZ was invalid");return new el(i,o)}fromRistrettoBytes(){Xc()}toRistrettoBytes(){Xc()}fromRistrettoHash(){Xc()}}function qc(e,t){const r=t.negate();return e?r:t}function Wc(e){if(!(e instanceof $c))throw new TypeError("ExtendedPoint expected")}function Yc(e){if(!(e instanceof Jc))throw new TypeError("RistrettoPoint expected")}function Xc(){throw new Error("Legacy method: switch to RistrettoPoint")}$c.BASE=new $c(Mc.Gx,Mc.Gy,Oc,hl(Mc.Gx*Mc.Gy)),$c.ZERO=new $c(Nc,Oc,Oc,Nc);class Jc{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){const{d:t}=Mc,r=hl(Kc*e*e),n=hl((r+Oc)*jc);let s=BigInt(-1);const i=hl((s-t*r)*hl(r+t));let{isValid:o,value:a}=gl(n,i),A=hl(a*e);Al(A)||(A=hl(-A)),o||(a=A),o||(s=r);const c=hl(s*(r-Oc)*Gc-i),l=a*a,u=hl((a+a)*i),h=hl(c*Vc),d=hl(Oc-l),f=hl(Oc+l);return new $c(hl(u*f),hl(d*h),hl(h*f),hl(u*d))}static hashToCurve(e){const t=ul((e=ml(e,64)).slice(0,32)),r=this.calcElligatorRistrettoMap(t),n=ul(e.slice(32,64)),s=this.calcElligatorRistrettoMap(n);return new Jc(r.add(s))}static fromHex(e){e=ml(e,32);const{a:t,d:r}=Mc,n="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=ul(e);if(!function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(al(s),e)||Al(s))throw new Error(n);const i=hl(s*s),o=hl(Oc+t*i),a=hl(Oc-t*i),A=hl(o*o),c=hl(a*a),l=hl(t*r*A-c),{isValid:u,value:h}=yl(hl(l*c)),d=hl(h*a),f=hl(h*d*l);let p=hl((s+s)*d);Al(p)&&(p=hl(-p));const g=hl(o*f),y=hl(p*g);if(!u||Al(y)||g===Nc)throw new Error(n);return new Jc(new $c(p,g,Oc,y))}toRawBytes(){let{x:e,y:t,z:r,t:n}=this.ep;const s=hl(hl(r+t)*hl(r-t)),i=hl(e*t),o=hl(i*i),{value:a}=yl(hl(s*o)),A=hl(a*s),c=hl(a*i),l=hl(A*c*n);let u;if(Al(n*l)){let r=hl(t*Kc),n=hl(e*Kc);e=r,t=n,u=hl(A*zc)}else u=c;Al(e*l)&&(t=hl(-t));let h=hl((r-t)*u);return Al(h)&&(h=hl(-h)),al(h)}toHex(){return sl(this.toRawBytes())}toString(){return this.toHex()}equals(e){Yc(e);const t=this.ep,r=e.ep,n=hl(t.x*r.y)===hl(t.y*r.x),s=hl(t.y*r.y)===hl(t.x*r.x);return n||s}add(e){return Yc(e),new Jc(this.ep.add(e.ep))}subtract(e){return Yc(e),new Jc(this.ep.subtract(e.ep))}multiply(e){return new Jc(this.ep.multiply(e))}multiplyUnsafe(e){return new Jc(this.ep.multiplyUnsafe(e))}}Jc.BASE=new Jc($c.BASE),Jc.ZERO=new Jc($c.ZERO);const Zc=new WeakMap;class el{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,Zc.delete(this)}static fromHex(e,t=!0){const{d:r,P:n}=Mc,s=(e=ml(e,32)).slice();s[31]=-129&e[31];const i=cl(s);if(t&&i>=n)throw new Error("Expected 0 < hex < P");if(!t&&i>=Hc)throw new Error("Expected 0 < hex < 2**256");const o=hl(i*i),a=hl(o-Oc),A=hl(r*o+Oc);let{isValid:c,value:l}=gl(a,A);if(!c)throw new Error("Point.fromHex: invalid y coordinate");const u=(l&Oc)===Oc;return 0!=(128&e[31])!==u&&(l=hl(-l)),new el(l,i)}static async fromPrivateKey(e){return(await Cl(e)).point}toRawBytes(){const e=al(this.y);return e[31]|=this.x&Oc?128:0,e}toHex(){return sl(this.toRawBytes())}toX25519(){const{y:e}=this;return al(hl((Oc+e)*dl(Oc-e)))}isTorsionFree(){return $c.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new el(hl(-this.x),this.y)}add(e){return $c.fromAffine(this).add($c.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return $c.fromAffine(this).multiply(e,this).toAffine()}}el.BASE=new el(Mc.Gx,Mc.Gy),el.ZERO=new el(Nc,Oc);class tl{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromHex(e){const t=ml(e,64),r=el.fromHex(t.slice(0,32),!1),n=cl(t.slice(32,64));return new tl(r,n)}assertValidity(){const{r:e,s:t}=this;if(!(e instanceof el))throw new Error("Expected Point instance");return bl(t,Mc.l,!1),this}toRawBytes(){const e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(al(this.s),32),e}toHex(){return sl(this.toRawBytes())}}function rl(...e){if(!e.every((e=>e instanceof Uint8Array)))throw new Error("Expected Uint8Array list");if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const s=e[t];r.set(s,n),n+=s.length}return r}const nl=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function sl(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=nl[e[r]];return t}function il(e){if("string"!=typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){const n=2*r,s=e.slice(n,n+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");t[r]=i}return t}function ol(e){return il(e.toString(16).padStart(64,"0"))}function al(e){return ol(e).reverse()}function Al(e){return(hl(e)&Oc)===Oc}function cl(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+sl(Uint8Array.from(e).reverse()))}const ll=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function ul(e){return hl(cl(e)&ll)}function hl(e,t=Mc.P){const r=e%t;return r>=Nc?r:t+r}function dl(e,t=Mc.P){if(e===Nc||t<=Nc)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=hl(e,t),n=t,s=Nc,i=Oc,o=Oc,a=Nc;for(;r!==Nc;){const e=n/r,t=n%r,A=s-o*e,c=i-a*e;n=r,r=t,s=o,i=a,o=A,a=c}if(n!==Oc)throw new Error("invert: does not exist");return hl(s,t)}function fl(e,t){const{P:r}=Mc;let n=e;for(;t-- >Nc;)n*=n,n%=r;return n}function pl(e){const{P:t}=Mc,r=BigInt(5),n=BigInt(10),s=BigInt(20),i=BigInt(40),o=BigInt(80),a=e*e%t*e%t,A=fl(a,Fc)*a%t,c=fl(A,Oc)*e%t,l=fl(c,r)*c%t,u=fl(l,n)*l%t,h=fl(u,s)*u%t,d=fl(h,i)*h%t,f=fl(d,o)*d%t,p=fl(f,o)*d%t,g=fl(p,n)*l%t;return{pow_p_5_8:fl(g,Fc)*e%t,b2:a}}function gl(e,t){const r=hl(t*t*t),n=hl(r*r*t);let s=hl(e*r*pl(e*n).pow_p_5_8);const i=hl(t*s*s),o=s,a=hl(s*Kc),A=i===e,c=i===hl(-e),l=i===hl(-e*Kc);return A&&(s=o),(c||l)&&(s=a),Al(s)&&(s=hl(-s)),{isValid:A||c,value:s}}function yl(e){return gl(Oc,e)}function wl(e){return hl(cl(e),Mc.l)}function ml(e,t){const r=e instanceof Uint8Array?Uint8Array.from(e):il(e);if("number"==typeof t&&r.length!==t)throw new Error(`Expected ${t} bytes`);return r}function bl(e,t,r=!0){if(!t)throw new TypeError("Specify max value");if("number"==typeof e&&Number.isSafeInteger(e)&&(e=BigInt(e)),"bigint"==typeof e&&e<t)if(r){if(Nc<e)return e}else if(Nc<=e)return e;throw new TypeError("Expected valid scalar: 0 < scalar < max")}function El(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function vl(e){if(32!==(e="bigint"==typeof e||"number"==typeof e?ol(bl(e,Hc)):ml(e)).length)throw new Error("Expected 32 bytes");return e}function Bl(e){const t=El(e.slice(0,32)),r=e.slice(32,64),n=wl(t),s=el.BASE.multiply(n),i=s.toRawBytes();return{head:t,prefix:r,scalar:n,point:s,pointBytes:i}}let _l;async function Cl(e){return Bl(await kl.sha512(vl(e)))}async function Sl(e){return(await Cl(e)).pointBytes}function Il(e,t,r){t=ml(t),r instanceof el||(r=el.fromHex(r,!1));const{r:n,s:s}=e instanceof tl?e.assertValidity():tl.fromHex(e);return{r:n,s:s,SB:$c.BASE.multiplyUnsafe(s),pub:r,msg:t}}function Tl(e,t,r,n){const s=wl(n),i=$c.fromAffine(e).multiplyUnsafe(s);return $c.fromAffine(t).add(i).subtract(r).multiplyUnsafe(Mc.h).equals($c.ZERO)}el.BASE._setWindowSize(8);const Rl={node:Lc,web:"object"==typeof self&&"crypto"in self?self.crypto:void 0},kl={bytesToHex:sl,hexToBytes:il,concatBytes:rl,getExtendedPublicKey:Cl,mod:hl,invert:dl,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:e=>{if((e=ml(e)).length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return hl(cl(e),Mc.l-Oc)+Oc},randomBytes:(e=32)=>{if(Rl.web)return Rl.web.getRandomValues(new Uint8Array(e));if(Rl.node){const{randomBytes:t}=Rl.node;return new Uint8Array(t(e).buffer)}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>kl.randomBytes(32),sha512:async(...e)=>{const t=rl(...e);if(Rl.web){const e=await Rl.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(e)}if(Rl.node)return Uint8Array.from(Rl.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")},precompute(e=8,t=el.BASE){const r=t.equals(el.BASE)?t:new el(t.x,t.y);return r._setWindowSize(e),r.multiply(Fc),r},sha512Sync:void 0};Object.defineProperties(kl,{sha512Sync:{configurable:!1,get(){return _l},set(e){_l||(_l=e)}}});const Ul=64;async function Dl(e,t){const r=e.subarray(0,32);return await async function(e,t){e=ml(e);const{prefix:r,scalar:n,pointBytes:s}=await Cl(t),i=wl(await kl.sha512(r,e)),o=el.BASE.multiply(i),a=hl(i+wl(await kl.sha512(o.toRawBytes(),s,e))*n,Mc.l);return new tl(o,a).toRawBytes()}(t,r)}async function Pl(e,t,r){return await async function(e,t,r){const{r:n,SB:s,msg:i,pub:o}=Il(e,t,r),a=await kl.sha512(n.toRawBytes(),o.toRawBytes(),i);return Tl(o,n,s,a)}(t,r,e)}function Ll(e,t){const r=new Uint8Array(Ul);for(let n=0;n<32;n++)r[n]=e[n],r[32+n]=t[n];return r}class Nl{constructor(e){this._key=Hl(e,32)}async verify(e,t){return await Pl(this._key,t,e)}marshal(){return this._key}get bytes(){return nA.encode({Type:tA.Ed25519,Data:this.marshal()}).subarray()}equals(e){return ii(this.bytes,e.bytes)}async hash(){const{bytes:e}=await $n.digest(this.bytes);return e}}class Ol{constructor(e,t){this._key=Hl(e,Ul),this._publicKey=Hl(t,32)}async sign(e){return await Dl(this._key,e)}get public(){return new Nl(this._publicKey)}marshal(){return this._key}get bytes(){return sA.encode({Type:tA.Ed25519,Data:this.marshal()}).subarray()}equals(e){return ii(this.bytes,e.bytes)}async hash(){const{bytes:e}=await $n.digest(this.bytes);return e}async id(){const e=await Pn.digest(this.public.bytes);return V.encode(e.bytes).substring(1)}async export(e,t="libp2p-key"){if("libp2p-key"===t)return await Sc(this.bytes,e);throw new wa(`export format '${t}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}function Fl(e){if(e.length>Ul){const t=(e=Hl(e,96)).subarray(0,Ul),r=e.subarray(Ul,e.length);return new Ol(t,r)}const t=(e=Hl(e,Ul)).subarray(0,Ul),r=e.subarray(32);return new Ol(t,r)}function Ql(e){return e=Hl(e,32),new Nl(e)}async function xl(){const{privateKey:e,publicKey:t}=await async function(){const e=kl.randomPrivateKey(),t=await Sl(e);return{privateKey:Ll(e,t),publicKey:t}}();return new Ol(e,t)}async function Ml(e){const{privateKey:t,publicKey:r}=await async function(e){if(32!==e.length)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,r=await Sl(t);return{privateKey:Ll(t,r),publicKey:r}}(e);return new Ol(t,r)}function Hl(e,t){if((e=Uint8Array.from(e??[])).length!==t)throw new wa(`Key must be a Uint8Array of length ${t}, got ${e.length}`,"ERR_INVALID_KEY_TYPE");return e}async function Kl(e,t){const{digest:r}=await $n.digest(t);try{return await async function(e,t,r={}){const{seed:n,m:s,d:i}=fc(e,t,r.extraEntropy),o=new nc(32,IA);let a;for(await o.reseed(n);!(a=oc(await o.generate(),s,i,r.canonical));)await o.reseed();return pc(a,r)}(r,e)}catch(e){throw new wa(String(e),"ERR_INVALID_INPUT")}}async function Vl(e,t,r){try{const{digest:n}=await $n.digest(r);return function(e,t,r,n=gc){let s;try{s=cc(e),t=WA(t)}catch(e){return!1}const{r:i,s:o}=s;if(n.strict&&s.hasHighS())return!1;const a=ec(t);let A;try{A=Ac(r)}catch(e){return!1}const{n:c}=BA,l=ZA(o,c),u=XA(a*l,c),h=XA(i*l,c),d=NA.BASE.multiplyAndAddUnsafe(A,u,h);return!!d&&XA(d.x,c)===i}(t,n,e)}catch(e){throw new wa(String(e),"ERR_INVALID_INPUT")}}function zl(e){try{NA.fromHex(e)}catch(e){throw new wa(String(e),"ERR_INVALID_PUBLIC_KEY")}}class jl{constructor(e){zl(e),this._key=e}async verify(e,t){return await Vl(this._key,t,e)}marshal(){return e=this._key,NA.fromHex(e).toRawBytes(!0);var e}get bytes(){return nA.encode({Type:tA.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return ii(this.bytes,e.bytes)}async hash(){const{bytes:e}=await $n.digest(this.bytes);return e}}class Gl{constructor(e,t){this._key=e,this._publicKey=t??function(e){try{return lc(e,!0)}catch(e){throw new wa(String(e),"ERR_INVALID_PRIVATE_KEY")}}(e),function(e){try{lc(e,!0)}catch(e){throw new wa(String(e),"ERR_INVALID_PRIVATE_KEY")}}(this._key),zl(this._publicKey)}async sign(e){return await Kl(this._key,e)}get public(){return new jl(this._publicKey)}marshal(){return this._key}get bytes(){return sA.encode({Type:tA.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return ii(this.bytes,e.bytes)}async hash(){const{bytes:e}=await $n.digest(this.bytes);return e}async id(){return Ts(await this.public.hash(),"base58btc")}async export(e,t="libp2p-key"){if("libp2p-key"===t)return await Sc(this.bytes,e);throw new wa(`export format '${t}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}function $l(e){return new Gl(e)}function ql(e){return new jl(e)}async function Wl(){const e=await mc.randomPrivateKey();return new Gl(e)}const Yl={rsa:E,ed25519:v,secp256k1:B};function Xl(e){const t=Object.keys(Yl).join(" / ");return new wa(`invalid or unsupported key type ${e}. Must be ${t}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Jl(e){if("rsa"===(e=e.toLowerCase())||"ed25519"===e||"secp256k1"===e)return Yl[e];throw Xl(e)}async function Zl(e,t){return await Jl(e).generateKeyPair(t??2048)}function eu(e){const t=nA.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case tA.RSA:return Yl.rsa.unmarshalRsaPublicKey(r);case tA.Ed25519:return Yl.ed25519.unmarshalEd25519PublicKey(r);case tA.Secp256k1:return Yl.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw Xl(t.Type??"RSA")}}function tu(e,t){return Jl(t=(t??"rsa").toLowerCase()),e.bytes}async function ru(e){const t=sA.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case tA.RSA:return await Yl.rsa.unmarshalRsaPrivateKey(r);case tA.Ed25519:return Yl.ed25519.unmarshalEd25519PrivateKey(r);case tA.Secp256k1:return Yl.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw Xl(t.Type??"RSA")}}async function nu(e,t){try{const r=await async function(e,t){const r=ee.decode(e),n=pA();return await n.decrypt(r,t)}(e,t);return await ru(r)}catch(e){}const r=AA.pki.decryptRsaPrivateKey(e,t);if(null===r)throw new wa("Cannot read the key, most likely the password is wrong or not a RSA key","ERR_CANNOT_DECRYPT_PEM");let n=AA.asn1.toDer(AA.pki.privateKeyToAsn1(r));return n=vs(n.getBytes(),"ascii"),await Yl.rsa.unmarshalRsaPrivateKey(n)}const su="ERR_UNRECOGNIZED_VALIDITY",iu="ERR_SIGNATURE_VERIFICATION",ou="ERR_UNDEFINED_PARAMETER";var au;!function(e){let t,r,n;!function(e){e.EOL="EOL"}(t=e.ValidityType||(e.ValidityType={})),function(e){e[e.EOL=0]="EOL"}(r||(r={})),function(e){e.codec=()=>oA(r)}(t=e.ValidityType||(e.ValidityType={})),e.codec=()=>(null==n&&(n=aA(((t,r,n={})=>{!1!==n.lengthDelimited&&r.fork(),null!=t.value&&(r.uint32(10),r.bytes(t.value)),null!=t.signature&&(r.uint32(18),r.bytes(t.signature)),null!=t.validityType&&(r.uint32(24),e.ValidityType.codec().encode(t.validityType,r)),null!=t.validity&&(r.uint32(34),r.bytes(t.validity)),null!=t.sequence&&(r.uint32(40),r.uint64(t.sequence)),null!=t.ttl&&(r.uint32(48),r.uint64(t.ttl)),null!=t.pubKey&&(r.uint32(58),r.bytes(t.pubKey)),null!=t.signatureV2&&(r.uint32(66),r.bytes(t.signatureV2)),null!=t.data&&(r.uint32(74),r.bytes(t.data)),!1!==n.lengthDelimited&&r.ldelim()}),((t,r)=>{const n={},s=null==r?t.len:t.pos+r;for(;t.pos<s;){const r=t.uint32();switch(r>>>3){case 1:n.value=t.bytes();break;case 2:n.signature=t.bytes();break;case 3:n.validityType=e.ValidityType.codec().decode(t);break;case 4:n.validity=t.bytes();break;case 5:n.sequence=t.uint64();break;case 6:n.ttl=t.uint64();break;case 7:n.pubKey=t.bytes();break;case 8:n.signatureV2=t.bytes();break;case 9:n.data=t.bytes();break;default:t.skipType(7&r)}}return n}))),n),e.encode=t=>Za(t,e.codec()),e.decode=t=>Ja(t,e.codec())}(au||(au={}));const Au=se("ipns:utils"),cu=vs("/ipns/");function lu(e){const t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(e).trim().match(t);if(null==r)throw new Error("Invalid format");const n=parseInt(r[1],10),s=parseInt(r[2],10)-1,i=parseInt(r[3],10),o=parseInt(r[4],10),a=parseInt(r[5],10),A=parseInt(r[6],10),c=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(n,s,i,o,a,A,c))}const uu=e=>Fs([vs("ipns-signature:"),e]),hu=e=>{const t=au.decode(e);return null!=t.sequence&&(t.sequence=BigInt(t.sequence)),null!=t.ttl&&(t.ttl=BigInt(t.ttl)),{value:t.value??new Uint8Array(0),signature:t.signature??new Uint8Array(0),validityType:t.validityType??au.ValidityType.EOL,validity:t.validity??new Uint8Array(0),sequence:t.sequence??0n,pubKey:t.pubKey,ttl:t.ttl??void 0,signatureV2:t.signatureV2,data:t.data}},du=e=>Fs([cu,e.toBytes()]),fu=se("ipns"),pu=Pn.code,gu="/ipns/",yu=gu.length,wu=async(e,t,r,n,s,i)=>{r=BigInt(r);const o=vs(s.toString());if(null==e.privateKey)throw ie(new Error("Missing private key"),"ERR_MISSING_PRIVATE_KEY");const a=await ru(e.privateKey),A=await bu(a,t,n,o),c=((e,t,r,n,s)=>{let i;if(r!==au.ValidityType.EOL)throw ie(new Error("Unknown validity type"),su);return i=0,Kr({Value:e,Validity:t,ValidityType:i,Sequence:n,TTL:s})})(t,o,n,r,i),l=uu(c),u={value:t,signature:A,validityType:n,validity:o,sequence:r,ttl:i,signatureV2:await a.sign(l),data:c};if(null!=e.publicKey){const t=Qe(e.toBytes());t.code===pu&&ii(e.publicKey,t.digest)||(u.pubKey=e.publicKey)}return fu("ipns entry for %b created",t),u},mu=e=>new Ao(`/ipns/${(e=>G.encode(e).slice(1))(e)}`),bu=async(e,t,r,n)=>{try{const s=((e,t,r)=>Fs([e,r,vs(t)]))(t,r,n);return await e.sign(s)}catch(e){throw fu.error("record signature creation failed",e),ie(new Error("record signature creation failed"),"ERR_SIGNATURE_CREATION")}},Eu=se("ipfs:ipns:publisher"),vu=Ka().code,Bu=36e5;class _u{constructor(e,t){this._routing=e,this._datastore=t}async publishWithEOL(e,t,r,n){const s=await this._updateOrCreateRecord(e,t,r,n);return this._putRecordToRouting(s,e,n)}publish(e,t,r){return this.publishWithEOL(e,t,Bu,r)}async _putRecordToRouting(e,t,r){if(!ba(t)){const e="peerId received is not valid";throw Eu.error(e),ie(new Error(e),"ERR_INVALID_PEER_ID")}if(null==t.publicKey)throw ie(new Error("Public key was missing"),"ERR_MISSING_PUBLIC_KEY");const n=du(t);return await this._publishEntry(n,e,r),e}async _publishEntry(e,t,r){try{const n=await this._routing.put(e,t,r);return Eu(`ipns record for ${Ts(e,"base32")} was stored in the routing`),n}catch(t){const r=`ipns record for ${Ts(e,"base32")} could not be stored in the routing - ${t.stack}`;throw Eu.error(r),Eu.error(t),ie(new Error(r),"ERR_PUTTING_TO_ROUTING")}}async _getPublished(e,t={}){if(!ba(e)){const e="peerId received is not valid";throw Eu.error(e),ie(new Error(e),"ERR_INVALID_PEER_ID")}const r=!1!==t.checkRouting;try{const t=await this._datastore.get(mu(e.toBytes()));return this._unmarshalData(t)}catch(t){if(t.code!==vu){const t=`unexpected error getting the ipns record ${e.toString()} from datastore`;throw Eu.error(t),ie(new Error(t),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!r)throw ie(t,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{const t=du(e),r=await this._routing.get(t);return this._unmarshalData(r)}catch(e){throw Eu.error(e),e}}}_unmarshalData(e){try{return hu(e)}catch(e){throw ie(e,"ERR_INVALID_RECORD_DATA")}}async _updateOrCreateRecord(e,t,r,n){if(!ba(e)){const e="peerId received is not valid";throw Eu.error(e),ie(new Error(e),"ERR_INVALID_PEER_ID")}const s={checkRouting:!0};let i;try{i=await this._getPublished(e,s)}catch(t){if(t.code!==vu){const r=`unexpected error when determining the last published IPNS record for ${e.toString()} ${t.stack}`;throw Eu.error(r),ie(new Error(r),"ERR_DETERMINING_PUBLISHED_RECORD")}}let o,a=0n;i&&void 0!==i.sequence&&(a=ii(i.value,t)?i.sequence:i.sequence+BigInt(1));try{o=await(async(e,t,r,n)=>{const s=new Va(Date.now()+Number(n)),i=au.ValidityType.EOL,[o,a]=n.toString().split("."),A=BigInt(o)*BigInt(1e5)+BigInt(a??"0");return await wu(e,t,r,i,s,A)})(e,t,a,r)}catch(e){const r=`ipns record for ${t} could not be created`;throw Eu.error(e),ie(new Error(r),"ERR_CREATING_IPNS_RECORD")}try{const r=(A=o,au.encode(A));return await this._datastore.put(mu(e.toBytes()),r,n),Eu(`ipns record for ${Ts(t,"base32")} was stored in the datastore`),r}catch(e){const r=`ipns record for ${t} could not be stored in the datastore`;throw Eu.error(r),ie(new Error(r),"ERR_STORING_IN_DATASTORE")}var A}}_u.defaultRecordLifetime=Bu;const Cu=se("ipfs:ipns:republisher");class Su{constructor(e,t,r,n,s={pass:""}){this._publisher=e,this._datastore=t,this._peerId=r,this._keychain=n,this._options=s,this._republishHandle=null}async start(){if(this._republishHandle)throw ie(new Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");const e={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:t=>{e._timeoutId=setTimeout((async()=>{e._timeoutId=null;try{e._inflightTask=e._task(),await e._inflightTask,e._task&&e.runPeriodically(t)}catch(e){Cu.error(e)}}),t())},cancel:async()=>{null!=e._timeoutId&&clearTimeout(e._timeoutId),e._task=null,await e._inflightTask}},{pass:t}=this._options;let r=!0;e._task=async()=>{const e=new Bs.TimeoutController(3e4);try{await this._republishEntries(this._peerId,t,{signal:e.signal})}finally{e.clear()}},e.runPeriodically((()=>r?(r=!1,this._options.initialBroadcastInterval||6e4):this._options.broadcastInterval||144e5)),this._republishHandle=e}async stop(){const e=this._republishHandle;if(!e)throw ie(new Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");this._republishHandle=null,await e.cancel()}async _republishEntries(e,t,r){try{await this._republishEntry(e,r)}catch(e){const t="cannot republish entry for the node's private key";return void Cu.error(t)}if(t)try{const e=await this._keychain.listKeys();for(const n of e){if("self"===n.name)continue;const e=await this._keychain.exportKey(n.name,t),s=await nu(e,t),i=await ka(s.public.bytes,s.bytes);await this._republishEntry(i,r)}}catch(e){Cu.error(e)}}async _republishEntry(e,t){try{const r=await this._getPreviousValue(e);await this._publisher.publishWithEOL(e,r,864e5,t)}catch(e){if("ERR_NO_ENTRY_FOUND"===e.code)return;throw e}}async _getPreviousValue(e){if(!ba(e))throw ie(new Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{const t=await this._datastore.get(mu(e.toBytes()));if(!(t instanceof Uint8Array))throw ie(new Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{return hu(t).value}catch(e){throw Cu.error(e),ie(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch(t){if(t&&t.notFound)throw ie(new Error(`no previous entry for record with id: ${e.toString()}`),"ERR_NO_ENTRY_FOUND");throw t}}}const Iu=se("ipns:validator"),Tu=e=>{if(null==e.data)throw ie(new Error("Record data is missing"),"ERR_INVALID_RECORD_DATA");const t=(e=>{const t=qr(e);if(0!==t.ValidityType)throw ie(new Error("Unknown validity type"),su);return t.ValidityType=au.ValidityType.EOL,Number.isInteger(t.Sequence)&&(t.Sequence=BigInt(t.Sequence)),Number.isInteger(t.TTL)&&(t.TTL=BigInt(t.TTL)),t})(e.data);if(!ii(t.Value,e.value))throw ie(new Error('Field "value" did not match between protobuf and CBOR'),iu);if(!ii(t.Validity,e.validity))throw ie(new Error('Field "validity" did not match between protobuf and CBOR'),iu);if(t.ValidityType!==e.validityType)throw ie(new Error('Field "validityType" did not match between protobuf and CBOR'),iu);if(t.Sequence!==e.sequence)throw ie(new Error('Field "sequence" did not match between protobuf and CBOR'),iu);if(t.TTL!==e.ttl)throw ie(new Error('Field "ttl" did not match between protobuf and CBOR'),iu)},Ru=async(e,t)=>{const r=(e=>Ra(e.slice(cu.length)))(e),n=hu(t),s=await(async(e,t)=>{if(null==t||null==e){const e=new Error("one or more of the provided parameters are not defined");throw Au.error(e),ie(e,ou)}let r;if(null!=t.pubKey){try{r=eu(t.pubKey)}catch(e){throw Au.error(e),e}if(!(await ka(t.pubKey)).equals(e))throw ie(new Error("Embedded public key did not match PeerID"),"ERR_INVALID_EMBEDDED_KEY")}else null!=e.publicKey&&(r=eu(e.publicKey));if(null!=r)return r;throw ie(new Error("no public key is available"),ou)})(r,n);await(async(e,t)=>{const{value:r,validityType:n,validity:s}=t;let i,o,a;if(null==t.signatureV2||null==t.data)throw ie(new Error("missing data or signatureV2"),iu);o=t.signatureV2,i=uu(t.data),Tu(t);try{a=await e.verify(i,o)}catch(e){a=!1}if(!a)throw Iu.error("record signature verification failed"),ie(new Error("record signature verification failed"),iu);if(null!=s&&n===au.ValidityType.EOL){let e;try{e=lu(Ts(s))}catch(e){throw Iu.error("unrecognized validity format (not an rfc3339 format)"),ie(new Error("unrecognized validity format (not an rfc3339 format)"),"ERR_UNRECOGNIZED_FORMAT")}if(e.getTime()<Date.now())throw Iu.error("record has expired"),ie(new Error("record has expired"),"ERR_IPNS_EXPIRED_RECORD")}else if(null!=n)throw Iu.error("unrecognized validity type"),ie(new Error("unrecognized validity type"),su);Iu("ipns entry for %b is valid",r)})(s,n)},ku=se("ipfs:ipns:resolver"),Uu=Ka().code;class Du{constructor(e){this._routing=e}async resolve(e,t={}){if("string"!=typeof e)throw ie(new Error("invalid name"),"ERR_INVALID_NAME");const r=t.recursive&&"true"===t.recursive.toString(),n=e.split("/");if(3!==n.length||""!==n[0])throw ie(new Error("invalid name"),"ERR_INVALID_NAME");const s=n[2];let i=1/0;r&&(i=32);const o=await this.resolver(s,i,t);return ku(`${e} was locally resolved correctly`),o}async resolver(e,t,r){if(0===t){const e="could not resolve name (recursion limit of 32 exceeded)";throw ku.error(e),ie(new Error(e),"ERR_RESOLVE_RECURSION_LIMIT")}const n=await this._resolveName(e,r),s=n.split("/");return"ipfs"!==s[1]&&t?this.resolver(s[2],t-1,r):n}async _resolveName(e,t){const r=Ta(e),n=du(r);let s;try{s=await this._routing.get(n,t)}catch(t){if(ku.error("could not get record from routing",t),t.code===Uu)throw ie(new Error(`record requested for ${e} was not found in the network`),"ERR_NO_RECORD_FOUND");throw ie(new Error(`unexpected error getting the ipns record ${r.toString()}`),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}return this._validateRecord(r,s)}async _validateRecord(e,t){await Ru(Fs([vs("/ipns/"),e.toBytes()]),t);return Ts(hu(t).value)}}class Pu{constructor(e){this.lru=Io(e)}get(e){const t=this.lru.get(e);if(t)return t.expire&&t.expire<Date.now()?void this.lru.remove(e):t.value}set(e,t,r){this.lru.set(e,{value:t,expire:Date.now()+r})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}}const Lu=se("ipfs:ipns");class Nu{constructor(e,t,r,n,s){this.publisher=new _u(e,t),this.republisher=new Su(this.publisher,t,r,n,s),this.resolver=new Du(e),this.cache=new Pu(1e3),this.routing=e}async publish(e,t,r=_u.defaultRecordLifetime,n){try{await this.publisher.publishWithEOL(e,t,r,n),Lu(`IPNS value ${Ts(t,"base32")} was published correctly`);const s=e.toString(),i=parseFloat(r),o=i<6e4?i:6e4;return this.cache.set(s,t,o),Lu(`IPNS value ${Ts(t,"base32")} was cached correctly`),{name:s,value:t}}catch(e){throw Lu.error(e),e}}async resolve(e,t={}){if("string"!=typeof e)throw ie(new Error("name received is not valid"),"ERR_INVALID_NAME");if(!t.nocache&&!t.recursive){const t=e.split("/")[2],r=this.cache.get(t);if(r)return r}try{const r=await this.resolver.resolve(e,t);return Lu(`IPNS record from ${e} was resolved correctly`),r}catch(e){throw Lu.error(e),e}}async initializeKeyspace(e,t,r){return this.publish(e,t,_u.defaultRecordLifetime,r)}}async function Ou(e){const t=[];for await(const r of e)t.push(r);return t}const Fu=(e,t)=>async function*(){const r=await Ou(e);yield*r.sort(t)}();async function Qu(e){for await(const t of e);}async function*xu(e,t){for await(const r of e)await t(r)&&(yield r)}async function*Mu(e,t){let r=0;if(!(t<1))for await(const n of e)if(yield n,r++,r===t)return}class Hu{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,r){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(const{key:r,value:n}of e)await this.put(r,n,t),yield{key:r,value:n}}async*getMany(e,t={}){for await(const r of e)yield this.get(r,t)}async*deleteMany(e,t={}){for await(const r of e)await this.delete(r,t),yield r}batch(){let e=[],t=[];return{put(t,r){e.push({key:t,value:r})},delete(e){t.push(e)},commit:async r=>{await Qu(this.putMany(e,r)),e=[],await Qu(this.deleteMany(t,r)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let r=this._all(e,t);if(null!=e.prefix&&(r=xu(r,(t=>t.key.toString().startsWith(e.prefix)))),Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>xu(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>Fu(e,t)),r)),null!=e.offset){let t=0;r=xu(r,(()=>t++>=e.offset))}return null!=e.limit&&(r=Mu(r,e.limit)),r}queryKeys(e,t){let r=this._allKeys(e,t);if(null!=e.prefix&&(r=xu(r,(t=>t.toString().startsWith(e.prefix)))),Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>xu(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>Fu(e,t)),r)),null!=e.offset){let t=0;r=xu(r,(()=>t++>=e.offset))}return null!=e.limit&&(r=Mu(r,e.limit)),r}}class Ku{constructor(e){if(!(e>0)||0!=(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class Vu{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new Ku(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=e?.byteLength?e.byteLength:1}push(e){if(null!=e?.value&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new Ku(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(void 0===e&&null!=this.tail.next){const t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return null!=e?.value&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}}function zu(e={}){return ju((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),e)}function ju(e,t){let r,n,s,i=(t=t??{}).onEnd,o=new Vu;const a=e=>null!=n?n(e):(o.push(e),r),A=e=>{if(s)return r;if(!0!==t?.objectMode&&null==e?.byteLength)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return a({done:!1,value:e})},c=e=>s?r:(s=!0,null!=e?(e=>(o=new Vu,null!=n?n({error:e}):(o.push({error:e}),r)))(e):a({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>o.isEmpty()?s?{done:!0}:await new Promise(((t,s)=>{n=i=>{n=null,o.push(i);try{t(e(o))}catch(e){s(e)}return r}})):e(o),return:()=>(o=new Vu,c(),{done:!0}),throw:e=>(c(e),{done:!0}),push:A,end:c,get readableLength(){return o.size}},null==i)return r;const l=r;return r={[Symbol.asyncIterator](){return this},next(){return l.next()},throw(e){return l.throw(e),null!=i&&(i(e),i=void 0),{done:!0}},return(){return l.return(),null!=i&&(i(),i=void 0),{done:!0}},push:A,end(e){return l.end(e),null!=i&&(i(e),i=void 0),r},get readableLength(){return l.readableLength}},r}const Gu=se("datastore:core:tiered");class $u extends Hu{constructor(e){super(),this.stores=e.slice()}async open(){try{await Promise.all(this.stores.map((e=>e.open())))}catch(e){throw xa(e)}}async put(e,t,r){try{await Promise.all(this.stores.map((n=>n.put(e,t,r))))}catch(e){throw Ha(e)}}async get(e,t){for(const r of this.stores)try{const n=await r.get(e,t);if(n)return n}catch(e){Gu.error(e)}throw Ka()}async has(e,t){for(const r of this.stores)if(await r.has(e,t))return!0;return!1}async delete(e,t){try{await Promise.all(this.stores.map((r=>r.delete(e,t))))}catch(e){throw Ma(e)}}async*putMany(e,t={}){let r;const n=this.stores.map((e=>{const n=zu({objectMode:!0});return Qu(e.putMany(n,t)).catch((e=>{r=e})),n}));try{for await(const t of e){if(r)throw r;n.forEach((e=>e.push(t))),yield t}}finally{n.forEach((e=>e.end()))}}async*deleteMany(e,t={}){let r;const n=this.stores.map((e=>{const n=zu({objectMode:!0});return Qu(e.deleteMany(n,t)).catch((e=>{r=e})),n}));try{for await(const t of e){if(r)throw r;n.forEach((e=>e.push(t))),yield t}}finally{n.forEach((e=>e.end()))}}async close(){await Promise.all(this.stores.map((e=>e.close())))}batch(){const e=this.stores.map((e=>e.batch()));return{put:(t,r)=>{e.forEach((e=>e.put(t,r)))},delete:t=>{e.forEach((e=>e.delete(t)))},commit:async t=>{for(const r of e)await r.commit(t)}}}query(e,t){return this.stores[this.stores.length-1].query(e,t)}queryKeys(e,t){return this.stores[this.stores.length-1].queryKeys(e,t)}}var qu=r(26905);const Wu=(e,t)=>{const r=t.map(((e,t)=>({entry:au.decode(e),index:t})));return r.sort(((e,t)=>{if(null!=e.entry.signatureV2&&null==t.entry.signatureV2)return-1;if(null==e.entry.signatureV2&&null!=t.entry.signatureV2)return 1;const r=e.entry.sequence??0n,n=t.entry.sequence??0n;if(r>n)return-1;if(r<n)return 1;const s=e.entry.validity??new Uint8Array(0),i=t.entry.validity??new Uint8Array(0),o=lu(Ts(s)),a=lu(Ts(i));return o.getTime()>a.getTime()?-1:o.getTime()<a.getTime()?1:0})),r[0].index},Yu="SHARDING";class Xu extends Hu{constructor(){super(),this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,t){this.data[e.toString()]=t}async get(e){if(!await this.has(e))throw Ka();return this.data[e.toString()]}async has(e){return void 0!==this.data[e.toString()]}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map((([e,t])=>({key:new Ao(e),value:t})))}async*_allKeys(){yield*Object.entries(this.data).map((([e])=>new Ao(e)))}}new Ao(Yu),new Ao("_README");const Ju="/record/";function Zu(e){return Ts(e,"base32")}function eh(e){("string"==typeof e||e instanceof String)&&(e=vs(e.toString()));const t=Ts(e,"base64url");return`${Ju}${t}`}const th=se("datastore-pubsub:publisher");class rh extends Hu{constructor(e,t,r,n,s,i){if(super(),!n)throw new wa("missing validator","ERR_INVALID_PARAMETERS");if("function"!=typeof n)throw new wa("missing validate function","ERR_INVALID_PARAMETERS");if("function"!=typeof s)throw new wa("missing select function","ERR_INVALID_PARAMETERS");if(i&&"function"!=typeof i)throw new wa("invalid subscriptionKeyFn received","ERR_INVALID_PARAMETERS");this._pubsub=e,this._datastore=t,this._peerId=r,this._validator=n,this._selector=s,this._handleSubscriptionKeyFn=i,this._onMessage=this._onMessage.bind(this),this._pubsub.addEventListener("message",this._onMessage)}async put(e,t,r){if(!(e instanceof Uint8Array)){const e="datastore key does not have a valid format";throw th.error(e),new wa(e,"ERR_INVALID_DATASTORE_KEY")}if(!(t instanceof Uint8Array)){const e="received value is not a Uint8Array";throw th.error(e),new wa(e,"ERR_INVALID_VALUE_RECEIVED")}const n=eh(e);th(`publish value for topic ${n}`),await this._pubsub.publish(n,t)}async get(e,t){if(!(e instanceof Uint8Array)){const e="datastore key does not have a valid format";throw th.error(e),new wa(e,"ERR_INVALID_DATASTORE_KEY")}const r=eh(e),n=await this._pubsub.getTopics();if(n&&Array.isArray(n)&&n.indexOf(r)>-1)return this._getLocal(e,t);try{await this._pubsub.subscribe(r)}catch(e){const t=`cannot subscribe topic ${r}`;throw th.error(t),new wa(t,"ERR_SUBSCRIBING_TOPIC")}return th(`subscribed values for key ${r}`),this._getLocal(e)}unsubscribe(e){const t=eh(e);return this._pubsub.unsubscribe(t)}async _getLocal(e,t){const r=new Ao("/"+Zu(e),!1);let n;try{n=await this._datastore.get(r,t)}catch(e){if("ERR_NOT_FOUND"!==e.code){const e=`unexpected error getting the ipns record for ${r.toString()}`;throw th.error(e),new wa(e,"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}const t=`local record requested was not found for ${r.toString()}`;throw th.error(t),new wa(t,"ERR_NOT_FOUND")}if(!(n instanceof Uint8Array)){const e="found record that we couldn't convert to a value";throw th.error(e),new wa(e,"ERR_INVALID_RECORD_RECEIVED")}return n}async _onMessage(e){const t=e.detail;if("signed"!==t.type)return void th.error("unsigned message received, this module can only work with signed messages");const{data:r,from:n,topic:s}=t;let i;try{i=function(e){if(e.substring(0,Ju.length)!==Ju)throw new wa("topic received is not from a record","ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");return vs(e.substring(Ju.length),"base64url")}(s)}catch(e){return void th.error(e)}if(th(`message received for topic ${s}`),this._peerId.equals(n))th("message discarded as it is from the same peer");else{if(this._handleSubscriptionKeyFn){let e;try{e=await this._handleSubscriptionKeyFn(i)}catch(e){return void th.error("message discarded by the subscriptionKeyFn")}i=e}try{await this._storeIfSubscriptionIsBetter(i,r)}catch(e){th.error(e)}}}async _storeIfSubscriptionIsBetter(e,t,r){let n=!1;try{n=await this._isBetter(e,t)}catch(e){if("ERR_NOT_VALID_RECORD"!==e.code)throw e}n&&await this._storeRecord(e,t,r)}async _validateRecord(e,t){return this._validator(e,t)}async _selectRecord(e,t){return 0===await this._selector(e,t)}async _isBetter(e,t){try{await this._validateRecord(e,t)}catch(e){const t="record received through pubsub is not valid";throw th.error(t),new wa(t,"ERR_NOT_VALID_RECORD")}const r=new Ao(e);let n;try{n=await this._getLocal(r.uint8Array())}catch(e){return!0}return!ii(n,t)&&this._selectRecord(e,[n,t])}async _storeRecord(e,t,r){const n=new Ao("/"+Zu(e),!1);await this._datastore.put(n,t,r),th(`record for ${eh(e)} was stored in the datastore`)}}const nh=se("ipfs:ipns:pubsub");class sh{constructor(e,t,r){this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new rh(e,t,r,Ru,Wu,this._handleSubscriptionKey)}async put(e,t,r){try{await this._pubsubDs.put(e,t,r)}catch(e){throw nh.error(e),e}}async get(e,t){let r,n;try{r=await this._pubsubDs.get(e,t)}catch(e){n=e}if(Ts(e.slice(0,yu))===gu){const t=V.encode(e).substring(1),r=V.encode(e.slice(yu)).substring(1);this._subscriptions[t]=r,nh(`subscribed to pubsub topic ${t}, id ${r}`)}if(n)throw n;return r}_handleSubscriptionKey(e){e instanceof Uint8Array&&(e=Ts(e,"base58btc"));const t=this._subscriptions[e];if(!t)throw ie(new Error(`key ${e} does not correspond to a subscription`),"ERR_INVALID_KEY");try{return du(Ta(t))}catch(e){throw nh.error(e),e}}getSubscriptions(){return Object.values(this._subscriptions).filter(Boolean).map((e=>`${gu}${e}`))}async cancel(e){if("string"!=typeof e)throw ie(new Error("invalid subscription name"),"ERR_INVALID_SUBSCRIPTION_NAME");e.startsWith(gu)&&(e=e.substring(yu));const t=Object.keys(this._subscriptions).find((t=>this._subscriptions[t]===e));if(!t)return{canceled:!1};const r=vs(t);return this._pubsubDs.unsubscribe(r),delete this._subscriptions[t],nh(`unsubscribed pubsub ${t}: ${e}`),{canceled:!0}}}var ih;function oh(e){const t=e.getUTCFullYear(),r=String(e.getUTCMonth()+1).padStart(2,"0"),n=String(e.getUTCDate()).padStart(2,"0"),s=String(e.getUTCHours()).padStart(2,"0"),i=String(e.getUTCMinutes()).padStart(2,"0"),o=String(e.getUTCSeconds()).padStart(2,"0"),a=e.getUTCMilliseconds();return`${t}-${r}-${n}T${s}:${i}:${o}.${String(1e3*a*1e3).padStart(9,"0")}Z`}!function(e){let t;e.codec=()=>(null==t&&(t=aA(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),(!0===r.writeDefaults||null!=e.key&&e.key.byteLength>0)&&(t.uint32(10),t.bytes(e.key)),(!0===r.writeDefaults||null!=e.value&&e.value.byteLength>0)&&(t.uint32(18),t.bytes(e.value)),!0!==r.writeDefaults&&""===e.timeReceived||(t.uint32(42),t.string(e.timeReceived)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={key:new Uint8Array(0),value:new Uint8Array(0),timeReceived:""},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.key=e.bytes();break;case 2:r.value=e.bytes();break;case 5:r.timeReceived=e.string();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>Za(t,e.codec()),e.decode=t=>Ja(t,e.codec())}(ih||(ih={}));class ah{constructor(e,t,r){if(!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(t instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=t,this.timeReceived=r}serialize(){return ih.encode(this.prepareSerialize())}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:oh(this.timeReceived)}}static deserialize(e){const t=ih.decode(e);return new ah(t.key,t.value,new Date(t.timeReceived))}static fromDeserialized(e){const t=function(e){const t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(e).trim().match(t);if(null==r)throw new Error("Invalid format");const n=parseInt(r[1],10),s=parseInt(r[2],10)-1,i=parseInt(r[3],10),o=parseInt(r[4],10),a=parseInt(r[5],10),A=parseInt(r[6],10),c=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(n,s,i,o,a,A,c))}(e.timeReceived);if(null==e.key)throw new Error("key missing from deserialized object");if(null==e.value)throw new Error("value missing from deserialized object");return new ah(e.key,e.value,t)}}const Ah=se("ipfs:ipns:offline-datastore");class ch{constructor(e){this._datastore=e,this.stores=[]}async put(e,t,r){if(!(e instanceof Uint8Array))throw ie(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!(t instanceof Uint8Array))throw ie(new Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let n;try{n=this._routingKey(e)}catch(e){throw Ah.error(e),ie(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}const s=new ah(e,t,new Date);await this._datastore.put(n,s.serialize(),r)}async get(e,t){if(!(e instanceof Uint8Array))throw ie(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let r;try{r=this._routingKey(e)}catch(e){throw Ah.error(e),ie(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}const n=await this._datastore.get(r,t);let s;try{s=ah.deserialize(n)}catch(e){throw Ah.error(e),e}return s.value}_routingKey(e){return new Ao("/dht/record/"+Ts(e,"base32"),!1)}}const lh=se("ipfs:ipns:dht-datastore");class uh{constructor(e){this._dht=e}async put(e,t,r){try{await Qu(this._dht.put(e,t,r))}catch(e){throw lh.error(e),e}}async get(e,t){for await(const r of this._dht.get(e,t))if("VALUE"===r.name)return r.value;throw Ka()}}const hh=se("ipfs:components:ipns");class dh{constructor(e={pass:""}){this.options=e,this.offline=null,this.online=null}getIPNS(){const e=this.online||this.offline;if(e)return e;throw new As}get routing(){return this.getIPNS().routing}startOffline({repo:e,peerId:t,keychain:r}){if(null!=this.offline)throw new ls;hh("initializing IPNS keyspace (offline)");const n=new ch(e.datastore),s=new Nu(n,e.datastore,t,r,this.options);this.offline=s}async startOnline({libp2p:e,repo:t,peerId:r,keychain:n}){if(null!=this.online)throw new ls;const s=function({libp2p:e,repo:t,peerId:r,options:n}){const s=[];let i;if(qu(n,"EXPERIMENTAL.ipnsPubsub",!1)&&(i=new sh(e.pubsub,t.datastore,r),s.push(i)),!0!==qu(n,"offline",!1)&&["dht","dhtclient","dhtserver"].includes(qu(n,"config.Routing.Type","none"))&&s.push(new uh(e.dht)),qu(n,"offline",!1)||0===s.length){const e=new ch(t.datastore);s.push(e)}return new $u(s)}({libp2p:e,repo:t,peerId:r,options:this.options}),i=new Nu(s,t.datastore,r,n,this.options);await i.republisher.start(),this.online=i}async stop(){const e=this.online;e&&(await e.republisher.stop(),this.online=null)}publish(e,t,r,n){return this.getIPNS().publish(e,t,r,n)}resolve(e,t){return this.getIPNS().resolve(e,t)}initializeKeyspace(e,t,r){return this.getIPNS().initializeKeyspace(e,t,r)}}async function fh({ipns:e,repo:t,codecs:r},n,s){if(so(n))return e.resolve(n);const{cid:i,path:o}=wo(n);await Qu(Co(i,o||"",r,t,s))}const ph=se("ipfs:name:publish");function gh({ipns:e,repo:t,codecs:r,peerId:n,isOnline:s,keychain:i}){const o=async e=>{let t;if("self"===e&&null!=n.privateKey)t=await ru(n.privateKey);else try{const r=await i.exportKey(e,"temp");t=await nu(r,"temp")}catch(e){throw ph.error(e),ie(e,"ERR_CANNOT_GET_KEY")}return ka(t.public.bytes,t.bytes)};return go((async function(n,i={}){const a=!(!1===i.resolve),A=i.lifetime||"24h",c=i.key||"self";if(!s())throw ie(new Error(mo),"OFFLINE_ERROR");try{n=(e=>{if(Ve.asCID(e))return`/ipfs/${e}`;const t=e.toString();try{return`/ipfs/${Ve.parse(t)}`}catch{}if(no(t))return t;throw ie(new Error(`invalid path: ${e}`),"ERR_BAD_PATH")})(n)}catch(e){throw ph.error(e),e}let l=0;try{l=fo(A)||0,l=parseFloat(l.toFixed(6))}catch(e){throw ph.error(e),e}const u=await Promise.all([o(c),a?fh({ipns:e,repo:t,codecs:r},n):Promise.resolve()]),h=vs(n),d=await e.publish(u[0],h,l,i);return{name:d.name,value:Ts(d.value)}}))}var yh=r(82734);const wh=I.bind({ignoreUndefined:!0}),mh=se("ipfs:name:resolve"),bh=(e,t)=>t.length>0?e+"/"+t.join("/"):e;function Eh(e,t){if(!e||!t||!t.ipnsPubsub)throw ie(new Error("IPNS pubsub subsystem is not enabled"),"ERR_IPNS_PUBSUB_NOT_ENABLED");if(e.routing instanceof sh)return e.routing;const r=(e.routing.stores||[]).find((e=>e instanceof sh));if(!r)throw ie(new Error("IPNS pubsub datastore not found"),"ERR_PUBSUB_DATASTORE_NOT_FOUND");return r}class vh{constructor({ipns:e,options:t}){this.cancel=function({ipns:e,options:t}){const r=t.EXPERIMENTAL;return go((async function(t,n={}){return Eh(e,r).cancel(t,n)}))}({ipns:e,options:t}),this.state=function({ipns:e,options:t}){const r=t.EXPERIMENTAL;return go((async function(t={}){try{return{enabled:Boolean(Eh(e,r))}}catch(e){return{enabled:!1}}}))}({ipns:e,options:t}),this.subs=function({ipns:e,options:t}){const r=t.EXPERIMENTAL;return go((async function(t={}){return Eh(e,r).getSubscriptions(t)}))}({ipns:e,options:t})}}class Bh{constructor({dns:e,ipns:t,repo:r,codecs:n,peerId:s,isOnline:i,keychain:o,options:a}){this.publish=gh({ipns:t,repo:r,codecs:n,peerId:s,isOnline:i,keychain:o}),this.resolve=function({dns:e,ipns:t,isOnline:r,options:{offline:n}}){return go((async function*(s,i={}){if(i=wh({nocache:!1,recursive:!0},i),n&&i&&i.nocache)throw ie(new Error("cannot specify both offline and nocache"),"ERR_NOCACHE_AND_OFFLINE");if(!r()&&!n)throw ie(new Error(mo),"OFFLINE_ERROR");let o=s.toString();o.startsWith("/ipns/")||(o=`/ipns/${o}`);let[a,A,...c]=o.slice(1).split("/");try{if("1"===A.substring(0,1)){const e=Ta(A),t=Qe(e.toBytes());A=Ve.createV1(114,t).toString(Mn)}else{const e=Ve.parse(A);1===e.version&&(A=e.toString(Mn))}}catch(t){if(yh(A))return void(yield bh(await e(A,i),c));throw mh.error(t),ie(new Error("Invalid IPNS name"),"ERR_IPNS_INVALID_NAME")}const l=await t.resolve(`/${a}/${A}`,i);yield bh(l instanceof Uint8Array?Ts(l):l,c)}))}({dns:e,ipns:t,isOnline:i,options:a}),this.pubsub=new vh({ipns:t,options:a})}}const _h=Ka().code,Ch="<dst>",Sh="<src> -> <dst>";function Ih({repo:e,codecs:t,resolve:r,preload:n}){return async function*(s,i={}){if(0===i.maxDepth)return;if(i.edges&&i.format&&i.format!==Ch)throw new Error("Cannot set edges to true and also specify format");if(i.format=i.edges?Sh:i.format,"number"!=typeof i.maxDepth&&(i.maxDepth=i.recursive?1/0:1),i.timeout){const e=[new Bs.TimeoutController(i.timeout).signal];i.signal&&e.push(i.signal),i.signal=(0,co.anySignal)(e)}const o=(Array.isArray(s)?s:[s]).map((e=>function(e,t,r){const{cid:n,path:s}=wo(t);!1!==r.preload&&e(n);return`/ipfs/${n}${s||""}`}(n,e,i)));for(const n of o)try{yield*Th(r,e,t,n,i)}catch(e){yield{ref:"",err:e.message}}}}async function*Th(e,t,r,n,s){const i=await e(n,s),{cid:o}=wo(i),a=null!=s.maxDepth?s.maxDepth:1/0,A=s.unique||!1;for await(const e of async function*(e,t,r,n,s,i){const o=new Set;async function*a(r,A){const c=A+1;if(!(c>n))try{for await(const n of async function*(e,t,r,n){const s=await e.blocks.get(r,n),i=await t.getCodec(r.code),o=i.decode(s),a=r.code===Et,A=[];for(const[e,t]of kh(o,A)){if(a){const r=e.match(/^Links\/(\d+)\/Hash$/);if(r){const e=Number(r[1]);if(e<o.Links.length){yield{name:o.Links[e].Name,cid:t};continue}}}yield{name:e,cid:t}}}(e,t,r.cid,i))yield{parent:r,node:n,isDuplicate:s&&o.has(n.cid.toString())},s&&o.add(n.cid.toString()),yield*a(n,c)}catch(e){throw e.code===_h&&(e.message=`Could not find object with CID: ${r.cid}`),e}}yield*a({cid:r},0)}(t,r,o,a,A,s))e.parent&&(e.isDuplicate||(yield{ref:Rh(e.parent.cid,e.node.cid,e.node.name,s.format)}))}function Rh(e,t,r="",n=Ch){let s=n.replace(/<src>/g,e.toString());return s=s.replace(/<dst>/g,t.toString()),s=s.replace(/<linkname>/g,r),s}const kh=function*(e,t){if(null!=e&&!(e instanceof Uint8Array)){for(const[r,n]of Object.entries(e)){const e=[...t,r];if(null!=n&&"object"==typeof n)if(Array.isArray(n))for(const[t,r]of n.entries()){const n=[...e,t],s=Ve.asCID(r);s?yield[n.join("/"),s]:"object"==typeof r&&(yield*kh(r,n))}else{const t=Ve.asCID(n);t?yield[e.join("/"),t]:yield*kh(n,e)}}return[]}};function Uh({repo:e}){return go((async function*(t={}){for await(const r of e.blocks.queryKeys({},{signal:t.signal}))yield{ref:r.toString()}}))}function Dh({network:e}){return go((async function(t={}){const r=(await e.use(t)).bitswap,n=r.stat().snapshot;return{provideBufLen:parseInt(n.providesBufferLength.toString()),blocksReceived:BigInt(n.blocksReceived.toString()),wantlist:Array.from(r.getWantlist()).map((e=>e[1].cid)),peers:r.peers(),dupBlksReceived:BigInt(n.dupBlksReceived.toString()),dupDataReceived:BigInt(n.dupDataReceived.toString()),dataReceived:BigInt(n.dataReceived.toString()),blocksSent:BigInt(n.blocksSent.toString()),dataSent:BigInt(n.dataSent.toString())}}))}class Ph{constructor({network:e}){this.wantlist=function({network:e}){return go((async function(t={}){const{bitswap:r}=await e.use(t),n=r.getWantlist();return Array.from(n).map((e=>e[1].cid))}))}({network:e}),this.wantlistForPeer=function({network:e}){return go((async function(t,r={}){const{bitswap:n}=await e.use(r),s=n.wantlistForPeer(t);return Array.from(s).map((e=>e[1].cid))}))}({network:e}),this.unwant=function({network:e}){return go((async function(t,r={}){const{bitswap:n}=await e.use(r);return Array.isArray(t)||(t=[t]),n.unwant(t)}))}({network:e}),this.stat=Dh({network:e})}}function Lh(e){try{return Vi.matches(e)}catch(e){return!1}}class Nh{constructor({repo:e}){this.add=function({repo:e}){return go((async function(t,r={}){if(!Lh(t))throw new Error(`${t} is not a valid Multiaddr`);const n=await e.config.getAll(r),s=n.Bootstrap||[];return s.push(t.toString()),n.Bootstrap=Array.from(new Set(s)).sort(((e,t)=>e.localeCompare(t))),await e.config.replace(n),{Peers:[t]}}))}({repo:e}),this.list=function({repo:e}){return go((async function(t={}){return{Peers:(await e.config.get("Bootstrap",t)||[]).map((e=>mi(e)))}}))}({repo:e}),this.rm=function({repo:e}){return go((async function(t,r={}){if(!Lh(t))throw new Error(`${t} is not a valid Multiaddr`);const n=await e.config.getAll(r);return n.Bootstrap=(n.Bootstrap||[]).filter((e=>e.toString()!==t.toString())),await e.config.replace(n),{Peers:[t]}}))}({repo:e}),this.clear=function({repo:e}){return go((async function(t={}){const r=await e.config.getAll(t),n=r.Bootstrap||[];return r.Bootstrap=[],await e.config.replace(r),{Peers:n.map((e=>mi(e)))}}))}({repo:e}),this.reset=function({repo:e}){return go((async function(t={}){const r=await e.config.getAll(t);return r.Bootstrap=["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],await e.config.replace(r),{Peers:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"].map((e=>mi(e)))}}))}({repo:e})}}function Oh(){const e={};return e.promise=new Promise(((t,r)=>{e.resolve=t,e.reject=r})),e}const Fh=globalThis.CustomEvent??Event;async function*Qh(e,t={}){let r=t.concurrency??1/0;r<1&&(r=1/0);const n=null!=t.ordered&&t.ordered,s=new EventTarget,i=[];let o,a=Oh(),A=Oh(),c=!1,l=!1;function u(){return n?i[0]?.done:Boolean(i.find((e=>e.done)))}function*h(){for(;i.length>0&&i[0].done;){const e=i[0];if(i.shift(),!e.ok)throw l=!0,a.resolve(),e.err;yield e.value,a.resolve()}}function*d(){for(;u();)for(let e=0;e<i.length;e++)if(i[e].done){const t=i[e];if(i.splice(e,1),e--,!t.ok)throw l=!0,a.resolve(),t.err;yield t.value,a.resolve()}}for(s.addEventListener("task-complete",(()=>{A.resolve()})),Promise.resolve().then((async()=>{try{for await(const t of e){if(i.length===r&&(a=Oh(),await a.promise),l)break;const e={done:!1};i.push(e),t().then((t=>{e.done=!0,e.ok=!0,e.value=t,s.dispatchEvent(new Fh("task-complete"))}),(t=>{e.done=!0,e.err=t,s.dispatchEvent(new Fh("task-complete"))}))}c=!0,s.dispatchEvent(new Fh("task-complete"))}catch(e){o=e,s.dispatchEvent(new Fh("task-complete"))}}));;){if(u()||(A=Oh(),await A.promise),null!=o)throw o;if(n?yield*h():yield*d(),c&&0===i.length)break}}async function*xh(e,t){for await(const r of e)yield t(r)}async function*Mh(...e){const t=zu({objectMode:!0});Promise.resolve().then((async()=>{try{await Promise.all(e.map((async e=>{for await(const r of e)t.push(r)}))),t.end()}catch(e){t.end(e)}})),yield*t}const Hh=e=>null!=e&&("function"==typeof e[Symbol.asyncIterator]||"function"==typeof e[Symbol.iterator]||"function"==typeof e.next),Kh=e=>null!=e&&"function"==typeof e.sink&&Hh(e.source),Vh=e=>t=>{const r=e.sink(t);if(null!=r.then){const t=zu({objectMode:!0});r.then((()=>{t.end()}),(e=>{t.end(e)}));const n=async function*(){yield*e.source,t.end()};return Mh(t,n())}return e.source};function zh(e,...t){if(Kh(e)){const t=e;e=()=>t.source}else if(Hh(e)){const t=e;e=()=>t}const r=[e,...t];if(r.length>1&&Kh(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let e=1;e<r.length-1;e++)Kh(r[e])&&(r[e]=Vh(r[e]));return((...e)=>{let t;for(;e.length>0;)t=e.shift()(t);return t})(...r)}function jh(e){return e instanceof Uint8Array?Ve.decode(e):Ve.parse(e.toString())}class Gh{constructor({codecs:e,hashers:t,preload:r,repo:n}){this.get=function({preload:e,repo:t}){return go((async function(r,n={}){return!1!==n.preload&&e(r),t.blocks.get(r,n)}))}({preload:r,repo:n}),this.put=function({codecs:e,hashers:t,repo:r,preload:n}){return go((async function(s,i={}){const o=i.pin?await r.gcLock.readLock():null;try{const a=null!=i.version?i.version:0,A=i.format||(0===a?"dag-pb":"raw"),c=await t.getHasher(i.mhtype||"sha2-256"),l=await c.digest(s),u=await e.getCodec(A),h=Ve.create(a,u.code,l);return await r.blocks.put(h,s,{signal:i.signal}),!1!==i.preload&&n(h),!0===i.pin&&await r.pins.pinRecursively(h,{signal:i.signal}),h}finally{o&&o()}}))}({codecs:e,hashers:t,preload:r,repo:n}),this.rm=function({repo:e}){return go((async function*(t,r={}){Array.isArray(t)||(t=[t]);const n=await e.gcLock.writeLock();try{yield*zh(t,(t=>xh(t,(t=>async()=>{const n={cid:t=jh(t)};try{if(!await e.blocks.has(t))throw ie(new Error("block not found"),"ERR_BLOCK_NOT_FOUND");await e.blocks.delete(t)}catch(e){r.force||(e.message=`cannot remove ${t}: ${e.message}`,n.error=e)}return n}))),(e=>Qh(e,{concurrency:8})),(e=>xu(e,(()=>!r.quiet))))}finally{n()}}))}({repo:n}),this.stat=function({repo:e,preload:t}){return go((async function(r,n={}){return r=jh(r),!1!==n.preload&&t(r),{cid:r,size:(await e.blocks.get(r)).length}}))}({preload:r,repo:n})}}async function*$h(e,t={}){const r=e.getReader();try{for(;;){const e=await r.read();if(e.done)return;yield e.value}}finally{!0!==t.preventCancel&&await r.cancel(),r.releaseLock()}}function qh(e){const[t,r]=null!=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>t.next(),push:e=>{n.push(e)},next:()=>n.length>0?{done:!1,value:n.shift()}:t.next(),[r](){return this}}}function Wh(e){return ArrayBuffer.isView(e)||e instanceof ArrayBuffer}function Yh(e){return e.constructor&&("Blob"===e.constructor.name||"File"===e.constructor.name)&&"function"==typeof e.stream}function Xh(e){return"object"==typeof e&&(e.path||e.content)}const Jh=e=>e&&"function"==typeof e.getReader;async function*Zh(e){yield e}async function ed(e){if(Wh(e))return Zh(td(e));if("string"==typeof e||e instanceof String)return Zh(td(e.toString()));if(Yh(e))return"function"==typeof(t=e).stream?$h(t.stream()):$h(new Response(t).body);var t;if(Jh(e)&&(e=$h(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const t=qh(e),{value:r,done:n}=await t.peek();if(n)return Zh(new Uint8Array(0));if(t.push(r),Number.isInteger(r))return Zh(Uint8Array.from(await Ou(t)));if(Wh(r)||"string"==typeof r||r instanceof String)return xh(t,td)}throw ie(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")}function td(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Array.isArray(e)?Uint8Array.from(e):vs(e.toString())}async function rd(e,t){const{path:r,mode:n,mtime:s,content:i}=e,o={path:r||"",mode:ye(n),mtime:we(s)};return i?o.content=await t(i):r||(o.content=await t(e)),o}function nd(e){return async function*(e,t){if(null==e)throw ie(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");if("string"==typeof e||e instanceof String)yield rd(e.toString(),t);else if(Wh(e)||Yh(e))yield rd(e,t);else{if(Jh(e)&&(e=$h(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const r=qh(e),{value:n,done:s}=await r.peek();if(s)return void(yield{content:[]});if(r.push(n),Number.isInteger(n)||Wh(n)||"string"==typeof n||n instanceof String)return void(yield rd(r,t));throw ie(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(!Xh(e))throw ie(new Error('Unexpected input: cannot convert "'+typeof e+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT");yield rd(e,t)}}(e,ed)}async function*sd(e,t=1){let r=[];t<1&&(t=1);for await(const n of e)for(r.push(n);r.length>=t;)yield r.slice(0,t),r=r.slice(t);for(;r.length>0;)yield r.slice(0,t),r=r.slice(t)}async function*id(e,t=1){for await(const r of sd(e,t)){const e=r.map((async e=>await e().then((e=>({ok:!0,value:e})),(e=>({ok:!1,err:e})))));for(let t=0;t<e.length;t++){const r=await e[t];if(!r.ok)throw r.err;yield r.value}}}var od=r(40469);tn({name:"murmur3-32",code:35,encode:e=>function(e){const t=new Array(4);for(let r=0;r<4;r++)t[r]=255&e,e>>=8;return new Uint8Array(t)}(od.x86.hash32(e))});const ad=tn({name:"murmur3-128",code:34,encode:e=>P(od.x64.hash128(e))});tn({name:"murmur3-x64-64",code:34,encode:e=>P(od.x64.hash128(e)).subarray(0,8)});const Ad={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hasher:$n,leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:0x3df305dfb2a804,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,recursive:!1,hidden:!1,timeout:void 0,hamtHashFn:async function(e){return(await ad.encode(e)).slice(0,8).reverse()},hamtHashCode:34,hamtBucketBits:8};var cd=async(e,t,r)=>{r.codec||(r.codec=o),r.hasher||(r.hasher=$n),void 0===r.cidVersion&&(r.cidVersion=1),r.codec===o&&r.hasher!==$n&&(r.cidVersion=1);const n=await r.hasher.digest(e),s=Ve.create(r.cidVersion,r.codec.code,n);return r.onlyHash||await t.put(s,e,{signal:r.signal}),s};var ld=async(e,t,r)=>{const n=new me({type:"directory",mtime:e.mtime,mode:e.mode}),s=vt(gt({Data:n.marshal()}));return{cid:await cd(s,t,r),path:e.path,unixfs:n,size:s.length}};var ud=async function(e,t){return t(await Ou(e))};async function hd(e,t,r){const n=[];for await(const s of sd(e,r.maxChildrenPerNode))n.push(await t(s));return n.length>1?hd(n,t,r):n[0]}var dd=function(e,t,r){return hd(e,t,r)};var fd=async function(e,t,r){const n=new gd(r.layerRepeat);let s=0,i=1,o=n;for await(const a of sd(e,r.maxChildrenPerNode))o.isFull()&&(o!==n&&n.addChild(await o.reduce(t)),s&&s%r.layerRepeat==0&&i++,o=new pd(i,r.layerRepeat,s),s++),o.append(a);return o&&o!==n&&n.addChild(await o.reduce(t)),n.reduce(t)};class pd{constructor(e,t,r=0){this.maxDepth=e,this.layerRepeat=t,this.currentDepth=1,this.iteration=r,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:e,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;const e=this._findParent(this.node,this.currentDepth);return!e||(this._addNextNodeToParent(e),!1)}_addNextNodeToParent(e){this.parent=e;const t={children:[],depth:e.depth+1,parent:e,maxDepth:this.maxDepth,maxChildren:Math.floor(e.children.length/this.layerRepeat)*this.layerRepeat};e.children.push(t),this.currentDepth=t.depth,this.node=t}append(e){this.node.data=e}reduce(e){return this._reduce(this.root,e)}async _reduce(e,t){let r=[];return e.children.length&&(r=await Promise.all(e.children.filter((e=>e.data)).map((e=>this._reduce(e,t))))),t((e.data||[]).concat(r))}_findParent(e,t){const r=e.parent;if(r&&0!==r.depth)return r.children.length!==r.maxChildren&&r.maxChildren?r:this._findParent(r,t)}}class gd extends pd{constructor(e){super(0,e),this.root.depth=0,this.currentDepth=1}addChild(e){this.root.children.push(e)}reduce(e){return e((this.root.data||[]).concat(this.root.children))}}var yd=async function*(e,t,r){for await(let n of e.content)yield async()=>{let s;r.progress(n.length,e.path);const i={codec:o,cidVersion:r.cidVersion,hasher:r.hasher,onlyHash:r.onlyHash};return r.rawLeaves?(i.codec=m,i.cidVersion=1):(s=new me({type:r.leafType,data:n}),n=vt({Data:s.marshal(),Links:[]})),{cid:await cd(n,t,i),unixfs:s,size:n.length}}};const wd={flat:ud,balanced:dd,trickle:fd};var md=function(e,t,r){const n=wd[r.strategy];if(!n)throw ie(new Error(`Unknown importer build strategy name: ${r.strategy}`),"ERR_BAD_STRATEGY");return n(async function*(e,t,r){let n,s,i=-1;s="function"==typeof r.bufferImporter?r.bufferImporter:yd;for await(const o of id(s(e,t,r),r.blockWriteConcurrency))i++,0!==i?(1===i&&n&&(yield n,n=null),yield o):n=o;n&&(n.single=!0,yield n)}(e,t,r),((e,t,r)=>async function(n){if(1===n.length&&n[0].single&&r.reduceSingleLeafToSelf){const s=n[0];if(void 0!==e.mtime||void 0!==e.mode){let n=await t.get(s.cid);s.unixfs=new me({type:"file",mtime:e.mtime,mode:e.mode,data:n}),n=vt(gt({Data:s.unixfs.marshal()})),s.cid=await cd(n,t,{...r,codec:o,hasher:r.hasher,cidVersion:r.cidVersion}),s.size=n.length}return{cid:s.cid,path:e.path,unixfs:s.unixfs,size:s.size}}const s=new me({type:"file",mtime:e.mtime,mode:e.mode}),i=n.filter((e=>!(e.cid.code!==Yn||!e.size)||!(!e.unixfs||e.unixfs.data||!e.unixfs.fileSize())||Boolean(e.unixfs&&e.unixfs.data&&e.unixfs.data.length))).map((e=>e.cid.code===Yn?(s.addBlockSize(e.size),{Name:"",Tsize:e.size,Hash:e.cid}):(e.unixfs&&e.unixfs.data?s.addBlockSize(e.unixfs.data.length):s.addBlockSize(e.unixfs&&e.unixfs.fileSize()||0),{Name:"",Tsize:e.size,Hash:e.cid}))),a={Data:s.marshal(),Links:i},A=vt(gt(a));return{cid:await cd(A,t,r),path:e.path,unixfs:s,size:A.length+a.Links.reduce(((e,t)=>e+t.Tsize),0)}})(e,t,r),r)};const bd=Symbol.for("@achingbrain/uint8arraylist");function Ed(e,t){if(null==t||t<0)throw new RangeError("index is out of bounds");let r=0;for(const n of e){const e=r+n.byteLength;if(t<e)return{buf:n,index:t-r};r=e}throw new RangeError("index is out of bounds")}function vd(e){return Boolean(e?.[bd])}class Bd{constructor(...e){Object.defineProperty(this,bd,{value:!0}),this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let t=0;for(const r of e)if(r instanceof Uint8Array)t+=r.byteLength,this.bufs.push(r);else{if(!vd(r))throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");t+=r.byteLength,this.bufs.push(...r.bufs)}this.length+=t}prepend(...e){this.prependAll(e)}prependAll(e){let t=0;for(const r of e.reverse())if(r instanceof Uint8Array)t+=r.byteLength,this.bufs.unshift(r);else{if(!vd(r))throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");t+=r.byteLength,this.bufs.unshift(...r.bufs)}this.length+=t}get(e){const t=Ed(this.bufs,e);return t.buf[t.index]}set(e,t){const r=Ed(this.bufs,e);r.buf[r.index]=t}write(e,t=0){if(e instanceof Uint8Array)for(let r=0;r<e.length;r++)this.set(t+r,e[r]);else{if(!vd(e))throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList");for(let r=0;r<e.length;r++)this.set(t+r,e.get(r))}}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength)return this.bufs=[],void(this.length=0);for(;this.bufs.length>0;){if(!(e>=this.bufs[0].byteLength)){this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift()}}}slice(e,t){const{bufs:r,length:n}=this._subList(e,t);return Fs(r,n)}subarray(e,t){const{bufs:r,length:n}=this._subList(e,t);return 1===r.length?r[0]:Fs(r,n)}sublist(e,t){const{bufs:r,length:n}=this._subList(e,t),s=new Bd;return s.length=n,s.bufs=r,s}_subList(e,t){if(e=e??0,t=t??this.length,e<0&&(e=this.length+e),t<0&&(t=this.length+t),e<0||t>this.length)throw new RangeError("index is out of bounds");if(e===t)return{bufs:[],length:0};if(0===e&&t===this.length)return{bufs:[...this.bufs],length:this.length};const r=[];let n=0;for(let s=0;s<this.bufs.length;s++){const i=this.bufs[s],o=n,a=o+i.byteLength;if(n=a,e>=a)continue;const A=e>=o&&e<a,c=t>o&&t<=a;if(A&&c){if(e===o&&t===a){r.push(i);break}const n=e-o;r.push(i.subarray(n,n+(t-e)));break}if(A){if(0===e){r.push(i);continue}r.push(i.subarray(e-o))}else{if(c){if(t===a){r.push(i);break}r.push(i.subarray(0,t-o));break}r.push(i)}}return{bufs:r,length:t-e}}indexOf(e,t=0){if(!(vd(e)||e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');const r=e instanceof Uint8Array?e:e.subarray();if(t=Number(t??0),isNaN(t)&&(t=0),t<0&&(t=this.length+t),t<0&&(t=0),0===e.length)return t>this.length?this.length:t;const n=r.byteLength;if(0===n)throw new TypeError("search must be at least 1 byte long");const s=new Int32Array(256);for(let e=0;e<256;e++)s[e]=-1;for(let e=0;e<n;e++)s[r[e]]=e;const i=s,o=this.byteLength-r.byteLength,a=r.byteLength-1;let A;for(let e=t;e<=o;e+=A){A=0;for(let t=a;t>=0;t--){const n=this.get(e+t);if(r[t]!==n){A=Math.max(1,t-i[n]);break}}if(0===A)return e}return-1}getInt8(e){const t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getInt8(0)}setInt8(e,t){const r=ys(1);new DataView(r.buffer,r.byteOffset,r.byteLength).setInt8(0,t),this.write(r,e)}getInt16(e,t){const r=this.subarray(e,e+2);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt16(0,t)}setInt16(e,t,r){const n=gs(2);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt16(0,t,r),this.write(n,e)}getInt32(e,t){const r=this.subarray(e,e+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt32(0,t)}setInt32(e,t,r){const n=gs(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt32(0,t,r),this.write(n,e)}getBigInt64(e,t){const r=this.subarray(e,e+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getBigInt64(0,t)}setBigInt64(e,t,r){const n=gs(8);new DataView(n.buffer,n.byteOffset,n.byteLength).setBigInt64(0,t,r),this.write(n,e)}getUint8(e){const t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getUint8(0)}setUint8(e,t){const r=ys(1);new DataView(r.buffer,r.byteOffset,r.byteLength).setUint8(0,t),this.write(r,e)}getUint16(e,t){const r=this.subarray(e,e+2);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint16(0,t)}setUint16(e,t,r){const n=gs(2);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint16(0,t,r),this.write(n,e)}getUint32(e,t){const r=this.subarray(e,e+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint32(0,t)}setUint32(e,t,r){const n=gs(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint32(0,t,r),this.write(n,e)}getBigUint64(e,t){const r=this.subarray(e,e+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getBigUint64(0,t)}setBigUint64(e,t,r){const n=gs(8);new DataView(n.buffer,n.byteOffset,n.byteLength).setBigUint64(0,t,r),this.write(n,e)}getFloat32(e,t){const r=this.subarray(e,e+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getFloat32(0,t)}setFloat32(e,t,r){const n=gs(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setFloat32(0,t,r),this.write(n,e)}getFloat64(e,t){const r=this.subarray(e,e+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getFloat64(0,t)}setFloat64(e,t,r){const n=gs(8);new DataView(n.buffer,n.byteOffset,n.byteLength).setFloat64(0,t,r),this.write(n,e)}equals(e){if(null==e)return!1;if(!(e instanceof Bd))return!1;if(e.bufs.length!==this.bufs.length)return!1;for(let t=0;t<this.bufs.length;t++)if(!ii(this.bufs[t],e.bufs[t]))return!1;return!0}static fromUint8Arrays(e,t){const r=new Bd;return r.bufs=e,null==t&&(t=e.reduce(((e,t)=>e+t.byteLength),0)),r.length=t,r}}var _d=r(63060);var Cd=async function*(e,t){let r,n,s;if(t.minChunkSize&&t.maxChunkSize&&t.avgChunkSize)s=t.avgChunkSize,r=t.minChunkSize,n=t.maxChunkSize;else{if(!t.avgChunkSize)throw ie(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");s=t.avgChunkSize,r=s/3,n=s+s/2}if(r<16)throw ie(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");n<r&&(n=r),s<r&&(s=r);const i=Math.floor(Math.log2(s));for await(const s of async function*(e,t){const r=await(0,_d.create)(t.bits,t.min,t.max,t.window),n=new Bd;for await(const t of e){n.append(t);const e=r.fingerprint(t);for(let t=0;t<e.length;t++){const r=e[t],s=n.slice(0,r);n.consume(r),yield s}}n.length&&(yield n.subarray(0))}(e,{min:r,max:n,bits:i,window:t.window,polynomial:t.polynomial}))yield s};var Sd=async function*(e,t){let r=new Bd,n=0,s=!1;const i=t.maxChunkSize;for await(const t of e)for(r.append(t),n+=t.length;n>=i;)if(yield r.slice(0,i),s=!0,i===r.length)r=new Bd,n=0;else{const e=new Bd;e.append(r.sublist(i)),r=e,n-=i}s&&!n||(yield r.subarray(0,n))};var Id=async function*(e){for await(const t of e){if(void 0===t.length)throw ie(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if("string"==typeof t||t instanceof String)yield vs(t.toString());else if(Array.isArray(t))yield Uint8Array.from(t);else{if(!(t instanceof Uint8Array))throw ie(new Error("Content was invalid"),"ERR_INVALID_CONTENT");yield t}}};function Td(e){try{if(e instanceof Uint8Array)return async function*(){yield e}();if(t=e,Symbol.iterator in t)return async function*(){yield*e}();if(function(e){return Symbol.asyncIterator in e}(e))return e}catch{throw ie(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}var t;throw ie(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}var Rd=async function*(e,t,r){for await(const n of e)if(n.path&&("./"===n.path.substring(0,2)&&(r.wrapWithDirectory=!0),n.path=n.path.split("/").filter((e=>e&&"."!==e)).join("/")),n.content){let e,s;e="function"==typeof r.chunker?r.chunker:"rabin"===r.chunker?Cd:Sd,s="function"==typeof r.chunkValidator?r.chunkValidator:Id;const i={path:n.path,mtime:n.mtime,mode:n.mode,content:e(s(Td(n.content),r),r)};yield()=>md(i,t,r)}else{if(!n.path)throw new Error("Import candidate must have content or path or both");{const e={path:n.path,mtime:n.mtime,mode:n.mode};yield()=>ld(e,t,r)}}};var kd=class{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,t){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}};var Ud=class extends kd{constructor(e,t){super(e,t),this._children={}}async put(e,t){this.cid=void 0,this.size=void 0,this._children[e]=t}get(e){return Promise.resolve(this._children[e])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}async*eachChildSeries(){const e=Object.keys(this._children);for(let t=0;t<e.length;t++){const r=e[t];yield{key:r,child:this._children[r]}}}async*flush(e){const t=Object.keys(this._children),r=[];for(let n=0;n<t.length;n++){let s=this._children[t[n]];if(s instanceof kd)for await(const t of s.flush(e))s=t,yield s;null!=s.size&&s.cid&&r.push({Name:t[n],Tsize:s.size,Hash:s.cid})}const n=new me({type:"directory",mtime:this.mtime,mode:this.mode}),s={Data:n.marshal(),Links:r},i=vt(gt(s)),o=await cd(i,e,this.options),a=i.length+s.Links.reduce(((e,t)=>e+(null==t.Tsize?0:t.Tsize)),0);this.cid=o,this.size=a,yield{cid:o,unixfs:n,path:this.path,size:a}}},Dd=r(20544);class Pd{constructor(e,t,r=0){this._options=e,this._popCount=0,this._parent=t,this._posAtParent=r,this._children=new Dd,this.key=null}async put(e,t){const r=await this._findNewBucketAndPos(e);await r.bucket._putAt(r,e,t)}async get(e){const t=await this._findChild(e);if(null!=t)return t.value}async del(e){const t=await this._findPlace(e),r=t.bucket._at(t.pos);null!=r&&r.key===e&&t.bucket._delAt(t.pos)}leafCount(){return this._children.compactArray().reduce(((e,t)=>t instanceof Pd?e+t.leafCount():e+1),0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){const e=this._children.compactArray();for(const t of e)t instanceof Pd?yield*t.eachLeafSeries():yield t}serialize(e,t){return t(this._children.reduce(((r,n,s)=>(null!=n&&(n instanceof Pd?r.push(n.serialize(e,t)):r.push(e(n,s))),r)),[]))}async asyncTransform(e,t){return await Fd(this,e,t)}toJSON(){return this.serialize(Nd,Od)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){const t=await this._findPlace(e),r=t.bucket._at(t.pos);if(!(r instanceof Pd))return null!=r&&r.key===e?r:void 0}async _findPlace(e){const t=this._options.hash("string"==typeof e?vs(e):e),r=await t.take(this._options.bits),n=this._children.get(r);return n instanceof Pd?await n._findPlace(t):{bucket:this,pos:r,hash:t,existingChild:n}}async _findNewBucketAndPos(e){const t=await this._findPlace(e);if(null!=t.existingChild&&t.existingChild.key!==e){const e=new Pd(this._options,t.bucket,t.pos);t.bucket._putObjectAt(t.pos,e);const r=await e._findPlace(t.existingChild.hash);return r.bucket._putAt(r,t.existingChild.key,t.existingChild.value),await e._findNewBucketAndPos(t.hash)}return t}_putAt(e,t,r){this._putObjectAt(e.pos,{key:t,value:r,hash:e.hash})}_putObjectAt(e,t){null==this._children.get(e)&&this._popCount++,this._children.set(e,t)}_delAt(e){if(-1===e)throw new Error("Invalid position");null!=this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(null!=this._parent&&this._popCount<=1)if(1===this._popCount){const e=this._children.find(Ld);if(null!=e&&!(e instanceof Pd)){const t=e.hash;t.untake(this._options.bits);const r={pos:this._posAtParent,hash:t,bucket:this._parent};this._parent._putAt(r,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}}function Ld(e){return Boolean(e)}function Nd(e,t){return e.key}function Od(e){return e}async function Fd(e,t,r){const n=[];for(const s of e._children.compactArray())if(s instanceof Pd)await Fd(s,t,r);else{const r=await t(s);n.push({bitField:e._children.bitField(),children:r})}return await r(n)}const Qd=[255,254,252,248,240,224,192,128],xd=[1,3,7,15,31,63,127,255];class Md{constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+8*this._currentBytePos}totalBits(){return 8*this._value.length}take(e){let t=e,r=0;for(;t>0&&this._haveBits();){const e=this._value[this._currentBytePos],n=this._currentBitPos+1,s=Math.min(n,t);r=(r<<s)+Hd(e,n-s,s),t-=s,this._currentBitPos-=s,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return r}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}function Hd(e,t,r){const n=function(e,t){return Qd[e]&xd[Math.min(t+e-1,7)]}(t,r);return(e&n)>>>t}function Kd(e){return function(t){return t instanceof Vd?t:new Vd(t,e)}}class Vd{constructor(e,t){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let t=e;for(;this._availableBits<t;)await this._produceMoreBits();let r=0;for(;t>0;){const e=this._buffers[this._currentBufferIndex],n=Math.min(e.availableBits(),t);r=(r<<n)+e.take(n),t-=n,this._availableBits-=n,0===e.availableBits()&&this._currentBufferIndex++}return r}untake(e){let t=e;for(;t>0;){const e=this._buffers[this._currentBufferIndex],r=Math.min(e.totalBits()-e.availableBits(),t);e.untake(r),t-=r,this._availableBits+=r,this._currentBufferIndex>0&&e.totalBits()===e.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const e=this._depth>0?Fs([this._value,Uint8Array.from([this._depth])]):this._value,t=await this._hashFn(e),r=new Md(t);this._buffers.push(r),this._availableBits+=r.availableBits()}}function zd(e){if(null==e||null==e.hashFn)throw new Error("please define an options.hashFn");const t={bits:e.bits??8,hash:Kd(e.hashFn)};return new Pd(t)}var jd=class extends kd{constructor(e,t){super(e,t),this._bucket=zd({hashFn:t.hamtHashFn,bits:t.hamtBucketBits})}async put(e,t){await this._bucket.put(e,t)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}async*flush(e){for await(const t of Gd(this._bucket,e,this,this.options))yield{...t,path:this.path}}};async function*Gd(e,t,r,n){const s=e._children,i=[];let o=0;for(let e=0;e<s.length;e++){const r=s.get(e);if(!r)continue;const a=e.toString(16).toUpperCase().padStart(2,"0");if(r instanceof Pd){let e;for await(const s of await Gd(r,t,null,n))e=s;if(!e)throw new Error("Could not flush sharded directory, no subshard found");i.push({Name:a,Tsize:e.size,Hash:e.cid}),o+=e.size}else if("function"==typeof r.value.flush){const e=r.value;let n;for await(const r of e.flush(t))n=r,yield n;const s=a+r.key;i.push({Name:s,Tsize:n.size,Hash:n.cid}),o+=n.size}else{const e=r.value;if(!e.cid)continue;const t=a+r.key,n=e.size;i.push({Name:t,Tsize:n,Hash:e.cid}),o+=n}}const a=Uint8Array.from(s.bitField().reverse()),A=new me({type:"hamt-sharded-directory",data:a,fanout:e.tableSize(),hashType:n.hamtHashCode,mtime:r&&r.mtime,mode:r&&r.mode}),c=vt(gt({Data:A.marshal(),Links:i})),l=await cd(c,t,n),u=c.length+o;yield{cid:l,unixfs:A,size:u}}var $d=async function e(t,r,n,s){let i=r;r instanceof Ud&&r.directChildrenCount()>=n&&(i=await async function(e,t){const r=new jd({root:e.root,dir:!0,parent:e.parent,parentKey:e.parentKey,path:e.path,dirty:e.dirty,flat:!1,mtime:e.mtime,mode:e.mode},t);for await(const{key:t,child:n}of e.eachChildSeries())await r.put(t,n);return r}(r,s));const o=i.parent;if(o){if(i!==r){if(t&&(t.parent=i),!i.parentKey)throw new Error("No parent key found");await o.put(i.parentKey,i)}return e(i,o,n,s)}return i};var qd=(e="")=>(e.trim().match(/([^\\/]|\\\/)+/g)||[]).filter(Boolean);async function Wd(e,t,r){const n=qd(e.path||""),s=n.length-1;let i=t,o="";for(let a=0;a<n.length;a++){const A=n[a];o+=`${o?"/":""}${A}`;const c=a===s;if(i.dirty=!0,i.cid=void 0,i.size=void 0,c)await i.put(A,e),t=await $d(null,i,r.shardSplitThreshold,r);else{let e=await i.get(A);e&&e instanceof kd||(e=new Ud({root:!1,dir:!0,parent:i,parentKey:A,path:o,dirty:!0,flat:!0,mtime:e&&e.unixfs&&e.unixfs.mtime,mode:e&&e.unixfs&&e.unixfs.mode},r)),await i.put(A,e),i=e}}return t}async function*Yd(e,t){e instanceof kd?yield*e.flush(t):e&&e.unixfs&&e.unixfs.isDirectory()&&(yield e)}var Xd=async function*(e,t,r){let n=new Ud({root:!0,dir:!0,path:"",dirty:!0,flat:!0},r);for await(const t of e)t&&(n=await Wd(t,n,r),t.unixfs&&t.unixfs.isDirectory()||(yield t));if(r.wrapWithDirectory)yield*Yd(n,t);else for await(const e of n.eachChildSeries())e&&(yield*Yd(e.child,t))};async function*Jd(e,t,r={}){const n=((e={})=>I.bind({ignoreUndefined:!0})(Ad,e))(r);let s,i,o;s="function"==typeof r.dagBuilder?r.dagBuilder:Rd,i="function"==typeof r.treeBuilder?r.treeBuilder:Xd,o=Symbol.asyncIterator in e||Symbol.iterator in e?e:[e];for await(const e of i(id(s(o,t,n),n.fileImportConcurrency),t,n))yield{cid:e.cid,path:e.path,unixfs:e.unixfs,size:e.size}}async function*Zd(e,t){if("string"==typeof e||e instanceof String||Wh(e)||Yh(e)||e._readableState)throw ie(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(Jh(e)&&(e=$h(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const r=qh(e),{value:n,done:s}=await r.peek();if(s)return void(yield*[]);if(r.push(n),Number.isInteger(n))throw ie(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(n._readableState)return void(yield*xh(r,(e=>ef({content:e},t))));if(Wh(n))return void(yield ef({content:r},t));if(Xh(n)||n[Symbol.iterator]||n[Symbol.asyncIterator]||Jh(n)||Yh(n))return void(yield*xh(r,(e=>ef(e,t))))}if(Xh(e))throw ie(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");throw ie(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}async function ef(e,t){const{path:r,mode:n,mtime:s,content:i}=e,o={path:r||"",mode:ye(n),mtime:we(s)};return i?o.content=await t(i):r||(o.content=await t(e)),o}const tf=e=>{if(e){if(e.startsWith("size-")){const t=e.split("-")[1],r=parseInt(t);if(isNaN(r))throw new Error("Chunker parameter size must be an integer");return{chunker:"fixed",maxChunkSize:r}}if(e.startsWith("rabin"))return{chunker:"rabin",...rf(e)};throw new Error(`Unrecognized chunker option: ${e}`)}return{chunker:"fixed"}},rf=e=>{const t={},r=e.split("-");switch(r.length){case 1:t.avgChunkSize=262144;break;case 2:t.avgChunkSize=nf(r[1],"avg");break;case 4:t.minChunkSize=nf(r[1],"min"),t.avgChunkSize=nf(r[2],"avg"),t.maxChunkSize=nf(r[3],"max");break;default:throw new Error('Incorrect chunker format (expected "rabin" "rabin-[avg]" or "rabin-[min]-[avg]-[max]"')}return t},nf=(e,t)=>{const r=parseInt(e);if(isNaN(r))throw new Error(`Chunker parameter ${t} must be an integer`);return r},sf=I.bind({ignoreUndefined:!0});function of({repo:e,preload:t,hashers:r,options:n}){const s=n&&n.sharding;return go((async function*(n,i={}){const o=sf({shardSplitThreshold:s?1e3:1/0,strategy:"balanced"},i,{...tf(i.chunker)});o.hashAlg&&"sha2-256"!==o.hashAlg&&1!==o.cidVersion&&(o.cidVersion=1),o.trickle&&(o.strategy="trickle"),"trickle"===o.strategy&&(o.leafType="raw",o.reduceSingleLeafToSelf=!1),o.cidVersion>0&&void 0===o.rawLeaves&&(o.rawLeaves=!0),void 0!==o.hashAlg&&void 0===o.rawLeaves&&(o.rawLeaves=!0),delete o.trickle;const a={};if(o.progress){const e=o.progress;o.progress=(t,r)=>{a[r]||(a[r]=0),a[r]+=t,e(a[r],r)}}let A;null!=o.hashAlg&&(A=await r.getHasher(o.hashAlg));const c=zh(Zd(n,ed),(t=>Jd(t,e.blocks,{...o,hasher:A,pin:!1})),function(e){async function*t(t){for await(const r of t){let t=r.cid;1===e.cidVersion&&(t=t.toV1());let n=r.path?r.path:t.toString();e.wrapWithDirectory&&!r.path&&(n=""),yield{path:n,cid:t,size:r.size,mode:r.unixfs&&r.unixfs.mode,mtime:r.unixfs&&r.unixfs.mtime}}}return t}(o),function(e,t){async function*r(r){for await(const n of r){(!n.path||t.wrapWithDirectory?""===n.path:!n.path.includes("/"))&&!t.onlyHash&&!1!==t.preload&&e(n.cid),yield n}}return r}(t,o),function(e,t){async function*r(r){for await(const n of r){const r=!(n.path&&n.path.includes("/"));(null==t.pin||t.pin)&&r&&!t.onlyHash&&await e.pins.pinRecursively(n.cid),yield n}}return r}(e,o)),l=await e.gcLock.readLock();try{for await(const e of c){const t=e.path??e.cid.toString();delete a[t],yield{...e,path:t}}}finally{l()}}))}const af=async function(e){return(await ad.encode(e)).slice(0,8).reverse()},Af=e=>e.toString(16).toUpperCase().padStart(2,"0").substring(0,2),cf=async(e,t,r,n,s)=>{if(!n){const e=zd({hashFn:af});n={rootBucket:e,hamtDepth:1,lastBucket:e}}await((e,t,r)=>Promise.all(e.map((e=>{if(null==e.Name)throw new Error("Unexpected Link without a Name");if(2===e.Name.length){const n=parseInt(e.Name,16);return t._putObjectAt(n,new Pd({hash:r._options.hash,bits:r._options.bits},t,n))}return r.put(e.Name.substring(2),!0)}))))(e.Links,n.lastBucket,n.rootBucket);const i=await n.rootBucket._findNewBucketAndPos(t);let o=Af(i.pos);const a=(e=>{let t=e.bucket;const r=[];for(;t._parent;)r.push(t),t=t._parent;return r.push(t),r.reverse()})(i);a.length>n.hamtDepth&&(n.lastBucket=a[n.hamtDepth],o=Af(n.lastBucket._posAtParent));const A=e.Links.find((e=>{if(null==e.Name)return!1;const r=e.Name.substring(0,2),n=e.Name.substring(2);return r===o&&(!n||n===t)}));if(!A)return null;if(null!=A.Name&&A.Name.substring(2)===t)return A.Hash;n.hamtDepth++;return e=Bt(await r.get(A.Hash,s)),cf(e,t,r,n,s)};var lf=cf;var uf=function(e,t,r,n){const s=t+e.length;return r>=s||n<t?new Uint8Array(0):(n>=t&&n<s&&(e=e.subarray(0,n-t)),r>=t&&r<s&&(e=e.subarray(r-t)),e)};var hf=(e,t,r)=>{if(t||(t=0),t<0)throw ie(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(t>e)throw ie(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(r||0===r||(r=e-t),r<0)throw ie(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return t+r>e&&(r=e-t),{offset:t,length:r}};async function df(e,t,r,n,s,i,o,a){if(t instanceof Uint8Array)return void r.push(uf(t,n,s,i));if(null==t.Data)throw ie(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let A;try{A=me.unmarshal(t.Data)}catch(e){throw ie(e,"ERR_NOT_UNIXFS")}if(null!=A.data){const e=A.data,t=uf(e,n,s,i);r.push(t),n+=t.byteLength}const c=[];for(let e=0;e<t.Links.length;e++){const r=t.Links[e],o=n,a=o+A.blockSizes[e];if((s>=o&&s<a||i>=o&&i<=a||s<o&&i>a)&&c.push({link:r,blockStart:n}),(n=a)>i)break}await zh(c,(t=>xh(t,(t=>async()=>{const r=await e.get(t.link.Hash,{signal:a.signal});return{...t,block:r}}))),(e=>Qh(e,{ordered:!0})),(async t=>{for await(const{link:n,block:A,blockStart:c}of t){let t;switch(n.Hash.code){case Et:t=Bt(A);break;case Yn:t=A;break;default:return void r.end(ie(new Error(`Unsupported codec: ${n.Hash.code}`),"ERR_NOT_UNIXFS"))}o.add((async()=>{await df(e,t,r,c,s,i,o,a)}))}}))}var ff=(e,t,r,n,s,i,o)=>async function*(e={}){const n=r.fileSize();if(void 0===n)throw new Error("File was a directory");const{offset:s,length:i}=hf(n,e.offset,e.length);if(0===i)return;const a=new ua({concurrency:1}),A=zu();a.add((async()=>{await df(o,t,A,0,s,s+i,a,e)})),a.on("error",(e=>{A.end(e)}));let c=0;for await(const e of A)null!=e&&(c+=e.byteLength,c===i&&A.end(),yield e)};var pf=(e,t,r,n,s,i,o)=>async function*(e={}){const r=e.offset||0,a=e.length||t.Links.length,A=t.Links.slice(r,a);for(const t of A){const r=await s(t.Hash,t.Name||"",`${n}/${t.Name||""}`,[],i+1,o,e);r.entry&&(yield r.entry)}};async function*gf(e,t,r,n,s,i){const o=e.Links;for(const a of o){const o=null!=a.Name?a.Name.substring(2):null;if(o){const e=await r(a.Hash,o,`${t}/${o}`,[],n+1,s,i);yield e.entry}else{e=Bt(await s.get(a.Hash));for await(const o of gf(e,t,r,n,s,i))yield o}}}var yf=(e,t,r,n,s,i,o)=>function(e={}){return gf(t,n,s,i,o,e)};const wf={raw:ff,file:ff,directory:pf,"hamt-sharded-directory":yf,metadata:(e,t,r,n,s,i,o)=>()=>[],symlink:(e,t,r,n,s,i,o)=>()=>[]};var mf=async(e,t,r,n,s,i,o,a)=>{const A=Bt(await o.get(e,a));let c,l;if(t||(t=e.toString()),null==A.Data)throw ie(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{c=me.unmarshal(A.Data)}catch(e){throw ie(e,"ERR_NOT_UNIXFS")}if(r||(r=t),n.length){let e;if(e=c&&"hamt-sharded-directory"===c.type?await lf(A,n[0],o):((e,t)=>{const r=e.Links.find((e=>e.Name===t));return r&&r.Hash})(A,n[0]),!e)throw ie(new Error("file does not exist"),"ERR_NOT_FOUND");const t=n.shift();l={cid:e,toResolve:n,name:t||"",path:`${r}/${t}`}}return{entry:{type:c.isDirectory()?"directory":"file",name:t,path:r,cid:e,content:wf[c.type](e,A,c,r,s,i,o),unixfs:c,depth:i,node:A,size:c.fileSize()},next:l}};var bf=async(e,t,r,n,s,i,o,a)=>{if(n.length)throw ie(new Error(`No link named ${r} found in raw node ${e}`),"ERR_NOT_FOUND");const A=await Qe(e.multihash.bytes);return{entry:{type:"identity",name:t,path:r,cid:e,content:(c=A.digest,async function*(e={}){const{offset:t,length:r}=hf(c.length,e.offset,e.length);yield uf(c,0,t,t+r)}),depth:i,size:A.digest.length,node:A.digest}};var c};const Ef={[Et]:mf,[Yn]:async(e,t,r,n,s,i,o,a)=>{if(n.length)throw ie(new Error(`No link named ${r} found in raw node ${e}`),"ERR_NOT_FOUND");const A=await o.get(e,a);return{entry:{type:"raw",name:t,path:r,cid:e,content:(c=A,async function*(e={}){const{offset:t,length:r}=hf(c.length,e.offset,e.length);yield uf(c,0,t,t+r)}),depth:i,size:A.length,node:A}};var c},[Jr]:async(e,t,r,n,s,i,o,a)=>{const A=await o.get(e),c=en(A);let l=c,u=r;for(;n.length;){const s=n[0];if(!(s in l))throw ie(new Error(`No property named ${s} found in cbor node ${e}`),"ERR_NO_PROP");{n.shift(),u=`${u}/${s}`;const o=Ve.asCID(l[s]);if(o)return{entry:{type:"object",name:t,path:r,cid:e,node:A,depth:i,size:A.length,content:async function*(){yield c}},next:{cid:o,name:s,path:u,toResolve:n}};l=l[s]}}return{entry:{type:"object",name:t,path:r,cid:e,node:A,depth:i,size:A.length,content:async function*(){yield c}}}},[Pn.code]:bf};var vf=function e(t,r,n,s,i,o,a){const A=Ef[t.code];if(!A)throw ie(new Error(`No resolver for code ${t.code}`),"ERR_NO_RESOLVER");return A(t,r,n,s,e,i,o,a)};const Bf=e=>{if(e instanceof Uint8Array)return{cid:Ve.decode(e),toResolve:[]};const t=Ve.asCID(e);if(t)return{cid:t,toResolve:[]};if("string"==typeof e){0===e.indexOf("/ipfs/")&&(e=e.substring(6));const t=((e="")=>(e.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean))(e);return{cid:Ve.parse(t[0]),toResolve:t.slice(1)}}throw ie(new Error(`Unknown path type ${e}`),"ERR_BAD_PATH")};async function*_f(e,t,r={}){let{cid:n,toResolve:s}=Bf(e),i=n.toString(),o=i;const a=s.length;for(;;){const A=await vf(n,i,o,s,a,t,r);if(!A.entry&&!A.next)throw ie(new Error(`Could not resolve ${e}`),"ERR_NOT_FOUND");if(A.entry&&(yield A.entry),!A.next)return;s=A.next.toResolve,n=A.next.cid,i=A.next.name,o=A.next.path}}async function Cf(e,t,r={}){const n=await Da(_f(e,t,r));if(!n)throw ie(new Error(`Could not resolve ${e}`),"ERR_NOT_FOUND");return n}async function*Sf(e,t,r={}){const n=await Cf(e,t,r);if(n&&(yield n,"directory"===n.type))for await(const e of async function*e(t,r){for await(const n of t.content(r))yield n,n instanceof Uint8Array||"directory"===n.type&&(yield*e(n,r))}(n,r))yield e}"0".charCodeAt(0),vs("ustar\0","binary"),vs("ustar ","binary"),vs(" \0","binary");var If=r(71993);async function Tf(e){let t=new Uint8Array(0);for await(const r of e)t=Fs([t,r],t.length+r.length);return t}const Rf="0".charCodeAt(0),kf=vs("ustar\0","binary"),Uf=vs("00","binary"),Df=parseInt("7777",8),Pf=function(e,t){const r=e.toString(8);return r.length>t?vs("7777777777777777777".slice(0,t)+" "):vs("0000000000000000000".slice(0,t-r.length)+r+" ")},Lf=function(e){const t=vs(e).byteLength;let r=Math.floor(Math.log(t)/Math.log(10))+1;return t+r>=Math.pow(10,r)&&r++,`${t+r}${e}`};function Nf(e){const t=new Uint8Array(512);let r=e.name,n="";if(5===e.typeflag&&"/"!==r[r.length-1]&&(r+="/"),vs(r).byteLength!==r.length)return null;for(;vs(r).byteLength>100;){const e=r.indexOf("/");if(-1===e)return null;n+=""!==n?"/"+r.slice(0,e):r.slice(0,e),r=r.slice(e+1)}return vs(r).byteLength>100||vs(n).byteLength>155||null!=e.linkname&&vs(e.linkname).byteLength>100?null:(t.set(vs(r),0),t.set(Pf(e.mode&Df,6),100),t.set(Pf(e.uid,6),108),t.set(Pf(e.gid,6),116),t.set(Pf(e.size,11),124),t.set(Pf(e.mtime.getTime()/1e3|0,11),136),t[156]=Rf+function(e){switch(e){case"file":default:return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}}(e.type),null!=e.linkname&&t.set(vs(e.linkname),157),t.set(kf,257),t.set(Uf,263),null!=e.uname&&t.set(vs(e.uname),265),null!=e.gname&&t.set(vs(e.gname),297),t.set(Pf(e.devmajor??0,6),329),t.set(Pf(e.devminor??0,6),337),null!=n&&t.set(vs(n),345),t.set(Pf(function(e){let t=256;for(let r=0;r<148;r++)t+=e[r];for(let r=156;r<512;r++)t+=e[r];return t}(t),6),148),t)}const{S_IFMT:Of,S_IFBLK:Ff,S_IFCHR:Qf,S_IFDIR:xf,S_IFIFO:Mf,S_IFLNK:Hf}=If,Kf=parseInt("755",8),Vf=parseInt("644",8),zf=new Uint8Array(1024);function jf(e=0){switch(e&Of){case Ff:return"block-device";case Qf:return"character-device";case xf:return"directory";case Mf:return"fifo";case Hf:return"symlink";default:return"file"}}function Gf(e){return 0!==(e&=511)?zf.subarray(0,512-e):new Uint8Array(0)}function $f(e){if(null==e.pax){const t=Nf(e);if(null!=t)return t}return function(e){const t=function(e){let t="";null!=e.name&&(t+=Lf(" path="+e.name+"\n")),null!=e.linkname&&(t+=Lf(" linkpath="+e.linkname+"\n"));const r=e.pax;if(null!=r)for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t+=Lf(" "+e+"="+r[e]+"\n"));return vs(t)}(e),r={name:"PaxHeader",mode:e.mode,uid:e.uid,gid:e.gid,size:t.length,mtime:e.mtime,type:"pax-header",linkname:e.linkname,uname:e.uname,gname:e.gname,devmajor:e.devmajor,devminor:e.devminor};return new Bd(Nf(r)??new Uint8Array(0),t,Gf(t.length),Nf({...r,size:e.size,type:e.type})??new Uint8Array(0)).subarray()}(e)}function qf(){return async function*(e){for await(let{header:t,body:r}of e){const e={...t,size:"symlink"===t.type?0:t.size??0,type:t.type??jf(t.mode),mode:t.mode??("directory"===t.type?Kf:Vf),uid:t.uid??0,gid:t.gid??0,mtime:t.mtime??new Date};if("string"==typeof r&&(r=vs(r)),r instanceof Uint8Array||vd(r)){e.size=r.length,yield $f(e),yield vd(r)?r.subarray():r,yield Gf(e.size);continue}if("symlink"===e.type&&null==e.linkname){if(null==r)throw new Error("type was symlink but no linkname or body specified");e.linkname=Ts(await Tf(r)),yield $f(e);continue}if(yield $f(e),"file"!==e.type&&"contiguous-file"!==e.type)continue;let n=0;for await(const e of r??[])n+=e.length,yield vd(e)?e.subarray():e;if(n!==e.size)throw new Error(`size mismatch, wrote ${n} of ${e.size} bytes`);yield Gf(e.size)}yield zf}}function Wf(e){let t=e.length;for(;--t>=0;)e[t]=0}const Yf=256,Xf=286,Jf=30,Zf=15,ep=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),tp=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),rp=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),np=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),sp=new Array(576);Wf(sp);const ip=new Array(60);Wf(ip);const op=new Array(512);Wf(op);const ap=new Array(256);Wf(ap);const Ap=new Array(29);Wf(Ap);const cp=new Array(Jf);function lp(e,t,r,n,s){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=s,this.has_stree=e&&e.length}let up,hp,dp;function fp(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}Wf(cp);const pp=e=>e<256?op[e]:op[256+(e>>>7)],gp=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},yp=(e,t,r)=>{e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,gp(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},wp=(e,t,r)=>{yp(e,r[2*t],r[2*t+1])},mp=(e,t)=>{let r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1},bp=(e,t,r)=>{const n=new Array(16);let s,i,o=0;for(s=1;s<=Zf;s++)o=o+r[s-1]<<1,n[s]=o;for(i=0;i<=t;i++){let t=e[2*i+1];0!==t&&(e[2*i]=mp(n[t]++,t))}},Ep=e=>{let t;for(t=0;t<Xf;t++)e.dyn_ltree[2*t]=0;for(t=0;t<Jf;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},vp=e=>{e.bi_valid>8?gp(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Bp=(e,t,r,n)=>{const s=2*t,i=2*r;return e[s]<e[i]||e[s]===e[i]&&n[t]<=n[r]},_p=(e,t,r)=>{const n=e.heap[r];let s=r<<1;for(;s<=e.heap_len&&(s<e.heap_len&&Bp(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!Bp(t,n,e.heap[s],e.depth));)e.heap[r]=e.heap[s],r=s,s<<=1;e.heap[r]=n},Cp=(e,t,r)=>{let n,s,i,o,a=0;if(0!==e.sym_next)do{n=255&e.pending_buf[e.sym_buf+a++],n+=(255&e.pending_buf[e.sym_buf+a++])<<8,s=e.pending_buf[e.sym_buf+a++],0===n?wp(e,s,t):(i=ap[s],wp(e,i+Yf+1,t),o=ep[i],0!==o&&(s-=Ap[i],yp(e,s,o)),n--,i=pp(n),wp(e,i,r),o=tp[i],0!==o&&(n-=cp[i],yp(e,n,o)))}while(a<e.sym_next);wp(e,256,t)},Sp=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,s=t.stat_desc.has_stree,i=t.stat_desc.elems;let o,a,A,c=-1;for(e.heap_len=0,e.heap_max=573,o=0;o<i;o++)0!==r[2*o]?(e.heap[++e.heap_len]=c=o,e.depth[o]=0):r[2*o+1]=0;for(;e.heap_len<2;)A=e.heap[++e.heap_len]=c<2?++c:0,r[2*A]=1,e.depth[A]=0,e.opt_len--,s&&(e.static_len-=n[2*A+1]);for(t.max_code=c,o=e.heap_len>>1;o>=1;o--)_p(e,r,o);A=i;do{o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],_p(e,r,1),a=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=a,r[2*A]=r[2*o]+r[2*a],e.depth[A]=(e.depth[o]>=e.depth[a]?e.depth[o]:e.depth[a])+1,r[2*o+1]=r[2*a+1]=A,e.heap[1]=A++,_p(e,r,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const r=t.dyn_tree,n=t.max_code,s=t.stat_desc.static_tree,i=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,A=t.stat_desc.max_length;let c,l,u,h,d,f,p=0;for(h=0;h<=Zf;h++)e.bl_count[h]=0;for(r[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)l=e.heap[c],h=r[2*r[2*l+1]+1]+1,h>A&&(h=A,p++),r[2*l+1]=h,l>n||(e.bl_count[h]++,d=0,l>=a&&(d=o[l-a]),f=r[2*l],e.opt_len+=f*(h+d),i&&(e.static_len+=f*(s[2*l+1]+d)));if(0!==p){do{for(h=A-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[A]--,p-=2}while(p>0);for(h=A;0!==h;h--)for(l=e.bl_count[h];0!==l;)u=e.heap[--c],u>n||(r[2*u+1]!==h&&(e.opt_len+=(h-r[2*u+1])*r[2*u],r[2*u+1]=h),l--)}})(e,t),bp(r,c,e.bl_count)},Ip=(e,t,r)=>{let n,s,i=-1,o=t[1],a=0,A=7,c=4;for(0===o&&(A=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)s=o,o=t[2*(n+1)+1],++a<A&&s===o||(a<c?e.bl_tree[2*s]+=a:0!==s?(s!==i&&e.bl_tree[2*s]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,i=s,0===o?(A=138,c=3):s===o?(A=6,c=3):(A=7,c=4))},Tp=(e,t,r)=>{let n,s,i=-1,o=t[1],a=0,A=7,c=4;for(0===o&&(A=138,c=3),n=0;n<=r;n++)if(s=o,o=t[2*(n+1)+1],!(++a<A&&s===o)){if(a<c)do{wp(e,s,e.bl_tree)}while(0!=--a);else 0!==s?(s!==i&&(wp(e,s,e.bl_tree),a--),wp(e,16,e.bl_tree),yp(e,a-3,2)):a<=10?(wp(e,17,e.bl_tree),yp(e,a-3,3)):(wp(e,18,e.bl_tree),yp(e,a-11,7));a=0,i=s,0===o?(A=138,c=3):s===o?(A=6,c=3):(A=7,c=4)}};let Rp=!1;const kp=(e,t,r,n)=>{yp(e,0+(n?1:0),3),vp(e),gp(e,r),gp(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r};var Up=e=>{Rp||((()=>{let e,t,r,n,s;const i=new Array(16);for(r=0,n=0;n<28;n++)for(Ap[n]=r,e=0;e<1<<ep[n];e++)ap[r++]=n;for(ap[r-1]=n,s=0,n=0;n<16;n++)for(cp[n]=s,e=0;e<1<<tp[n];e++)op[s++]=n;for(s>>=7;n<Jf;n++)for(cp[n]=s<<7,e=0;e<1<<tp[n]-7;e++)op[256+s++]=n;for(t=0;t<=Zf;t++)i[t]=0;for(e=0;e<=143;)sp[2*e+1]=8,e++,i[8]++;for(;e<=255;)sp[2*e+1]=9,e++,i[9]++;for(;e<=279;)sp[2*e+1]=7,e++,i[7]++;for(;e<=287;)sp[2*e+1]=8,e++,i[8]++;for(bp(sp,287,i),e=0;e<Jf;e++)ip[2*e+1]=5,ip[2*e]=mp(e,5);up=new lp(sp,ep,257,Xf,Zf),hp=new lp(ip,tp,0,Jf,Zf),dp=new lp(new Array(0),rp,0,19,7)})(),Rp=!0),e.l_desc=new fp(e.dyn_ltree,up),e.d_desc=new fp(e.dyn_dtree,hp),e.bl_desc=new fp(e.bl_tree,dp),e.bi_buf=0,e.bi_valid=0,Ep(e)},Dp=(e,t,r,n)=>{let s,i,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<Yf;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),Sp(e,e.l_desc),Sp(e,e.d_desc),o=(e=>{let t;for(Ip(e,e.dyn_ltree,e.l_desc.max_code),Ip(e,e.dyn_dtree,e.d_desc.max_code),Sp(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*np[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),s=e.opt_len+3+7>>>3,i=e.static_len+3+7>>>3,i<=s&&(s=i)):s=i=r+5,r+4<=s&&-1!==t?kp(e,t,r,n):4===e.strategy||i===s?(yp(e,2+(n?1:0),3),Cp(e,sp,ip)):(yp(e,4+(n?1:0),3),((e,t,r,n)=>{let s;for(yp(e,t-257,5),yp(e,r-1,5),yp(e,n-4,4),s=0;s<n;s++)yp(e,e.bl_tree[2*np[s]+1],3);Tp(e,e.dyn_ltree,t-1),Tp(e,e.dyn_dtree,r-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),Cp(e,e.dyn_ltree,e.dyn_dtree)),Ep(e),n&&vp(e)},Pp={_tr_init:Up,_tr_stored_block:kp,_tr_flush_block:Dp,_tr_tally:(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(ap[r]+Yf+1)]++,e.dyn_dtree[2*pp(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{yp(e,2,3),wp(e,256,sp),(e=>{16===e.bi_valid?(gp(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}};var Lp=(e,t,r,n)=>{let s=65535&e|0,i=e>>>16&65535|0,o=0;for(;0!==r;){o=r>2e3?2e3:r,r-=o;do{s=s+t[n++]|0,i=i+s|0}while(--o);s%=65521,i%=65521}return s|i<<16|0};const Np=new Uint32Array((()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t})());var Op=(e,t,r,n)=>{const s=Np,i=n+r;e^=-1;for(let r=n;r<i;r++)e=e>>>8^s[255&(e^t[r])];return-1^e},Fp={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Qp={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:xp,_tr_stored_block:Mp,_tr_flush_block:Hp,_tr_tally:Kp,_tr_align:Vp}=Pp,{Z_NO_FLUSH:zp,Z_PARTIAL_FLUSH:jp,Z_FULL_FLUSH:Gp,Z_FINISH:$p,Z_BLOCK:qp,Z_OK:Wp,Z_STREAM_END:Yp,Z_STREAM_ERROR:Xp,Z_DATA_ERROR:Jp,Z_BUF_ERROR:Zp,Z_DEFAULT_COMPRESSION:eg,Z_FILTERED:tg,Z_HUFFMAN_ONLY:rg,Z_RLE:ng,Z_FIXED:sg,Z_DEFAULT_STRATEGY:ig,Z_UNKNOWN:og,Z_DEFLATED:ag}=Qp,Ag=258,cg=262,lg=42,ug=113,hg=666,dg=(e,t)=>(e.msg=Fp[t],t),fg=e=>2*e-(e>4?9:0),pg=e=>{let t=e.length;for(;--t>=0;)e[t]=0},gg=e=>{let t,r,n,s=e.w_size;t=e.hash_size,n=t;do{r=e.head[--n],e.head[n]=r>=s?r-s:0}while(--t);t=s,n=t;do{r=e.prev[--n],e.prev[n]=r>=s?r-s:0}while(--t)};let yg=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask;const wg=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))},mg=(e,t)=>{Hp(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,wg(e.strm)},bg=(e,t)=>{e.pending_buf[e.pending++]=t},Eg=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},vg=(e,t,r,n)=>{let s=e.avail_in;return s>n&&(s=n),0===s?0:(e.avail_in-=s,t.set(e.input.subarray(e.next_in,e.next_in+s),r),1===e.state.wrap?e.adler=Lp(e.adler,t,s,r):2===e.state.wrap&&(e.adler=Op(e.adler,t,s,r)),e.next_in+=s,e.total_in+=s,s)},Bg=(e,t)=>{let r,n,s=e.max_chain_length,i=e.strstart,o=e.prev_length,a=e.nice_match;const A=e.strstart>e.w_size-cg?e.strstart-(e.w_size-cg):0,c=e.window,l=e.w_mask,u=e.prev,h=e.strstart+Ag;let d=c[i+o-1],f=c[i+o];e.prev_length>=e.good_match&&(s>>=2),a>e.lookahead&&(a=e.lookahead);do{if(r=t,c[r+o]===f&&c[r+o-1]===d&&c[r]===c[i]&&c[++r]===c[i+1]){i+=2,r++;do{}while(c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&i<h);if(n=Ag-(h-i),i=h-Ag,n>o){if(e.match_start=t,o=n,n>=a)break;d=c[i+o-1],f=c[i+o]}}}while((t=u[t&l])>A&&0!=--s);return o<=e.lookahead?o:e.lookahead},_g=e=>{const t=e.w_size;let r,n,s;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-cg)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),gg(e),n+=t),0===e.strm.avail_in)break;if(r=vg(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=3)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=yg(e,e.ins_h,e.window[s+1]);e.insert&&(e.ins_h=yg(e,e.ins_h,e.window[s+3-1]),e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<cg&&0!==e.strm.avail_in)},Cg=(e,t)=>{let r,n,s,i=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,o=0,a=e.strm.avail_in;do{if(r=65535,s=e.bi_valid+42>>3,e.strm.avail_out<s)break;if(s=e.strm.avail_out-s,n=e.strstart-e.block_start,r>n+e.strm.avail_in&&(r=n+e.strm.avail_in),r>s&&(r=s),r<i&&(0===r&&t!==$p||t===zp||r!==n+e.strm.avail_in))break;o=t===$p&&r===n+e.strm.avail_in?1:0,Mp(e,0,0,o),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,wg(e.strm),n&&(n>r&&(n=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+n),e.strm.next_out),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n,e.block_start+=n,r-=n),r&&(vg(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(0===o);return a-=e.strm.avail_in,a&&(a>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=a&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-a,e.strm.next_in),e.strstart),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),o?4:t!==zp&&t!==$p&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(s=e.window_size-e.strstart,e.strm.avail_in>s&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,s+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),s>e.strm.avail_in&&(s=e.strm.avail_in),s&&(vg(e.strm,e.window,e.strstart,s),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.high_water<e.strstart&&(e.high_water=e.strstart),s=e.bi_valid+42>>3,s=e.pending_buf_size-s>65535?65535:e.pending_buf_size-s,i=s>e.w_size?e.w_size:s,n=e.strstart-e.block_start,(n>=i||(n||t===$p)&&t!==zp&&0===e.strm.avail_in&&n<=s)&&(r=n>s?s:n,o=t===$p&&0===e.strm.avail_in&&r===n?1:0,Mp(e,e.block_start,r,o),e.block_start+=r,wg(e.strm)),o?3:1)},Sg=(e,t)=>{let r,n;for(;;){if(e.lookahead<cg){if(_g(e),e.lookahead<cg&&t===zp)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=yg(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-cg&&(e.match_length=Bg(e,r)),e.match_length>=3)if(n=Kp(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=yg(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=yg(e,e.ins_h,e.window[e.strstart+1]);else n=Kp(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(mg(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===$p?(mg(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(mg(e,!1),0===e.strm.avail_out)?1:2},Ig=(e,t)=>{let r,n,s;for(;;){if(e.lookahead<cg){if(_g(e),e.lookahead<cg&&t===zp)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=yg(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-cg&&(e.match_length=Bg(e,r),e.match_length<=5&&(e.strategy===tg||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-3,n=Kp(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=s&&(e.ins_h=yg(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(mg(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(n=Kp(e,0,e.window[e.strstart-1]),n&&mg(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=Kp(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===$p?(mg(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(mg(e,!1),0===e.strm.avail_out)?1:2};function Tg(e,t,r,n,s){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=s}const Rg=[new Tg(0,0,0,0,Cg),new Tg(4,4,8,4,Sg),new Tg(4,5,16,8,Sg),new Tg(4,6,32,32,Sg),new Tg(4,4,16,16,Ig),new Tg(8,16,32,32,Ig),new Tg(8,16,128,128,Ig),new Tg(8,32,128,256,Ig),new Tg(32,128,258,1024,Ig),new Tg(32,258,258,4096,Ig)];function kg(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ag,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),pg(this.dyn_ltree),pg(this.dyn_dtree),pg(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),pg(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),pg(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Ug=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==lg&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==ug&&t.status!==hg?1:0},Dg=e=>{if(Ug(e))return dg(e,Xp);e.total_in=e.total_out=0,e.data_type=og;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?lg:ug,e.adler=2===t.wrap?0:1,t.last_flush=-2,xp(t),Wp},Pg=e=>{const t=Dg(e);var r;return t===Wp&&((r=e.state).window_size=2*r.w_size,pg(r.head),r.max_lazy_match=Rg[r.level].max_lazy,r.good_match=Rg[r.level].good_length,r.nice_match=Rg[r.level].nice_length,r.max_chain_length=Rg[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=2,r.match_available=0,r.ins_h=0),t},Lg=(e,t,r,n,s,i)=>{if(!e)return Xp;let o=1;if(t===eg&&(t=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),s<1||s>9||r!==ag||n<8||n>15||t<0||t>9||i<0||i>sg||8===n&&1!==o)return dg(e,Xp);8===n&&(n=9);const a=new kg;return e.state=a,a.strm=e,a.status=lg,a.wrap=o,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=s+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<s+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=t,a.strategy=i,a.method=r,Pg(e)};var Ng=(e,t)=>{if(Ug(e)||t>qp||t<0)return e?dg(e,Xp):Xp;const r=e.state;if(!e.output||0!==e.avail_in&&!e.input||r.status===hg&&t!==$p)return dg(e,0===e.avail_out?Zp:Xp);const n=r.last_flush;if(r.last_flush=t,0!==r.pending){if(wg(e),0===e.avail_out)return r.last_flush=-1,Wp}else if(0===e.avail_in&&fg(t)<=fg(n)&&t!==$p)return dg(e,Zp);if(r.status===hg&&0!==e.avail_in)return dg(e,Zp);if(r.status===lg&&0===r.wrap&&(r.status=ug),r.status===lg){let t=ag+(r.w_bits-8<<4)<<8,n=-1;if(n=r.strategy>=rg||r.level<2?0:r.level<6?1:6===r.level?2:3,t|=n<<6,0!==r.strstart&&(t|=32),t+=31-t%31,Eg(r,t),0!==r.strstart&&(Eg(r,e.adler>>>16),Eg(r,65535&e.adler)),e.adler=1,r.status=ug,wg(e),0!==r.pending)return r.last_flush=-1,Wp}if(57===r.status)if(e.adler=0,bg(r,31),bg(r,139),bg(r,8),r.gzhead)bg(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),bg(r,255&r.gzhead.time),bg(r,r.gzhead.time>>8&255),bg(r,r.gzhead.time>>16&255),bg(r,r.gzhead.time>>24&255),bg(r,9===r.level?2:r.strategy>=rg||r.level<2?4:0),bg(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(bg(r,255&r.gzhead.extra.length),bg(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=Op(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69;else if(bg(r,0),bg(r,0),bg(r,0),bg(r,0),bg(r,0),bg(r,9===r.level?2:r.strategy>=rg||r.level<2?4:0),bg(r,3),r.status=ug,wg(e),0!==r.pending)return r.last_flush=-1,Wp;if(69===r.status){if(r.gzhead.extra){let t=r.pending,n=(65535&r.gzhead.extra.length)-r.gzindex;for(;r.pending+n>r.pending_buf_size;){let s=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+s),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>t&&(e.adler=Op(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex+=s,wg(e),0!==r.pending)return r.last_flush=-1,Wp;t=0,n-=s}let s=new Uint8Array(r.gzhead.extra);r.pending_buf.set(s.subarray(r.gzindex,r.gzindex+n),r.pending),r.pending+=n,r.gzhead.hcrc&&r.pending>t&&(e.adler=Op(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex=0}r.status=73}if(73===r.status){if(r.gzhead.name){let t,n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=Op(e.adler,r.pending_buf,r.pending-n,n)),wg(e),0!==r.pending)return r.last_flush=-1,Wp;n=0}t=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,bg(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>n&&(e.adler=Op(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex=0}r.status=91}if(91===r.status){if(r.gzhead.comment){let t,n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=Op(e.adler,r.pending_buf,r.pending-n,n)),wg(e),0!==r.pending)return r.last_flush=-1,Wp;n=0}t=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,bg(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>n&&(e.adler=Op(e.adler,r.pending_buf,r.pending-n,n))}r.status=103}if(103===r.status){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(wg(e),0!==r.pending))return r.last_flush=-1,Wp;bg(r,255&e.adler),bg(r,e.adler>>8&255),e.adler=0}if(r.status=ug,wg(e),0!==r.pending)return r.last_flush=-1,Wp}if(0!==e.avail_in||0!==r.lookahead||t!==zp&&r.status!==hg){let n=0===r.level?Cg(r,t):r.strategy===rg?((e,t)=>{let r;for(;;){if(0===e.lookahead&&(_g(e),0===e.lookahead)){if(t===zp)return 1;break}if(e.match_length=0,r=Kp(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(mg(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===$p?(mg(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(mg(e,!1),0===e.strm.avail_out)?1:2})(r,t):r.strategy===ng?((e,t)=>{let r,n,s,i;const o=e.window;for(;;){if(e.lookahead<=Ag){if(_g(e),e.lookahead<=Ag&&t===zp)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(s=e.strstart-1,n=o[s],n===o[++s]&&n===o[++s]&&n===o[++s])){i=e.strstart+Ag;do{}while(n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&s<i);e.match_length=Ag-(i-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=Kp(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=Kp(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(mg(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===$p?(mg(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(mg(e,!1),0===e.strm.avail_out)?1:2})(r,t):Rg[r.level].func(r,t);if(3!==n&&4!==n||(r.status=hg),1===n||3===n)return 0===e.avail_out&&(r.last_flush=-1),Wp;if(2===n&&(t===jp?Vp(r):t!==qp&&(Mp(r,0,0,!1),t===Gp&&(pg(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),wg(e),0===e.avail_out))return r.last_flush=-1,Wp}return t!==$p?Wp:r.wrap<=0?Yp:(2===r.wrap?(bg(r,255&e.adler),bg(r,e.adler>>8&255),bg(r,e.adler>>16&255),bg(r,e.adler>>24&255),bg(r,255&e.total_in),bg(r,e.total_in>>8&255),bg(r,e.total_in>>16&255),bg(r,e.total_in>>24&255)):(Eg(r,e.adler>>>16),Eg(r,65535&e.adler)),wg(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?Wp:Yp)},Og=(e,t)=>{let r=t.length;if(Ug(e))return Xp;const n=e.state,s=n.wrap;if(2===s||1===s&&n.status!==lg||n.lookahead)return Xp;if(1===s&&(e.adler=Lp(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){0===s&&(pg(n.head),n.strstart=0,n.block_start=0,n.insert=0);let e=new Uint8Array(n.w_size);e.set(t.subarray(r-n.w_size,r),0),t=e,r=n.w_size}const i=e.avail_in,o=e.next_in,a=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,_g(n);n.lookahead>=3;){let e=n.strstart,t=n.lookahead-2;do{n.ins_h=yg(n,n.ins_h,n.window[e+3-1]),n.prev[e&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=e,e++}while(--t);n.strstart=e,n.lookahead=2,_g(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=o,e.input=a,e.avail_in=i,n.wrap=s,Wp},Fg={deflateInit:(e,t)=>Lg(e,t,ag,15,8,ig),deflateInit2:Lg,deflateReset:Pg,deflateResetKeep:Dg,deflateSetHeader:(e,t)=>Ug(e)||2!==e.state.wrap?Xp:(e.state.gzhead=t,Wp),deflate:Ng,deflateEnd:e=>{if(Ug(e))return Xp;const t=e.state.status;return e.state=null,t===ug?dg(e,Jp):Wp},deflateSetDictionary:Og,deflateInfo:"pako deflate (from Nodeca project)"};const Qg=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var xg=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(const t in r)Qg(r,t)&&(e[t]=r[t])}}return e},Mg=e=>{let t=0;for(let r=0,n=e.length;r<n;r++)t+=e[r].length;const r=new Uint8Array(t);for(let t=0,n=0,s=e.length;t<s;t++){let s=e[t];r.set(s,n),n+=s.length}return r};let Hg=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){Hg=!1}const Kg=new Uint8Array(256);for(let e=0;e<256;e++)Kg[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Kg[254]=Kg[254]=1;var Vg=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,r,n,s,i,o=e.length,a=0;for(s=0;s<o;s++)r=e.charCodeAt(s),55296==(64512&r)&&s+1<o&&(n=e.charCodeAt(s+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),s++)),a+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(a),i=0,s=0;i<a;s++)r=e.charCodeAt(s),55296==(64512&r)&&s+1<o&&(n=e.charCodeAt(s+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),s++)),r<128?t[i++]=r:r<2048?(t[i++]=192|r>>>6,t[i++]=128|63&r):r<65536?(t[i++]=224|r>>>12,t[i++]=128|r>>>6&63,t[i++]=128|63&r):(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63,t[i++]=128|r>>>6&63,t[i++]=128|63&r);return t},zg=(e,t)=>{const r=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let n,s;const i=new Array(2*r);for(s=0,n=0;n<r;){let t=e[n++];if(t<128){i[s++]=t;continue}let o=Kg[t];if(o>4)i[s++]=65533,n+=o-1;else{for(t&=2===o?31:3===o?15:7;o>1&&n<r;)t=t<<6|63&e[n++],o--;o>1?i[s++]=65533:t<65536?i[s++]=t:(t-=65536,i[s++]=55296|t>>10&1023,i[s++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&Hg)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r})(i,s)},jg=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let r=t-1;for(;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+Kg[e[r]]>t?r:t};var Gg=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const $g=Object.prototype.toString,{Z_NO_FLUSH:qg,Z_SYNC_FLUSH:Wg,Z_FULL_FLUSH:Yg,Z_FINISH:Xg,Z_OK:Jg,Z_STREAM_END:Zg,Z_DEFAULT_COMPRESSION:ey,Z_DEFAULT_STRATEGY:ty,Z_DEFLATED:ry}=Qp;function ny(e){this.options=xg({level:ey,method:ry,chunkSize:16384,windowBits:15,memLevel:8,strategy:ty},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Gg,this.strm.avail_out=0;let r=Fg.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==Jg)throw new Error(Fp[r]);if(t.header&&Fg.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?Vg(t.dictionary):"[object ArrayBuffer]"===$g.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,r=Fg.deflateSetDictionary(this.strm,e),r!==Jg)throw new Error(Fp[r]);this._dict_set=!0}}function sy(e,t){const r=new ny(t);if(r.push(e,!0),r.err)throw r.msg||Fp[r.err];return r.result}ny.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize;let s,i;if(this.ended)return!1;for(i=t===~~t?t:!0===t?Xg:qg,"string"==typeof e?r.input=Vg(e):"[object ArrayBuffer]"===$g.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(i===Wg||i===Yg)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(s=Fg.deflate(r,i),s===Zg)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),s=Fg.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===Jg;if(0!==r.avail_out){if(i>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},ny.prototype.onData=function(e){this.chunks.push(e)},ny.prototype.onEnd=function(e){e===Jg&&(this.result=Mg(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var iy={Deflate:ny,deflate:sy,deflateRaw:function(e,t){return(t=t||{}).raw=!0,sy(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,sy(e,t)},constants:Qp};const oy=16209;var ay=function(e,t){let r,n,s,i,o,a,A,c,l,u,h,d,f,p,g,y,w,m,b,E,v,B,_,C;const S=e.state;r=e.next_in,_=e.input,n=r+(e.avail_in-5),s=e.next_out,C=e.output,i=s-(t-e.avail_out),o=s+(e.avail_out-257),a=S.dmax,A=S.wsize,c=S.whave,l=S.wnext,u=S.window,h=S.hold,d=S.bits,f=S.lencode,p=S.distcode,g=(1<<S.lenbits)-1,y=(1<<S.distbits)-1;e:do{d<15&&(h+=_[r++]<<d,d+=8,h+=_[r++]<<d,d+=8),w=f[h&g];t:for(;;){if(m=w>>>24,h>>>=m,d-=m,m=w>>>16&255,0===m)C[s++]=65535&w;else{if(!(16&m)){if(0==(64&m)){w=f[(65535&w)+(h&(1<<m)-1)];continue t}if(32&m){S.mode=16191;break e}e.msg="invalid literal/length code",S.mode=oy;break e}b=65535&w,m&=15,m&&(d<m&&(h+=_[r++]<<d,d+=8),b+=h&(1<<m)-1,h>>>=m,d-=m),d<15&&(h+=_[r++]<<d,d+=8,h+=_[r++]<<d,d+=8),w=p[h&y];r:for(;;){if(m=w>>>24,h>>>=m,d-=m,m=w>>>16&255,!(16&m)){if(0==(64&m)){w=p[(65535&w)+(h&(1<<m)-1)];continue r}e.msg="invalid distance code",S.mode=oy;break e}if(E=65535&w,m&=15,d<m&&(h+=_[r++]<<d,d+=8,d<m&&(h+=_[r++]<<d,d+=8)),E+=h&(1<<m)-1,E>a){e.msg="invalid distance too far back",S.mode=oy;break e}if(h>>>=m,d-=m,m=s-i,E>m){if(m=E-m,m>c&&S.sane){e.msg="invalid distance too far back",S.mode=oy;break e}if(v=0,B=u,0===l){if(v+=A-m,m<b){b-=m;do{C[s++]=u[v++]}while(--m);v=s-E,B=C}}else if(l<m){if(v+=A+l-m,m-=l,m<b){b-=m;do{C[s++]=u[v++]}while(--m);if(v=0,l<b){m=l,b-=m;do{C[s++]=u[v++]}while(--m);v=s-E,B=C}}}else if(v+=l-m,m<b){b-=m;do{C[s++]=u[v++]}while(--m);v=s-E,B=C}for(;b>2;)C[s++]=B[v++],C[s++]=B[v++],C[s++]=B[v++],b-=3;b&&(C[s++]=B[v++],b>1&&(C[s++]=B[v++]))}else{v=s-E;do{C[s++]=C[v++],C[s++]=C[v++],C[s++]=C[v++],b-=3}while(b>2);b&&(C[s++]=C[v++],b>1&&(C[s++]=C[v++]))}break}}break}}while(r<n&&s<o);b=d>>3,r-=b,d-=b<<3,h&=(1<<d)-1,e.next_in=r,e.next_out=s,e.avail_in=r<n?n-r+5:5-(r-n),e.avail_out=s<o?o-s+257:257-(s-o),S.hold=h,S.bits=d};const Ay=15,cy=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ly=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),uy=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),hy=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var dy=(e,t,r,n,s,i,o,a)=>{const A=a.bits;let c,l,u,h,d,f,p=0,g=0,y=0,w=0,m=0,b=0,E=0,v=0,B=0,_=0,C=null;const S=new Uint16Array(16),I=new Uint16Array(16);let T,R,k,U=null;for(p=0;p<=Ay;p++)S[p]=0;for(g=0;g<n;g++)S[t[r+g]]++;for(m=A,w=Ay;w>=1&&0===S[w];w--);if(m>w&&(m=w),0===w)return s[i++]=20971520,s[i++]=20971520,a.bits=1,0;for(y=1;y<w&&0===S[y];y++);for(m<y&&(m=y),v=1,p=1;p<=Ay;p++)if(v<<=1,v-=S[p],v<0)return-1;if(v>0&&(0===e||1!==w))return-1;for(I[1]=0,p=1;p<Ay;p++)I[p+1]=I[p]+S[p];for(g=0;g<n;g++)0!==t[r+g]&&(o[I[t[r+g]]++]=g);if(0===e?(C=U=o,f=20):1===e?(C=cy,U=ly,f=257):(C=uy,U=hy,f=0),_=0,g=0,p=y,d=i,b=m,E=0,u=-1,B=1<<m,h=B-1,1===e&&B>852||2===e&&B>592)return 1;for(;;){T=p-E,o[g]+1<f?(R=0,k=o[g]):o[g]>=f?(R=U[o[g]-f],k=C[o[g]-f]):(R=96,k=0),c=1<<p-E,l=1<<b,y=l;do{l-=c,s[d+(_>>E)+l]=T<<24|R<<16|k|0}while(0!==l);for(c=1<<p-1;_&c;)c>>=1;if(0!==c?(_&=c-1,_+=c):_=0,g++,0==--S[p]){if(p===w)break;p=t[r+o[g]]}if(p>m&&(_&h)!==u){for(0===E&&(E=m),d+=y,b=p-E,v=1<<b;b+E<w&&(v-=S[b+E],!(v<=0));)b++,v<<=1;if(B+=1<<b,1===e&&B>852||2===e&&B>592)return 1;u=_&h,s[u]=m<<24|b<<16|d-i|0}}return 0!==_&&(s[d+_]=p-E<<24|64<<16|0),a.bits=m,0};const{Z_FINISH:fy,Z_BLOCK:py,Z_TREES:gy,Z_OK:yy,Z_STREAM_END:wy,Z_NEED_DICT:my,Z_STREAM_ERROR:by,Z_DATA_ERROR:Ey,Z_MEM_ERROR:vy,Z_BUF_ERROR:By,Z_DEFLATED:_y}=Qp,Cy=16180,Sy=16190,Iy=16191,Ty=16192,Ry=16194,ky=16199,Uy=16200,Dy=16206,Py=16209,Ly=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function Ny(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Oy=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Cy||t.mode>16211?1:0},Fy=e=>{if(Oy(e))return by;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Cy,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,yy},Qy=e=>{if(Oy(e))return by;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Fy(e)},xy=(e,t)=>{let r;if(Oy(e))return by;const n=e.state;return t<0?(r=0,t=-t):(r=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?by:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,Qy(e))},My=(e,t)=>{if(!e)return by;const r=new Ny;e.state=r,r.strm=e,r.window=null,r.mode=Cy;const n=xy(e,t);return n!==yy&&(e.state=null),n};let Hy,Ky,Vy=!0;const zy=e=>{if(Vy){Hy=new Int32Array(512),Ky=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(dy(1,e.lens,0,288,Hy,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;dy(2,e.lens,0,32,Ky,0,e.work,{bits:5}),Vy=!1}e.lencode=Hy,e.lenbits=9,e.distcode=Ky,e.distbits=5},jy=(e,t,r,n)=>{let s;const i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(t.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):(s=i.wsize-i.wnext,s>n&&(s=n),i.window.set(t.subarray(r-n,r-n+s),i.wnext),(n-=s)?(i.window.set(t.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0};var Gy=(e,t)=>{let r,n,s,i,o,a,A,c,l,u,h,d,f,p,g,y,w,m,b,E,v,B,_=0;const C=new Uint8Array(4);let S,I;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Oy(e)||!e.output||!e.input&&0!==e.avail_in)return by;r=e.state,r.mode===Iy&&(r.mode=Ty),o=e.next_out,s=e.output,A=e.avail_out,i=e.next_in,n=e.input,a=e.avail_in,c=r.hold,l=r.bits,u=a,h=A,B=yy;e:for(;;)switch(r.mode){case Cy:if(0===r.wrap){r.mode=Ty;break}for(;l<16;){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}if(2&r.wrap&&35615===c){0===r.wbits&&(r.wbits=15),r.check=0,C[0]=255&c,C[1]=c>>>8&255,r.check=Op(r.check,C,2,0),c=0,l=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=Py;break}if((15&c)!==_y){e.msg="unknown compression method",r.mode=Py;break}if(c>>>=4,l-=4,v=8+(15&c),0===r.wbits&&(r.wbits=v),v>15||v>r.wbits){e.msg="invalid window size",r.mode=Py;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=512&c?16189:Iy,c=0,l=0;break;case 16181:for(;l<16;){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}if(r.flags=c,(255&r.flags)!==_y){e.msg="unknown compression method",r.mode=Py;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=Py;break}r.head&&(r.head.text=c>>8&1),512&r.flags&&4&r.wrap&&(C[0]=255&c,C[1]=c>>>8&255,r.check=Op(r.check,C,2,0)),c=0,l=0,r.mode=16182;case 16182:for(;l<32;){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}r.head&&(r.head.time=c),512&r.flags&&4&r.wrap&&(C[0]=255&c,C[1]=c>>>8&255,C[2]=c>>>16&255,C[3]=c>>>24&255,r.check=Op(r.check,C,4,0)),c=0,l=0,r.mode=16183;case 16183:for(;l<16;){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}r.head&&(r.head.xflags=255&c,r.head.os=c>>8),512&r.flags&&4&r.wrap&&(C[0]=255&c,C[1]=c>>>8&255,r.check=Op(r.check,C,2,0)),c=0,l=0,r.mode=16184;case 16184:if(1024&r.flags){for(;l<16;){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}r.length=c,r.head&&(r.head.extra_len=c),512&r.flags&&4&r.wrap&&(C[0]=255&c,C[1]=c>>>8&255,r.check=Op(r.check,C,2,0)),c=0,l=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&r.flags&&(d=r.length,d>a&&(d=a),d&&(r.head&&(v=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+d),v)),512&r.flags&&4&r.wrap&&(r.check=Op(r.check,n,d,i)),a-=d,i+=d,r.length-=d),r.length))break e;r.length=0,r.mode=16186;case 16186:if(2048&r.flags){if(0===a)break e;d=0;do{v=n[i+d++],r.head&&v&&r.length<65536&&(r.head.name+=String.fromCharCode(v))}while(v&&d<a);if(512&r.flags&&4&r.wrap&&(r.check=Op(r.check,n,d,i)),a-=d,i+=d,v)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&r.flags){if(0===a)break e;d=0;do{v=n[i+d++],r.head&&v&&r.length<65536&&(r.head.comment+=String.fromCharCode(v))}while(v&&d<a);if(512&r.flags&&4&r.wrap&&(r.check=Op(r.check,n,d,i)),a-=d,i+=d,v)break e}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&r.flags){for(;l<16;){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}if(4&r.wrap&&c!==(65535&r.check)){e.msg="header crc mismatch",r.mode=Py;break}c=0,l=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Iy;break;case 16189:for(;l<32;){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}e.adler=r.check=Ly(c),c=0,l=0,r.mode=Sy;case Sy:if(0===r.havedict)return e.next_out=o,e.avail_out=A,e.next_in=i,e.avail_in=a,r.hold=c,r.bits=l,my;e.adler=r.check=1,r.mode=Iy;case Iy:if(t===py||t===gy)break e;case Ty:if(r.last){c>>>=7&l,l-=7&l,r.mode=Dy;break}for(;l<3;){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}switch(r.last=1&c,c>>>=1,l-=1,3&c){case 0:r.mode=16193;break;case 1:if(zy(r),r.mode=ky,t===gy){c>>>=2,l-=2;break e}break;case 2:r.mode=16196;break;case 3:e.msg="invalid block type",r.mode=Py}c>>>=2,l-=2;break;case 16193:for(c>>>=7&l,l-=7&l;l<32;){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Py;break}if(r.length=65535&c,c=0,l=0,r.mode=Ry,t===gy)break e;case Ry:r.mode=16195;case 16195:if(d=r.length,d){if(d>a&&(d=a),d>A&&(d=A),0===d)break e;s.set(n.subarray(i,i+d),o),a-=d,i+=d,A-=d,o+=d,r.length-=d;break}r.mode=Iy;break;case 16196:for(;l<14;){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}if(r.nlen=257+(31&c),c>>>=5,l-=5,r.ndist=1+(31&c),c>>>=5,l-=5,r.ncode=4+(15&c),c>>>=4,l-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Py;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;l<3;){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}r.lens[T[r.have++]]=7&c,c>>>=3,l-=3}for(;r.have<19;)r.lens[T[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,S={bits:r.lenbits},B=dy(0,r.lens,0,19,r.lencode,0,r.work,S),r.lenbits=S.bits,B){e.msg="invalid code lengths set",r.mode=Py;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;_=r.lencode[c&(1<<r.lenbits)-1],g=_>>>24,y=_>>>16&255,w=65535&_,!(g<=l);){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}if(w<16)c>>>=g,l-=g,r.lens[r.have++]=w;else{if(16===w){for(I=g+2;l<I;){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}if(c>>>=g,l-=g,0===r.have){e.msg="invalid bit length repeat",r.mode=Py;break}v=r.lens[r.have-1],d=3+(3&c),c>>>=2,l-=2}else if(17===w){for(I=g+3;l<I;){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}c>>>=g,l-=g,v=0,d=3+(7&c),c>>>=3,l-=3}else{for(I=g+7;l<I;){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}c>>>=g,l-=g,v=0,d=11+(127&c),c>>>=7,l-=7}if(r.have+d>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Py;break}for(;d--;)r.lens[r.have++]=v}}if(r.mode===Py)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=Py;break}if(r.lenbits=9,S={bits:r.lenbits},B=dy(1,r.lens,0,r.nlen,r.lencode,0,r.work,S),r.lenbits=S.bits,B){e.msg="invalid literal/lengths set",r.mode=Py;break}if(r.distbits=6,r.distcode=r.distdyn,S={bits:r.distbits},B=dy(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,S),r.distbits=S.bits,B){e.msg="invalid distances set",r.mode=Py;break}if(r.mode=ky,t===gy)break e;case ky:r.mode=Uy;case Uy:if(a>=6&&A>=258){e.next_out=o,e.avail_out=A,e.next_in=i,e.avail_in=a,r.hold=c,r.bits=l,ay(e,h),o=e.next_out,s=e.output,A=e.avail_out,i=e.next_in,n=e.input,a=e.avail_in,c=r.hold,l=r.bits,r.mode===Iy&&(r.back=-1);break}for(r.back=0;_=r.lencode[c&(1<<r.lenbits)-1],g=_>>>24,y=_>>>16&255,w=65535&_,!(g<=l);){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}if(y&&0==(240&y)){for(m=g,b=y,E=w;_=r.lencode[E+((c&(1<<m+b)-1)>>m)],g=_>>>24,y=_>>>16&255,w=65535&_,!(m+g<=l);){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}c>>>=m,l-=m,r.back+=m}if(c>>>=g,l-=g,r.back+=g,r.length=w,0===y){r.mode=16205;break}if(32&y){r.back=-1,r.mode=Iy;break}if(64&y){e.msg="invalid literal/length code",r.mode=Py;break}r.extra=15&y,r.mode=16201;case 16201:if(r.extra){for(I=r.extra;l<I;){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,l-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;_=r.distcode[c&(1<<r.distbits)-1],g=_>>>24,y=_>>>16&255,w=65535&_,!(g<=l);){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}if(0==(240&y)){for(m=g,b=y,E=w;_=r.distcode[E+((c&(1<<m+b)-1)>>m)],g=_>>>24,y=_>>>16&255,w=65535&_,!(m+g<=l);){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}c>>>=m,l-=m,r.back+=m}if(c>>>=g,l-=g,r.back+=g,64&y){e.msg="invalid distance code",r.mode=Py;break}r.offset=w,r.extra=15&y,r.mode=16203;case 16203:if(r.extra){for(I=r.extra;l<I;){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,l-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Py;break}r.mode=16204;case 16204:if(0===A)break e;if(d=h-A,r.offset>d){if(d=r.offset-d,d>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Py;break}d>r.wnext?(d-=r.wnext,f=r.wsize-d):f=r.wnext-d,d>r.length&&(d=r.length),p=r.window}else p=s,f=o-r.offset,d=r.length;d>A&&(d=A),A-=d,r.length-=d;do{s[o++]=p[f++]}while(--d);0===r.length&&(r.mode=Uy);break;case 16205:if(0===A)break e;s[o++]=r.length,A--,r.mode=Uy;break;case Dy:if(r.wrap){for(;l<32;){if(0===a)break e;a--,c|=n[i++]<<l,l+=8}if(h-=A,e.total_out+=h,r.total+=h,4&r.wrap&&h&&(e.adler=r.check=r.flags?Op(r.check,s,h,o-h):Lp(r.check,s,h,o-h)),h=A,4&r.wrap&&(r.flags?c:Ly(c))!==r.check){e.msg="incorrect data check",r.mode=Py;break}c=0,l=0}r.mode=16207;case 16207:if(r.wrap&&r.flags){for(;l<32;){if(0===a)break e;a--,c+=n[i++]<<l,l+=8}if(4&r.wrap&&c!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=Py;break}c=0,l=0}r.mode=16208;case 16208:B=wy;break e;case Py:B=Ey;break e;case 16210:return vy;default:return by}return e.next_out=o,e.avail_out=A,e.next_in=i,e.avail_in=a,r.hold=c,r.bits=l,(r.wsize||h!==e.avail_out&&r.mode<Py&&(r.mode<Dy||t!==fy))&&jy(e,e.output,e.next_out,h-e.avail_out),u-=e.avail_in,h-=e.avail_out,e.total_in+=u,e.total_out+=h,r.total+=h,4&r.wrap&&h&&(e.adler=r.check=r.flags?Op(r.check,s,h,e.next_out-h):Lp(r.check,s,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Iy?128:0)+(r.mode===ky||r.mode===Ry?256:0),(0===u&&0===h||t===fy)&&B===yy&&(B=By),B},$y={inflateReset:Qy,inflateReset2:xy,inflateResetKeep:Fy,inflateInit:e=>My(e,15),inflateInit2:My,inflate:Gy,inflateEnd:e=>{if(Oy(e))return by;let t=e.state;return t.window&&(t.window=null),e.state=null,yy},inflateGetHeader:(e,t)=>{if(Oy(e))return by;const r=e.state;return 0==(2&r.wrap)?by:(r.head=t,t.done=!1,yy)},inflateSetDictionary:(e,t)=>{const r=t.length;let n,s,i;return Oy(e)?by:(n=e.state,0!==n.wrap&&n.mode!==Sy?by:n.mode===Sy&&(s=1,s=Lp(s,t,r,0),s!==n.check)?Ey:(i=jy(e,t,r,r),i?(n.mode=16210,vy):(n.havedict=1,yy)))},inflateInfo:"pako inflate (from Nodeca project)"};var qy=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Wy=Object.prototype.toString,{Z_NO_FLUSH:Yy,Z_FINISH:Xy,Z_OK:Jy,Z_STREAM_END:Zy,Z_NEED_DICT:ew,Z_STREAM_ERROR:tw,Z_DATA_ERROR:rw,Z_MEM_ERROR:nw}=Qp;function sw(e){this.options=xg({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Gg,this.strm.avail_out=0;let r=$y.inflateInit2(this.strm,t.windowBits);if(r!==Jy)throw new Error(Fp[r]);if(this.header=new qy,$y.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Vg(t.dictionary):"[object ArrayBuffer]"===Wy.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=$y.inflateSetDictionary(this.strm,t.dictionary),r!==Jy)))throw new Error(Fp[r])}function iw(e,t){const r=new sw(t);if(r.push(e),r.err)throw r.msg||Fp[r.err];return r.result}sw.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let i,o,a;if(this.ended)return!1;for(o=t===~~t?t:!0===t?Xy:Yy,"[object ArrayBuffer]"===Wy.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),i=$y.inflate(r,o),i===ew&&s&&(i=$y.inflateSetDictionary(r,s),i===Jy?i=$y.inflate(r,o):i===rw&&(i=ew));r.avail_in>0&&i===Zy&&r.state.wrap>0&&0!==e[r.next_in];)$y.inflateReset(r),i=$y.inflate(r,o);switch(i){case tw:case rw:case ew:case nw:return this.onEnd(i),this.ended=!0,!1}if(a=r.avail_out,r.next_out&&(0===r.avail_out||i===Zy))if("string"===this.options.to){let e=jg(r.output,r.next_out),t=r.next_out-e,s=zg(r.output,e);r.next_out=t,r.avail_out=n-t,t&&r.output.set(r.output.subarray(e,e+t),0),this.onData(s)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(i!==Jy||0!==a){if(i===Zy)return i=$y.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(0===r.avail_in)break}}return!0},sw.prototype.onData=function(e){this.chunks.push(e)},sw.prototype.onEnd=function(e){e===Jy&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Mg(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var ow={Inflate:sw,inflate:iw,inflateRaw:function(e,t){return(t=t||{}).raw=!0,iw(e,t)},ungzip:iw,constants:Qp};const{Deflate:aw,deflate:Aw,deflateRaw:cw,gzip:lw}=iy,{Inflate:uw,inflate:hw,inflateRaw:dw,ungzip:fw}=ow;var pw={Deflate:aw,deflate:Aw,deflateRaw:cw,gzip:lw,Inflate:uw,inflate:hw,inflateRaw:dw,ungzip:fw,constants:Qp};class gw{constructor({preload:e,repo:t,hashers:r,options:n}){const s=of({preload:e,repo:t,options:n,hashers:r});this.addAll=s,this.add=function({addAll:e}){return async function(t,r={}){const n=await Da(e(nd(t),r));if(null==n)throw Error("Failed to add a file, if you see this please report a bug");return n}}({addAll:s}),this.cat=function({repo:e,preload:t}){return go((async function*(r,n={}){if(r=Eo(r),!1!==n.preload){const e=r.split("/");t(Ve.parse(e[0]))}const s=await Cf(r,e.blocks,n);if("directory"===s.type)throw new Error("this dag node is a directory");if(!s.content)throw new Error("this dag node has no content");yield*s.content(n)}))}({repo:t,preload:e}),this.get=function({repo:e,preload:t}){return go((async function*(r,n={}){if(null!=n.compressionLevel&&(n.compressionLevel<-1||n.compressionLevel>9))throw ie(new Error("Compression level must be between -1 and 9"),"ERR_INVALID_PARAMS");if(!1!==n.preload){let e;try{e=Eo(r).split("/")}catch(e){throw ie(e,"ERR_INVALID_PATH")}t(Ve.parse(e[0]))}const s=Ve.asCID(r)||r,i=await Cf(s,e.blocks,n);if("file"===i.type||"raw"===i.type){const e=[];return n.compress&&!0!==n.archive?e.push(i.content):e.push([{header:{name:i.path,mode:"file"===i.type&&i.unixfs.mode,mtime:"file"===i.type&&i.unixfs.mtime?new Date(1e3*i.unixfs.mtime.secs):void 0,size:i.size,type:"file"},body:i.content()}],qf()),n.compress&&e.push((async function*(e){const t=await Tf(e);yield pw.gzip(t,{level:n.compressionLevel||6})})),void(yield*zh(...e))}if("directory"!==i.type)throw ie(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");{const t=[Sf(s,e.blocks,n),async function*(e){for await(const t of e){const e={header:{name:t.path,size:t.size}};if("file"===t.type)e.header.type="file",e.header.mode=null!=t.unixfs.mode?t.unixfs.mode:void 0,e.header.mtime=t.unixfs.mtime?new Date(1e3*t.unixfs.mtime.secs):void 0,e.body=t.content();else if("raw"===t.type)e.header.type="file",e.body=t.content();else{if("directory"!==t.type)throw ie(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");e.header.type="directory",e.header.mode=null!=t.unixfs.mode?t.unixfs.mode:void 0,e.header.mtime=t.unixfs.mtime?new Date(1e3*t.unixfs.mtime.secs):void 0}yield e}},qf()];if(n.compress){if(!n.archive)throw ie(new Error("file is not regular"),"ERR_INVALID_PATH");n.compress&&t.push((async function*(e){const t=await Tf(e);yield pw.gzip(t,{level:n.compressionLevel||6})}))}yield*zh(...t)}}))}({repo:t,preload:e}),this.ls=function({repo:e,preload:t}){return go((async function*(r,n={}){const s=Eo(r),i=s.split("/");!1!==n.preload&&t(Ve.parse(i[0]));const o=Ve.asCID(s)||s,a=await Cf(o,e.blocks,n);if("file"!==a.type){if("directory"!==a.type)throw ie(new Error(`Unknown UnixFS type ${a.type}`),"ERR_UNKNOWN_UNIXFS_TYPE");for await(const e of a.content())yield Bo(e)}else yield Bo(a)}))}({repo:t,preload:e})}}const yw="0.18.0";const ww=se("ipfs:components:id");function mw({peerId:e,network:t}){return go((async function(r={}){const n=t.try();if(!n){if(r.peerId)throw new us;if(null==e.publicKey)throw ie(new Error("Public key missing"),"ERR_MISSING_PUBLIC_KEY");return{id:e,publicKey:Ts(e.publicKey,"base64pad"),addresses:[],agentVersion:`js-ipfs/${yw}`,protocolVersion:"9000",protocols:[]}}const{libp2p:s}=n,i=r.peerId?r.peerId:e,o=await async function(e,t,r){let n=await t.peerStore.get(e);n||(n=await async function(e,t,r){if(null==t.dht)throw ie(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");for await(const n of t.dht.findPeer(e,r))if("FINAL_PEER"===n.name)break;const n=await t.peerStore.get(e);if(!n)throw ie(new Error("Could not find peer"),"ERR_NOT_FOUND");return n}(e,t,r));let s=e.publicKey?e.publicKey:await t.peerStore.keyBook.get(e);if(null==s)try{s=await t.getPublicKey(e,r)}catch(t){ww.error("Could not load public key for",e.toString(),t)}return{...n,publicKey:s,metadata:n.metadata||new Map,addresses:n.addresses.map((e=>e.multiaddr))}}(i,s,r),a=Ts(o.metadata.get("AgentVersion")||new Uint8Array),A=Ts(o.metadata.get("ProtocolVersion")||new Uint8Array),c=o.id.toString();return{id:i,publicKey:o.publicKey?Ts(o.publicKey,"base64pad"):"",addresses:(o.addresses||[]).map((e=>{const t=e.toString();return t.endsWith(`/p2p/${c}`)?t:`${t}/p2p/${c}`})).sort().map((e=>mi(e))),agentVersion:a,protocolVersion:A,protocols:(o.protocols||[]).sort()}}))}var bw=function(e,t,r){var n,s,i;Array.isArray(t)&&(n=t.slice(0));"string"==typeof t&&(n=t.split("."));"symbol"==typeof t&&(n=[t]);if(!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");if(!(s=n.pop()))return!1;Ew(s);for(;i=n.shift();)if(Ew(i),void 0===e[i]&&(e[i]={}),!(e=e[i])||"object"!=typeof e)return!1;return e[s]=r,!0};function Ew(e){if("__proto__"==e||"constructor"==e||"prototype"==e)throw new Error("setting of prototype values not supported")}const vw={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:e=>(bw(e,"Discovery.MDNS.Enabled",!1),bw(e,"Discovery.webRTCStar.Enabled",!1),e.Swarm={...e.Swarm||{},DisableNatPortMap:!0},e)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:e=>(bw(e,"Discovery.MDNS.Enabled",!0),bw(e,"Discovery.webRTCStar.Enabled",!0),bw(e,"Swarm",{...e.Swarm||{},DisableNatPortMap:!1}),e)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:e=>{const t={Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:5,HighWater:20},DisableNatPortMap:!0},Routing:{Type:"dhtclient"}};return bw(e,"Addresses.API",t.Addresses.API?"/ip4/127.0.0.1/tcp/0":""),bw(e,"Addresses.Gateway",t.Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),bw(e,"Addresses.Swarm",t.Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),bw(e,"Addresses.Delegates",[]),bw(e,"Bootstrap",[]),bw(e,"Discovery.MDNS.Enabled",!1),bw(e,"Discovery.webRTCStar.Enabled",!1),bw(e,"Swarm",{...e.Swarm||{},DisableNatPortMap:!0}),e}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:e=>{const t={Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:5,HighWater:20},DisableNatPortMap:!0},Routing:{Type:"dhtclient"}};return bw(e,"Addresses.API",t.Addresses.API),bw(e,"Addresses.Gateway",t.Addresses.Gateway),bw(e,"Addresses.Swarm",t.Addresses.Swarm),bw(e,"Addresses.Delegates",t.Addresses.Delegates),bw(e,"Bootstrap",t.Bootstrap),bw(e,"Discovery.MDNS.Enabled",t.Discovery.MDNS.Enabled),bw(e,"Discovery.webRTCStar.Enabled",t.Discovery.webRTCStar.Enabled),bw(e,"Swarm",{...e.Swarm||{},DisableNatPortMap:!1}),e}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:e=>{const t=e.Swarm||{},r=t.ConnMgr||{};return r.LowWater=20,r.HighWater=40,t.ConnMgr=r,e.Swarm=t,e}},"default-power":{description:'Inverse of "lowpower" profile.',transform:e=>{const t={Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:5,HighWater:20},DisableNatPortMap:!0},Routing:{Type:"dhtclient"}};return e.Swarm=t.Swarm,e}}},Bw=se("ipfs:core:config");async function _w(e){return Object.keys(vw).map((e=>({name:e,description:vw[e].description})))}function Cw({enumerable:e=!0,configurable:t=!1}={}){return{enumerable:e,configurable:t,writable:!1}}function*Sw(e,t){if(null!=t&&"object"==typeof t)if(Array.isArray(t))for(const[r,n]of t.entries()){const t=[...e,r],s=Ve.asCID(n);s?yield[t.join("/"),s]:"object"==typeof n&&(yield*Iw(n,t))}else{const r=Ve.asCID(t);r?yield[e.join("/"),r]:yield*Iw(t,e)}}function*Iw(e,t){if(null==e||e instanceof Uint8Array)return;const r=Ve.asCID(e);r&&(yield[t.join("/"),r]);for(const[r,n]of Object.entries(e)){const e=[...t,r];yield*Sw(e,n)}}function*Tw(e,t){if(Array.isArray(t))for(const[r,n]of t.entries()){const t=[...e,r];yield t.join("/"),"object"!=typeof n||Ve.asCID(n)||(yield*Rw(n,t))}else yield*Rw(t,e)}function*Rw(e,t){if(null!=e&&"object"==typeof e)for(const[r,n]of Object.entries(e)){const e=[...t,r];yield e.join("/"),null==n||n instanceof Uint8Array||"object"!=typeof n||Ve.asCID(n)||(yield*Tw(e,n))}}class kw{constructor({cid:e,bytes:t,value:r}){if(!e||!t||void 0===r)throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=r,this.asBlock=this,Object.defineProperties(this,{cid:Cw(),bytes:Cw(),value:Cw(),asBlock:Cw()})}links(){return Iw(this.value,[])}tree(){return Rw(this.value,[])}get(e="/"){return function(e,t){let r=e;for(const[e,n]of t.entries()){if(r=r[n],null==r)throw new Error(`Object has no property at ${t.slice(0,e+1).map((e=>`[${JSON.stringify(e)}]`)).join("")}`);const s=Ve.asCID(r);if(s)return{value:s,remaining:t.slice(e+1).join("/")}}return{value:r}}(this.value,e.split("/").filter(Boolean))}}function Uw({bytes:e,cid:t,value:r,codec:n}){const s=void 0!==r?r:n&&n.decode(e);if(void 0===s)throw new Error('Missing required argument, must either provide "value" or "codec"');return new kw({cid:t,bytes:e,value:s})}function Dw(e){const t=Zr({version:1,roots:e}),r=Os.encode(t.length),n=new Uint8Array(r.length+t.length);return n.set(r,0),n.set(t,r.length),n}function Pw(){}const Lw={Null:e=>null===e,Int:e=>Number.isInteger(e),Float:e=>"number"==typeof e&&Number.isFinite(e),String:e=>"string"==typeof e,Bool:e=>"boolean"==typeof e,Bytes:e=>e instanceof Uint8Array,Link:e=>!Lw.Null(e)&&"object"==typeof e&&e.asCID===e,List:e=>Array.isArray(e),Map:e=>!Lw.Null(e)&&"object"==typeof e&&e.asCID!==e&&!Lw.List(e)&&!Lw.Bytes(e)},Nw={Int:Lw.Int,"CarHeader > version":e=>Nw.Int(e),"CarHeader > roots (anon) > valueType (anon)":Lw.Link,"CarHeader > roots (anon)":e=>Lw.List(e)&&Array.prototype.every.call(e,Nw["CarHeader > roots (anon) > valueType (anon)"]),"CarHeader > roots":e=>Nw["CarHeader > roots (anon)"](e),CarHeader:e=>{const t=e&&Object.keys(e);return Lw.Map(e)&&["version"].every((e=>t.includes(e)))&&Object.entries(e).every((([e,t])=>Nw["CarHeader > "+e]&&Nw["CarHeader > "+e](t)))}},Ow=Nw.CarHeader,Fw=18,Qw=32,xw=112;function Mw(e,t){if(!e.length)throw new Error("Unexpected end of data");const r=Os.decode(e);return t.seek(Os.decode.bytes),r}async function Hw(e,t){const r=Mw(await e.upTo(8),e);if(0===r)throw new Error("Invalid CAR header (zero length)");const n=await e.exactly(r,!0),s=en(n);if(!Ow(s))throw new Error("Invalid CAR header format");if(1!==s.version&&2!==s.version||void 0!==t&&s.version!==t)throw new Error(`Invalid CAR version: ${s.version}${void 0!==t?` (expected ${t})`:""}`);const i=Array.isArray(s.roots);if(1===s.version&&!i||2===s.version&&i)throw new Error("Invalid CAR header format");if(1===s.version)return s;const o=function(e){const t=new DataView(e.buffer,e.byteOffset,e.byteLength);let r=0;return{version:2,characteristics:[t.getBigUint64(r,!0),t.getBigUint64(r+=8,!0)],dataOffset:Number(t.getBigUint64(r+=8,!0)),dataSize:Number(t.getBigUint64(r+=8,!0)),indexOffset:Number(t.getBigUint64(r+=8,!0))}}(await e.exactly(40,!0));e.seek(o.dataOffset-e.pos);const a=await Hw(e,1);return Object.assign(a,o)}async function Kw(e){const t=await e.exactly(2,!1);if(t[0]===Fw&&t[1]===Qw){const t=await e.exactly(34,!0),r=Qe(t);return Ve.create(0,xw,r)}const r=Mw(await e.upTo(8),e);if(1!==r)throw new Error(`Unexpected CID version (${r})`);const n=Mw(await e.upTo(8),e),s=await e.exactly(function(e){Os.decode(e);const t=Os.decode.bytes,r=Os.decode(e.subarray(Os.decode.bytes));return t+Os.decode.bytes+r}(await e.upTo(8)),!0),i=Qe(s);return Ve.create(r,n,i)}async function Vw(e){const t=e.pos;let r=Mw(await e.upTo(8),e);if(0===r)throw new Error("Invalid CAR section (zero length)");r+=e.pos-t;return{cid:await Kw(e),length:r,blockLength:r-Number(e.pos-t)}}async function zw(e){const{cid:t,blockLength:r}=await Vw(e);return{bytes:await e.exactly(r,!0),cid:t}}async function jw(e){const t=e.pos,{cid:r,length:n,blockLength:s}=await Vw(e),i={cid:r,length:n,blockLength:s,offset:t,blockOffset:e.pos};return e.seek(i.blockLength),i}function Gw(e){const t=(async()=>{const t=await Hw(e);if(2===t.version){const r=e.pos-t.dataOffset;e=function(e,t){let r=0;return{async upTo(n){let s=await e.upTo(n);return s.length+r>t&&(s=s.subarray(0,t-r)),s},async exactly(n,s=!1){const i=await e.exactly(n,s);if(i.length+r>t)throw new Error("Unexpected end of data");return s&&(r+=n),i},seek(t){r+=t,e.seek(t)},get pos(){return e.pos}}}(e,t.dataSize-r)}return t})();return{header:()=>t,async*blocks(){for(await t;(await e.upTo(8)).length>0;)yield await zw(e)},async*blocksIndex(){for(await t;(await e.upTo(8)).length>0;)yield await jw(e)}}}function $w(e){let t=0;return{async upTo(r){return e.subarray(t,t+Math.min(r,e.length-t))},async exactly(r,n=!1){if(r>e.length-t)throw new Error("Unexpected end of data");const s=e.subarray(t,t+r);return n&&(t+=r),s},seek(e){t+=e},get pos(){return t}}}function qw(e){const t=e[Symbol.asyncIterator]();return function(e){let t=0,r=0,n=0,s=new Uint8Array(0);const i=async t=>{r=s.length-n;const i=[s.subarray(n)];for(;r<t;){const t=await e();if(null==t)break;r<0?t.length>r&&i.push(t.subarray(-r)):i.push(t),r+=t.length}s=new Uint8Array(i.reduce(((e,t)=>e+t.length),0));let o=0;for(const e of i)s.set(e,o),o+=e.length;n=0};return{async upTo(e){return s.length-n<e&&await i(e),s.subarray(n,n+Math.min(s.length-n,e))},async exactly(e,r=!1){if(s.length-n<e&&await i(e),s.length-n<e)throw new Error("Unexpected end of data");const o=s.subarray(n,n+e);return r&&(t+=e,n+=e),o},seek(e){t+=e,n+=e},get pos(){return t}}}((async function(){const e=await t.next();return e.done?null:e.value}))}class Ww{constructor(e,t){this._encoder=t,this._mutex=t.setRoots(e),this._ended=!1}async put(e){if(!(e.bytes instanceof Uint8Array&&e.cid))throw new TypeError("Can only write {cid, bytes} objects");if(this._ended)throw new Error("Already closed");const t=Ve.asCID(e.cid);if(!t)throw new TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then((()=>this._encoder.writeBlock({cid:t,bytes:e.bytes}))),this._mutex}async close(){if(this._ended)throw new Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(e){e=function(e){if(void 0===e)return[];if(!Array.isArray(e)){const t=Ve.asCID(e);if(!t)throw new TypeError("roots must be a single CID or an array of CIDs");return[t]}const t=[];for(const r of e){const e=Ve.asCID(r);if(!e)throw new TypeError("roots must be a single CID or an array of CIDs");t.push(e)}return t}(e);const{encoder:t,iterator:r}=Xw();return{writer:new Ww(e,t),out:new Yw(r)}}static createAppender(){const{encoder:e,iterator:t}=Xw();e.setRoots=()=>Promise.resolve();return{writer:new Ww([],e),out:new Yw(t)}}static async updateRootsInBytes(e,t){const r=$w(e);await Hw(r);const n=Dw(t);if(Number(r.pos)!==n.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${r.pos} bytes, new header is ${n.length} bytes)`);return e.set(n,0),e}}class Yw{constructor(e){this._iterator=e}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}}function Xw(){const e=function(){const e=[];let t=null,r=Pw,n=!1,s=null,i=Pw;const o=()=>(t||(t=new Promise((e=>{r=()=>{t=null,r=Pw,e()}}))),t),a={write(t){e.push(t);const r=o();return i(),r},async end(){n=!0;const e=o();i(),await e}},A={async next(){const t=e.shift();return t?(0===e.length&&r(),{done:!1,value:t}):n?(r(),{done:!0,value:void 0}):(s||(s=new Promise((e=>{i=()=>(s=null,i=Pw,e(A.next()))}))),s)}};return{writer:a,iterator:A}}(),{writer:t,iterator:r}=e,n=function(e){return{async setRoots(t){const r=Dw(t);await e.write(r)},async writeBlock(t){const{cid:r,bytes:n}=t;await e.write(new Uint8Array(Os.encode(r.bytes.length+n.length))),await e.write(r.bytes),n.length&&await e.write(n)},async close(){await e.end()}}}(t);return{encoder:n,iterator:r}}const Jw=async({cid:e,load:t,seen:r})=>{r=r||new Set;const n=e.toString(V);if(r.has(n))return;const s=await t(e);if(r.add(n),null!==s)for(const[,e]of s.links())await Jw({cid:e,load:t,seen:r})},Zw=se("ipfs:components:dag:import"),em=[Yn,rs];function tm({repo:e,preload:t,codecs:r}){return go((async function*(n,s={}){!1!==s.preload&&t(n);const i=Ve.asCID(n);if(!i)throw new Error(`Unexpected error converting CID type: ${n}`);Zw(`Exporting ${i} as car`);const{writer:o,out:a}=await Ww.create([i]);let A=null;(async()=>{try{const t=function(e,t,r,n){return async s=>{const i=await n.getCodec(s.code);if(!i)throw new Error(`Can't decode links in block with codec 0x${s.code.toString(16)} to form complete DAG`);const o=await e.blocks.get(s,r);return Zw(`Adding block ${s} to car`),await t.put({cid:s,bytes:o}),em.includes(s.code)?null:Uw({bytes:o,cid:s,codec:i})}}(e,o,{signal:s.signal,timeout:s.timeout},r);await Jw({cid:i,load:t})}catch(e){A=e}finally{o.close()}})();for await(const e of a){if(A)break;yield e}if(A)throw A}))}async function rm(e){for await(const t of e)return t}class nm{constructor(e,t,r){this._version=e,this._roots=t,this._iterable=r,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}}class sm extends nm{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(e){const{version:t,roots:r,iterator:n}=await om(e);return new sm(t,r,n)}static async fromIterable(e){const{version:t,roots:r,iterator:n}=await am(e);return new sm(t,r,n)}}class im extends(null){[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");this._decoded=!0;const e=this._iterable[Symbol.asyncIterator]();return{async next(){const t=await e.next();return t.done?t:{done:!1,value:t.value.cid}}}}static async fromBytes(e){const{version:t,roots:r,iterator:n}=await om(e);return new im(t,r,n)}static async fromIterable(e){const{version:t,roots:r,iterator:n}=await am(e);return new im(t,r,n)}}async function om(e){if(!(e instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return Am($w(e))}async function am(e){if(!e||"function"!=typeof e[Symbol.asyncIterator])throw new TypeError("fromIterable() requires an async iterable");return Am(qw(e))}async function Am(e){const t=Gw(e),{version:r,roots:n}=await t.header();return{version:r,roots:n,iterator:t.blocks()}}const cm=se("ipfs:components:dag:import");async function lm(e,t,r){const n=await sm.fromIterable(r),s=await n.getRoots();return await Qu(e.blocks.putMany(xh(n,(({cid:e,bytes:t})=>(cm(`Import block ${e}`),{key:e,value:t}))),{signal:t.signal})),s}class um{constructor({repo:e,codecs:t,hashers:r,preload:n}){this.export=tm({repo:e,preload:n,codecs:t}),this.get=function({codecs:e,repo:t,preload:r}){return go((async function(n,s={}){if(!1!==s.preload&&r(n),s.path){const r=s.localResolve?await rm(Co(n,s.path,e,t,s)):await Da(Co(n,s.path,e,t,s));if(!r)throw ie(new Error("Not found"),"ERR_NOT_FOUND");return r}const i=await e.getCodec(n.code),o=await t.blocks.get(n,s);return{value:i.decode(o),remainderPath:""}}))}({codecs:t,repo:e,preload:n}),this.import=function({repo:e}){return go((async function*(t,r={}){const n=await e.gcLock.readLock();try{const s={signal:r.signal,timeout:r.timeout},i=qh(t),{value:o,done:a}=await i.peek();if(a)return;let A;o&&i.push(o),A=o instanceof Uint8Array?[i]:i;for await(const t of A){const n=await lm(e,s,t);if(!1!==r.pinRoots)for(const t of n){let r="";try{await e.blocks.has(t)?(cm(`Pinning root ${t}`),await e.pins.pinRecursively(t)):r="blockstore: block not found"}catch(e){r=e.message}yield{root:{cid:t,pinErrorMsg:r}}}}}finally{n()}}))}({repo:e}),this.resolve=function({repo:e,codecs:t,preload:r}){return go((async function(n,s={}){const{cid:i}=wo(n);return!1!==s.preload&&r(i),vo(e,t,n,s)}))}({repo:e,codecs:t,preload:n}),this.put=function({repo:e,codecs:t,hashers:r,preload:n}){return go((async function(s,i={}){const o=i.pin?await e.gcLock.readLock():null;try{const a=await t.getCodec(i.storeCodec||"dag-cbor");if(!a)throw new Error(`Unknown storeCodec ${i.storeCodec}, please configure additional BlockCodecs for this IPFS instance`);if(i.inputCodec){if(!(s instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");const e=await t.getCodec(i.inputCodec);if(!e)throw new Error(`Unknown inputCodec ${i.inputCodec}, please configure additional BlockCodecs for this IPFS instance`);s=e.decode(s)}const A=null!=i.version?i.version:1,c=await r.getHasher(i.hashAlg||"sha2-256");if(!c)throw new Error(`Unknown hash algorithm ${i.hashAlg}, please configure additional MultihashHashers for this IPFS instance`);const l=a.encode(s),u=await c.digest(l),h=Ve.create(A,a.code,u);return await e.blocks.put(h,l,{signal:i.signal}),i.pin&&await e.pins.pinRecursively(h),!1!==i.preload&&n(h),h}finally{o&&o()}}))}({repo:e,codecs:t,hashers:r,preload:n})}}const hm=(e,t)=>t,dm={ip4:hm,ip6:(e,t,r,n)=>1===n.length&&"ip6"===n[0].protocol?t:`[${t}]`,tcp:(e,t,r,n,s)=>n.some((e=>["http","https","ws","wss"].includes(e.protocol)))?`${e}:${t}`:((e,t,r,n)=>{if(null!=n&&!1===n.assumeHttp)return`tcp://${e}:${t}`;let s="tcp",i=`:${t}`;return"tcp"===r[r.length-1].protocol&&(s="443"===t?"https":"http",i="443"===t||"80"===t?"":i),`${s}://${e}${i}`})(e,t,n,s),udp:(e,t)=>`udp://${e}:${t}`,dnsaddr:hm,dns4:hm,dns6:hm,ipfs:(e,t)=>`${e}/ipfs/${t}`,p2p:(e,t)=>`${e}/p2p/${t}`,http:e=>`http://${e}`,https:e=>`https://${e}`,ws:e=>`ws://${e}`,wss:e=>`wss://${e}`,"p2p-websocket-star":e=>`${e}/p2p-websocket-star`,"p2p-webrtc-star":e=>`${e}/p2p-webrtc-star`,"p2p-webrtc-direct":e=>`${e}/p2p-webrtc-direct`};function fm(e,t){const r=mi(e),n=r.toString().split("/").slice(1);return r.tuples().map((e=>({protocol:n.shift()??"",content:null!=e[1]?n.shift()??"":""}))).reduce(((e,r,n,s)=>{const i=dm[r.protocol];if(null==i)throw new Error(`Unsupported protocol ${r.protocol}`);return i(e,r.content,n,s,t)}),"")}const pm=se("ipfs:preload"),gm=new(ua.default?ua.default:ua)({concurrency:4});function ym(e,t={}){return pm(e),gm.add((async()=>{const r=(await ha.post(e,{signal:t.signal})).body.getReader();try{for(;;){const{done:e}=await r.read();if(e)return}}finally{r.releaseLock()}}))}const wm=se("ipfs:preload");function mm(e={}){if(e.enabled=Boolean(e.enabled),e.addresses=e.addresses||[],e.cache=e.cache||1e3,!e.enabled||!e.addresses.length){wm("preload disabled");const e=()=>{};return Object.assign(e,{start:()=>{},stop:()=>{}})}let t=!0,r=[];const n=e.addresses.map((e=>fm(e))),s=Io(e.cache),i=async e=>{try{if(t)throw new Error(`preload ${e} but preloader is not started`);const i=e.toString();if(s.has(i))return;s.set(i,!0);const o=function(e){if(!Array.isArray(e))throw new TypeError("Expected an array, got "+typeof e);for(let t=(e=[...e]).length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e}(n);let a=!1;const A=Date.now();for(const e of o){if(t)throw new Error(`preload aborted for ${i}`);let n;try{n=new AbortController,r=r.concat(n),await ym(`${e}/api/v0/refs?r=true&arg=${encodeURIComponent(i)}`,{signal:n.signal}),a=!0}catch(e){"aborted"!==e.type&&wm.error(e)}finally{r=r.filter((e=>e!==n))}if(a)break}wm(`${a?"":"un"}successfully preloaded ${i} in ${Date.now()-A}ms`)}catch(e){wm.error(e)}};return i.start=()=>{t=!1},i.stop=()=>{t=!0,wm(`aborting ${r.length} pending preload request(s)`),r.forEach((e=>e.abort())),r=[]},i}const bm=se("ipfs:mfs-preload");class Em extends Error{constructor(e){super(e),this.name="TimeoutError"}}class vm extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const Bm=e=>void 0===globalThis.DOMException?new vm(e):new DOMException(e),_m=e=>{const t=void 0===e.reason?Bm("This operation was aborted."):e.reason;return t instanceof Error?t:Bm(t)};function Cm(e,t){const{milliseconds:r,fallback:n,message:s,customTimers:i={setTimeout:setTimeout,clearTimeout:clearTimeout}}=t;let o;const a=new Promise(((a,A)=>{if("number"!=typeof r||1!==Math.sign(r))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${r}\``);if(r===Number.POSITIVE_INFINITY)return void a(e);if(t.signal){const{signal:e}=t;e.aborted&&A(_m(e)),e.addEventListener("abort",(()=>{A(_m(e))}))}const c=new Em;o=i.setTimeout.call(void 0,(()=>{if(n)try{a(n())}catch(e){A(e)}else"function"==typeof e.cancel&&e.cancel(),!1===s?a():s instanceof Error?A(s):(c.message=s??`Promise timed out after ${r} milliseconds`,A(c))}),r),(async()=>{try{a(await e)}catch(e){A(e)}finally{i.clearTimeout.call(void 0,o)}})()}));return a.clear=()=>{i.clearTimeout.call(void 0,o),o=void 0},a}const Sm="lock:worker:request-read",Im="lock:worker:release-read",Tm="lock:master:grant-read",Rm="lock:worker:request-write",km="lock:worker:release-write",Um="lock:master:grant-write",Dm={},Pm=e=>{e.addEventListener("message",(t=>{Pm.dispatchEvent("message",e,t)})),null!=e.port&&e.port.addEventListener("message",(t=>{Pm.dispatchEvent("message",e,t)}))};Pm.addEventListener=(e,t)=>{null==Dm[e]&&(Dm[e]=[]),Dm[e].push(t)},Pm.removeEventListener=(e,t)=>{null!=Dm[e]&&(Dm[e]=Dm[e].filter((e=>e===t)))},Pm.dispatchEvent=function(e,t,r){null!=Dm[e]&&Dm[e].forEach((e=>e(t,r)))};var Lm=Pm;const Nm=(e,t,r,n,s)=>(i,o)=>{if(o.data.type!==r)return;const a={type:o.data.type,name:o.data.name,identifier:o.data.identifier};e.dispatchEvent(new MessageEvent(t,{data:{name:a.name,handler:async()=>(i.postMessage({type:s,name:a.name,identifier:a.identifier}),await new Promise((e=>{const t=r=>{if(null==r||null==r.data)return;const s=r.data.type,o=(r.data.name,r.data.identifier);s===n&&o===a.identifier&&(i.removeEventListener("message",t),e())};i.addEventListener("message",t)})))}}))},Om=(e,t,r,n)=>async()=>{const s=((e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),""))();return globalThis.postMessage({type:t,identifier:s,name:e}),await new Promise((t=>{const i=o=>{if(null==o||null==o.data)return;const a=o.data.type,A=o.data.identifier;a===r&&A===s&&(globalThis.removeEventListener("message",i),t((()=>{globalThis.postMessage({type:n,identifier:s,name:e})})))};globalThis.addEventListener("message",i)}))},Fm={singleProcess:!1};const Qm={};let xm;async function Mm(e,t){let r;const n=new Promise((e=>{r=e}));return e.add((async()=>await Cm((async()=>await new Promise((e=>{r((()=>{e()}))})))(),{milliseconds:t.timeout}))),await n}const Hm={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function Km(e){const t=Object.assign({},Hm,e);return null==xm&&(xm=(e=>{if(e=Object.assign({},Fm,e),Boolean(globalThis.document)||e.singleProcess){const e=new EventTarget;return Lm.addEventListener("message",Nm(e,"requestReadLock",Sm,Im,Tm)),Lm.addEventListener("message",Nm(e,"requestWriteLock",Rm,km,Um)),e}return{isWorker:!0,readLock:e=>Om(e,Sm,Tm,Im),writeLock:e=>Om(e,Rm,Um,km)}})(t),!0!==xm.isWorker&&(xm.addEventListener("requestReadLock",(e=>{null!=Qm[e.data.name]&&Qm[e.data.name].readLock().then((async t=>await e.data.handler().finally((()=>t()))))})),xm.addEventListener("requestWriteLock",(async e=>{null!=Qm[e.data.name]&&Qm[e.data.name].writeLock().then((async t=>await e.data.handler().finally((()=>t()))))})))),null==Qm[t.name]&&(Qm[t.name]=((e,t)=>{if(!0===xm.isWorker)return{readLock:xm.readLock(e,t),writeLock:xm.writeLock(e,t)};const r=new ua({concurrency:1});let n;return{async readLock(){if(null!=n)return await Mm(n,t);n=new ua({concurrency:t.concurrency,autoStart:!1});const e=n,s=Mm(n,t);return r.add((async()=>(e.start(),await e.onIdle().then((()=>{n===e&&(n=null)}))))),await s},async writeLock(){return n=null,await Mm(r,t)}}})(t.name,t)),Qm[t.name]}let Vm;function zm(e=!1){if(Vm)return Vm;const t=Km({singleProcess:e});return Vm={readLock:e=>async(...r)=>{const n=await t.readLock();try{return await e.apply(null,r)}finally{n()}},writeLock:e=>async(...r)=>{const n=await t.writeLock();try{return await e.apply(null,r)}finally{n()}}},Vm}const jm=se("ipfs:mfs:utils:with-mfs-root");async function Gm(e,t){if(t&&t.signal&&t.signal.aborted)throw ie(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});let r;await e.repo.datastore.open();try{const t=await e.repo.datastore.get(bo);r=Ve.decode(t)}catch(n){if("ERR_NOT_FOUND"!==n.code)throw n;jm("Creating new MFS root");const s=vt({Data:new me({type:"directory"}).marshal(),Links:[]}),i=await $n.digest(s);if(r=Ve.createV0(i),await e.repo.blocks.put(r,s),t&&t.signal&&t.signal.aborted)throw ie(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await e.repo.datastore.put(bo,r.bytes)}return jm(`Loaded MFS root /ipfs/${r}`),r}function $m(e=""){return(e.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean)}const qm="ipfs",Wm=async(e,t,r)=>{const n=await Gm(e,r);let s={entryType:"file"},i="";if(i=Ve.asCID(t)?`/ipfs/${t}`:t.toString(),i=i.trim(),i=i.replace(/(\/\/+)/g,"/"),i.endsWith("/")&&i.length>1&&(i=i.substring(0,i.length-1)),!i)throw ie(new Error("paths must not be empty"),"ERR_NO_PATH");if("/"!==i.substring(0,1))throw ie(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");"/"===i.substring(i.length-1)&&(i=i.substring(0,i.length-1));const o=$m(i);if(o[0]===qm){let e;e=2===o.length?`/${o.join("/")}`:`/${o.slice(0,o.length-1).join("/")}`,s={type:"ipfs",depth:o.length-2,entryType:"file",mfsPath:`/${o.join("/")}`,mfsDirectory:e,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}else{const e=`/${qm}/${n}${o.length?"/"+o.join("/"):""}`,t=`/${qm}/${n}/${o.slice(0,o.length-1).join("/")}`;s={type:"mfs",depth:o.length,entryType:"file",mfsDirectory:t,mfsPath:e,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}const a="mfs"===s.type?s.mfsPath:s.path;try{const t=await Cf(a,e.repo.blocks,r);s.cid=t.cid,s.mfsPath=`/ipfs/${t.path}`,s.entryType=t.type,s.content=t.content,"file"!==s.entryType&&"directory"!==s.entryType||"file"!==t.type&&"directory"!==t.type||(s.unixfs=t.unixfs)}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}return s.exists=Boolean(s.cid),s},Ym=I.bind({ignoreUndefined:!0}),Xm=se("ipfs:mfs:stat"),Jm={withLocal:!1};function Zm(e){return go((async function(t,r={}){r=Ym(Jm,r),Xm(`Fetching stats for ${t}`);const{type:n,cid:s,mfsPath:i}=await Wm(e,t,r),o="ipfs"===n&&s?s:i;let a;try{a=await Cf(o,e.repo.blocks)}catch(e){if("ERR_NOT_FOUND"===e.code)throw ie(new Error(`${t} does not exist`),"ERR_NOT_FOUND");throw e}if(!eb[a.type])throw new Error(`Cannot stat codec ${a.cid.code}`);return eb[a.type](a)}))}const eb={raw:e=>({cid:e.cid,size:e.node.length,cumulativeSize:e.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1}),file:e=>{const t={cid:e.cid,type:"file",size:e.unixfs.fileSize(),cumulativeSize:vt(e.node).length+(e.node.Links||[]).reduce(((e,t)=>e+(t.Tsize||0)),0),blocks:e.unixfs.blockSizes.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:e.unixfs.mode};return e.unixfs.mtime&&(t.mtime=e.unixfs.mtime),t},directory:e=>{const t={cid:e.cid,type:"directory",size:0,cumulativeSize:vt(e.node).length+(e.node.Links||[]).reduce(((e,t)=>e+(t.Tsize||0)),0),blocks:e.node.Links.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:e.unixfs.mode};return e.unixfs.mtime&&(t.mtime=e.unixfs.mtime),t},object:e=>({cid:e.cid,size:e.node.length,cumulativeSize:e.node.length,type:"file",blocks:0,local:void 0,sizeLocal:void 0,withLocality:!1}),identity:e=>({cid:e.cid,size:e.node.length,cumulativeSize:e.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1})},tb=se("ipfs:mfs:utils:to-trail");async function rb(e,t){tb(`Creating trail for path ${t}`);const r=[];for await(const n of _f(t,e.repo.blocks))r.push({name:n.name,cid:n.cid,size:n.size,type:n.type});return r}const nb=async(e,t,r)=>{r.codec||(r.codec=o),r.hasher||(r.hasher=$n),void 0===r.cidVersion&&(r.cidVersion=1),r.codec===o&&r.hasher!==$n&&(r.cidVersion=1);const n=await r.hasher.digest(e),s=Ve.create(r.cidVersion,r.codec.code,n);return r.onlyHash||await t.put(s,e,{signal:r.signal}),s},sb=ad.code;async function ib(e){return(await ad.encode(e)).subarray(0,8).reverse()}class ob{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,t){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}}class ab extends ob{constructor(e,t){super(e,t),this._bucket=zd({hashFn:ib,bits:8})}async put(e,t){await this._bucket.put(e,t)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}async*flush(e){yield*Ab(this._bucket,e,this,this.options)}}async function*Ab(e,t,r,n){const s=e._children,i=[];let o=0;for(let e=0;e<s.length;e++){const r=s.get(e);if(!r)continue;const a=e.toString(16).toUpperCase().padStart(2,"0");if(r instanceof Pd){let e;for await(const s of await Ab(r,t,null,n))e=s;if(!e)throw new Error("Could not flush sharded directory, no subshard found");i.push({Name:a,Tsize:e.size,Hash:e.cid}),o+=e.size}else if("function"==typeof r.value.flush){const e=r.value;let n;for await(const r of e.flush(t))n=r,yield n;const s=a+r.key;i.push({Name:s,Tsize:n.size,Hash:n.cid}),o+=n.size}else{const e=r.value;if(!e.cid)continue;const t=a+r.key,n=e.size;i.push({Name:t,Tsize:n,Hash:e.cid}),o+=n}}const a=Uint8Array.from(s.bitField().reverse()),A={Data:new me({type:"hamt-sharded-directory",data:a,fanout:e.tableSize(),hashType:sb,mtime:r&&r.mtime,mode:r&&r.mode}).marshal(),Links:i},c=vt(gt(A)),l=await nb(c,t,n),u=c.length+o;yield{cid:l,node:A,size:u}}const cb=se("ipfs:mfs:core:utils:hamt-utils"),lb=async(e,t,r,n)=>{if(!n.parent.Data)throw new Error("Could not update HAMT directory because parent had no data");const s=Uint8Array.from(r._children.bitField().reverse()),i=me.unmarshal(n.parent.Data),o=new me({type:"hamt-sharded-directory",data:s,fanout:r.tableSize(),hashType:sb,mode:i.mode,mtime:i.mtime}),a=await e.hashers.getHasher(n.hashAlg),A={Data:o.marshal(),Links:t.sort(((e,t)=>(e.Name||"").localeCompare(t.Name||"")))},c=vt(A),l=await a.digest(c),u=Ve.create(n.cidVersion,Et,l);return n.flush&&await e.repo.blocks.put(u,c),{node:A,cid:u,size:t.reduce(((e,t)=>e+(t.Tsize||0)),c.length)}},ub=async(e,t,r,n,s)=>{const i=new Pd({hash:r._options.hash,bits:r._options.bits},n,s);return n._putObjectAt(s,i),await db(e,t,i,r),i},hb=async e=>{const t=zd({hashFn:ib,bits:8});return await Promise.all(e.map((async e=>{const r=e.Name||"";if(2===r.length){const e=parseInt(r,16),n=new Pd({hash:t._options.hash,bits:t._options.bits},t,e);return t._putObjectAt(e,n),Promise.resolve()}return t.put(r.substring(2),{size:e.Tsize,cid:e.Hash})}))),t},db=async(e,t,r,n)=>{await Promise.all(t.map((async t=>{const s=t.Name||"";if(2===s.length){cb("Populating sub bucket",s);const i=parseInt(s,16),o=Bt(await e.repo.blocks.get(t.Hash)),a=new Pd({hash:n._options.hash,bits:n._options.bits},r,i);return r._putObjectAt(i,a),await db(e,o.Links,a,n),Promise.resolve()}return n.put(s.substring(2),{size:t.Tsize,cid:t.Hash})})))},fb=e=>e.toString(16).toUpperCase().padStart(2,"0").substring(0,2),pb=se("ipfs:mfs:core:utils:add-link");async function gb(e,t){let r=t.parent;if(t.parentCid){const n=Ve.asCID(t.parentCid);if(null===n)throw ie(new Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");if(n.code!==Et)throw ie(new Error("Unsupported codec. Only DAG-PB is supported"),"EINVALIDPARENTCID");pb(`Loading parent node ${n}`);r=Bt(await e.repo.blocks.get(n))}if(!r)throw ie(new Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(!t.cid)throw ie(new Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!t.name)throw ie(new Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(!t.size&&0!==t.size)throw ie(new Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");if(!r.Data)throw ie(new Error("Parent node with no data passed to addLink"),"ERR_INVALID_PARENT");const n=me.unmarshal(r.Data);return"hamt-sharded-directory"===n.type?(pb("Adding link to sharded directory"),mb(e,{...t,parent:r})):r.Links.length>=t.shardSplitThreshold?(pb("Converting directory to sharded directory"),yb(e,{...t,parent:r,mtime:n.mtime,mode:n.mode})):(pb(`Adding ${t.name} (${t.cid}) to regular directory`),wb(e,{...t,parent:r}))}const yb=async(e,t)=>{const r=await(async(e,t,r={})=>{const n=new ab({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mtime:r.mtime,mode:r.mode},r);for(let e=0;e<t.length;e++)await n._bucket.put(t[e].name,{size:t[e].size,cid:t[e].cid});const s=await Da(n.flush(e.repo.blocks));if(!s)throw new Error("Flushing shard yielded no result");return s})(e,t.parent.Links.map((e=>({name:e.Name||"",size:e.Tsize||0,cid:e.Hash}))).concat({name:t.name,size:t.size,cid:t.cid}),t);return pb(`Converted directory to sharded directory ${r.cid}`),r},wb=async(e,t)=>{const r=t.parent.Links.filter((e=>e.Name!==t.name));if(r.push({Name:t.name,Tsize:t.size,Hash:t.cid}),!t.parent.Data)throw ie(new Error("Parent node with no data passed to addToDirectory"),"ERR_INVALID_PARENT");const n=me.unmarshal(t.parent.Data);let s;if(n.mtime){const e=Date.now(),t=Math.floor(e/1e3);n.mtime={secs:t,nsecs:1e3*(e-1e3*t)},s=n.marshal()}else s=t.parent.Data;t.parent=gt({Data:s,Links:r});const i=await e.hashers.getHasher(t.hashAlg),o=vt(t.parent),a=await i.digest(o),A=Ve.create(t.cidVersion,Et,a);return t.flush&&await e.repo.blocks.put(A,o),{node:t.parent,cid:A,size:o.length}},mb=async(e,t)=>{const{shard:r,path:n}=await bb(e,t),s=await Da(r.flush(e.repo.blocks));if(!s)throw new Error("No result from flushing shard");const i=Bt(await e.repo.blocks.get(s.cid)),o=t.parent.Links.filter((e=>(e.Name||"").substring(0,2)!==n[0].prefix)),a=i.Links.find((e=>(e.Name||"").substring(0,2)===n[0].prefix));if(!a)throw new Error(`No link found with prefix ${n[0].prefix}`);return o.push(a),lb(e,o,n[0].bucket,t)},bb=async(e,t)=>{const r={name:t.name,cid:t.cid,size:t.size};if(!t.parent.Data)throw ie(new Error("Parent node with no data passed to addFileToShardedDirectory"),"ERR_INVALID_PARENT");const n=await hb(t.parent.Links),s=me.unmarshal(t.parent.Data),i=new ab({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mode:s.mode},t);i._bucket=n,s.mtime&&(i.mtime={secs:Math.round(Date.now()/1e3)});const o=await n._findNewBucketAndPos(r.name),a=Eb(o);a[0].node=t.parent;let A=0;for(;A<a.length;){const t=a[A];A++;const s=t.node;if(!s)throw new Error("Segment had no node");const i=s.Links.find((e=>(e.Name||"").substring(0,2)===t.prefix));if(!i){pb(`Link ${t.prefix}${r.name} will be added`),A=a.length;break}if(i.Name===`${t.prefix}${r.name}`){pb(`Link ${t.prefix}${r.name} will be replaced`),A=a.length;break}if((i.Name||"").length>2){pb(`Link ${i.Name} ${i.Hash} will be replaced with a subshard`),A=a.length;break}pb(`Found subshard ${t.prefix}`);const o=Bt(await e.repo.blocks.get(i.Hash));if(!a[A]){pb(`Loaded new subshard ${t.prefix}`),await ub(e,o.Links,n,t.bucket,parseInt(t.prefix,16));const s=await n._findNewBucketAndPos(r.name);a.push({bucket:s.bucket,prefix:fb(s.pos),node:o});break}const c=a[A];await db(e,o.Links,c.bucket,n),c.node=o}return await i._bucket.put(r.name,{size:r.size,cid:r.cid}),{shard:i,path:a}},Eb=e=>{const t=[{bucket:e.bucket,prefix:fb(e.pos)}];let r=e.bucket._parent,n=e.bucket._posAtParent;for(;r;)t.push({bucket:r,prefix:fb(n)}),n=r._posAtParent,r=r._parent;return t.reverse(),t},vb=se("ipfs:mfs:utils:update-tree"),Bb={shardSplitThreshold:1e3};async function _b(e,t,r){r=Object.assign({},Bb,r),vb("Trail",t),t=t.slice().reverse();let n,s=0;for await(const i of e.repo.blocks.getMany(t.map((e=>e.cid)))){const o=Bt(i),a=t[s].cid,A=t[s].name;if(s++,!n){n={cid:a,name:A,size:i.length};continue}const c=await gb(e,{parent:o,name:n.name,cid:n.cid,size:n.size,flush:r.flush,shardSplitThreshold:r.shardSplitThreshold,hashAlg:r.hashAlg,cidVersion:r.cidVersion});n={cid:c.cid,name:A,size:c.size}}const{cid:i}=n;return vb(`Final CID ${i}`),i}const Cb=se("ipfs:mfs:utils:update-mfs-root");async function Sb(e,t,r){if(r&&r.signal&&r.signal.aborted)throw ie(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});return Cb(`New MFS root will be ${t}`),await e.repo.datastore.put(bo,t.bytes),t}const Ib=I.bind({ignoreUndefined:!0}),Tb=se("ipfs:mfs:mkdir"),Rb={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,flush:!0};function kb(e){return go((async function(t,r={}){const n=Ib(Rb,r);if(!t)throw new Error("no path given to Mkdir");if("/"===(t=t.trim())){if(n.parents)return;throw ie(new Error("cannot create directory '/': Already exists"),"ERR_INVALID_PATH")}if("/"!==t.substring(0,1))throw ie(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");Tb(`Creating ${t}`);const s=$m(t);if("ipfs"===s[0])throw ie(new Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");const i=await Gm(e,n);let o;const a=[],A=await async function(e,t,r){const n=new me({type:t,mode:r.mode,mtime:r.mtime}),s=await e.hashers.getHasher(r.hashAlg),i={Data:n.marshal(),Links:[]},o=vt(i),a=await s.digest(o),A=Ve.create(r.cidVersion,Et,a);return r.flush&&await e.repo.blocks.put(A,o),{cid:A,node:i}}(e,"directory",n);for(let r=0;r<=s.length;r++){const c=s.slice(0,r),l=`/ipfs/${i}/${c.join("/")}`;try{if(o=await Cf(l,e.repo.blocks),"file"!==o.type&&"directory"!==o.type)throw ie(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(r===s.length){if(n.parents)return;throw ie(new Error("file already exists"),"ERR_ALREADY_EXISTS")}a.push({name:o.name,cid:o.cid})}catch(t){if("ERR_NOT_FOUND"!==t.code)throw t;if(r<s.length&&!n.parents)throw ie(new Error(`Intermediate directory path ${l} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");await Ub(e,c[c.length-1],A,a[a.length-1],a,n)}}const c=await _b(e,a,n);await Sb(e,c,n)}))}const Ub=async(e,t,r,n,s,i)=>{Tb(`Adding empty dir called ${t} to ${n.cid}`);const o=await gb(e,{parent:n.node,parentCid:n.cid,size:0,cid:r.cid,name:t,hashAlg:i.hashAlg,cidVersion:i.cidVersion,flush:i.flush,shardSplitThreshold:i.shardSplitThreshold});s[s.length-1].cid=o.cid,s.push({name:t,cid:r.cid})},Db=I.bind({ignoreUndefined:!0}),Pb=se("ipfs:mfs:cp"),Lb={parents:!1,flush:!0,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};function Nb(e){return go((async function(t,r,n={}){const s=Db(Lb,n);Array.isArray(t)||(t=[t]);const i=await Promise.all(t.map((t=>Wm(e,t,s))));let o=await Wm(e,r,s);if(!i.length||!o)throw ie(new Error("Please supply at least one source"),"ERR_INVALID_PARAMS");const a=i.find((e=>!e.exists));if(a)throw ie(new Error(`${a.path} does not exist`),"ERR_INVALID_PARAMS");const A=Ob(o);if(o.exists){if(Pb("Destination exists"),1===i.length&&!A)throw ie(new Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(Pb("Destination does not exist"),i.length>1){if(!s.parents)throw ie(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await kb(e)(o.path,s),o=await Wm(e,o.path,s)}else if(o.parts.length>1){const t=`/${o.parts.slice(0,-1).join("/")}`;try{await Zm(e)(t,s)}catch(r){if("ERR_NOT_FOUND"!==r.code)throw r;if(!s.parents)throw ie(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await kb(e)(t,s),o=await Wm(e,o.path,s)}}const c=Ob(o)?o.mfsPath:o.mfsDirectory,l=await rb(e,c);if(1===i.length){const t=i.pop();if(!t)throw ie(new Error("could not find source"),"ERR_INVALID_PARAMS");const r=A?t.name:o.name;return Pb(`Only one source, copying to destination ${A?"directory":"file"} ${r}`),Fb(e,t,r,l,s)}return Pb("Multiple sources, wrapping in a directory"),Qb(e,i,o,l,s)}))}const Ob=e=>e.unixfs&&e.unixfs.type&&e.unixfs.type.includes("directory"),Fb=async(e,t,r,n,s)=>{let i=n.pop();if(!i)throw ie(new Error("destination had no parent"),"ERR_INVALID_PARAMS");i=await xb(e,t,r,i,s),n.push(i);const o=await _b(e,n,s);await Sb(e,o,s)},Qb=async(e,t,r,n,s)=>{for(let n=0;n<t.length;n++){const i=t[n];r=await xb(e,i,i.name,r,s)}n[n.length-1]=r;const i=await _b(e,n,s);await Sb(e,i,s)},xb=async(e,t,r,n,s)=>{const i=await e.repo.blocks.get(t.cid),{node:o,cid:a,size:A}=await gb(e,{parentCid:n.cid,size:i.length,cid:t.cid,name:r,hashAlg:s.hashAlg,cidVersion:s.cidVersion,flush:s.flush,shardSplitThreshold:s.shardSplitThreshold});return n.node=o,n.cid=a,n.size=A,n},Mb=se("ipfs:mfs:core:utils:remove-link");const Hb=async(e,t)=>{t.parent.Links=t.parent.Links.filter((e=>e.Name!==t.name));const r=await vt(t.parent),n=await e.hashers.getHasher(t.hashAlg),s=await n.digest(r),i=Ve.create(t.cidVersion,Et,s);return await e.repo.blocks.put(i,r),Mb(`Updated regular directory ${i}`),{node:t.parent,cid:i}},Kb=async(e,t)=>{const{rootBucket:r,path:n}=await(async(e,t,r)=>{const n=await hb(r.Links),s=await n._findNewBucketAndPos(t),i=[{bucket:s.bucket,prefix:fb(s.pos)}];let o=s.bucket;for(;o!==n;)i.push({bucket:o,prefix:fb(o._posAtParent)}),o=o._parent;i.reverse(),i[0].node=r;for(let r=0;r<i.length;r++){const s=i[r];if(!s.node)throw new Error("Could not generate HAMT path");const o=s.node.Links.filter((e=>(e.Name||"").substring(0,2)===s.prefix)).pop();if(!o){cb(`Link ${s.prefix}${t} will be added`);continue}if(o.Name===`${s.prefix}${t}`){cb(`Link ${s.prefix}${t} will be replaced`);continue}cb(`Found subshard ${s.prefix}`);const a=Bt(await e.repo.blocks.get(o.Hash));if(!i[r+1]){cb(`Loaded new subshard ${s.prefix}`),await ub(e,a.Links,n,s.bucket,parseInt(s.prefix,16));const r=await n._findNewBucketAndPos(t);i.push({bucket:r.bucket,prefix:fb(r.pos),node:a});continue}const A=i[r+1];await db(e,a.Links,A.bucket,n),A.node=a}return await n.put(t,!0),i.reverse(),{rootBucket:n,path:i}})(e,t.name,t.parent);await r.del(t.name);const{node:s}=await Vb(e,n,t.name,t);return lb(e,s.Links,r,t)},Vb=async(e,t,r,n)=>{const s=t.pop();if(!s)throw ie(new Error("Could not find parent"),"EINVALIDPARENT");const{bucket:i,prefix:o,node:a}=s;if(!a)throw ie(new Error("Could not find parent"),"EINVALIDPARENT");const A=a.Links.find((e=>(e.Name||"").substring(0,2)===o));if(!A)throw ie(new Error(`No link found with prefix ${o} for file ${r}`),"ERR_NOT_FOUND");if(A.Name===`${o}${r}`){Mb(`Removing existing link ${A.Name}`);const t=a.Links.filter((e=>e.Name!==A.Name));return await i.del(r),lb(e,t,i,n)}Mb(`Descending into sub-shard ${A.Name} for ${o}${r}`);const c=await Vb(e,t,r,n);let l=c.cid,u=c.size,h=o;if(1===c.node.Links.length){Mb(`Removing subshard for ${o}`);const e=c.node.Links[0];h=`${o}${(e.Name||"").substring(2)}`,l=e.Hash,u=e.Tsize||0}return Mb(`Updating shard ${o} with name ${h}`),zb(e,i,a,o,h,u,l,n)},zb=(e,t,r,n,s,i,o,a)=>{const A=r.Links.filter((e=>e.Name!==n));return A.push({Name:s,Tsize:i,Hash:o}),lb(e,A,t,a)},jb=I.bind({ignoreUndefined:!0}),Gb={recursive:!1,cidVersion:0,hashAlg:"sha2-256",flush:!0,shardSplitThreshold:1e3};function $b(e){return go((async function(t,r={}){const n=jb(Gb,r);Array.isArray(t)||(t=[t]);const s=await Promise.all(t.map((t=>Wm(e,t,n))));if(!s.length)throw ie(new Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");s.forEach((e=>{if("/"===e.path)throw ie(new Error("Cannot delete root"),"ERR_INVALID_PARAMS")}));for(const t of s)await qb(e,t.path,n)}))}const qb=async(e,t,r)=>{const n=await Wm(e,t,r),s=await rb(e,n.mfsPath),i=s[s.length-1];s.pop();const o=s[s.length-1];if(!o)throw ie(new Error(`${t} does not exist`),"ERR_NOT_FOUND");if("directory"===i.type&&!r.recursive)throw ie(new Error(`${t} is a directory, use -r to remove directories`),"ERR_WAS_DIR");const{cid:a}=await async function(e,t){let r=t.parent;if(t.parentCid){const n=Ve.asCID(t.parentCid);if(null===n)throw ie(new Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");Mb(`Loading parent node ${n}`),r=Bt(await e.repo.blocks.get(n))}if(!r)throw ie(new Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(!t.name)throw ie(new Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");if(!r.Data)throw ie(new Error("Parent node had no data"),"ERR_INVALID_NODE");return"hamt-sharded-directory"===me.unmarshal(r.Data).type?(Mb(`Removing ${t.name} from sharded directory`),Kb(e,{...t,parent:r})):(Mb(`Removing link ${t.name} regular directory`),Hb(e,{...t,parent:r}))}(e,{parentCid:o.cid,name:i.name,hashAlg:r.hashAlg,cidVersion:r.cidVersion,flush:r.flush,shardSplitThreshold:r.shardSplitThreshold});o.cid=a;const A=await _b(e,s,r);await Sb(e,A,r)},Wb=I.bind({ignoreUndefined:!0}),Yb=se("ipfs:mfs:touch"),Xb={flush:!0,shardSplitThreshold:1e3,hashAlg:"sha2-256",cidVersion:0,recursive:!1};function Jb(e,t,r){t||(t=0);const n=e.match(/^(u?g?o?a?)(-?\+?=?)?(r?w?x?X?s?t?)$/);if(!n)throw new Error(`Invalid file mode: ${e}`);let[,s,i,o]=n;"a"!==s&&s||(s="ugo");let a=function(e,t,r){let n=0;return(e.includes("x")||e.includes("X")&&(r||1&t||8&t||64&t))&&(n+=1),e.includes("w")&&(n+=2),e.includes("r")&&(n+=4),n}(o,t,r);return a=function(e,t){let r=0;return e.includes("u")&&(r+=t<<6),e.includes("g")&&(r+=t<<3),e.includes("o")&&(r+=t),r}(s,a),a=function(e,t,r){return t.includes("t")&&(r+=parseInt("1000",8)),t.includes("s")&&(e.includes("u")&&(r+=parseInt("4000",8)),e.includes("g")&&(r+=parseInt("2000",8))),r}(s,o,a),"="===i?(s.includes("u")&&(t&=parseInt("7077",8),t|=a),s.includes("g")&&(t&=parseInt("7707",8),t|=a),s.includes("o")&&(t&=parseInt("7770",8),t|=a),t):"+"===i?a|t:"-"===i?a^t:t}function Zb(e,t){if(e instanceof String||"string"==typeof e){const r=`${e}`;e=r.match(/^\d+$/g)?parseInt(r,8):0+r.split(",").reduce(((e,r)=>Jb(r,e,t.isDirectory())),t.mode||0)}return e}const eE=I.bind({ignoreUndefined:!0}),tE={};const rE=I.bind({ignoreUndefined:!0}),nE={parents:!1,flush:!0,cidVersion:0,hashAlg:"sha2-256",shardSplitThreshold:1e3};const sE=I.bind({ignoreUndefined:!0}),iE=se("ipfs:mfs:touch"),oE={flush:!0,shardSplitThreshold:1e3,cidVersion:0,hashAlg:"sha2-256"};const aE=I.bind({ignoreUndefined:!0}),AE={offset:0,length:1/0};const cE=se("ipfs:mfs:utils:to-async-iterator");const lE=I.bind({ignoreUndefined:!0}),uE=se("ipfs:mfs:write"),hE={offset:0,length:1/0,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",parents:!1,progress:(e,t)=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3};const dE=async(e,t,r,n,s)=>{const i=await fE(e,r,n,s);await zm().writeLock((async()=>{const r=$m(t),n=r.pop();if(null==n)throw ie(new Error("source does not exist"),"ERR_NO_EXIST");let o=!1;try{await Zm(e)(`/${r.join("/")}`,s),o=!0}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}o||await kb(e)(`/${r.join("/")}`,s);const a=await Wm(e,t,s),A=await rb(e,a.mfsDirectory),c=A[A.length-1];if(!c)throw ie(new Error("directory does not exist"),"ERR_NO_EXIST");if(!c.type||!c.type.includes("directory"))throw ie(new Error(`cannot write to ${c.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");const l=Bt(await e.repo.blocks.get(c.cid)),u=await gb(e,{parent:l,name:n,cid:i.cid,size:i.size,flush:s.flush,shardSplitThreshold:s.shardSplitThreshold,hashAlg:s.hashAlg,cidVersion:s.cidVersion});c.cid=u.cid;const h=await _b(e,A,s);await Sb(e,h,s)}))()},fE=async(e,t,r,n)=>{r.exists?uE(`Overwriting file ${r.cid} offset ${n.offset} length ${n.length}`):uE(`Writing file offset ${n.offset} length ${n.length}`);const s=[];if(n.offset>0)if(r.unixfs){if(uE(`Writing first ${n.offset} bytes of original file`),s.push((()=>r.content({offset:0,length:n.offset}))),r.unixfs.fileSize()<n.offset){const e=n.offset-r.unixfs.fileSize();uE(`Writing zeros for extra ${e} bytes`),s.push(gE(e))}}else uE(`Writing zeros for first ${n.offset} bytes`),s.push(gE(n.offset));s.push(pE(t,n.length));const i=wE(yE(s),(e=>{if(r.unixfs&&!n.truncate){const t=r.unixfs.fileSize();if(t>e)return uE(`Writing last ${t-e} of ${t} bytes from original file starting at offset ${e}`),r.content({offset:e});uE("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:async function*(){}}}));let o,a;void 0!==n.mode&&null!==n.mode?o=ye(n.mode):r&&r.unixfs&&(o=r.unixfs.mode),null!=n.mtime?a=we(n.mtime):r&&r.unixfs&&(a=r.unixfs.mtime);const A=await e.hashers.getHasher(n.hashAlg),c=await Da(Jd([{content:i,mode:o,mtime:a}],e.repo.blocks,{progress:n.progress,hasher:A,cidVersion:n.cidVersion,strategy:n.strategy,rawLeaves:n.rawLeaves,reduceSingleLeafToSelf:n.reduceSingleLeafToSelf,leafType:n.leafType}));if(!c)throw ie(new Error(`cannot write to ${parent.name}`),"ERR_COULD_NOT_WRITE");return uE(`Wrote ${c.cid}`),{cid:c.cid,size:c.size}},pE=(e,t)=>async function*(){let r=0;for await(const n of e){if(r+=n.length,r>t)return void(yield n.subarray(0,t-r));yield n}},gE=(e,t=262144)=>{const r=new Uint8Array(t);return pE(async function*(){for(;;)yield r}(),e)},yE=async function*(e){for(let t=0;t<e.length;t++)yield*e[t]()},wE=async function*(e,t){let r=0;for await(const t of e)r+=t.length,yield t;for await(const e of t(r))r+=e.length,yield e},mE=e=>{const t={cid:e.cid,name:e.name,type:"directory"===e.type?"directory":"file",size:e.size};return"file"!==e.type&&"directory"!==e.type||(t.mode=e.unixfs.mode,t.mtime=e.unixfs.mtime),t};const bE={stat:Zm},EE={chmod:function(e){return go((async function(t,r,n={}){const s=Wb(Xb,n);Yb(`Fetching stats for ${t}`);const{cid:i,mfsDirectory:o,name:a}=await Wm(e,t,s);if(i.code!==Et)throw ie(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(s.recursive){const n=await zh((async function*(){for await(const n of Sf(i,e.repo.blocks)){if("file"!==n.type&&"directory"!==n.type)throw ie(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");n.unixfs.mode=Zb(r,n.unixfs);const e=gt({Data:n.unixfs.marshal(),Links:n.node.Links});yield{path:n.path,content:e}}}),(t=>Jd(t,e.repo.blocks,{...s,pin:!1,dagBuilder:async function*(e,t,r){for await(const n of e)yield async function(){const e=n.content,s=vt(e),i=await nb(s,t,r);if(!e.Data)throw ie(new Error(`${i} had no data`),"ERR_INVALID_NODE");const o=me.unmarshal(e.Data);return{cid:i,size:s.length,path:n.path,unixfs:o}}}})),(e=>Da(e)));if(!n)throw ie(new Error(`Could not chmod ${t}`),"ERR_COULD_NOT_CHMOD");return await $b(e)(t,s),void await Nb(e)(`/ipfs/${n.cid}`,t,s)}const A=Bt(await e.repo.blocks.get(i));if(!A.Data)throw ie(new Error(`${i} had no data`),"ERR_INVALID_NODE");const c=me.unmarshal(A.Data);c.mode=Zb(r,c);const l=vt({Data:c.marshal(),Links:A.Links}),u=s.hashAlg||Xb.hashAlg,h=await e.hashers.getHasher(u),d=await h.digest(l),f=Ve.create(s.cidVersion,Et,d);s.flush&&await e.repo.blocks.put(f,l);const p=await rb(e,o),g=p[p.length-1],y=Ve.decode(g.cid.bytes),w=Bt(await e.repo.blocks.get(y)),m=await gb(e,{parent:w,name:a,cid:f,size:l.length,flush:s.flush,hashAlg:u,cidVersion:i.version,shardSplitThreshold:1/0});g.cid=m.cid;const b=await _b(e,p,s);await Sb(e,b,s)}))},cp:Nb,flush:function(e){return go((async function(t,r={}){r=eE(tE,r);const{cid:n}=await Zm(e)(t,r);return n}))},mkdir:kb,mv:function(e){return go((async function(t,r,n={}){const s=rE(nE,n);await Nb(e)(t,r,s),await $b(e)(t,{...s,recursive:!0})}))},rm:$b,touch:function(e){return go((async function(t,r={}){const n=sE(oE,r);n.mtime=n.mtime||new Date,iE(`Touching ${t} mtime: ${n.mtime}`);const{cid:s,mfsDirectory:i,name:o,exists:a}=await Wm(e,t,n),A=r.hashAlg||oE.hashAlg,c=await e.hashers.getHasher(A);let l,u,h=n.cidVersion;if(a){if(s.code!==Et)throw ie(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");h=s.version;const r=Bt(await e.repo.blocks.get(s));if(!r.Data)throw ie(new Error(`${t} had no data`),"ERR_INVALID_NODE");const i=me.unmarshal(r.Data);i.mtime=n.mtime,l=vt({Data:i.marshal(),Links:r.Links});const o=await c.digest(l);u=Ve.create(n.cidVersion,Et,o),n.flush&&await e.repo.blocks.put(u,l)}else{l=vt({Data:new me({type:"file",mtime:n.mtime}).marshal(),Links:[]});const t=await c.digest(l);u=Ve.create(n.cidVersion,Et,t),n.flush&&await e.repo.blocks.put(u,l)}const d=await rb(e,i),f=d[d.length-1],p=f.cid,g=Bt(await e.repo.blocks.get(p)),y=await gb(e,{parent:g,name:o,cid:u,size:l.length,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:n.hashAlg,cidVersion:h});f.cid=y.cid;const w=await _b(e,d,n);await Sb(e,w,n)}))}},vE={write:function(e){return go((async function(t,r,n={}){const s=lE(hE,n);let i,o,a;if(uE("Reading source, destination and parent"),await zm().readLock((async()=>{i=await function(e){if(!e)throw ie(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");if(("string"==typeof e||e instanceof String)&&(cE("Content was a string"),e=vs(e.toString())),e.length)return cE("Content was array-like"),{[Symbol.asyncIterator]:function*(){yield e}};if(e[Symbol.asyncIterator])return cE("Content was an async iterator"),e;if(e[Symbol.iterator])return cE("Content was an iterator"),e;if(global.Blob&&e instanceof global.Blob)return cE("Content was an HTML5 Blob"),$h(e.stream());throw ie(new Error(`Don't know how to convert ${e} into an async iterator`),"ERR_INVALID_PARAMS")}(r),o=await Wm(e,t,s),a=await Wm(e,o.mfsDirectory,s)}))(),uE("Read source, destination and parent"),!s.parents&&!a.exists)throw ie(new Error("directory does not exist"),"ERR_NO_EXIST");if(null==i)throw ie(new Error("could not create source"),"ERR_NO_SOURCE");if(null==o)throw ie(new Error("could not create destination"),"ERR_NO_DESTINATION");if(!s.create&&!o.exists)throw ie(new Error("file does not exist"),"ERR_NO_EXIST");if("file"!==o.entryType)throw ie(new Error("not a file"),"ERR_NOT_A_FILE");return dE(e,t,i,o,s)}))},read:function(e){return go((function(t,r={}){return r=aE(AE,r),{[Symbol.asyncIterator]:async function*(){const n=await Wm(e,t,r),s=await Cf(n.mfsPath,e.repo.blocks);if("file"!==s.type&&"raw"!==s.type)throw ie(new Error(`${t} was not a file or raw bytes`),"ERR_NOT_FILE");if(!s.content)throw ie(new Error(`Could not load content stream from ${t}`),"ERR_NO_CONTENT");for await(const e of s.content({offset:r.offset,length:r.length}))yield e}}}))},ls:function(e){return go((async function*(t,r={}){const n=await Wm(e,t,r),s=await Cf(n.mfsPath,e.repo.blocks);"directory"!==s.type?yield mE(s):yield*xh(s.content(r),mE)}))}},BE=({options:e,mfs:t,operations:r,lock:n})=>{Object.keys(r).forEach((s=>{t[s]=n(r[s](e))}))},_E={repoOwner:!0,repo:null};function CE({repo:e,preload:t,hashers:r,options:n}){const s=function(e){const{repoOwner:t}=Object.assign({},_E||{},e),r=zm(t),n={};return BE({options:e,mfs:n,operations:bE,lock:e=>r.readLock(e)}),BE({options:e,mfs:n,operations:EE,lock:e=>r.writeLock(e)}),Object.keys(vE).forEach((t=>{n[t]=vE[t](e)})),n}({repo:e,repoOwner:!1!==n.repoOwner,hashers:r}),i=e=>(...r)=>{const n=r.filter((e=>Zi(e,Wi)||Ji(e)));if(n.length){const e=r[r.length-1];e&&!1!==e.preload&&n.forEach((e=>t(e)))}return e(...r)};return{...s,chmod:s.chmod,cp:i(s.cp),mkdir:s.mkdir,stat:i(s.stat),rm:s.rm,read:i(s.read),touch:s.touch,write:s.write,mv:i(s.mv),flush:s.flush,ls:i((async function*(...e){for await(const t of s.ls(...e))yield{...t,size:t.size||0}}))}}const SE="Ed25519";class IE{constructor({keychain:e}){this.gen=function({keychain:e}){return go(((t,r={type:SE,size:2048})=>e.createKey(t,r.type||SE,r.size||2048)))}({keychain:e}),this.list=function({keychain:e}){return go((()=>e.listKeys()))}({keychain:e}),this.rm=function({keychain:e}){return go((t=>e.removeKey(t)))}({keychain:e}),this.rename=function({keychain:e}){return go((async(t,r)=>{const n=await e.renameKey(t,r);return{was:t,now:n.name,id:n.id,overwrite:!1}}))}({keychain:e}),this.export=function({keychain:e}){return go(((t,r)=>e.exportKey(t,r)))}({keychain:e}),this.import=function({keychain:e}){return go(((t,r,n)=>e.importKey(t,r,n)))}({keychain:e}),this.info=function({keychain:e}){return go((t=>e.findKeyByName(t)))}({keychain:e})}}function TE({repo:e,preload:t}){return go((async function(r,n={}){return!1!==n.preload&&t(r),Bt(await e.blocks.get(r,n))}))}function RE(e,t=[]){for(const r in e){const n=e[r];if("/"===r&&1===Object.keys(e).length)try{t.push({Name:"",Tsize:0,Hash:Ve.parse(n)});continue}catch(e){}const s=Ve.asCID(n);s?t.push({Name:"",Tsize:0,Hash:s}):(Array.isArray(n)&&RE(n,t),n&&"object"==typeof n&&RE(n,t))}return t}function kE({repo:e,codecs:t}){return go((async function(r,n={}){const s=await t.getCodec(r.code),i=await e.blocks.get(r,n),o=s.decode(i);switch(r.code){case Yn:return[];case Et:return o.Links;case Jr:case hn:return RE(o);default:throw new Error(`Cannot resolve links from codec ${r.code}`)}}))}function UE({repo:e,preload:t}){return go((async function(r,n={}){const s=await e.gcLock.readLock();try{const i=vt(r),o=await $n.digest(i),a=Ve.createV1(Et,o);return await e.blocks.put(a,i,{signal:n.signal}),!1!==n.preload&&t(a),n.pin&&await e.pins.pinRecursively(a,{signal:n.signal}),a}finally{s()}}))}class DE{constructor({repo:e,preload:t}){this.addLink=function({repo:e,preload:t}){const r=TE({repo:e,preload:t}),n=UE({repo:e,preload:t});return go((async function(e,t,s={}){const i=await r(e,s);return n({...i,Links:i.Links.concat([t])},s)}))}({repo:e,preload:t}),this.appendData=function({repo:e,preload:t}){const r=TE({repo:e,preload:t}),n=UE({repo:e,preload:t});return go((async function(e,t,s={}){const i=await r(e,s),o=Fs([i.Data||[],t]);return n({...i,Data:o},s)}))}({repo:e,preload:t}),this.rmLink=function({repo:e,preload:t}){const r=TE({repo:e,preload:t}),n=UE({repo:e,preload:t});return go((async function(e,t,s={}){const i=await r(e,s),o=("string"==typeof t?t:t.Name)||"";return i.Links=i.Links.filter((e=>e.Name!==o)),n(i,s)}))}({repo:e,preload:t}),this.setData=function({repo:e,preload:t}){const r=TE({repo:e,preload:t}),n=UE({repo:e,preload:t});return go((async function(e,t,s={}){const i=await r(e,s);return n({...i,Data:t},s)}))}({repo:e,preload:t})}}class PE{constructor({repo:e,codecs:t,preload:r}){this.data=function({repo:e,preload:t}){const r=TE({repo:e,preload:t});return go((async function(e,t={}){return(await r(e,t)).Data||new Uint8Array(0)}))}({repo:e,preload:r}),this.get=TE({repo:e,preload:r}),this.links=kE({repo:e,codecs:t}),this.new=function({repo:e,preload:t}){return go((async function(r={}){let n;if(r.template){if("unixfs-dir"!==r.template)throw new Error("unknown template");n=new me({type:"directory"}).marshal()}const s=vt({Data:n,Links:[]}),i=await $n.digest(s),o=Ve.createV0(i);return await e.blocks.put(o,s,{signal:r.signal}),!1!==r.preload&&t(o),o}))}({repo:e,preload:r}),this.put=UE({repo:e,preload:r}),this.stat=function({repo:e,preload:t}){const r=TE({repo:e,preload:t});return go((async function(e,t={}){const n=await r(e,t),s=vt(n).length,i=n.Links.reduce(((e,t)=>e+(t.Tsize||0)),0);return{Hash:e,NumLinks:n.Links.length,BlockSize:s,LinksSize:s-(n.Data||[]).length,DataSize:(n.Data||[]).length,CumulativeSize:s+i}}))}({repo:e,preload:r}),this.patch=new DE({repo:e,preload:r})}}const LE=se("ipfs:repo:gc");function NE({repo:e}){return go((async function(t={}){const r=await e.stat();return{numObjects:BigInt(r.numObjects.toString()),repoSize:BigInt(r.repoSize.toString()),repoPath:r.repoPath,version:`${r.version}`,storageMax:BigInt(r.storageMax.toString())}}))}class OE{constructor({repo:e,hashers:t}){this.gc=function({repo:e,hashers:t}){return go((async function*(r={}){const n=Date.now();let s;try{s=await Gm({repo:e,hashers:t},r),await e.pins.pinRecursively(s),yield*e.gc()}finally{s&&await e.pins.unpin(s)}LE(`Complete (${Date.now()-n}ms)`)}))}({repo:e,hashers:t}),this.stat=NE({repo:e}),this.version=function({repo:e}){return go((async function(t={}){try{await e._checkInitialized(t)}catch(e){if([/Key not found in database \[\/version\]/,/ENOENT/,/repo is not initialized yet/].some((t=>t.test(e.message))))return 12;throw e}return e.version.get()}))}({repo:e}),this.setApiAddr=t=>e.apiAddr.set(t)}}function FE(e,t){return{totalIn:BigInt(0),totalOut:BigInt(0),rateIn:0,rateOut:0}}class QE{constructor({repo:e,network:t}){this.repo=NE({repo:e}),this.bw=function({network:e}){return go((async function*(t={}){const{libp2p:r}=await e.use(t);if(!t.poll)return void(yield FE());const n=t.interval||1e3;let s,i=-1;try{if(i="string"==typeof n?fo(n)||-1:n,!i||i<0)throw new Error("invalid duration")}catch(e){throw ie(e,"ERR_INVALID_POLL_INTERVAL")}try{for(;;)yield FE(),await new Promise((e=>{s=setTimeout(e,i)}))}finally{clearTimeout(s)}}))}({network:t}),this.bitswap=Dh({network:t})}}var xE=function(e,t,r){if(!e)return r;var n,s;Array.isArray(t)&&(n=t.slice(0));"string"==typeof t&&(n=t.split("."));"symbol"==typeof t&&(n=[t]);if(!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");for(;n.length;){if(s=n.shift(),!e)return r;if(void 0===(e=e[s]))return r}return e};async function ME(e){let t=0;for await(const r of e)t++;return t}const HE=R("ipfs:repo:migrator:migration-8");function KE(e){return e.child?KE(e.child):e}function VE(e){try{const t=j.decode(`b${e.toString().toLowerCase().slice(1)}`),r=Ve.decode(t).multihash.bytes,n=j.encode(r).slice(1).toUpperCase();return new Ao(`/${n}`,!1)}catch(t){return e}}function zE(e){try{const t=j.decode(`b${e.toString().toLowerCase().slice(1)}`),r=Qe(t),n=j.encode(Ve.createV1(Yn,r).bytes).slice(1);return new Ao(`/${n.toUpperCase()}`,!1)}catch{return e}}async function jE(e,t,r){const n=e.blocks;await n.open();const s=KE(n),i=await ME(s.queryKeys({filters:[e=>r(e).toString()!==e.toString()]}));try{let e=0;for await(const n of s.query({})){const o=r(n.key);o.toString()!==n.key.toString()&&(e+=1,HE(`Migrating Block from ${n.key} to ${o}`,await s.has(n.key)),await s.delete(n.key),await s.put(o,n.value),t(e/i*100,`Migrated Block from ${n.key} to ${o}`))}}finally{await n.close()}}const GE={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(e,t=(()=>{}))=>jE(e,t,VE),revert:(e,t=(()=>{}))=>jE(e,t,zE)},$E=oe.Reader,qE=oe.Writer,WE=(oe.util,oe.roots.default||(oe.roots.default={})),YE=WE.ipfs=(()=>{const e={};return e.pin=function(){const e={};return e.Set=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.version=0,e.prototype.fanout=0,e.prototype.seed=0,e.encode=function(e,t){return t||(t=qE.create()),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(8).uint32(e.version),null!=e.fanout&&Object.hasOwnProperty.call(e,"fanout")&&t.uint32(16).uint32(e.fanout),null!=e.seed&&Object.hasOwnProperty.call(e,"seed")&&t.uint32(29).fixed32(e.seed),t},e.decode=function(e,t){e instanceof $E||(e=$E.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new WE.ipfs.pin.Set;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.version=e.uint32();break;case 2:n.fanout=e.uint32();break;case 3:n.seed=e.fixed32();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof WE.ipfs.pin.Set)return e;var t=new WE.ipfs.pin.Set;return null!=e.version&&(t.version=e.version>>>0),null!=e.fanout&&(t.fanout=e.fanout>>>0),null!=e.seed&&(t.seed=e.seed>>>0),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.version=0,r.fanout=0,r.seed=0),null!=e.version&&e.hasOwnProperty("version")&&(r.version=e.version),null!=e.fanout&&e.hasOwnProperty("fanout")&&(r.fanout=e.fanout),null!=e.seed&&e.hasOwnProperty("seed")&&(r.seed=e.seed),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,oe.util.toJSONOptions)},e}(),e}(),e})();var XE=r(96132);const JE=new Ao("/local/pins"),ZE=Ve.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),ev="direct",tv="recursive";function rv(e){return new Ao(`/${j.encode(e.multihash.bytes).toUpperCase().substring(1)}`)}function nv(e,t){for(let r=0;r<e.byteLength;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}const sv=YE.pin.Set;async function*iv(e,t){const r=function(e){const t=e.Data;if(!t)throw new Error("No data present");const r=Os.decode(t),n=Os.decode.bytes??0;if(n<=0)throw new Error("Invalid Set header length");if(n+r>t.length)throw new Error("Impossibly large set header length");const s=t.slice(n,r+n),i=sv.toObject(sv.decode(s),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(1!==i.version)throw new Error(`Unsupported Set version: ${i.version}`);if(i.fanout>e.Links.length)throw new Error("Impossibly large fanout");return{header:i,data:t.slice(r+n)}}(t);let n=0;for(const s of t.Links){if(n<r.header.fanout){const t=s.Hash;if(!ZE.equals(t)){const r=Bt(await e.get(t));yield*iv(e,r)}}else yield s.Hash;n++}}async function*ov(e,t,r){const n=t.Links.find((e=>e.Name===r));if(!n)throw new Error("No link found with name "+r);const s=Bt(await e.get(n.Hash));yield*iv(e,s)}function av(e,t){return async function t(r,n){const s=sv.encode({version:1,fanout:256,seed:n}).finish(),i=Fs([Os.encode(s.length),s]),o=[];for(let e=0;e<256;e++)o.push({Name:"",Tsize:1,Hash:ZE});if(r.length<=8192){const e=r.map((e=>({link:{Name:"",Tsize:1,Hash:e.key},data:e.data||new Uint8Array}))).sort(((e,t)=>nv(e.link.Hash.bytes,t.link.Hash.bytes))),t=o.concat(e.map((e=>e.link)));return{Data:Fs([i,...e.map((e=>e.data))]),Links:t}}{const e=r.reduce(((e,t)=>{const r=function(e,t){const r=new Uint8Array(4);new DataView(r.buffer).setUint32(0,e,!0);const n=vs(t.toString()),s=Fs([r,n],r.byteLength+n.byteLength);return XE(Ts(s))}(n,t.key)%256;return e[r]=r in e?e[r].concat([t]):[t],e}),[]);let s=0;for(const r of e){const e=await t(r,n+1);await a(e,s),s++}return{Data:i,Links:o}}async function a(t,r){const n=vt(t),s=await $n.digest(n),i=Ve.createV0(s);await e.put(i,n);const a=t.Links.reduce(((e,t)=>e+(t.Tsize||0)),0)+n.length;o[r]={Name:"",Tsize:a,Hash:i}}}(t,0)}async function Av(e,t,r){const n=await av(e,r.map((e=>({key:e})))),s=vt(n),i=await $n.digest(s),o=Ve.createV0(i);await e.put(o,s);return{Name:t,Tsize:n.Links.reduce(((e,t)=>e+t.Tsize),0)+s.length,Hash:o}}async function cv(e,t,r,n){if(!await t.has(JE))return;const s=await t.get(JE),i=Ve.decode(s),o=Bt(await e.get(i));let a=0;const A=await ME(ov(e,o,tv))+await ME(ov(e,o,ev));for await(const t of ov(e,o,tv)){a++;const e={depth:1/0};0!==t.version&&(e.version=t.version),t.code!==Et&&(e.codec=t.code),await r.put(rv(t),Kr(e)),n(a/A*100,`Migrated recursive pin ${t}`)}for await(const t of ov(e,o,ev)){a++;const e={depth:0};0!==t.version&&(e.version=t.version),t.code!==Et&&(e.codec=t.code),await r.put(rv(t),Kr(e)),n(a/A*100,`Migrated direct pin ${t}`)}await e.delete(i),await t.delete(JE)}async function lv(e,t,r,n){const s=[],i=[];let o=0;const a=await ME(r.queryKeys({}));for await(const{key:e,value:t}of r.query({})){o++;const r=qr(t),A=Ve.create(r.version||0,r.codec||Et,Qe(j.decode("b"+e.toString().toLowerCase().split("/").pop())));0===r.depth?(n(o/a*100,`Reverted direct pin ${A}`),i.push(A)):(n(o/a*100,`Reverted recursive pin ${A}`),s.push(A))}n(100,"Updating pin root");const A=vt({Links:[await Av(e,ev,i),await Av(e,tv,s)]}),c=await $n.digest(A),l=Ve.createV0(c);await e.put(l,A),await t.put(JE,l.bytes)}async function uv(e,t,r){const n=e.blocks,s=e.datastore,i=e.pins;await n.open(),await s.open(),await i.open();try{await r(n,s,i,t)}finally{await i.close(),await s.close(),await n.close()}}const hv={version:9,description:"Migrates pins to datastore",migrate:(e,t=(()=>{}))=>uv(e,t,cv),revert:(e,t=(()=>{}))=>uv(e,t,lv)},dv=new Ao("/config"),fv=new Ao("/version");function pv(e){let t=e;for(;t.db||t.child;)if(t=t.db||t.child,"level-js"===t.type||"Level"===t.constructor.name)return t}function gv(e){const t=e.get.bind(e),r=e.has.bind(e);return e.get=n=>async function(e,t,r,n){if(await r(e))return t(e);const s=pv(n);if(!s)throw Ka();return new Promise(((t,r)=>{const n=s.store("readonly").get(e.toString());n.transaction.onabort=()=>{r(n.transaction.error)},n.transaction.oncomplete=()=>{if(n.result)return t(n.result);r(Ka())}}))}(n,t,r,e),e.has=t=>async function(e,t,r){const n=await t(e);if(n)return n;const s=pv(r);return!!s&&new Promise(((t,r)=>{const n=s.store("readonly").get(e.toString());n.transaction.onabort=()=>{r(n.transaction.error)},n.transaction.oncomplete=()=>{t(Boolean(n.result))}}))}(t,r,e),e}function yv(e){return{...e,root:gv(e.root),datastore:gv(e.datastore),pins:gv(e.pins),keys:gv(e.keys)}}async function wv(e,t,r=(()=>{})){const n=pv(t);if(!n)return void r(`${e} did not need an upgrade`);r(`Upgrading ${e}`);await Bv(n,((e,t)=>[{type:"del",key:e},{type:"put",key:vs(e),value:t}]))}async function mv(e,t,r=(()=>{})){const n=pv(t);if(!n)return void r(`${e} did not need a downgrade`);r(`Downgrading ${e}`);await Bv(n,((e,t)=>[{type:"del",key:e},{type:"put",key:Ts(e),value:t}]))}function bv(e){return e.child?bv(e.child):e}async function Ev(e,t,r){const n=Object.entries(e).map((([e,t])=>({key:e,backend:bv(t)}))).filter((({key:e,backend:t})=>"LevelDatastore"===t.constructor.name)).map((({key:e,backend:t})=>({name:e,store:t})));t(0,`Migrating ${n.length} dbs`);let s=0;const i=e=>{t(Math.round(s/n.length*100),e)};for(const{name:e,store:t}of n){await t.open();try{await r(e,t,i)}finally{s++,await t.close()}}t(100,`Migrated ${n.length} dbs`)}const vv={version:10,description:"Migrates datastore-level keys to binary",migrate:(e,t=(()=>{}))=>Ev(e,t,wv),revert:(e,t=(()=>{}))=>Ev(e,t,mv)};function Bv(e,t){return new Promise(((r,n)=>{const s=e.iterator();s._deserializeKey=s._deserializeValue=e=>e,function i(){const o=(o,a,A)=>{if(o||void 0===a){const e=e=>{e?n(e):r()};s.end(e)}else!function(t,r){const n=e.store("readwrite"),s=n.transaction;let i,o=0;s.onabort=()=>r(i||s.error||new Error("aborted by user")),s.oncomplete=()=>r(),function e(){const r=t[o++],a=r.key;let A;try{A="del"===r.type?n.delete(a):n.put(r.value,a)}catch(e){return i=e,void s.abort()}o<t.length&&(A.onsuccess=e)}()}(t(a,A),i)};s.next(o)}()}))}const _v=new Ao("/local/filesroot");const Cv={version:11,description:"Store mfs root in the datastore",migrate:async function(e,t=(()=>{})){if(t(100,"Migrating MFS root to repo datastore"),await e.root.open(),await e.datastore.open(),await e.root.has(_v)){const t=await e.root.get(_v);await e.datastore.put(_v,t),await e.root.delete(_v)}await e.datastore.close(),await e.root.close(),t(100,"Stored MFS root in repo datastore")},revert:async function(e,t=(()=>{})){if(t(100,"Migrating MFS root to repo root datastore"),await e.root.open(),await e.datastore.open(),await e.datastore.has(_v)){const t=await e.datastore.get(_v);await e.root.put(_v,t),await e.datastore.delete(_v)}await e.datastore.close(),await e.root.close(),t(100,"Stored MFS root in repo root datastore")}},Sv=oe.Reader,Iv=oe.Writer,Tv=oe.util,Rv=oe.roots.default||(oe.roots.default={}),kv=Rv.Protocols=(()=>{function e(e){if(this.protocols=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.protocols=Tv.emptyArray,e.encode=function(e,t){if(t||(t=Iv.create()),null!=e.protocols&&e.protocols.length)for(var r=0;r<e.protocols.length;++r)t.uint32(10).string(e.protocols[r]);return t},e.decode=function(e,t){e instanceof Sv||(e=Sv.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new Rv.Protocols;e.pos<r;){var s=e.uint32();if(s>>>3==1)n.protocols&&n.protocols.length||(n.protocols=[]),n.protocols.push(e.string());else e.skipType(7&s)}return n},e.fromObject=function(e){if(e instanceof Rv.Protocols)return e;var t=new Rv.Protocols;if(e.protocols){if(!Array.isArray(e.protocols))throw TypeError(".Protocols.protocols: array expected");t.protocols=[];for(var r=0;r<e.protocols.length;++r)t.protocols[r]=String(e.protocols[r])}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.protocols=[]),e.protocols&&e.protocols.length){r.protocols=[];for(var n=0;n<e.protocols.length;++n)r.protocols[n]=e.protocols[n]}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,oe.util.toJSONOptions)},e})(),Uv=oe.Reader,Dv=oe.Writer,Pv=oe.util,Lv=oe.roots.default||(oe.roots.default={}),Nv=Lv.Addresses=(()=>{function e(e){if(this.addrs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.addrs=Pv.emptyArray,e.prototype.certifiedRecord=null,e.encode=function(e,t){if(t||(t=Dv.create()),null!=e.addrs&&e.addrs.length)for(var r=0;r<e.addrs.length;++r)Lv.Addresses.Address.encode(e.addrs[r],t.uint32(10).fork()).ldelim();return null!=e.certifiedRecord&&Object.hasOwnProperty.call(e,"certifiedRecord")&&Lv.Addresses.CertifiedRecord.encode(e.certifiedRecord,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){e instanceof Uv||(e=Uv.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new Lv.Addresses;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.addrs&&n.addrs.length||(n.addrs=[]),n.addrs.push(Lv.Addresses.Address.decode(e,e.uint32()));break;case 2:n.certifiedRecord=Lv.Addresses.CertifiedRecord.decode(e,e.uint32());break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof Lv.Addresses)return e;var t=new Lv.Addresses;if(e.addrs){if(!Array.isArray(e.addrs))throw TypeError(".Addresses.addrs: array expected");t.addrs=[];for(var r=0;r<e.addrs.length;++r){if("object"!=typeof e.addrs[r])throw TypeError(".Addresses.addrs: object expected");t.addrs[r]=Lv.Addresses.Address.fromObject(e.addrs[r])}}if(null!=e.certifiedRecord){if("object"!=typeof e.certifiedRecord)throw TypeError(".Addresses.certifiedRecord: object expected");t.certifiedRecord=Lv.Addresses.CertifiedRecord.fromObject(e.certifiedRecord)}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.addrs=[]),t.defaults&&(r.certifiedRecord=null),e.addrs&&e.addrs.length){r.addrs=[];for(var n=0;n<e.addrs.length;++n)r.addrs[n]=Lv.Addresses.Address.toObject(e.addrs[n],t)}return null!=e.certifiedRecord&&e.hasOwnProperty("certifiedRecord")&&(r.certifiedRecord=Lv.Addresses.CertifiedRecord.toObject(e.certifiedRecord,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,oe.util.toJSONOptions)},e.Address=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}let t;return e.prototype.multiaddr=Pv.newBuffer([]),e.prototype.isCertified=null,Object.defineProperty(e.prototype,"_isCertified",{get:Pv.oneOfGetter(t=["isCertified"]),set:Pv.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=Dv.create()),null!=e.multiaddr&&Object.hasOwnProperty.call(e,"multiaddr")&&t.uint32(10).bytes(e.multiaddr),null!=e.isCertified&&Object.hasOwnProperty.call(e,"isCertified")&&t.uint32(16).bool(e.isCertified),t},e.decode=function(e,t){e instanceof Uv||(e=Uv.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new Lv.Addresses.Address;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.multiaddr=e.bytes();break;case 2:n.isCertified=e.bool();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof Lv.Addresses.Address)return e;var t=new Lv.Addresses.Address;return null!=e.multiaddr&&("string"==typeof e.multiaddr?Pv.base64.decode(e.multiaddr,t.multiaddr=Pv.newBuffer(Pv.base64.length(e.multiaddr)),0):e.multiaddr.length&&(t.multiaddr=e.multiaddr)),null!=e.isCertified&&(t.isCertified=Boolean(e.isCertified)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.multiaddr="":(r.multiaddr=[],t.bytes!==Array&&(r.multiaddr=Pv.newBuffer(r.multiaddr)))),null!=e.multiaddr&&e.hasOwnProperty("multiaddr")&&(r.multiaddr=t.bytes===String?Pv.base64.encode(e.multiaddr,0,e.multiaddr.length):t.bytes===Array?Array.prototype.slice.call(e.multiaddr):e.multiaddr),null!=e.isCertified&&e.hasOwnProperty("isCertified")&&(r.isCertified=e.isCertified,t.oneofs&&(r._isCertified="isCertified")),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,oe.util.toJSONOptions)},e}(),e.CertifiedRecord=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.seq=Pv.Long?Pv.Long.fromBits(0,0,!0):0,e.prototype.raw=Pv.newBuffer([]),e.encode=function(e,t){return t||(t=Dv.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.raw&&Object.hasOwnProperty.call(e,"raw")&&t.uint32(18).bytes(e.raw),t},e.decode=function(e,t){e instanceof Uv||(e=Uv.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new Lv.Addresses.CertifiedRecord;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.seq=e.uint64();break;case 2:n.raw=e.bytes();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof Lv.Addresses.CertifiedRecord)return e;var t=new Lv.Addresses.CertifiedRecord;return null!=e.seq&&(Pv.Long?(t.seq=Pv.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"==typeof e.seq&&(t.seq=new Pv.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.raw&&("string"==typeof e.raw?Pv.base64.decode(e.raw,t.raw=Pv.newBuffer(Pv.base64.length(e.raw)),0):e.raw.length&&(t.raw=e.raw)),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(Pv.Long){var n=new Pv.Long(0,0,!0);r.seq=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.seq=t.longs===String?"0":0;t.bytes===String?r.raw="":(r.raw=[],t.bytes!==Array&&(r.raw=Pv.newBuffer(r.raw)))}return null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?r.seq=t.longs===String?String(e.seq):e.seq:r.seq=t.longs===String?Pv.Long.prototype.toString.call(e.seq):t.longs===Number?new Pv.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.raw&&e.hasOwnProperty("raw")&&(r.raw=t.bytes===String?Pv.base64.encode(e.raw,0,e.raw.length):t.bytes===Array?Array.prototype.slice.call(e.raw):e.raw),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,oe.util.toJSONOptions)},e}(),e})(),Ov=oe.Reader,Fv=oe.Writer,Qv=oe.util,xv=oe.roots.default||(oe.roots.default={}),Mv=xv.Peer=(()=>{function e(e){if(this.addresses=[],this.protocols=[],this.metadata=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}let t;return e.prototype.addresses=Qv.emptyArray,e.prototype.protocols=Qv.emptyArray,e.prototype.metadata=Qv.emptyArray,e.prototype.pubKey=null,e.prototype.peerRecordEnvelope=null,Object.defineProperty(e.prototype,"_pubKey",{get:Qv.oneOfGetter(t=["pubKey"]),set:Qv.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_peerRecordEnvelope",{get:Qv.oneOfGetter(t=["peerRecordEnvelope"]),set:Qv.oneOfSetter(t)}),e.encode=function(e,t){if(t||(t=Fv.create()),null!=e.addresses&&e.addresses.length)for(var r=0;r<e.addresses.length;++r)xv.Address.encode(e.addresses[r],t.uint32(10).fork()).ldelim();if(null!=e.protocols&&e.protocols.length)for(r=0;r<e.protocols.length;++r)t.uint32(18).string(e.protocols[r]);if(null!=e.metadata&&e.metadata.length)for(r=0;r<e.metadata.length;++r)xv.Metadata.encode(e.metadata[r],t.uint32(26).fork()).ldelim();return null!=e.pubKey&&Object.hasOwnProperty.call(e,"pubKey")&&t.uint32(34).bytes(e.pubKey),null!=e.peerRecordEnvelope&&Object.hasOwnProperty.call(e,"peerRecordEnvelope")&&t.uint32(42).bytes(e.peerRecordEnvelope),t},e.decode=function(e,t){e instanceof Ov||(e=Ov.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new xv.Peer;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.addresses&&n.addresses.length||(n.addresses=[]),n.addresses.push(xv.Address.decode(e,e.uint32()));break;case 2:n.protocols&&n.protocols.length||(n.protocols=[]),n.protocols.push(e.string());break;case 3:n.metadata&&n.metadata.length||(n.metadata=[]),n.metadata.push(xv.Metadata.decode(e,e.uint32()));break;case 4:n.pubKey=e.bytes();break;case 5:n.peerRecordEnvelope=e.bytes();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof xv.Peer)return e;var t=new xv.Peer;if(e.addresses){if(!Array.isArray(e.addresses))throw TypeError(".Peer.addresses: array expected");t.addresses=[];for(var r=0;r<e.addresses.length;++r){if("object"!=typeof e.addresses[r])throw TypeError(".Peer.addresses: object expected");t.addresses[r]=xv.Address.fromObject(e.addresses[r])}}if(e.protocols){if(!Array.isArray(e.protocols))throw TypeError(".Peer.protocols: array expected");t.protocols=[];for(r=0;r<e.protocols.length;++r)t.protocols[r]=String(e.protocols[r])}if(e.metadata){if(!Array.isArray(e.metadata))throw TypeError(".Peer.metadata: array expected");t.metadata=[];for(r=0;r<e.metadata.length;++r){if("object"!=typeof e.metadata[r])throw TypeError(".Peer.metadata: object expected");t.metadata[r]=xv.Metadata.fromObject(e.metadata[r])}}return null!=e.pubKey&&("string"==typeof e.pubKey?Qv.base64.decode(e.pubKey,t.pubKey=Qv.newBuffer(Qv.base64.length(e.pubKey)),0):e.pubKey.length&&(t.pubKey=e.pubKey)),null!=e.peerRecordEnvelope&&("string"==typeof e.peerRecordEnvelope?Qv.base64.decode(e.peerRecordEnvelope,t.peerRecordEnvelope=Qv.newBuffer(Qv.base64.length(e.peerRecordEnvelope)),0):e.peerRecordEnvelope.length&&(t.peerRecordEnvelope=e.peerRecordEnvelope)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.addresses=[],r.protocols=[],r.metadata=[]),e.addresses&&e.addresses.length){r.addresses=[];for(var n=0;n<e.addresses.length;++n)r.addresses[n]=xv.Address.toObject(e.addresses[n],t)}if(e.protocols&&e.protocols.length){r.protocols=[];for(n=0;n<e.protocols.length;++n)r.protocols[n]=e.protocols[n]}if(e.metadata&&e.metadata.length){r.metadata=[];for(n=0;n<e.metadata.length;++n)r.metadata[n]=xv.Metadata.toObject(e.metadata[n],t)}return null!=e.pubKey&&e.hasOwnProperty("pubKey")&&(r.pubKey=t.bytes===String?Qv.base64.encode(e.pubKey,0,e.pubKey.length):t.bytes===Array?Array.prototype.slice.call(e.pubKey):e.pubKey,t.oneofs&&(r._pubKey="pubKey")),null!=e.peerRecordEnvelope&&e.hasOwnProperty("peerRecordEnvelope")&&(r.peerRecordEnvelope=t.bytes===String?Qv.base64.encode(e.peerRecordEnvelope,0,e.peerRecordEnvelope.length):t.bytes===Array?Array.prototype.slice.call(e.peerRecordEnvelope):e.peerRecordEnvelope,t.oneofs&&(r._peerRecordEnvelope="peerRecordEnvelope")),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,oe.util.toJSONOptions)},e})(),Hv=(xv.Address=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}let t;return e.prototype.multiaddr=Qv.newBuffer([]),e.prototype.isCertified=null,Object.defineProperty(e.prototype,"_isCertified",{get:Qv.oneOfGetter(t=["isCertified"]),set:Qv.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=Fv.create()),null!=e.multiaddr&&Object.hasOwnProperty.call(e,"multiaddr")&&t.uint32(10).bytes(e.multiaddr),null!=e.isCertified&&Object.hasOwnProperty.call(e,"isCertified")&&t.uint32(16).bool(e.isCertified),t},e.decode=function(e,t){e instanceof Ov||(e=Ov.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new xv.Address;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.multiaddr=e.bytes();break;case 2:n.isCertified=e.bool();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof xv.Address)return e;var t=new xv.Address;return null!=e.multiaddr&&("string"==typeof e.multiaddr?Qv.base64.decode(e.multiaddr,t.multiaddr=Qv.newBuffer(Qv.base64.length(e.multiaddr)),0):e.multiaddr.length&&(t.multiaddr=e.multiaddr)),null!=e.isCertified&&(t.isCertified=Boolean(e.isCertified)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.multiaddr="":(r.multiaddr=[],t.bytes!==Array&&(r.multiaddr=Qv.newBuffer(r.multiaddr)))),null!=e.multiaddr&&e.hasOwnProperty("multiaddr")&&(r.multiaddr=t.bytes===String?Qv.base64.encode(e.multiaddr,0,e.multiaddr.length):t.bytes===Array?Array.prototype.slice.call(e.multiaddr):e.multiaddr),null!=e.isCertified&&e.hasOwnProperty("isCertified")&&(r.isCertified=e.isCertified,t.oneofs&&(r._isCertified="isCertified")),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,oe.util.toJSONOptions)},e})(),xv.Metadata=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.key="",e.prototype.value=Qv.newBuffer([]),e.encode=function(e,t){return t||(t=Fv.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).bytes(e.value),t},e.decode=function(e,t){e instanceof Ov||(e=Ov.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new xv.Metadata;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.key=e.string();break;case 2:n.value=e.bytes();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof xv.Metadata)return e;var t=new xv.Metadata;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&("string"==typeof e.value?Qv.base64.decode(e.value,t.value=Qv.newBuffer(Qv.base64.length(e.value)),0):e.value.length&&(t.value=e.value)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.key="",t.bytes===String?r.value="":(r.value=[],t.bytes!==Array&&(r.value=Qv.newBuffer(r.value)))),null!=e.key&&e.hasOwnProperty("key")&&(r.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(r.value=t.bytes===String?Qv.base64.encode(e.value,0,e.value.length):t.bytes===Array?Array.prototype.slice.call(e.value):e.value),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,oe.util.toJSONOptions)},e})(),oe.Reader),Kv=oe.Writer,Vv=oe.util,zv=oe.roots.default||(oe.roots.default={}),jv=zv.Envelope=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.publicKey=Vv.newBuffer([]),e.prototype.payloadType=Vv.newBuffer([]),e.prototype.payload=Vv.newBuffer([]),e.prototype.signature=Vv.newBuffer([]),e.encode=function(e,t){return t||(t=Kv.create()),null!=e.publicKey&&Object.hasOwnProperty.call(e,"publicKey")&&t.uint32(10).bytes(e.publicKey),null!=e.payloadType&&Object.hasOwnProperty.call(e,"payloadType")&&t.uint32(18).bytes(e.payloadType),null!=e.payload&&Object.hasOwnProperty.call(e,"payload")&&t.uint32(26).bytes(e.payload),null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(42).bytes(e.signature),t},e.decode=function(e,t){e instanceof Hv||(e=Hv.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new zv.Envelope;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.publicKey=e.bytes();break;case 2:n.payloadType=e.bytes();break;case 3:n.payload=e.bytes();break;case 5:n.signature=e.bytes();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof zv.Envelope)return e;var t=new zv.Envelope;return null!=e.publicKey&&("string"==typeof e.publicKey?Vv.base64.decode(e.publicKey,t.publicKey=Vv.newBuffer(Vv.base64.length(e.publicKey)),0):e.publicKey.length&&(t.publicKey=e.publicKey)),null!=e.payloadType&&("string"==typeof e.payloadType?Vv.base64.decode(e.payloadType,t.payloadType=Vv.newBuffer(Vv.base64.length(e.payloadType)),0):e.payloadType.length&&(t.payloadType=e.payloadType)),null!=e.payload&&("string"==typeof e.payload?Vv.base64.decode(e.payload,t.payload=Vv.newBuffer(Vv.base64.length(e.payload)),0):e.payload.length&&(t.payload=e.payload)),null!=e.signature&&("string"==typeof e.signature?Vv.base64.decode(e.signature,t.signature=Vv.newBuffer(Vv.base64.length(e.signature)),0):e.signature.length&&(t.signature=e.signature)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.publicKey="":(r.publicKey=[],t.bytes!==Array&&(r.publicKey=Vv.newBuffer(r.publicKey))),t.bytes===String?r.payloadType="":(r.payloadType=[],t.bytes!==Array&&(r.payloadType=Vv.newBuffer(r.payloadType))),t.bytes===String?r.payload="":(r.payload=[],t.bytes!==Array&&(r.payload=Vv.newBuffer(r.payload))),t.bytes===String?r.signature="":(r.signature=[],t.bytes!==Array&&(r.signature=Vv.newBuffer(r.signature)))),null!=e.publicKey&&e.hasOwnProperty("publicKey")&&(r.publicKey=t.bytes===String?Vv.base64.encode(e.publicKey,0,e.publicKey.length):t.bytes===Array?Array.prototype.slice.call(e.publicKey):e.publicKey),null!=e.payloadType&&e.hasOwnProperty("payloadType")&&(r.payloadType=t.bytes===String?Vv.base64.encode(e.payloadType,0,e.payloadType.length):t.bytes===Array?Array.prototype.slice.call(e.payloadType):e.payloadType),null!=e.payload&&e.hasOwnProperty("payload")&&(r.payload=t.bytes===String?Vv.base64.encode(e.payload,0,e.payload.length):t.bytes===Array?Array.prototype.slice.call(e.payload):e.payload),null!=e.signature&&e.hasOwnProperty("signature")&&(r.signature=t.bytes===String?Vv.base64.encode(e.signature,0,e.signature.length):t.bytes===Array?Array.prototype.slice.call(e.signature):e.signature),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,oe.util.toJSONOptions)},e})(),Gv=oe.Reader,$v=oe.Writer,qv=oe.util,Wv=oe.roots.default||(oe.roots.default={}),Yv=Wv.PeerRecord=(()=>{function e(e){if(this.addresses=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.peerId=qv.newBuffer([]),e.prototype.seq=qv.Long?qv.Long.fromBits(0,0,!0):0,e.prototype.addresses=qv.emptyArray,e.encode=function(e,t){if(t||(t=$v.create()),null!=e.peerId&&Object.hasOwnProperty.call(e,"peerId")&&t.uint32(10).bytes(e.peerId),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(16).uint64(e.seq),null!=e.addresses&&e.addresses.length)for(var r=0;r<e.addresses.length;++r)Wv.PeerRecord.AddressInfo.encode(e.addresses[r],t.uint32(26).fork()).ldelim();return t},e.decode=function(e,t){e instanceof Gv||(e=Gv.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new Wv.PeerRecord;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.peerId=e.bytes();break;case 2:n.seq=e.uint64();break;case 3:n.addresses&&n.addresses.length||(n.addresses=[]),n.addresses.push(Wv.PeerRecord.AddressInfo.decode(e,e.uint32()));break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof Wv.PeerRecord)return e;var t=new Wv.PeerRecord;if(null!=e.peerId&&("string"==typeof e.peerId?qv.base64.decode(e.peerId,t.peerId=qv.newBuffer(qv.base64.length(e.peerId)),0):e.peerId.length&&(t.peerId=e.peerId)),null!=e.seq&&(qv.Long?(t.seq=qv.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"==typeof e.seq&&(t.seq=new qv.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),e.addresses){if(!Array.isArray(e.addresses))throw TypeError(".PeerRecord.addresses: array expected");t.addresses=[];for(var r=0;r<e.addresses.length;++r){if("object"!=typeof e.addresses[r])throw TypeError(".PeerRecord.addresses: object expected");t.addresses[r]=Wv.PeerRecord.AddressInfo.fromObject(e.addresses[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.addresses=[]),t.defaults)if(t.bytes===String?r.peerId="":(r.peerId=[],t.bytes!==Array&&(r.peerId=qv.newBuffer(r.peerId))),qv.Long){var n=new qv.Long(0,0,!0);r.seq=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.seq=t.longs===String?"0":0;if(null!=e.peerId&&e.hasOwnProperty("peerId")&&(r.peerId=t.bytes===String?qv.base64.encode(e.peerId,0,e.peerId.length):t.bytes===Array?Array.prototype.slice.call(e.peerId):e.peerId),null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?r.seq=t.longs===String?String(e.seq):e.seq:r.seq=t.longs===String?qv.Long.prototype.toString.call(e.seq):t.longs===Number?new qv.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),e.addresses&&e.addresses.length){r.addresses=[];for(var s=0;s<e.addresses.length;++s)r.addresses[s]=Wv.PeerRecord.AddressInfo.toObject(e.addresses[s],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,oe.util.toJSONOptions)},e.AddressInfo=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.multiaddr=qv.newBuffer([]),e.encode=function(e,t){return t||(t=$v.create()),null!=e.multiaddr&&Object.hasOwnProperty.call(e,"multiaddr")&&t.uint32(10).bytes(e.multiaddr),t},e.decode=function(e,t){e instanceof Gv||(e=Gv.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new Wv.PeerRecord.AddressInfo;e.pos<r;){var s=e.uint32();if(s>>>3==1)n.multiaddr=e.bytes();else e.skipType(7&s)}return n},e.fromObject=function(e){if(e instanceof Wv.PeerRecord.AddressInfo)return e;var t=new Wv.PeerRecord.AddressInfo;return null!=e.multiaddr&&("string"==typeof e.multiaddr?qv.base64.decode(e.multiaddr,t.multiaddr=qv.newBuffer(qv.base64.length(e.multiaddr)),0):e.multiaddr.length&&(t.multiaddr=e.multiaddr)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.multiaddr="":(r.multiaddr=[],t.bytes!==Array&&(r.multiaddr=qv.newBuffer(r.multiaddr)))),null!=e.multiaddr&&e.hasOwnProperty("multiaddr")&&(r.multiaddr=t.bytes===String?qv.base64.encode(e.multiaddr,0,e.multiaddr.length):t.bytes===Array?Array.prototype.slice.call(e.multiaddr):e.multiaddr),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,oe.util.toJSONOptions)},e}(),e})();oe.util.Long=void 0,oe.configure();const Xv={version:12,description:"Store each peerstore peer under a single datastore key",migrate:async function(e,t=(()=>{})){t(0,"Storing each peerstore key under a single datastore key"),await e.datastore.open();const r={},n=[];for await(const{key:t,value:s}of e.datastore.query({prefix:"/peers"})){n.push(t);const e=t.toString(),[,i,o,a,A]=e.split("/");if("peers"===i&&(["protos","addrs","metadata","keys"].includes(o)&&a))if(r[a]=r[a]||{addresses:[],protocols:[],metadata:[]},"protos"===o){const e=kv.decode(s);r[a].protocols=e.protocols.sort()}else if("addrs"===o){const e=Nv.decode(s);r[a].addresses=e.addrs.sort(((e,t)=>mi(e.multiaddr).toString().localeCompare(mi(t.multiaddr).toString()))),e.certifiedRecord&&e.certifiedRecord.raw&&(r[a].peerRecordEnvelope=e.certifiedRecord.raw)}else"metadata"===o?r[a].metadata.push({key:A,value:s}):"keys"===o&&(r[a].pubKey=s)}t(33,"Read peer data from store");for(const t of n)await e.datastore.delete(t);t(66,"Removed existing peer data from store");for(const t of Object.keys(r)){const n=r[t];n.metadata=n.metadata.sort(((e,t)=>e.key.localeCompare(t.key)));const s=Mv.encode(n).finish();await e.datastore.put(new Ao(`/peers/${t}`),s)}await e.datastore.close(),t(100,"Stored each peerstore key under a single datastore key")},revert:async function(e,t=(()=>{})){t(0,"Storing each peerstore key under a multiple datastore keys"),await e.datastore.open();const r={},n=[];for await(const{key:t,value:s}of e.datastore.query({prefix:"/peers"})){n.push(t);const e=t.toString(),[,,i]=e.split("/");r[i]=Mv.decode(s)}t(33,"Read peer data from store");for(const t of n)await e.datastore.delete(t);t(66,"Removed existing peer data from store");for(const[t,n]of Object.entries(r)){if(n.protocols&&n.protocols.length>0&&await e.datastore.put(new Ao(`/peers/protos/${t}`),kv.encode({protocols:n.protocols}).finish()),n.addresses&&n.addresses.length>0){const r=n.peerRecordEnvelope;let s;if(r){const e=jv.decode(r);s={raw:r,seq:Yv.decode(e.payload).seq}}await e.datastore.put(new Ao(`/peers/addrs/${t}`),Nv.encode({addrs:n.addresses,certifiedRecord:s}).finish())}if(n.metadata&&n.metadata.length>0)for(const{key:r,value:s}of n.metadata)await e.datastore.put(new Ao(`/peers/metadata/${t}/${r}`),s);n.pubKey&&await e.datastore.put(new Ao(`/peers/keys/${t}`),n.pubKey)}await e.datastore.close(),t(100,"Stored each peerstore key under multiple datastore keys")}},Jv={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0};var Zv=[Object.assign({version:1},Jv),Object.assign({version:2},Jv),Object.assign({version:3},Jv),Object.assign({version:4},Jv),Object.assign({version:5},Jv),Object.assign({version:6},Jv),Object.assign({version:7},Jv),GE,hv,vv,Cv,Xv];class eB extends Error{constructor(e){super(e),this.name="NonReversibleMigrationError",this.code=eB.code,this.message=e}}eB.code="ERR_NON_REVERSIBLE_MIGRATION";class tB extends Error{constructor(e){super(e),this.name="NotInitializedRepoError",this.code=tB.code,this.message=e}}tB.code="ERR_NOT_INITIALIZED_REPO";class rB extends Error{constructor(e){super(e),this.name="RequiredParameterError",this.code=rB.code,this.message=e}}rB.code="ERR_REQUIRED_PARAMETER";class nB extends Error{constructor(e){super(e),this.name="InvalidValueError",this.code=nB.code,this.message=e}}nB.code="ERR_INVALID_VALUE";class sB extends Error{constructor(e){super(e),this.name="MissingRepoOptionsError",this.code=sB.code,this.message=e}}sB.code="ERR_MISSING_REPO_OPTIONS";const iB=R("ipfs:repo:migrator:repo:init");async function oB(e){if(!await async function(e){if(!e)throw new sB("Please pass repo options when trying to open a repo");const t=e.root;try{await t.open();const e=await t.has(fv),r=await t.has(dv);return!(!e||!r)||(iB(`Version entry present: ${e}`),iB(`Config entry present: ${r}`),!1)}catch(e){return iB("While checking if repo is initialized error was thrown: "+e.message),!1}finally{if(void 0!==t)try{await t.close()}catch{}}}(e))throw new tB("Repo is not initialized!");const t=e.root;await t.open();try{return parseInt(Ts(await t.get(fv)))}finally{await t.close()}}async function aB(e,t){if(!t)throw new sB("Please pass repo options when trying to open a repo");const r=t.root;await r.open(),await r.put(fv,vs(String(e))),await r.close()}const AB=R("ipfs:repo:migrator");async function cB(e,t,r,n,s={}){const i=s.ignoreLock??!1,o=s.onProgress,a=s.isDryRun??!1,A=s.migrations??Zv;if(!e)throw new uB.RequiredParameterError("Path argument is required!");if(!r)throw new uB.RequiredParameterError("repoOptions argument is required!");if(!n)throw new uB.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(n)||n<=0)throw new uB.InvalidValueError("Version has to be positive integer!");t=yv(t);const c=await oB(t);if(c===n)return void AB("Nothing to migrate.");if(c>n)throw new uB.InvalidValueError(`Current repo's version (${c}) is higher then toVersion (${n}), you probably wanted to revert it?`);let l;lB(A,c,n),a||i||(l=await r.repoLock.lock(e));try{for(const e of A){if(void 0!==n&&e.version>n)break;if(!(e.version<=c)){AB(`Migrating version ${e.version}`);try{if(!a){let r=()=>{};o&&(r=(t,r)=>o(e.version,t.toFixed(2),r)),await e.migrate(t,r)}}catch(r){const n=e.version-1;throw AB(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${n}`),await aB(n,t),new Error(`During migration to version ${e.version} exception was raised: ${r.stack||r.message||r}`)}AB(`Migrating to version ${e.version} finished`)}}a||await aB(n||function(e){return e=e||Zv,Array.isArray(e)&&0!==e.length?e[e.length-1].version:0}(A),t),AB("Repo successfully migrated",void 0!==n?`to version ${n}!`:"to latest version!")}finally{a||i||!l||await l.close()}}function lB(e,t,r,n=!1){let s=0;for(const i of e){if(i.version>r)break;if(i.version>t){if(n&&!i.revert)throw new uB.NonReversibleMigrationError(`It is not possible to revert to version ${t} because migration version ${i.version} is not reversible. Cancelling reversion.`);s++}}if(s!==r-t)throw new uB.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${t} to ${r}`)}const uB=_;var hB=r(79830);class dB extends Error{constructor(e){super(e),this.name="LockExistsError",this.code=dB.code}}dB.code="ERR_LOCK_EXISTS";class fB extends Error{constructor(e){super(e),this.name="NotFoundError",this.code=fB.code}}fB.code="ERR_NOT_FOUND";class pB extends Error{constructor(e){super(e),this.name="InvalidRepoVersionError",this.code=pB.code}}pB.code="ERR_INVALID_REPO_VERSION";const gB="ERR_REPO_NOT_INITIALIZED";async function yB(e,t,r){const n=await t(e);if(n)return n;const s=mB(r);return!!s&&new Promise(((t,r)=>{const n=s.store("readonly").get(e.toString());n.transaction.onabort=()=>{r(n.transaction.error)},n.transaction.oncomplete=()=>{t(Boolean(n.result))}}))}async function wB(e,t,r,n){if(await r(e))return t(e);const s=mB(n);if(!s)throw new fB;return new Promise(((t,r)=>{const n=s.store("readonly").get(e.toString());n.transaction.onabort=()=>{r(n.transaction.error)},n.transaction.oncomplete=()=>{if(n.result)return t(n.result);r(new fB)}}))}function mB(e){let t=e;for(;t.db||t.child;)if(t=t.db||t.child,"level-js"===t.type||"Level"===t.constructor.name)return t}const bB=R("ipfs:repo:version"),EB=new Ao("version");const vB=ua.default?ua.default:ua,BB=new Ao("config");var _B=r(42122),CB=r(74704),SB=r(861);function IB(e){if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)}const TB=new Ao("datastore_spec");function RB(e){return{exists(){return e.has(TB)},async get(){const t=await e.get(TB);return JSON.parse(Ts(t))},async set(t){return e.put(TB,vs(JSON.stringify(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!IB(e)&&!Array.isArray(e))throw new TypeError("Expected a plain object or array");var r=t.deep,n=t.compare,s=[],i=[],o=function e(t){var r=s.indexOf(t);if(-1!==r)return i[r];var n=[];return s.push(t),i.push(n),n.push.apply(n,SB(t.map((function(t){return Array.isArray(t)?e(t):IB(t)?a(t):t})))),n},a=function e(t){var a=s.indexOf(t);if(-1!==a)return i[a];var A={},c=Object.keys(t).sort(n);s.push(t),i.push(A);var l,u=CB(c);try{for(u.s();!(l=u.n()).done;){var h=l.value,d=t[h],f=void 0;f=r&&Array.isArray(d)?o(d):r&&IB(d)?e(d):d,Object.defineProperty(A,h,_B(_B({},Object.getOwnPropertyDescriptor(t,h)),{},{value:f}))}}catch(e){u.e(e)}finally{u.f()}return A};return Array.isArray(e)?r?o(e):e.slice():a(e)}(t,{deep:!0}))))}}}const kB=new Ao("api");function UB(e){const t=Ve.asCID(e);if(null==t)throw ie(new Error("Not a valid cid"),"ERR_INVALID_CID");return t.multihash.code!==Pn.code?{isIdentity:!1}:{isIdentity:!0,digest:t.multihash.digest}}const DB=R("ipfs:repo:lock:memory"),PB="repo.lock",LB={};const NB={lock:async function(e){const t=e+"/"+PB;if(DB("locking %s",t),!0===LB[t])throw new dB(`Lock already being held for file: ${t}`);return LB[t]=!0,{async close(){LB[t]&&delete LB[t]}}},locked:async function(e){const t=e+"/"+PB;return DB(`checking lock: ${t}`),Boolean(LB[t])}};var OB={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:NB},FB={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}};function QB(e){const t=Ve.asCID(e);if(null==t)throw ie(new Error("Not a valid cid"),"ERR_INVALID_CID");const r=j.encode(t.multihash.bytes);return new Ao("/"+r.slice(1).toUpperCase(),!1)}function xB(e){return Qe(j.decode(`b${e.toString().toLowerCase().substring(1)}`))}const MB=R("ipfs:repo:utils:walk-dag");async function*HB(e,t,r,n){try{const s=await t.get(e,n),i=Uw({bytes:s,cid:e,codec:await r(e.code)});for(const[,e]of i.links())yield e,yield*HB(e,t,r,n)}catch(t){throw MB("Could not walk DAG for CID",e.toString(),t),t}}class KB extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"==typeof e.maxAge&&0===e.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if("function"==typeof this.onEviction)for(const[t,r]of e)this.onEviction(t,r.value)}_deleteIfExpired(e,t){return"number"==typeof t.expiry&&t.expiry<=Date.now()&&("function"==typeof this.onEviction&&this.onEviction(e,t.value),this.delete(e))}_getOrDeleteIfExpired(e,t){if(!1===this._deleteIfExpired(e,t))return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){const r=t.get(e);return this._getItemValue(e,r)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(const e of this.oldCache){const[t,r]=e;if(!this.cache.has(t)){!1===this._deleteIfExpired(t,r)&&(yield e)}}for(const e of this.cache){const[t,r]=e;!1===this._deleteIfExpired(t,r)&&(yield e)}}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){const t=this.oldCache.get(e);if(!1===this._deleteIfExpired(e,t))return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:r=this.maxAge}={}){const n="number"==typeof r&&r!==Number.POSITIVE_INFINITY?Date.now()+r:void 0;this.cache.has(e)?this.cache.set(e,{value:t,expiry:n}):this._set(e,{value:t,expiry:n})}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):!!this.oldCache.has(e)&&!this._deleteIfExpired(e,this.oldCache.get(e))}peek(e){return this.cache.has(e)?this._peek(e,this.cache):this.oldCache.has(e)?this._peek(e,this.oldCache):void 0}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const t=[...this._entriesAscending()],r=t.length-e;r<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(r>0&&this._emitEvictions(t.slice(0,r)),this.oldCache=new Map(t.slice(r)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[t,r]=e;!1===this._deleteIfExpired(t,r)&&(yield[t,r.value])}for(const e of this.oldCache){const[t,r]=e;if(!this.cache.has(t)){!1===this._deleteIfExpired(t,r)&&(yield[t,r.value])}}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){const r=e[t],[n,s]=r;!1===this._deleteIfExpired(n,s)&&(yield[n,s.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){const r=e[t],[n,s]=r;if(!this.cache.has(n)){!1===this._deleteIfExpired(n,s)&&(yield[n,s.value])}}}*entriesAscending(){for(const[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(const[r,n]of this.entriesAscending())e.call(t,n,r,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}class VB{constructor({pinstore:e,blockstore:t,loadCodec:r}){this.pinstore=e,this.blockstore=t,this.loadCodec=r,this.log=R("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(e,t={}){await this.blockstore.get(e,t);const r={depth:0};return 0!==e.version&&(r.version=e.version),e.code!==Et&&(r.codec=e.code),t.metadata&&(r.metadata=t.metadata),this.pinstore.put(QB(e),Kr(r))}unpin(e,t){return this.pinstore.delete(QB(e),t)}async pinRecursively(e,t={}){await this.fetchCompleteDag(e,t);const r={depth:1/0};0!==e.version&&(r.version=e.version),e.code!==Et&&(r.codec=e.code),t.metadata&&(r.metadata=t.metadata),await this.pinstore.put(QB(e),Kr(r))}async*directKeys(e){for await(const e of this.pinstore.query({filters:[e=>0===qr(e.value).depth]})){const t=qr(e.value),r=t.version||0,n=null!=t.codec?t.codec:Et,s=xB(e.key);yield{cid:Ve.create(r,n,s),metadata:t.metadata}}}async*recursiveKeys(e){for await(const e of this.pinstore.query({filters:[e=>qr(e.value).depth===1/0]})){const t=qr(e.value),r=t.version||0,n=null!=t.codec?t.codec:Et,s=xB(e.key);yield{cid:Ve.create(r,n,s),metadata:t.metadata}}}async*indirectKeys(e){for await(const{cid:t}of this.recursiveKeys())for await(const r of HB(t,this.blockstore,this.loadCodec,e)){const e=[Oa.recursive];(await this.isPinnedWithType(r,e)).pinned||(yield r)}}async isPinnedWithType(e,t,r){Array.isArray(t)||(t=[t]);const n=t.includes(Oa.all),s=t.includes(Oa.direct),i=t.includes(Oa.recursive),o=t.includes(Oa.indirect);if(i||s||n){const r=await rm(this.pinstore.query({prefix:QB(e).toString(),filters:[e=>{if(n)return!0;const r=qr(e.value);return t.includes(0===r.depth?Oa.direct:Oa.recursive)}],limit:1}));if(r){const t=qr(r.value);return{cid:e,pinned:!0,reason:0===t.depth?Oa.direct:Oa.recursive,metadata:t.metadata}}}const a=this;if(n||o){const t=await rm(async function*(e,t){for await(const{cid:r}of t)for await(const t of HB(r,a.blockstore,a.loadCodec))if(t.equals(e))return void(yield r)}(e,this.recursiveKeys()));if(t)return{cid:e,pinned:!0,reason:Oa.indirect,parent:t}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,t={}){const r=new KB({maxSize:t.cidCacheMaxSize??2048}),n=async(e,t)=>{if(r.has(e.toString()))return;r.set(e.toString(),!0);const s=Uw({bytes:await this.blockstore.get(e,t),cid:e,codec:await this.loadCodec(e.code)});await Promise.all([...s.links()].map((([,e])=>n(e,t))))};await n(e,t)}static checkPinType(e){if("string"!=typeof e||!Object.keys(Oa).includes(e))throw function(e){return ie(new Error(`Invalid type '${e}', must be one of {direct, indirect, recursive, all}`),"ERR_INVALID_PIN_TYPE")}(e);return!0}}async function zB(e,t){const{pinned:r,reason:n}=await t.isPinnedWithType(e,Oa.all);if(r)throw ie(new Error(`pinned: ${n}`),"ERR_BLOCK_PINNED")}const jB=R("ipfs:repo:gc"),GB=Ka().code,$B=new Ao("/local/filesroot");function qB({gcLock:e,pins:t,blockstore:r,root:n,loadCodec:s}){return async function*(){const i=Date.now();jB("Creating set of marked blocks");const o=await e.writeLock();try{const e=await async function({pins:e,blockstore:t,loadCodec:r,root:n}){const s=async function*(){let e;try{e=await n.get($B)}catch(e){if(e.code===GB)return void jB("No blocks in MFS");throw e}const s=Ve.decode(e);yield s,yield*HB(s,t,r)}(),i=Mh(xh(e.recursiveKeys(),(({cid:e})=>e)),e.indirectKeys(),xh(e.directKeys(),(({cid:e})=>e)),s),o=new Set;for await(const e of Mh(i,s))o.add(j.encode(e.multihash.bytes));return o}({pins:t,blockstore:r,root:n,loadCodec:s}),a=r.queryKeys({});yield*async function*({blockstore:e},t,r){let n=0,s=0;const i=async r=>async function(){n++;try{const n=j.encode(r.multihash.bytes);if(t.has(n))return null;try{await e.delete(r),s++}catch(e){return{err:new Error(`Could not delete block with CID ${r}: ${e.message}`)}}return{cid:r}}catch(e){const t=`Could delete block with CID ${r}`;return jB(t,e),{err:new Error(t+`: ${e.message}`)}}};yield*zh(async function*(e,t=1){for await(const r of sd(e,t)){const e=r.map((async e=>await e().then((e=>({ok:!0,value:e})),(e=>({ok:!1,err:e})))));for(let t=0;t<e.length;t++){const r=await e[t];if(!r.ok)throw r.err;yield r.value}}}(xh(r,i),256),(e=>xu(e,Boolean))),jB(`Marked set has ${t.size} unique blocks. Blockstore has ${n} blocks. Deleted ${s} blocks.`)}({blockstore:r},e,a),jB(`Complete (${Date.now()-i}ms)`)}finally{o()}}}const WB=R("ipfs:repo"),YB=Number.MAX_SAFE_INTEGER;class XB{constructor(e,t,r,n){if("string"!=typeof e)throw new Error("missing repo path");if("function"!=typeof t)throw new Error("missing codec loader");this.options=I(OB,n),this.closed=!0,this.path=e,this.root=r.root,this.datastore=r.datastore,this.keys=r.keys;const s=r.blocks,i=r.pins;this.pins=new VB({pinstore:i,blockstore:s,loadCodec:t});const o=(a=this.pins,A=s,{open(){return A.open()},close(){return A.close()},query(e,t){return A.query(e,t)},queryKeys(e,t){return A.queryKeys(e,t)},async get(e,t){return A.get(e,t)},async*getMany(e,t){yield*A.getMany(e,t)},async put(e,t,r){await A.put(e,t,r)},async*putMany(e,t){yield*A.putMany(e,t)},has(e,t){return A.has(e,t)},async delete(e,t){return await zB(e,a),A.delete(e,t)},deleteMany(e,t){return A.deleteMany(xh(e,(async e=>(await zB(e,a),e))),t)},batch(){return A.batch()}});var a,A;this.blocks=function(e){return{open(){return e.open()},close(){return e.close()},query(t,r){return e.query(t,r)},queryKeys(t,r){return e.queryKeys(t,r)},async get(t,r){const n=UB(t);return n.isIdentity?Promise.resolve(n.digest):e.get(t,r)},async*getMany(e,t){for await(const r of e)yield this.get(r,t)},async put(t,r,n){const{isIdentity:s}=UB(t);s||await e.put(t,r,n)},async*putMany(t,r){const n=zu({objectMode:!0});(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)((async()=>{try{await Qu(e.putMany(async function*(){for await(const{key:e,value:r}of t)UB(e).isIdentity||(yield{key:e,value:r}),n.push({key:e,value:r})}())),n.end()}catch(e){n.end(e)}})),yield*n},has(t,r){const{isIdentity:n}=UB(t);return n?Promise.resolve(!0):e.has(t,r)},delete(t,r){const{isIdentity:n}=UB(t);return n?Promise.resolve():e.delete(t,r)},deleteMany(t,r){return e.deleteMany(xu(t,(e=>!UB(e).isIdentity)),r)},batch(){const t=e.batch();return{put(e,r){const{isIdentity:n}=UB(e);n||t.put(e,r)},delete(e){const{isIdentity:r}=UB(e);r||t.delete(e)},commit:e=>t.commit(e)}}}}(o),this.version=function(e){return{async exists(){return yB(EB,e.has.bind(e),e)},async get(){const t=await wB(EB,e.get.bind(e),e.has.bind(e),e);return parseInt(Ts(t),10)},set(t){return e.put(EB,vs(String(t)))},async check(e){const t=await this.get();return bB("comparing version: %s and %s",t,e),t===e||6===t&&7===e||6===e&&7===t}}}(this.root),this.config=function(e){const t=new vB({concurrency:1}),r={async getAll(t={}){const r=await wB(BB,e.get.bind(e),e.has.bind(e),e);return JSON.parse(Ts(r))},async get(e,t={}){if(null==e)throw new fB(`Key ${e} does not exist in config`);const r=await this.getAll(t),n=xE(r,e);if(void 0===n)throw new fB(`Key ${e} does not exist in config`);return n},set(e,r,s={}){if("string"!=typeof e&&!(e instanceof String))throw ie(new Error("Invalid key type: "+typeof e),"ERR_INVALID_KEY");if(void 0===r||r instanceof Uint8Array)throw ie(new Error("Invalid value type: "+typeof r),"ERR_INVALID_VALUE");return t.add((()=>n({key:e,value:r},s.signal)))},replace(e,r={}){if(!e||e instanceof Uint8Array)throw ie(new Error("Invalid value type: "+typeof e),"ERR_INVALID_VALUE");return t.add((()=>n({key:void 0,value:e},r.signal)))},async exists(){return yB(BB,e.has.bind(e),e)}};return r;async function n(e,t){if(t&&t.aborted)return;const n=e.key,i=e.value;if(n){const e=await r.getAll();return"object"==typeof e&&null!==e&&bw(e,n,i),s(e)}return s(i)}function s(t){const r=vs(JSON.stringify(t,null,2));return e.put(BB,r)}}(this.root),this.spec=RB(this.root),this.apiAddr=function(e){return{async get(){const t=await e.get(kB);return t&&t.toString()},set(t){return e.put(kB,vs(t.toString()))},delete(){return e.delete(kB)}}}(this.root),this.gcLock=Km({name:e,singleProcess:!1!==this.options.repoOwner}),this.gc=qB({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:t})}async init(e){var t;WB("initializing at: %s",this.path),await this._openRoot(),await this.config.replace((t=e,t.Datastore=Object.assign({},FB,xE(t,"datastore")),t)),await this.spec.set(function(e){const t={...FB.Spec,...xE(e,"Datastore.Spec")};return{type:t.type,mounts:t.mounts.map((e=>({mountpoint:e.mountpoint,type:e.child.type,path:e.child.path,shardFunc:e.child.shardFunc})))}}(e)),await this.version.set(12)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch(e){return!1}}async open(){if(!this.closed)throw ie(new Error("repo is already open"),"ERR_REPO_ALREADY_OPEN");WB("opening at: %s",this.path);try{await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),WB("acquired repo.lock");if(!await this.version.check(12)){if(!await this._isAutoMigrationEnabled())throw new pB("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");await this._migrate(12,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys})}WB("creating datastore"),await this.datastore.open(),WB("creating blocks"),await this.blocks.open(),WB("creating keystore"),await this.keys.open(),WB("creating pins"),await this.pins.pinstore.open(),this.closed=!1,WB("all opened")}catch(e){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(e){WB("error removing lock",e)}throw e}}async _openRoot(){try{await this.root.open()}catch(e){if("Already open"!==e.message)throw e}}async _openLock(){const e=await this.options.repoLock.lock(this.path);if("function"!=typeof e.close)throw ie(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){let e;WB("init check");try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(e){if("ERR_NOT_FOUND"===e.code)throw ie(new Error("repo is not initialized yet"),gB,{path:this.path});throw e}if(!e)throw ie(new Error("repo is not initialized yet"),gB,{path:this.path})}async close(){if(this.closed)throw ie(new Error("repo is already closed"),"ERR_REPO_ALREADY_CLOSED");WB("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(e){if(e.code!==gB&&!e.message.startsWith("ENOENT"))throw e}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map((e=>e&&e.close()))),WB("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){const[e,t,r,n,s]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),JB(this.datastore),JB(this.keys)]),i=t.size+n+s;return{repoPath:this.path,storageMax:e,version:r,numObjects:t.count,repoSize:i}}throw ie(new Error("repo is not initialized yet"),gB,{path:this.path})}async _isAutoMigrationEnabled(){if(void 0!==this.options.autoMigrate)return this.options.autoMigrate;let e;try{e=await this.config.get("repoAutoMigrate")}catch(t){if(t.code!==fB.code)throw t;e=!0}return e}async _migrate(e,t){return await this.version.get()>e?(WB(`reverting to version ${e}`),async function(e,t,r,n,s={}){const i=s.ignoreLock??!1,o=s.onProgress,a=s.isDryRun??!1,A=s.migrations??Zv;if(!e)throw new uB.RequiredParameterError("Path argument is required!");if(!r)throw new uB.RequiredParameterError("repoOptions argument is required!");if(!n)throw new uB.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(n)||n<=0)throw new uB.InvalidValueError("Version has to be positive integer!");t=yv(t);const c=await oB(t);if(c===n)return void AB("Nothing to revert.");if(c<n)throw new uB.InvalidValueError(`Current repo's version (${c}) is lower then toVersion (${n}), you probably wanted to migrate it?`);let l;lB(A,n,c,!0),a||i||(l=await r.repoLock.lock(e)),AB(`Reverting from version ${c} to ${n}`);try{const e=A.slice().reverse();for(const r of e){if(r.version<=n)break;if(!(r.version>c)){AB(`Reverting migration version ${r.version}`);try{if(!a){let e=()=>{};o&&(e=(e,t)=>o(r.version,e.toFixed(2),t)),await r.revert(t,e)}}catch(e){const n=r.version;throw AB(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${n}`),await aB(n,t),e.message=`During reversion to version ${r.version} exception was raised: ${e.message}`,e}AB(`Reverting to version ${r.version} finished`)}}a||await aB(n,t),AB(`All migrations successfully reverted to version ${n}!`)}finally{a||i||!l||await l.close()}}(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(WB(`migrating to version ${e}`),cB(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{const e=await this.config.get("Datastore.StorageMax");return BigInt(hB(e))}catch(e){return BigInt(YB)}}async _blockStat(){let e=BigInt(0),t=BigInt(0);if(this.blocks)for await(const{key:r,value:n}of this.blocks.query({}))e+=BigInt(1),t+=BigInt(n.byteLength),t+=BigInt(r.bytes.byteLength);return{count:e,size:t}}}async function JB(e){let t=BigInt(0);for await(const r of e.query({}))t+=BigInt(r.value.byteLength),t+=BigInt(r.key.uint8Array().byteLength);return t}async function*ZB(e,t){const r=await Ou(e);yield*r.sort(t)}var e_=r(21301);class t_ extends Hu{constructor(e,t={}){super(),this.db="string"==typeof e?new e_.Level(e,{...t,keyEncoding:"utf8",valueEncoding:"view"}):e,this.opts={createIfMissing:!0,compression:!1,...t}}async open(){try{await this.db.open(this.opts)}catch(e){throw xa(e)}}async put(e,t){try{await this.db.put(e.toString(),t)}catch(e){throw Ha(e)}}async get(e){let t;try{t=await this.db.get(e.toString())}catch(e){if(e.notFound)throw Ka(e);throw Ha(e)}return t}async has(e){try{await this.db.get(e.toString())}catch(e){if(e.notFound)return!1;throw e}return!0}async delete(e){try{await this.db.del(e.toString())}catch(e){throw Ma(e)}}close(){return this.db&&this.db.close()}batch(){const e=[];return{put:(t,r)=>{e.push({type:"put",key:t.toString(),value:r})},delete:t=>{e.push({type:"del",key:t.toString()})},commit:()=>this.db.batch(e)}}query(e){let t=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(t=e.filters.reduce(((e,t)=>xu(e,t)),t)),Array.isArray(e.orders)&&(t=e.orders.reduce(((e,t)=>ZB(e,t)),t));const{offset:r,limit:n}=e;if(r){let e=0;t=xu(t,(()=>e++>=r))}return n&&(t=Mu(t,n)),t}queryKeys(e){let t=xh(this._query({values:!1,prefix:e.prefix}),(({key:e})=>e));Array.isArray(e.filters)&&(t=e.filters.reduce(((e,t)=>xu(e,t)),t)),Array.isArray(e.orders)&&(t=e.orders.reduce(((e,t)=>ZB(e,t)),t));const{offset:r,limit:n}=e;if(r){let e=0;t=xu(t,(()=>e++>=r))}return n&&(t=Mu(t,n)),t}_query(e){const t={keys:!0,keyEncoding:"buffer",values:e.values};if(null!=e.prefix){const r=e.prefix.toString();t.gte=r,t.lt=r+""}const r=this.db.iterator(t);if(r[Symbol.asyncIterator])return async function*(e){for await(const[t,r]of e)yield{key:new Ao(t,!1),value:r};await e.close()}(r);if(null!=r.next&&null!=r.end)return n=r,{[Symbol.asyncIterator](){return{next:()=>new Promise(((e,t)=>{n.next(((r,s,i)=>r?t(r):null==s?n.end((r=>{if(r)return t(r);e({done:!0,value:void 0})})):void e({done:!1,value:{key:new Ao(s,!1),value:i}})))})),return:()=>new Promise(((e,t)=>{n.end((r=>{if(r)return t(r);e({done:!0,value:void 0})}))}))}}};var n;throw new Error("Level returned incompatible iterator")}}const r_=(e,t)=>async function*(){const r=await Ou(e);yield*r.sort(t)}();class n_{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,r){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(const{key:r,value:n}of e)await this.put(r,n,t),yield{key:r,value:n}}async*getMany(e,t={}){for await(const r of e)yield this.get(r,t)}async*deleteMany(e,t={}){for await(const r of e)await this.delete(r,t),yield r}batch(){let e=[],t=[];return{put(t,r){e.push({key:t,value:r})},delete(e){t.push(e)},commit:async r=>{await Qu(this.putMany(e,r)),e=[],await Qu(this.deleteMany(t,r)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let r=this._all(e,t);if(null!=e.prefix&&(r=xu(r,(t=>t.key.toString().startsWith(e.prefix||"")))),Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>xu(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>r_(e,t)),r)),null!=e.offset){let t=0;r=xu(r,(()=>t++>=(e.offset||0)))}return null!=e.limit&&(r=Mu(r,e.limit)),r}queryKeys(e,t){let r=this._allKeys(e,t);if(null!=e.prefix&&(r=xu(r,(t=>t.toString().startsWith(e.prefix||"")))),Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>xu(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>r_(e,t)),r)),null!=e.offset){let t=0;r=xu(r,(()=>t++>=e.offset))}return null!=e.limit&&(r=Mu(r,e.limit)),r}}function s_(e){const t=Ve.asCID(e);if(!t)throw ie(new Error("Not a valid cid"),"ERR_INVALID_CID");return new Ao("/"+j.encode(t.multihash.bytes).slice(1).toUpperCase(),!1)}function i_(e){return Ve.createV1(Yn,Qe(j.decode("b"+e.toString().slice(1).toLowerCase())))}function o_(e){const t=e.substring(0,1);if("/"===t)return o_(e.substring(1));let r,n;r="b"===t.toLowerCase()?e=>j.decode(e.toLowerCase()).subarray(2):"c"===t.toLowerCase()?e=>$.decode(e.toLowerCase()).subarray(2):"z"===t?e=>V.decode(e).subarray(2):"Q"===t?e=>V.decode("z"+e):e=>j.decode("b"+e.toLowerCase()).subarray(2);for(let t=1;t<e.length;t++)try{n=r(e.substring(0,t))}catch(e){if("Unexpected end of data"!==e.message)throw e}let s="/C";return n&&(s=`/${j.encode(n).slice(1,-1).toUpperCase()||"C"}`),s}class a_ extends n_{constructor(e){super(),this.child=e}open(){return this.child.open()}close(){return this.child.close()}async*query(e,t){for await(const{key:r,value:n}of this.child.query(function(e){return{...e,prefix:e.prefix?o_(e.prefix):void 0,filters:e.filters?e.filters.map((e=>t=>e({key:i_(t.key),value:t.value}))):void 0,orders:e.orders?e.orders.map((e=>(t,r)=>e({key:i_(t.key),value:t.value},{key:i_(r.key),value:r.value}))):void 0}}(e),t))yield{key:i_(r),value:n}}async*queryKeys(e,t){for await(const r of this.child.queryKeys(function(e){return{...e,prefix:e.prefix?o_(e.prefix):void 0,filters:e.filters?e.filters.map((e=>t=>e(i_(t)))):void 0,orders:e.orders?e.orders.map((e=>(t,r)=>e(i_(t),i_(r)))):void 0}}(e),t))yield i_(r)}async get(e,t){return this.child.get(s_(e),t)}async*getMany(e,t){for await(const r of e)yield this.get(r,t)}async put(e,t,r){await this.child.put(s_(e),t,r)}async*putMany(e,t){const r=zu({objectMode:!0});(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)((async()=>{try{const n=this.child;await Qu(this.child.putMany(async function*(){for await(const s of e){const e=s_(s.key);await n.has(e,t)||(yield{key:e,value:s.value}),r.push(s)}}())),r.end()}catch(e){r.end(e)}})),yield*r}has(e,t){return this.child.has(s_(e),t)}delete(e,t){return this.child.delete(s_(e),t)}deleteMany(e,t){const r=zu({objectMode:!0});return Qu(this.child.deleteMany(async function*(){for await(const t of e)yield s_(t),r.push(t);r.end()}(),t)).catch((e=>{r.end(e)})),r}}function A_(e,t,r){const n=r.path||"ipfs";return function(e,t,r,n){return new XB(e,t,r,n)}(n,(e=>t.getCodec(e)),{root:new t_(n,{prefix:"",version:2}),blocks:new a_(new t_(`${n}/blocks`,{prefix:"",version:2})),datastore:new t_(`${n}/datastore`,{prefix:"",version:2}),keys:new t_(`${n}/keys`,{prefix:"",version:2}),pins:new t_(`${n}/pins`,{prefix:"",version:2})},{autoMigrate:r.autoMigrate,onMigrationProgress:r.onMigrationProgress||e,repoLock:NB})}const c_="ERR_SIGNATURE_NOT_VALID";var l_;function u_(e){return e instanceof Uint8Array?{get(t){return e[t]},set(t,r){e[t]=r}}:{get(t){return e.get(t)},set(t,r){e.set(t,r)}}}!function(e){let t;e.codec=()=>(null==t&&(t=aA(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),(!0===r.writeDefaults||null!=e.publicKey&&e.publicKey.byteLength>0)&&(t.uint32(10),t.bytes(e.publicKey)),(!0===r.writeDefaults||null!=e.payloadType&&e.payloadType.byteLength>0)&&(t.uint32(18),t.bytes(e.payloadType)),(!0===r.writeDefaults||null!=e.payload&&e.payload.byteLength>0)&&(t.uint32(26),t.bytes(e.payload)),(!0===r.writeDefaults||null!=e.signature&&e.signature.byteLength>0)&&(t.uint32(42),t.bytes(e.signature)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.publicKey=e.bytes();break;case 2:r.payloadType=e.bytes();break;case 3:r.payload=e.bytes();break;case 5:r.signature=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>Za(t,e.codec()),e.decode=t=>Ja(t,e.codec())}(l_||(l_={}));const h_=4294967296;class d_{constructor(e=0,t=0){this.hi=e,this.lo=t}toBigInt(e){if(!0===e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!=0){const e=1+~this.lo>>>0;let t=~this.hi>>>0;return 0===e&&(t=t+1>>>0),-(BigInt(e)+(BigInt(t)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(e){return Number(this.toBigInt(e))}zzDecode(){const e=-(1&this.lo),t=((this.lo>>>1|this.hi<<31)^e)>>>0,r=(this.hi>>>1^e)>>>0;return new d_(r,t)}zzEncode(){const e=this.hi>>31,t=((this.hi<<1|this.lo>>>31)^e)>>>0,r=(this.lo<<1^e)>>>0;return new d_(t,r)}toBytes(e,t=0){const r=u_(e);for(;this.hi>0;)r.set(t++,127&this.lo|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)r.set(t++,127&this.lo|128),this.lo=this.lo>>>7;r.set(t++,this.lo)}static fromBigInt(e){if(0n===e)return new d_;const t=e<0;t&&(e=-e);let r=0|Number(e>>32n),n=0|Number(e-(BigInt(r)<<32n));return t&&(r=~r>>>0,n=~n>>>0,++n>h_&&(n=0,++r>h_&&(r=0))),new d_(r,n)}static fromNumber(e){if(0===e)return new d_;const t=e<0;t&&(e=-e);let r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new d_(n,r)}static fromBytes(e,t=0){const r=u_(e),n=new d_;let s=0;if(e.length-t>4){for(;s<4;++s)if(n.lo=(n.lo|(127&r.get(t))<<7*s)>>>0,r.get(t++)<128)return n;if(n.lo=(n.lo|(127&r.get(t))<<28)>>>0,n.hi=(n.hi|(127&r.get(t))>>4)>>>0,r.get(t++)<128)return n;s=0}else for(;s<4;++s){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(n.lo=(n.lo|(127&r.get(t))<<7*s)>>>0,r.get(t++)<128)return n}if(e.length-t>4){for(;s<5;++s)if(n.hi=(n.hi|(127&r.get(t))<<7*s+3)>>>0,r.get(t++)<128)return n}else if(t<e.byteLength)for(;s<5;++s){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(n.hi=(n.hi|(127&r.get(t))<<7*s+3)>>>0,r.get(t++)<128)return n}throw RangeError("invalid varint encoding")}}const f_=Math.pow(2,7),p_=Math.pow(2,14),g_=Math.pow(2,21),y_=Math.pow(2,28),w_=Math.pow(2,35),m_=Math.pow(2,42),b_=Math.pow(2,49),E_=Math.pow(2,56),v_=Math.pow(2,63),B_={encodingLength(e){return e<f_?1:e<p_?2:e<g_?3:e<y_?4:e<w_?5:e<m_?6:e<b_?7:e<E_?8:e<v_?9:10},encode(e,t,r=0){if(null!=Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return null==t&&(t=ys(B_.encodingLength(e))),d_.fromNumber(e).toBytes(t,r),t},decode(e,t=0){return d_.fromBytes(e,t).toNumber(!0)}};class __{constructor(e){const{peerId:t,payloadType:r,payload:n,signature:s}=e;this.peerId=t,this.payloadType=r,this.payload=n,this.signature=s}marshal(){if(null==this.peerId.publicKey)throw new Error("Missing public key");return null==this.marshaled&&(this.marshaled=l_.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(e){return ii(this.marshal(),e.marshal())}async validate(e){const t=C_(e,this.payloadType,this.payload);if(null==this.peerId.publicKey)throw new Error("Missing public key");const r=eu(this.peerId.publicKey);return await r.verify(t.subarray(),this.signature)}}__.createFromProtobuf=async e=>{const t=l_.decode(e),r=await ka(t.publicKey);return new __({peerId:r,payloadType:t.payloadType,payload:t.payload,signature:t.signature})},__.seal=async(e,t)=>{if(null==t.privateKey)throw new Error("Missing private key");const r=e.domain,n=e.codec,s=e.marshal(),i=C_(r,n,s),o=await ru(t.privateKey),a=await o.sign(i.subarray());return new __({peerId:t,payloadType:n,payload:s,signature:a})},__.openAndCertify=async(e,t)=>{const r=await __.createFromProtobuf(e);if(!await r.validate(t))throw ie(new Error("envelope signature is not valid for the given domain"),c_);return r};const C_=(e,t,r)=>{const n=vs(e),s=B_.encode(n.byteLength),i=B_.encode(t.length),o=B_.encode(r.length);return new Bd(s,n,i,t,o,r)};var S_;!function(e){let t,r;!function(e){let t;e.codec=()=>(null==t&&(t=aA(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),(!0===r.writeDefaults||null!=e.multiaddr&&e.multiaddr.byteLength>0)&&(t.uint32(10),t.bytes(e.multiaddr)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={multiaddr:new Uint8Array(0)},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();if(t>>>3==1)r.multiaddr=e.bytes();else e.skipType(7&t)}return r}))),t),e.encode=t=>Za(t,e.codec()),e.decode=t=>Ja(t,e.codec())}(t=e.AddressInfo||(e.AddressInfo={})),e.codec=()=>(null==r&&(r=aA(((t,r,n={})=>{if(!1!==n.lengthDelimited&&r.fork(),(!0===n.writeDefaults||null!=t.peerId&&t.peerId.byteLength>0)&&(r.uint32(10),r.bytes(t.peerId)),!0!==n.writeDefaults&&0n===t.seq||(r.uint32(16),r.uint64(t.seq)),null!=t.addresses)for(const n of t.addresses)r.uint32(26),e.AddressInfo.codec().encode(n,r,{writeDefaults:!0});!1!==n.lengthDelimited&&r.ldelim()}),((t,r)=>{const n={peerId:new Uint8Array(0),seq:0n,addresses:[]},s=null==r?t.len:t.pos+r;for(;t.pos<s;){const r=t.uint32();switch(r>>>3){case 1:n.peerId=t.bytes();break;case 2:n.seq=t.uint64();break;case 3:n.addresses.push(e.AddressInfo.codec().decode(t,t.uint32()));break;default:t.skipType(7&r)}}return n}))),r),e.encode=t=>Za(t,e.codec()),e.decode=t=>Ja(t,e.codec())}(S_||(S_={}));const I_=Uint8Array.from([3,1]);class T_{constructor(e){this.domain=T_.DOMAIN,this.codec=T_.CODEC;const{peerId:t,multiaddrs:r,seqNumber:n}=e;this.peerId=t,this.multiaddrs=r??[],this.seqNumber=n??BigInt(Date.now())}marshal(){return null==this.marshaled&&(this.marshaled=S_.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map((e=>({multiaddr:e.bytes})))})),this.marshaled}equals(e){return e instanceof T_&&(!!this.peerId.equals(e.peerId)&&(this.seqNumber===e.seqNumber&&!!function(e,t){const r=(e,t)=>e.toString().localeCompare(t.toString());return e.length===t.length&&(t.sort(r),e.sort(r).every(((e,r)=>t[r].equals(e))))}(this.multiaddrs,e.multiaddrs)))}}T_.createFromProtobuf=e=>{const t=S_.decode(e),r=Ra(t.peerId),n=(t.addresses??[]).map((e=>mi(e.multiaddr))),s=t.seq;return new T_({peerId:r,multiaddrs:n,seqNumber:s})},T_.DOMAIN="libp2p-peer-record",T_.CODEC=I_;const R_=Symbol.for("@libp2p/topology");const k_=()=>{};class U_{constructor(e){this.min=e.min??0,this.max=e.max??1/0,this.peers=new Set,this.onConnect=e.onConnect??k_,this.onDisconnect=e.onDisconnect??k_}get[Symbol.toStringTag](){return R_.toString()}get[R_](){return!0}async setRegistrar(e){this.registrar=e}disconnect(e){this.onDisconnect(e)}}function D_(e){return new U_(e)}var P_,L_=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};class N_ extends EventTarget{constructor(){super(...arguments),P_.set(this,new Map)}listenerCount(e){const t=L_(this,P_,"f").get(e);return null==t?0:t.length}addEventListener(e,t,r){super.addEventListener(e,t,r);let n=L_(this,P_,"f").get(e);null==n&&(n=[],L_(this,P_,"f").set(e,n)),n.push({callback:t,once:(!0!==r&&!1!==r&&r?.once)??!1})}removeEventListener(e,t,r){super.removeEventListener(e.toString(),t??null,r);let n=L_(this,P_,"f").get(e);null!=n&&(n=n.filter((({callback:e})=>e!==t)),L_(this,P_,"f").set(e,n))}dispatchEvent(e){const t=super.dispatchEvent(e);let r=L_(this,P_,"f").get(e.type);return null==r||(r=r.filter((({once:e})=>!e)),L_(this,P_,"f").set(e.type,r)),t}safeDispatchEvent(e,t){return this.dispatchEvent(new F_(e,t))}}P_=new WeakMap;class O_ extends Event{constructor(e,t){super(e,t),this.detail=t?.detail}}const F_=globalThis.CustomEvent??O_;class Q_{constructor(e,t,r){this.gossip=e,this.msgs=new Map,this.history=[],this.notValidatedCount=0,this.msgIdToStrFn=r;for(let e=0;e<t;e++)this.history[e]=[]}get size(){return this.msgs.size}put(e,t,r=!1){const{msgIdStr:n}=e;return!this.msgs.has(n)&&(this.msgs.set(n,{message:t,validated:r,originatingPeers:new Set,iwantCounts:new Map}),this.history[0].push({...e,topic:t.topic}),r||this.notValidatedCount++,!0)}observeDuplicate(e,t){const r=this.msgs.get(e);r&&!r.validated&&r.originatingPeers.add(t)}get(e){return this.msgs.get(this.msgIdToStrFn(e))?.message}getWithIWantCount(e,t){const r=this.msgs.get(e);if(!r)return null;const n=(r.iwantCounts.get(t)??0)+1;return r.iwantCounts.set(t,n),{msg:r.message,count:n}}getGossipIDs(e){const t=new Map;for(let r=0;r<this.gossip;r++)this.history[r].forEach((r=>{const n=this.msgs.get(r.msgIdStr);if(n&&n.validated&&e.has(r.topic)){let e=t.get(r.topic);e||(e=[],t.set(r.topic,e)),e.push(r.msgId)}}));return t}validate(e){const t=this.msgs.get(e);if(!t)return null;t.validated||this.notValidatedCount--;const{message:r,originatingPeers:n}=t;return t.validated=!0,t.originatingPeers=new Set,{message:r,originatingPeers:n}}shift(){this.history[this.history.length-1].forEach((e=>{const t=this.msgs.get(e.msgIdStr);t&&(this.msgs.delete(e.msgIdStr),t.validated||this.notValidatedCount--)})),this.history.pop(),this.history.unshift([])}remove(e){const t=this.msgs.get(e);return t?(this.msgs.delete(e),t):null}}var x_=r(64482);const{RPC:M_}=x_,H_="/floodsub/1.0.0",K_="/meshsub/1.0.0",V_="/meshsub/1.1.0",z_=5e3;function j_(e){if(e.length<=1)return e;for(let t=0;t<e.length;t++){const r=Math.floor(Math.random()*Math.floor(e.length)),n=e[t];e[t]=e[r],e[r]=n}return e}function G_(e){return Ts(e,"base64")}const $_="StrictSign",q_="StrictNoSign";var W_,Y_,X_,J_,Z_,eC;function tC(e){switch(e){case W_.Ignore:return J_.Ignore;case W_.Reject:return J_.Reject}}!function(e){e.Accept="accept",e.Ignore="ignore",e.Reject="reject"}(W_||(W_={})),function(e){e.StrictSign="StrictSign",e.StrictNoSign="StrictNoSign"}(Y_||(Y_={})),function(e){e[e.Signing=0]="Signing",e[e.Anonymous=1]="Anonymous"}(X_||(X_={})),function(e){e.Error="error",e.Ignore="ignore",e.Reject="reject",e.Blacklisted="blacklisted"}(J_||(J_={})),function(e){e.InvalidSignature="invalid_signature",e.InvalidSeqno="invalid_seqno",e.InvalidPeerId="invalid_peerid",e.SignaturePresent="signature_present",e.SeqnoPresent="seqno_present",e.FromPresent="from_present",e.TransformFailed="transform_failed"}(Z_||(Z_={})),function(e){e.duplicate="duplicate",e.invalid="invalid",e.valid="valid"}(eC||(eC={}));const rC="ERR_INVALID_PEER_SCORE_PARAMS",nC={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:36e5},sC={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function iC(e={}){return{...nC,...e,topics:e.topics?Object.entries(e.topics).reduce(((e,[t,r])=>(e[t]=function(e={}){return{...sC,...e}}(r),e)),{}):{}}}function oC(e){if(e.topicWeight<0)throw new wa("invalid topic weight; must be >= 0",rC);if(0===e.timeInMeshQuantum)throw new wa("invalid TimeInMeshQuantum; must be non zero",rC);if(e.timeInMeshWeight<0)throw new wa("invalid TimeInMeshWeight; must be positive (or 0 to disable)",rC);if(0!==e.timeInMeshWeight&&e.timeInMeshQuantum<=0)throw new wa("invalid TimeInMeshQuantum; must be positive",rC);if(0!==e.timeInMeshWeight&&e.timeInMeshCap<=0)throw new wa("invalid TimeInMeshCap; must be positive",rC);if(e.firstMessageDeliveriesWeight<0)throw new wa("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)",rC);if(0!==e.firstMessageDeliveriesWeight&&(e.firstMessageDeliveriesDecay<=0||e.firstMessageDeliveriesDecay>=1))throw new wa("invalid FirstMessageDeliveriesDecay; must be between 0 and 1",rC);if(0!==e.firstMessageDeliveriesWeight&&e.firstMessageDeliveriesCap<=0)throw new wa("invalid FirstMessageDeliveriesCap; must be positive",rC);if(e.meshMessageDeliveriesWeight>0)throw new wa("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)",rC);if(0!==e.meshMessageDeliveriesWeight&&(e.meshMessageDeliveriesDecay<=0||e.meshMessageDeliveriesDecay>=1))throw new wa("invalid MeshMessageDeliveriesDecay; must be between 0 and 1",rC);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesCap<=0)throw new wa("invalid MeshMessageDeliveriesCap; must be positive",rC);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesThreshold<=0)throw new wa("invalid MeshMessageDeliveriesThreshold; must be positive",rC);if(e.meshMessageDeliveriesWindow<0)throw new wa("invalid MeshMessageDeliveriesWindow; must be non-negative",rC);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesActivation<1e3)throw new wa("invalid MeshMessageDeliveriesActivation; must be at least 1s",rC);if(e.meshFailurePenaltyWeight>0)throw new wa("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)",rC);if(0!==e.meshFailurePenaltyWeight&&(e.meshFailurePenaltyDecay<=0||e.meshFailurePenaltyDecay>=1))throw new wa("invalid MeshFailurePenaltyDecay; must be between 0 and 1",rC);if(e.invalidMessageDeliveriesWeight>0)throw new wa("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)",rC);if(e.invalidMessageDeliveriesDecay<=0||e.invalidMessageDeliveriesDecay>=1)throw new wa("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1",rC)}const aC={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function AC(e={}){return{...aC,...e}}function cC(e,t,r,n){let s=0;Object.entries(t.topics).forEach((([e,t])=>{const n=r.topics[e];if(void 0===n)return;let i=0;if(t.inMesh){let e=t.meshTime/n.timeInMeshQuantum;e>n.timeInMeshCap&&(e=n.timeInMeshCap),i+=e*n.timeInMeshWeight}let o=t.firstMessageDeliveries;if(o>n.firstMessageDeliveriesCap&&(o=n.firstMessageDeliveriesCap),i+=o*n.firstMessageDeliveriesWeight,t.meshMessageDeliveriesActive&&t.meshMessageDeliveries<n.meshMessageDeliveriesThreshold){const e=n.meshMessageDeliveriesThreshold-t.meshMessageDeliveries;i+=e*e*n.meshMessageDeliveriesWeight}i+=t.meshFailurePenalty*n.meshFailurePenaltyWeight;i+=t.invalidMessageDeliveries*t.invalidMessageDeliveries*n.invalidMessageDeliveriesWeight,s+=i*n.topicWeight})),r.topicScoreCap>0&&s>r.topicScoreCap&&(s=r.topicScoreCap);const i=r.appSpecificScore(e);if(s+=i*r.appSpecificWeight,t.knownIPs.forEach((e=>{if(r.IPColocationFactorWhitelist.has(e))return;const t=n.get(e),i=t?t.size:0;if(i>r.IPColocationFactorThreshold){const e=i-r.IPColocationFactorThreshold;s+=e*e*r.IPColocationFactorWeight}})),t.behaviourPenalty>r.behaviourPenaltyThreshold){const e=t.behaviourPenalty-r.behaviourPenaltyThreshold;s+=e*e*r.behaviourPenaltyWeight}return s}var lC,uC=r(45001);!function(e){e[e.unknown=0]="unknown",e[e.valid=1]="valid",e[e.invalid=2]="invalid",e[e.ignored=3]="ignored"}(lC||(lC={}));class hC{constructor(){this.records=new Map,this.queue=new uC}ensureRecord(e){let t=this.records.get(e);if(t)return t;t={status:lC.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(e,t);const r={msgId:e,expire:Date.now()+12e4};return this.queue.push(r),t}gc(){const e=Date.now();let t=this.queue.peekFront();for(;t&&t.expire<e;)this.records.delete(t.msgId),this.queue.shift(),t=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}}function dC(e,t,r=(()=>!0)){const n=new Set;if(t<=0)return n;for(const s of e){if(n.size>=t)break;r(s)&&(n.add(s),e.delete(s))}return n}class fC extends Map{constructor(e){super(),this.getDefault=e}getOrDefault(e){let t=super.get(e);return void 0===t&&(t=this.getDefault(),this.set(e,t)),t}}const pC=se("libp2p:gossipsub:score");class gC{constructor(e,t,r){this.params=e,this.metrics=t,this.peerStats=new Map,this.peerIPs=new fC((()=>new Set)),this.scoreCache=new Map,this.deliveryRecords=new hC,function(e){for(const[t,r]of Object.entries(e.topics))try{oC(r)}catch(e){throw new wa(`invalid score parameters for topic ${t}: ${e.message}`,rC)}if(e.topicScoreCap<0)throw new wa("invalid topic score cap; must be positive (or 0 for no cap)",rC);if(null===e.appSpecificScore||void 0===e.appSpecificScore)throw new wa("missing application specific score function",rC);if(e.IPColocationFactorWeight>0)throw new wa("invalid IPColocationFactorWeight; must be negative (or 0 to disable)",rC);if(0!==e.IPColocationFactorWeight&&e.IPColocationFactorThreshold<1)throw new wa("invalid IPColocationFactorThreshold; must be at least 1",rC);if(e.behaviourPenaltyWeight>0)throw new wa("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)",rC);if(0!==e.behaviourPenaltyWeight&&(e.behaviourPenaltyDecay<=0||e.behaviourPenaltyDecay>=1))throw new wa("invalid BehaviourPenaltyDecay; must be between 0 and 1",rC);if(e.decayInterval<1e3)throw new wa("invalid DecayInterval; must be at least 1s",rC);if(e.decayToZero<=0||e.decayToZero>=1)throw new wa("invalid DecayToZero; must be between 0 and 1",rC)}(e),this.scoreCacheValidityMs=r.scoreCacheValidityMs,this.computeScore=r.computeScore??cC}get size(){return this.peerStats.size}start(){this._backgroundInterval?pC("Peer score already running"):(this._backgroundInterval=setInterval((()=>this.background()),this.params.decayInterval),pC("started"))}stop(){this._backgroundInterval?(clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),pC("stopped")):pC("Peer score already stopped")}background(){this.refreshScores(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map((([e,t])=>[e,t])))}refreshScores(){const e=Date.now(),t=this.params.decayToZero;this.peerStats.forEach(((r,n)=>{r.connected?(Object.entries(r.topics).forEach((([r,n])=>{const s=this.params.topics[r];void 0!==s&&(n.firstMessageDeliveries*=s.firstMessageDeliveriesDecay,n.firstMessageDeliveries<t&&(n.firstMessageDeliveries=0),n.meshMessageDeliveries*=s.meshMessageDeliveriesDecay,n.meshMessageDeliveries<t&&(n.meshMessageDeliveries=0),n.meshFailurePenalty*=s.meshFailurePenaltyDecay,n.meshFailurePenalty<t&&(n.meshFailurePenalty=0),n.invalidMessageDeliveries*=s.invalidMessageDeliveriesDecay,n.invalidMessageDeliveries<t&&(n.invalidMessageDeliveries=0),n.inMesh&&(n.meshTime=e-n.graftTime,n.meshTime>s.meshMessageDeliveriesActivation&&(n.meshMessageDeliveriesActive=!0)))})),r.behaviourPenalty*=this.params.behaviourPenaltyDecay,r.behaviourPenalty<t&&(r.behaviourPenalty=0)):e>r.expire&&(this.removeIPsForPeer(n,r.knownIPs),this.peerStats.delete(n),this.scoreCache.delete(n))}))}score(e){this.metrics?.scoreFnCalls.inc();const t=this.peerStats.get(e);if(!t)return 0;const r=Date.now(),n=this.scoreCache.get(e);if(n&&n.cacheUntil>r)return n.score;this.metrics?.scoreFnRuns.inc();const s=this.computeScore(e,t,this.params,this.peerIPs),i=r+this.scoreCacheValidityMs;return n?(this.metrics?.scoreCachedDelta.observe(Math.abs(s-n.score)),n.score=s,n.cacheUntil=i):this.scoreCache.set(e,{score:s,cacheUntil:i}),s}addPenalty(e,t,r){const n=this.peerStats.get(e);n&&(n.behaviourPenalty+=t,this.metrics?.onScorePenalty(r))}addPeer(e){const t={connected:!0,expire:0,topics:{},knownIPs:new Set,behaviourPenalty:0};this.peerStats.set(e,t)}addIP(e,t){const r=this.peerStats.get(e);r&&r.knownIPs.add(t),this.peerIPs.getOrDefault(t).add(e)}removeIP(e,t){const r=this.peerStats.get(e);r&&r.knownIPs.delete(t);const n=this.peerIPs.get(t);n&&(n.delete(e),0===n.size&&this.peerIPs.delete(t))}removePeer(e){const t=this.peerStats.get(e);if(t){if(this.score(e)>0)return this.removeIPsForPeer(e,t.knownIPs),void this.peerStats.delete(e);Object.entries(t.topics).forEach((([e,t])=>{t.firstMessageDeliveries=0;const r=this.params.topics[e].meshMessageDeliveriesThreshold;if(t.inMesh&&t.meshMessageDeliveriesActive&&t.meshMessageDeliveries<r){const e=r-t.meshMessageDeliveries;t.meshFailurePenalty+=e*e}t.inMesh=!1,t.meshMessageDeliveriesActive=!1})),t.connected=!1,t.expire=Date.now()+this.params.retainScore}}graft(e,t){const r=this.peerStats.get(e);if(r){const e=this.getPtopicStats(r,t);e&&(e.inMesh=!0,e.graftTime=Date.now(),e.meshTime=0,e.meshMessageDeliveriesActive=!1)}}prune(e,t){const r=this.peerStats.get(e);if(r){const e=this.getPtopicStats(r,t);if(e){const r=this.params.topics[t].meshMessageDeliveriesThreshold;if(e.meshMessageDeliveriesActive&&e.meshMessageDeliveries<r){const t=r-e.meshMessageDeliveries;e.meshFailurePenalty+=t*t}e.meshMessageDeliveriesActive=!1,e.inMesh=!1}}}validateMessage(e){this.deliveryRecords.ensureRecord(e)}deliverMessage(e,t,r){this.markFirstMessageDelivery(e,r);const n=this.deliveryRecords.ensureRecord(t),s=Date.now();n.status===lC.unknown?(n.status=lC.valid,n.validated=s,n.peers.forEach((t=>{t!==e.toString()&&this.markDuplicateMessageDelivery(t,r)}))):pC("unexpected delivery: message from %s was first seen %s ago and has delivery status %s",e,s-n.firstSeen,lC[n.status])}rejectInvalidMessage(e,t){this.markInvalidMessageDelivery(e,t)}rejectMessage(e,t,r,n){switch(n){case J_.Error:return void this.markInvalidMessageDelivery(e,r);case J_.Blacklisted:return}const s=this.deliveryRecords.ensureRecord(t);if(s.status===lC.unknown){if(n===J_.Ignore)return s.status=lC.ignored,void s.peers.clear();s.status=lC.invalid,this.markInvalidMessageDelivery(e,r),s.peers.forEach((e=>{this.markInvalidMessageDelivery(e,r)})),s.peers.clear()}else pC("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",e,Date.now()-s.firstSeen,lC[s.status])}duplicateMessage(e,t,r){const n=this.deliveryRecords.ensureRecord(t);if(!n.peers.has(e))switch(n.status){case lC.unknown:n.peers.add(e);break;case lC.valid:n.peers.add(e),this.markDuplicateMessageDelivery(e,r,n.validated);break;case lC.invalid:this.markInvalidMessageDelivery(e,r);case lC.ignored:}}markInvalidMessageDelivery(e,t){const r=this.peerStats.get(e);if(r){const e=this.getPtopicStats(r,t);e&&(e.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(e,t){const r=this.peerStats.get(e);if(r){const e=this.getPtopicStats(r,t);if(e){let r=this.params.topics[t].firstMessageDeliveriesCap;e.firstMessageDeliveries=Math.min(r,e.firstMessageDeliveries+1),e.inMesh&&(r=this.params.topics[t].meshMessageDeliveriesCap,e.meshMessageDeliveries=Math.min(r,e.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(e,t,r){const n=this.peerStats.get(e);if(n){const e=void 0!==r?Date.now():0,s=this.getPtopicStats(n,t);if(s&&s.inMesh){const n=this.params.topics[t];if(void 0!==r){const s=e-r,i=s>n.meshMessageDeliveriesWindow;if(this.metrics?.onDuplicateMsgDelivery(t,s,i),i)return}const i=n.meshMessageDeliveriesCap;s.meshMessageDeliveries=Math.min(i,s.meshMessageDeliveries+1)}}}removeIPsForPeer(e,t){for(const r of t){const t=this.peerIPs.get(r);t&&(t.delete(e),0===t.size&&this.peerIPs.delete(r))}}getPtopicStats(e,t){let r=e.topics[t];return void 0!==r?r:void 0!==this.params.topics[t]?(r={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},e.topics[t]=r,r):null}}class yC{constructor(e,t,r){this.gossipsubIWantFollowupMs=e,this.msgIdToStrFn=t,this.metrics=r,this.promises=new Map,this.requestMsByMsg=new Map,this.requestMsByMsgExpire=10*e}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(e,t){const r=t[Math.floor(Math.random()*t.length)],n=this.msgIdToStrFn(r);let s=this.promises.get(n);s||(s=new Map,this.promises.set(n,s));const i=Date.now();s.has(e)||(s.set(e,i+this.gossipsubIWantFollowupMs),this.metrics&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(n)||this.requestMsByMsg.set(n,i)))}getBrokenPromises(){const e=Date.now(),t=new Map;let r=0;return this.promises.forEach(((n,s)=>{n.forEach(((s,i)=>{s<e&&(t.set(i,(t.get(i)??0)+1),n.delete(i),r++)})),n.size||this.promises.delete(s)})),this.metrics?.iwantPromiseBroken.inc(r),t}deliverMessage(e,t=!1){this.trackMessage(e);const r=this.promises.get(e);r&&(this.promises.delete(e),this.metrics&&(this.metrics.iwantPromiseResolved.inc(1),t&&this.metrics.iwantPromiseResolvedFromDuplicate.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(r.size)))}rejectMessage(e,t){this.trackMessage(e),t!==J_.Error&&this.promises.delete(e)}clear(){this.promises.clear()}prune(){const e=Date.now()-this.requestMsByMsgExpire;let t=0;for(const[r,n]of this.requestMsByMsg.entries()){if(!(n<e))break;this.requestMsByMsg.delete(r),t++}this.metrics?.iwantMessagePruned.inc(t)}trackMessage(e){if(this.metrics){const t=this.requestMsByMsg.get(e);void 0!==t&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-t)/1e3),this.requestMsByMsg.delete(e))}}}class wC{constructor(e){this.entries=new Map,this.validityMs=e.validityMs}get size(){return this.entries.size}put(e,t){return!!this.entries.has(e)||(this.entries.set(e,{value:t,validUntilMs:Date.now()+this.validityMs}),!1)}prune(){const e=Date.now();for(const[t,r]of this.entries.entries()){if(!(r.validUntilMs<e))break;this.entries.delete(t)}}has(e){return this.entries.has(e)}get(e){const t=this.entries.get(e);return t&&t.validUntilMs>=Date.now()?t.value:void 0}clear(){this.entries.clear()}}var mC,bC,EC,vC,BC,_C;!function(e){e.forward="forward",e.publish="publish"}(mC||(mC={})),function(e){e.Fanout="fanout",e.Random="random",e.Subscribed="subscribed",e.Outbound="outbound",e.NotEnough="not_enough",e.Opportunistic="opportunistic"}(bC||(bC={})),function(e){e.Dc="disconnected",e.BadScore="bad_score",e.Prune="prune",e.Unsub="unsubscribed",e.Excess="excess"}(EC||(EC={})),function(e){e.GraftBackoff="graft_backoff",e.BrokenPromise="broken_promise",e.MessageDeficit="message_deficit",e.IPColocation="IP_colocation"}(vC||(vC={})),function(e){e.LowScore="low_score",e.MaxIhave="max_ihave",e.MaxIasked="max_iasked"}(BC||(BC={})),function(e){e.graylist="graylist",e.publish="publish",e.gossip="gossip",e.mesh="mesh"}(_C||(_C={}));r(8925);var CC=r(98960);const SC={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function IC(e,t,r,n,s){if("sha1"!==s&&"sha2-256"!==s&&"sha2-512"!==s){const e=Object.keys(SC).join(" / ");throw new wa(`Hash '${s}' is unknown or not supported. Must be ${e}`,"ERR_UNSUPPORTED_HASH_TYPE")}const i=CC(e,t,r,n,SC[s]);return lA.encode64(i,null)}const TC=vs("libp2p-pubsub:");function RC(e){if("signed"!==e.type)throw new Error("expected signed message type");if(null==e.sequenceNumber)throw Error("missing seqno field");return((e,t)=>{const r=vs(t.toString(16).padStart(16,"0"),"base16"),n=new Uint8Array(e.length+r.length);return n.set(e,0),n.set(r,e.length),n})(e.from.toBytes(),e.sequenceNumber)}async function kC(e){return await $n.encode(e.data)}function UC(e,t,r,n,s){let i=0;const o=new Map;if(Object.entries(t.topics).forEach((([e,t])=>{const n=s.get(e)??"unknown",a=r.topics[e];if(void 0===a)return;let A=o.get(n);A||(A={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},o.set(n,A));let c=0,l=0,u=0,h=0,d=0;if(t.inMesh){c+=Math.max(t.meshTime/a.timeInMeshQuantum,a.timeInMeshCap)*a.timeInMeshWeight}let f=t.firstMessageDeliveries;if(f>a.firstMessageDeliveriesCap&&(f=a.firstMessageDeliveriesCap),l+=f*a.firstMessageDeliveriesWeight,t.meshMessageDeliveriesActive&&t.meshMessageDeliveries<a.meshMessageDeliveriesThreshold){const e=a.meshMessageDeliveriesThreshold-t.meshMessageDeliveries;u+=e*e*a.meshMessageDeliveriesWeight}h+=t.meshFailurePenalty*a.meshFailurePenaltyWeight;d+=t.invalidMessageDeliveries*t.invalidMessageDeliveries*a.invalidMessageDeliveriesWeight,i+=(c+l+u+h+d)*a.topicWeight,A.p1w+=c,A.p2w+=l,A.p3w+=u,A.p3bw+=h,A.p4w+=d})),r.topicScoreCap>0&&i>r.topicScoreCap){i=r.topicScoreCap;const e=r.topicScoreCap/i;for(const t of o.values())t.p1w*=e,t.p2w*=e,t.p3w*=e,t.p3bw*=e,t.p4w*=e}let a=0,A=0,c=0;a+=r.appSpecificScore(e)*r.appSpecificWeight,t.knownIPs.forEach((e=>{if(r.IPColocationFactorWhitelist.has(e))return;const t=n.get(e),s=t?t.size:0;if(s>r.IPColocationFactorThreshold){const e=s-r.IPColocationFactorThreshold;A+=e*e*r.IPColocationFactorWeight}}));return c+=t.behaviourPenalty*t.behaviourPenalty*r.behaviourPenaltyWeight,i+=a+A+c,{byTopic:o,p5w:a,p6w:A,p7w:c,score:i}}class DC extends Error{constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}function PC(e,t,r){const n=r??{},s=function(e){if(null!=e){if("function"==typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"==typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"==typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}(e);return async function*(){let r;const i=()=>{null!=r&&r()};for(t.addEventListener("abort",i);;){let o;try{if(t.aborted){const{abortMessage:e,abortCode:t}=n;throw new DC(e,t)}const e=new Promise(((e,t)=>{r=()=>{const{abortMessage:e,abortCode:r}=n;t(new DC(e,r))}}));o=await Promise.race([e,s.next()]),r=null}catch(r){t.removeEventListener("abort",i);const o="aborted"===r.type&&t.aborted;if(o&&null!=n.onAbort&&await n.onAbort(e),"function"==typeof s.return)try{const e=s.return();e instanceof Promise&&e.catch((e=>{null!=n.onReturnError&&n.onReturnError(e)}))}catch(e){null!=n.onReturnError&&n.onReturnError(e)}if(o&&!0===n.returnOnAbort)return;throw r}if(!0===o.done)break;yield o.value}t.removeEventListener("abort",i)}()}function LC(e,t,r){return n=>e(PC(n,t,r))}function NC(e,t,r){return{sink:LC(e.sink,t,{...r,onAbort:void 0}),source:PC(e.source,t,r)}}const OC=e=>{const t=B_.encodingLength(e),r=(n=t,null!=globalThis?.Buffer?.allocUnsafe?globalThis.Buffer.allocUnsafe(n):new Uint8Array(n));var n;return B_.encode(e,r),OC.bytes=t,r};function FC(e){const t=(e=e??{}).lengthEncoder??OC;return async function*(e){for await(const r of e){const e=t(r.byteLength);e instanceof Uint8Array?yield e:yield*e,r instanceof Uint8Array?yield r:yield*r}}}OC.bytes=0,FC.single=(e,t)=>{const r=(t=t??{}).lengthEncoder??OC;return new Bd(r(e.byteLength),e)};var QC;!function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"}(QC||(QC={}));const xC=e=>{const t=B_.decode(e);return xC.bytes=B_.encodingLength(t),t};function MC(e){return async function*(t){const r=new Bd;let n=QC.LENGTH,s=-1;const i=e?.lengthDecoder??xC,o=e?.maxLengthLength??8,a=e?.maxDataLength??4194304;for await(const A of t)for(r.append(A);r.byteLength>0;){if(n===QC.LENGTH)try{if(s=i(r),s<0)throw ie(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(s>a)throw ie(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");const t=i.bytes;r.consume(t),null!=e?.onLength&&e.onLength(s),n=QC.DATA}catch(e){if(e instanceof RangeError){if(r.byteLength>o)throw ie(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw e}if(n===QC.DATA){if(r.byteLength<s)break;const t=r.sublist(0,s);r.consume(s),null!=e?.onData&&e.onData(t),yield t,n=QC.LENGTH}}if(r.byteLength>0)throw ie(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}}xC.bytes=0,MC.fromReader=(e,t)=>{let r=1;const n=async function*(){for(;;)try{const{done:t,value:n}=await e.next(r);if(!0===t)return;null!=n&&(yield n)}catch(e){if("ERR_UNDER_READ"===e.code)return{done:!0,value:null};throw e}finally{r=1}}();return MC({...t??{},onLength:e=>{r=e}})(n)};class HC{constructor(e,t,r){this.rawStream=e,this.pushable=zu({objectMode:!1}),this.closeController=new AbortController,this.maxBufferSize=r.maxBufferSize??1/0,zh(PC(this.pushable,this.closeController.signal,{returnOnAbort:!0}),FC(),this.rawStream).catch(t)}get protocol(){return this.rawStream.stat.protocol}push(e){if(this.pushable.readableLength>this.maxBufferSize)throw Error(`OutboundStream buffer full, size > ${this.maxBufferSize}`);this.pushable.push(e)}close(){this.closeController.abort(),this.pushable.return(),this.rawStream.close()}}class KC{constructor(e,t={}){this.rawStream=e,this.closeController=new AbortController,this.source=PC(zh(this.rawStream,MC(t)),this.closeController.signal,{returnOnAbort:!0})}close(){this.closeController.abort(),this.rawStream.close()}}var VC=r(42450);const zC={maxSubscriptions:1/0,maxMessages:1/0,maxIhaveMessageIDs:1/0,maxIwantMessageIDs:1/0,maxControlMessages:1/0,maxPeerInfos:1/0};function jC(e,t){t={...t};const r=VC.Reader.create(e),n=e.length,s=void 0===n?r.len:r.pos+n,i={};for(;r.pos<s;){const e=r.uint32();switch(e>>>3){case 1:i.subscriptions&&i.subscriptions.length||(i.subscriptions=[]),i.subscriptions.length<t.maxSubscriptions?i.subscriptions.push(GC(r,r.uint32())):r.skipType(7&e);break;case 2:i.messages&&i.messages.length||(i.messages=[]),i.messages.length<t.maxMessages?i.messages.push($C(r,r.uint32())):r.skipType(7&e);break;case 3:i.control=qC(r,r.uint32(),t);break;default:r.skipType(7&e)}}return i}function GC(e,t){const r=void 0===t?e.len:e.pos+t,n={};for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.subscribe=e.bool();break;case 2:n.topic=e.string();break;default:e.skipType(7&t)}}return n}function $C(e,t){const r=void 0===t?e.len:e.pos+t,n={};for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.from=e.bytes();break;case 2:n.data=e.bytes();break;case 3:n.seqno=e.bytes();break;case 4:n.topic=e.string();break;case 5:n.signature=e.bytes();break;case 6:n.key=e.bytes();break;default:e.skipType(7&t)}}if(!n.topic)throw Error("missing required 'topic'");return n}function qC(e,t,r){const n=void 0===t?e.len:e.pos+t,s={};for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:s.ihave&&s.ihave.length||(s.ihave=[]),s.ihave.length<r.maxControlMessages?s.ihave.push(WC(e,e.uint32(),r)):e.skipType(7&t);break;case 2:s.iwant&&s.iwant.length||(s.iwant=[]),s.iwant.length<r.maxControlMessages?s.iwant.push(YC(e,e.uint32(),r)):e.skipType(7&t);break;case 3:s.graft&&s.graft.length||(s.graft=[]),s.graft.length<r.maxControlMessages?s.graft.push(XC(e,e.uint32())):e.skipType(7&t);break;case 4:s.prune&&s.prune.length||(s.prune=[]),s.prune.length<r.maxControlMessages?s.prune.push(JC(e,e.uint32(),r)):e.skipType(7&t);break;default:e.skipType(7&t)}}return s}function WC(e,t,r){const n=void 0===t?e.len:e.pos+t,s={};for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:s.topicID=e.string();break;case 2:s.messageIDs&&s.messageIDs.length||(s.messageIDs=[]),r.maxIhaveMessageIDs-- >0?s.messageIDs.push(e.bytes()):e.skipType(7&t);break;default:e.skipType(7&t)}}return s}function YC(e,t,r){const n=void 0===t?e.len:e.pos+t,s={};for(;e.pos<n;){const t=e.uint32();if(t>>>3==1)s.messageIDs&&s.messageIDs.length||(s.messageIDs=[]),r.maxIwantMessageIDs-- >0?s.messageIDs.push(e.bytes()):e.skipType(7&t);else e.skipType(7&t)}return s}function XC(e,t){const r=void 0===t?e.len:e.pos+t,n={};for(;e.pos<r;){const t=e.uint32();if(t>>>3==1)n.topicID=e.string();else e.skipType(7&t)}return n}function JC(e,t,r){const n=void 0===t?e.len:e.pos+t,s={};for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:s.topicID=e.string();break;case 2:s.peers&&s.peers.length||(s.peers=[]),r.maxPeerInfos-- >0?s.peers.push(ZC(e,e.uint32())):e.skipType(7&t);break;case 3:s.backoff=e.uint64();break;default:e.skipType(7&t)}}return s}function ZC(e,t){const r=void 0===t?e.len:e.pos+t,n={};for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.peerID=e.bytes();break;case 2:n.signedPeerRecord=e.bytes();break;default:e.skipType(7&t)}}return n}var eS;!function(e){e[e.ip4=4]="ip4",e[e.ip6=41]="ip6"}(eS||(eS={}));var tS;!function(e){e[e.started=0]="started",e[e.stopped=1]="stopped"}(tS||(tS={}));class rS extends N_{constructor(e,t={}){super(),this.multicodecs=[V_,K_],this.peers=new Set,this.streamsInbound=new Map,this.streamsOutbound=new Map,this.outboundInflightQueue=zu({objectMode:!0}),this.direct=new Set,this.floodsubPeers=new Set,this.acceptFromWhitelist=new Map,this.topics=new Map,this.subscriptions=new Set,this.mesh=new Map,this.fanout=new Map,this.fanoutLastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.topicValidators=new Map,this.heartbeatTicks=0,this.directPeerInitial=null,this.status={code:tS.stopped},this.heartbeatTimer=null,this.runHeartbeat=()=>{const e=this.metrics?.heartbeatDuration.startTimer();this.heartbeat().catch((e=>{this.log("Error running heartbeat",e)})).finally((()=>{if(null!=e&&e(),this.status.code===tS.started){clearTimeout(this.status.heartbeatTimeout);let e=this.opts.heartbeatInterval-(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;e<.25*this.opts.heartbeatInterval&&(e+=this.opts.heartbeatInterval,this.metrics?.heartbeatSkipped.inc()),this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,e)}}))};const r={fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:6,Dlo:4,Dhi:12,Dscore:4,Dout:2,Dlazy:6,heartbeatInterval:1e3,fanoutTTL:6e4,mcacheLength:5,mcacheGossip:3,seenTTL:12e4,gossipsubIWantFollowupMs:3e3,prunePeers:16,pruneBackoff:6e4,graftFloodThreshold:1e4,opportunisticGraftPeers:2,opportunisticGraftTicks:60,directConnectTicks:300,...t,scoreParams:iC(t.scoreParams),scoreThresholds:AC(t.scoreThresholds)};if(this.components=e,this.decodeRpcLimits=r.decodeRpcLimits??zC,this.globalSignaturePolicy=r.globalSignaturePolicy??$_,r.fallbackToFloodsub&&this.multicodecs.push(H_),this.log=se(r.debugName??"libp2p:gossipsub"),this.opts=r,this.direct=new Set(r.directPeers.map((e=>e.id.toString()))),this.seenCache=new wC({validityMs:r.seenTTL}),this.publishedMessageIds=new wC({validityMs:r.seenTTL}),t.msgIdFn)this.msgIdFn=t.msgIdFn;else switch(this.globalSignaturePolicy){case $_:this.msgIdFn=RC;break;case q_:this.msgIdFn=kC}if(t.fastMsgIdFn&&(this.fastMsgIdFn=t.fastMsgIdFn,this.fastMsgIdCache=new wC({validityMs:r.seenTTL})),this.msgIdToStrFn=t.msgIdToStrFn??G_,this.mcache=t.messageCache||new Q_(r.mcacheGossip,r.mcacheLength,this.msgIdToStrFn),t.dataTransform&&(this.dataTransform=t.dataTransform),t.metricsRegister){if(!t.metricsTopicStrToLabel)throw Error("Must set metricsTopicStrToLabel with metrics");const e=Math.max(...Object.values(r.scoreParams.topics).map((e=>e.meshMessageDeliveriesWindow)),1e3),n=function(e,t,r){return{protocolsEnabled:e.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:e.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:e.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:e.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEvents:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_total",help:"Number of times we include peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),meshPeerChurnEvents:e.gauge({name:"gossipsub_peer_churn_events_total",help:"Number of times we remove peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),peersPerProtocol:e.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:e.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:e.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),asyncValidationResult:e.gauge({name:"gossipsub_async_validation_result_total",help:"Message validation result for each topic",labelNames:["topic","acceptance"]}),asyncValidationMcacheHit:e.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),rpcRecvBytes:e.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:e.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:e.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:e.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:e.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:e.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:e.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:e.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:e.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcRecvNotAccepted:e.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:e.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:e.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:e.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:e.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:e.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:e.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:e.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:e.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:e.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:e.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeers:e.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),msgPublishPeersByGroup:e.gauge({name:"gossipsub_msg_publish_peers_by_group",help:"Total count of peers (by group) that we publish a msg to",labelNames:["topic","peerGroup"]}),msgPublishBytes:e.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgForwardCount:e.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:e.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:e.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedStatus:e.gauge({name:"gossipsub_msg_received_status_total",help:"Tracks distribution of recv msgs by duplicate, invalid, valid",labelNames:["topic","status"]}),msgReceivedInvalid:e.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["topic","error"]}),duplicateMsgDeliveryDelay:e.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*r.maxMeshMessageDeliveriesWindowSec,.5*r.maxMeshMessageDeliveriesWindowSec,1*r.maxMeshMessageDeliveriesWindowSec,2*r.maxMeshMessageDeliveriesWindowSec,4*r.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:e.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),duplicateMsgIgnored:e.gauge({name:"gossisub_ignored_published_duplicate_msgs_total",help:"Total count of published duplicate message ignored by topic",labelNames:["topic"]}),scoreFnCalls:e.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:e.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:e.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:e.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:e.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores",labelNames:["topic","p"]}),scoreWeights:e.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:e.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:e.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:e.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*r.behaviourPenaltyThreshold,.5*r.behaviourPenaltyThreshold,1*r.behaviourPenaltyThreshold,2*r.behaviourPenaltyThreshold,4*r.behaviourPenaltyThreshold]}),ihaveRcvIgnored:e.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:e.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:e.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:e.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:e.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:e.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:e.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedFromDuplicate:e.gauge({name:"gossipsub_iwant_promise_resolved_from_duplicate_total",help:"Total count of resolved IWANT promises from duplicate messages"}),iwantPromiseResolvedPeers:e.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:e.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantMessagePruned:e.gauge({name:"gossipsub_iwant_message_pruned",help:"Total count of pruned IWANT messages"}),iwantPromiseDeliveryTime:e.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*r.gossipPromiseExpireSec,1*r.gossipPromiseExpireSec,2*r.gossipPromiseExpireSec,4*r.gossipPromiseExpireSec]}),cacheSize:e.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:e.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),mcacheNotValidatedCount:e.gauge({name:"gossipsub_mcache_not_validated_count",help:"Current mcache msg count not validated"}),fastMsgIdCacheCollision:e.gauge({name:"gossipsub_fastmsgid_cache_collision_total",help:"Total count of key collisions on fastmsgid cache put"}),newConnectionCount:e.gauge({name:"gossipsub_new_connection_total",help:"Total new connection by status",labelNames:["status"]}),topicStrToLabel:t,toTopic(e){return this.topicStrToLabel.get(e)??e},onJoin(e){this.topicSubscriptionStatus.set({topicStr:e},1),this.meshPeerCounts.set({topicStr:e},0)},onLeave(e){this.topicSubscriptionStatus.set({topicStr:e},0),this.meshPeerCounts.set({topicStr:e},0)},onAddToMesh(e,t,r){const n=this.toTopic(e);this.meshPeerInclusionEvents.inc({topic:n,reason:t},r)},onRemoveFromMesh(e,t,r){const n=this.toTopic(e);this.meshPeerChurnEvents.inc({topic:n,reason:t},r)},onReportValidationMcacheHit(e){this.asyncValidationMcacheHit.inc({hit:e?"hit":"miss"})},onReportValidation(e,t){const r=this.toTopic(e);this.asyncValidationResult.inc({topic:r,acceptance:t})},onScorePenalty(e){this.scoringPenalties.inc({penalty:e},1)},onIhaveRcv(e,t,r){const n=this.toTopic(e);this.ihaveRcvMsgids.inc({topic:n},t),this.ihaveRcvNotSeenMsgids.inc({topic:n},r)},onIwantRcv(e,t){for(const[t,r]of e){const e=this.toTopic(t);this.iwantRcvMsgids.inc({topic:e},r)}this.iwantRcvDonthaveMsgids.inc(t)},onForwardMsg(e,t){const r=this.toTopic(e);this.msgForwardCount.inc({topic:r},1),this.msgForwardPeers.inc({topic:r},t)},onPublishMsg(e,t,r,n){const s=this.toTopic(e);this.msgPublishCount.inc({topic:s},1),this.msgPublishBytes.inc({topic:s},r*n),this.msgPublishPeers.inc({topic:s},r),this.msgPublishPeersByGroup.inc({topic:s,peerGroup:"direct"},t.direct),this.msgPublishPeersByGroup.inc({topic:s,peerGroup:"floodsub"},t.floodsub),this.msgPublishPeersByGroup.inc({topic:s,peerGroup:"mesh"},t.mesh),this.msgPublishPeersByGroup.inc({topic:s,peerGroup:"fanout"},t.fanout)},onMsgRecvPreValidation(e){const t=this.toTopic(e);this.msgReceivedPreValidation.inc({topic:t},1)},onMsgRecvResult(e,t){const r=this.toTopic(e);this.msgReceivedStatus.inc({topic:r,status:t})},onMsgRecvInvalid(e,t){const r=this.toTopic(e),n=t.reason===J_.Error?t.error:t.reason;this.msgReceivedInvalid.inc({topic:r,error:n},1)},onDuplicateMsgDelivery(e,t,r){if(this.duplicateMsgDeliveryDelay.observe(t/1e3),r){const t=this.toTopic(e);this.duplicateMsgLateDelivery.inc({topic:t},1)}},onPublishDuplicateMsg(e){const t=this.toTopic(e);this.duplicateMsgIgnored.inc({topic:t},1)},onRpcRecv(e,t){this.rpcRecvBytes.inc(t),this.rpcRecvCount.inc(1),e.subscriptions&&this.rpcRecvSubscription.inc(e.subscriptions.length),e.messages&&this.rpcRecvMessage.inc(e.messages.length),e.control&&(this.rpcRecvControl.inc(1),e.control.ihave&&this.rpcRecvIHave.inc(e.control.ihave.length),e.control.iwant&&this.rpcRecvIWant.inc(e.control.iwant.length),e.control.graft&&this.rpcRecvGraft.inc(e.control.graft.length),e.control.prune&&this.rpcRecvPrune.inc(e.control.prune.length))},onRpcSent(e,t){if(this.rpcSentBytes.inc(t),this.rpcSentCount.inc(1),e.subscriptions&&this.rpcSentSubscription.inc(e.subscriptions.length),e.messages&&this.rpcSentMessage.inc(e.messages.length),e.control){const t=e.control.ihave?.length??0,r=e.control.iwant?.length??0,n=e.control.graft?.length??0,s=e.control.prune?.length??0;t>0&&this.rpcSentIHave.inc(t),r>0&&this.rpcSentIWant.inc(r),n>0&&this.rpcSentGraft.inc(n),s>0&&this.rpcSentPrune.inc(s),(t>0||r>0||n>0||s>0)&&this.rpcSentControl.inc(1)}},registerScores(e,t){let r=0,n=0,s=0,i=0;for(const o of e)o>=t.graylistThreshold&&r++,o>=t.publishThreshold&&n++,o>=t.gossipThreshold&&s++,o>=0&&i++;this.peersByScoreThreshold.set({threshold:_C.graylist},r),this.peersByScoreThreshold.set({threshold:_C.publish},n),this.peersByScoreThreshold.set({threshold:_C.gossip},s),this.peersByScoreThreshold.set({threshold:_C.mesh},i),this.score.set(e)},registerScoreWeights(e){for(const[t,r]of e.byTopic)this.scoreWeights.set({topic:t,p:"p1"},r.p1w),this.scoreWeights.set({topic:t,p:"p2"},r.p2w),this.scoreWeights.set({topic:t,p:"p3"},r.p3w),this.scoreWeights.set({topic:t,p:"p3b"},r.p3bw),this.scoreWeights.set({topic:t,p:"p4"},r.p4w);this.scoreWeights.set({p:"p5"},e.p5w),this.scoreWeights.set({p:"p6"},e.p6w),this.scoreWeights.set({p:"p7"},e.p7w)},registerScorePerMesh(e,t){const r=new Map;e.forEach(((e,t)=>{const n=this.topicStrToLabel.get(t)??"unknown";let s=r.get(n);s||(s=new Set,r.set(n,s)),e.forEach((e=>s?.add(e)))}));for(const[e,n]of r){const r=[];n.forEach((e=>{r.push(t.get(e)??0)})),this.scorePerMesh.set({topic:e},r)}}}}(t.metricsRegister,t.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:r.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:e/1e3});n.mcacheSize.addCollect((()=>this.onScrapeMetrics(n)));for(const e of this.multicodecs)n.protocolsEnabled.set({protocol:e},1);this.metrics=n}else this.metrics=null;this.gossipTracer=new yC(this.opts.gossipsubIWantFollowupMs,this.msgIdToStrFn,this.metrics),this.score=new gC(this.opts.scoreParams,this.metrics,{scoreCacheValidityMs:r.heartbeatInterval}),this.maxInboundStreams=t.maxInboundStreams,this.maxOutboundStreams=t.maxOutboundStreams,this.allowedTopics=r.allowedTopics?new Set(r.allowedTopics):null}getPeers(){return[...this.peers.keys()].map((e=>Ta(e)))}isStarted(){return this.status.code===tS.started}async start(){if(this.isStarted())return;this.log("starting"),this.publishConfig=await async function(e,t){switch(e){case $_:{if(!t)throw Error("Must provide PeerId");if(null==t.privateKey)throw Error("Cannot sign message, no private key present");if(null==t.publicKey)throw Error("Cannot sign message, no public key present");const e=await ru(t.privateKey);return{type:X_.Signing,author:t,key:t.publicKey,privateKey:e}}case q_:return{type:X_.Anonymous};default:throw new Error(`Unknown signature policy "${e}"`)}}(this.globalSignaturePolicy,this.components.peerId),this.outboundInflightQueue=zu({objectMode:!0}),zh(this.outboundInflightQueue,(async e=>{for await(const{peerId:t,connection:r}of e)await this.createOutboundStream(t,r)})).catch((e=>this.log.error("outbound inflight queue error",e))),await Promise.all(this.opts.directPeers.map((async e=>{await this.components.peerStore.addressBook.add(e.id,e.addrs)})));const e=this.components.registrar;await Promise.all(this.multicodecs.map((t=>e.handle(t,this.onIncomingStream.bind(this),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}))));const t=D_({onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this)}),r=await Promise.all(this.multicodecs.map((r=>e.register(r,t)))),n=setTimeout(this.runHeartbeat,100);this.status={code:tS.started,registrarTopologyIds:r,heartbeatTimeout:n,hearbeatStartMs:Date.now()+100},this.score.start(),this.directPeerInitial=setTimeout((()=>{Promise.resolve().then((async()=>{await Promise.all(Array.from(this.direct).map((async e=>await this.connect(e))))})).catch((e=>{this.log(e)}))}),1e3),this.log("started")}async stop(){if(this.log("stopping"),this.status.code!==tS.started)return;const{registrarTopologyIds:e}=this.status;this.status={code:tS.stopped};const t=this.components.registrar;e.forEach((e=>t.unregister(e))),this.outboundInflightQueue.end();for(const e of this.streamsOutbound.values())e.close();this.streamsOutbound.clear();for(const e of this.streamsInbound.values())e.close();this.streamsInbound.clear(),this.peers.clear(),this.subscriptions.clear(),this.heartbeatTimer&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),this.directPeerInitial&&clearTimeout(this.directPeerInitial),this.log("stopped")}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream({stream:e,connection:t}){if(!this.isStarted())return;const r=t.remotePeer;this.addPeer(r,t.stat.direction,t.remoteAddr),this.createInboundStream(r,e),this.outboundInflightQueue.push({peerId:r,connection:t})}onPeerConnected(e,t){this.metrics?.newConnectionCount.inc({status:t.stat.status}),this.isStarted()&&"OPEN"===t.stat.status&&(this.addPeer(e,t.stat.direction,t.remoteAddr),this.outboundInflightQueue.push({peerId:e,connection:t}))}onPeerDisconnected(e){this.log("connection ended %p",e),this.removePeer(e)}async createOutboundStream(e,t){if(!this.isStarted())return;const r=e.toString();if(this.peers.has(r)&&!this.streamsOutbound.has(r))try{const n=new HC(await t.newStream(this.multicodecs),(e=>this.log.error("outbound pipe error",e)),{maxBufferSize:this.opts.maxOutboundBufferSize});this.log("create outbound stream %p",e),this.streamsOutbound.set(r,n);const s=n.protocol;s===H_&&this.floodsubPeers.add(r),this.metrics?.peersPerProtocol.inc({protocol:s},1),this.subscriptions.size>0&&(this.log("send subscriptions to",r),this.sendSubscriptions(r,Array.from(this.subscriptions),!0))}catch(e){this.log.error("createOutboundStream error",e)}}async createInboundStream(e,t){if(!this.isStarted())return;const r=e.toString();if(!this.peers.has(r))return;const n=this.streamsInbound.get(r);void 0!==n&&(this.log("replacing existing inbound steam %s",r),n.close()),this.log("create inbound stream %s",r);const s=new KC(t,{maxDataLength:this.opts.maxInboundDataLength});this.streamsInbound.set(r,s),this.pipePeerReadStream(e,s.source).catch((e=>this.log(e)))}addPeer(e,t,r){const n=e.toString();if(!this.peers.has(n)){this.log("new peer %p",e),this.peers.add(n),this.score.addPeer(n);const s=function(e){for(const t of e.tuples())switch(t[0]){case eS.ip4:case eS.ip6:return Qs(t[0],t[1])}return null}(r);null!==s?this.score.addIP(n,s):this.log("Added peer has no IP in current address %s %s",n,r.toString()),this.outbound.has(n)||this.outbound.set(n,"outbound"===t)}}removePeer(e){const t=e.toString();if(!this.peers.has(t))return;this.log("delete peer %p",e),this.peers.delete(t);const r=this.streamsOutbound.get(t),n=this.streamsInbound.get(t);r&&this.metrics?.peersPerProtocol.inc({protocol:r.protocol},-1),r?.close(),n?.close(),this.streamsOutbound.delete(t),this.streamsInbound.delete(t);for(const e of this.topics.values())e.delete(t);for(const[e,r]of this.mesh)!0===r.delete(t)&&this.metrics?.onRemoveFromMesh(e,EC.Dc,1);for(const e of this.fanout.values())e.delete(t);this.floodsubPeers.delete(t),this.gossip.delete(t),this.control.delete(t),this.outbound.delete(t),this.score.removePeer(t),this.acceptFromWhitelist.delete(t)}get started(){return this.status.code===tS.started}getMeshPeers(e){const t=this.mesh.get(e);return t?Array.from(t):[]}getSubscribers(e){const t=this.topics.get(e);return(t?Array.from(t):[]).map((e=>Ta(e)))}getTopics(){return Array.from(this.subscriptions)}async pipePeerReadStream(e,t){try{await zh(t,(async t=>{for await(const r of t)try{const t=r.subarray(),n=jC(t,this.decodeRpcLimits);this.metrics?.onRpcRecv(n,t.length),this.opts.awaitRpcHandler?await this.handleReceivedRpc(e,n):this.handleReceivedRpc(e,n).catch((e=>this.log(e)))}catch(e){this.log(e)}}))}catch(t){this.handlePeerReadStreamError(t,e)}}handlePeerReadStreamError(e,t){this.log.error(e),this.onPeerDisconnected(t)}async handleReceivedRpc(e,t){if(!this.acceptFrom(e.toString()))return this.log("received message from unacceptable peer %p",e),void this.metrics?.rpcRecvNotAccepted.inc();if(this.log("rpc from %p",e),t.subscriptions&&t.subscriptions.length>0){const r=[];t.subscriptions.forEach((t=>{const n=t.topic,s=!0===t.subscribe;if(null!=n){if(this.allowedTopics&&!this.allowedTopics.has(n))return;this.handleReceivedSubscription(e,n,s),r.push({topic:n,subscribe:s})}})),this.dispatchEvent(new F_("subscription-change",{detail:{peerId:e,subscriptions:r}}))}if(t.messages)for(const r of t.messages){if(this.allowedTopics&&!this.allowedTopics.has(r.topic))continue;const t=this.handleReceivedMessage(e,r).catch((e=>this.log(e)));this.opts.awaitRpcMessageHandler&&await t}t.control&&await this.handleControlMessage(e.toString(),t.control)}handleReceivedSubscription(e,t,r){this.log("subscription update from %p topic %s",e,t);let n=this.topics.get(t);null==n&&(n=new Set,this.topics.set(t,n)),r?n.add(e.toString()):n.delete(e.toString())}async handleReceivedMessage(e,t){this.metrics?.onMsgRecvPreValidation(t.topic);const r=await this.validateReceivedMessage(e,t);switch(this.metrics?.onMsgRecvResult(t.topic,r.code),r.code){case eC.duplicate:return this.score.duplicateMessage(e.toString(),r.msgIdStr,t.topic),this.gossipTracer.deliverMessage(r.msgIdStr,!0),void this.mcache.observeDuplicate(r.msgIdStr,e.toString());case eC.invalid:if(r.msgIdStr){const n=r.msgIdStr;this.score.rejectMessage(e.toString(),n,t.topic,r.reason),this.gossipTracer.rejectMessage(n,r.reason)}else this.score.rejectInvalidMessage(e.toString(),t.topic);return void this.metrics?.onMsgRecvInvalid(t.topic,r);case eC.valid:if(this.score.validateMessage(r.messageId.msgIdStr),this.gossipTracer.deliverMessage(r.messageId.msgIdStr),this.mcache.put(r.messageId,t,!this.opts.asyncValidation),this.subscriptions.has(t.topic)){this.components.peerId.equals(e)&&!this.opts.emitSelf||(super.dispatchEvent(new F_("gossipsub:message",{detail:{propagationSource:e,msgId:r.messageId.msgIdStr,msg:r.msg}})),super.dispatchEvent(new F_("message",{detail:r.msg})))}this.opts.asyncValidation||this.forwardMessage(r.messageId.msgIdStr,t,e.toString())}}async validateReceivedMessage(e,t){const r=this.fastMsgIdFn?.(t),n=void 0!==r?this.fastMsgIdCache?.get(r):void 0;if(n)return{code:eC.duplicate,msgIdStr:n};const s=await async function(e,t){switch(e){case q_:return null!=t.signature?{valid:!1,error:Z_.SignaturePresent}:null!=t.seqno?{valid:!1,error:Z_.SeqnoPresent}:null!=t.key?{valid:!1,error:Z_.FromPresent}:{valid:!0,message:{type:"unsigned",topic:t.topic,data:t.data??new Uint8Array(0)}};case $_:{if(null==t.seqno)return{valid:!1,error:Z_.InvalidSeqno};if(8!==t.seqno.length)return{valid:!1,error:Z_.InvalidSeqno};if(null==t.signature)return{valid:!1,error:Z_.InvalidSignature};if(null==t.from)return{valid:!1,error:Z_.InvalidPeerId};let e,r;try{e=Ra(t.from)}catch(e){return{valid:!1,error:Z_.InvalidPeerId}}if(t.key){if(r=eu(t.key),void 0!==e.publicKey&&!ii(r.bytes,e.publicKey))return{valid:!1,error:Z_.InvalidPeerId}}else{if(null==e.publicKey)return{valid:!1,error:Z_.InvalidPeerId};r=eu(e.publicKey)}const n={from:t.from,data:t.data,seqno:t.seqno,topic:t.topic,signature:void 0,key:void 0},s=Fs([TC,M_.Message.encode(n).finish()]);return await r.verify(s,t.signature)?{valid:!0,message:{type:"signed",from:e,data:t.data??new Uint8Array(0),sequenceNumber:BigInt(`0x${Ts(t.seqno,"base16")}`),topic:t.topic,signature:t.signature,key:t.key??tu(r)}}:{valid:!1,error:Z_.InvalidSignature}}}}(this.globalSignaturePolicy,t);if(!s.valid)return{code:eC.invalid,reason:J_.Error,error:s.error};const i=s.message;try{this.dataTransform&&(i.data=this.dataTransform.inboundTransform(t.topic,i.data))}catch(e){return this.log("Invalid message, transform failed",e),{code:eC.invalid,reason:J_.Error,error:Z_.TransformFailed}}const o=await this.msgIdFn(i),a=this.msgIdToStrFn(o),A={msgId:o,msgIdStr:a};if(void 0!==r&&this.fastMsgIdCache){this.fastMsgIdCache.put(r,a)&&this.metrics?.fastMsgIdCacheCollision.inc()}if(this.seenCache.has(a))return{code:eC.duplicate,msgIdStr:a};this.seenCache.put(a);const c=this.topicValidators.get(t.topic);if(null!=c){let t;try{t=await c(e,i)}catch(e){const r=e.code;"ERR_TOPIC_VALIDATOR_IGNORE"===r&&(t=W_.Ignore),t="ERR_TOPIC_VALIDATOR_REJECT"===r?W_.Reject:W_.Ignore}if(t!==W_.Accept)return{code:eC.invalid,reason:tC(t),msgIdStr:a}}return{code:eC.valid,messageId:A,msg:i}}getScore(e){return this.score.score(e)}sendSubscriptions(e,t,r){this.sendRpc(e,{subscriptions:t.map((e=>({topic:e,subscribe:r})))})}async handleControlMessage(e,t){if(void 0===t)return;const r=t.ihave?this.handleIHave(e,t.ihave):[],n=t.iwant?this.handleIWant(e,t.iwant):[],s=t.graft?await this.handleGraft(e,t.graft):[];t.prune&&await this.handlePrune(e,t.prune),(r.length||n.length||s.length)&&this.sendRpc(e,{messages:n,control:{iwant:r,prune:s}})}acceptFrom(e){if(this.direct.has(e))return!0;const t=Date.now(),r=this.acceptFromWhitelist.get(e);if(r&&r.messagesAccepted<128&&r.acceptUntil>=t)return r.messagesAccepted+=1,!0;const n=this.score.score(e);return n>=0?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:t+1e3}):this.acceptFromWhitelist.delete(e),n>=this.opts.scoreThresholds.graylistThreshold}handleIHave(e,t){if(!t.length)return[];const r=this.score.score(e);if(r<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,r),this.metrics?.ihaveRcvIgnored.inc({reason:BC.LowScore}),[];const n=(this.peerhave.get(e)??0)+1;if(this.peerhave.set(e,n),n>10)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,n),this.metrics?.ihaveRcvIgnored.inc({reason:BC.MaxIhave}),[];const s=this.iasked.get(e)??0;if(s>=z_)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,s),this.metrics?.ihaveRcvIgnored.inc({reason:BC.MaxIasked}),[];const i=new Map;if(t.forEach((({topicID:e,messageIDs:t})=>{if(!e||!t||!this.mesh.has(e))return;let r=0;t.forEach((e=>{const t=this.msgIdToStrFn(e);this.seenCache.has(t)||(i.set(t,e),r++)})),this.metrics?.onIhaveRcv(e,t.length,r)})),!i.size)return[];let o=i.size;o+s>z_&&(o=z_-s),this.log("IHAVE: Asking for %d out of %d messages from %s",o,i.size,e);let a=Array.from(i.values());return j_(a),a=a.slice(0,o),this.iasked.set(e,s+o),this.gossipTracer.addPromise(e,a),[{messageIDs:a}]}handleIWant(e,t){if(!t.length)return[];const r=this.score.score(e);if(r<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,r),[];const n=new Map,s=new Map;let i=0;return t.forEach((({messageIDs:t})=>{t&&t.forEach((t=>{const r=this.msgIdToStrFn(t),o=this.mcache.getWithIWantCount(r,e);null!=o?(s.set(o.msg.topic,1+(s.get(o.msg.topic)??0)),o.count>3?this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,t):n.set(r,o.msg)):i++}))})),this.metrics?.onIwantRcv(s,i),n.size?(this.log("IWANT: Sending %d messages to %s",n.size,e),Array.from(n.values())):(this.log("IWANT: Could not provide any wanted messages to %s",e),[])}async handleGraft(e,t){const r=[],n=this.score.score(e),s=Date.now();let i=this.opts.doPX;return t.forEach((({topicID:t})=>{if(!t)return;const o=this.mesh.get(t);if(!o)return void(i=!1);if(o.has(e))return;if(this.direct.has(e))return this.log("GRAFT: ignoring request from direct peer %s",e),r.push(t),void(i=!1);const a=this.backoff.get(t)?.get(e);if("number"==typeof a&&s<a){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1,vC.GraftBackoff),i=!1;const n=a+this.opts.graftFloodThreshold-this.opts.pruneBackoff;return s<n&&this.score.addPenalty(e,1,vC.GraftBackoff),this.addBackoff(e,t),void r.push(t)}return n<0?(this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,n,t),r.push(t),i=!1,void this.addBackoff(e,t)):o.size>=this.opts.Dhi&&!this.outbound.get(e)?(r.push(t),void this.addBackoff(e,t)):(this.log("GRAFT: Add mesh link from %s in %s",e,t),this.score.graft(e,t),o.add(e),void this.metrics?.onAddToMesh(t,bC.Subscribed,1))})),r.length?await Promise.all(r.map((t=>this.makePrune(e,t,i)))):[]}async handlePrune(e,t){const r=this.score.score(e);for(const{topicID:n,backoff:s,peers:i}of t){if(null==n)continue;const t=this.mesh.get(n);if(!t)return;if(this.log("PRUNE: Remove mesh link to %s in %s",e,n),this.score.prune(e,n),t.has(e)&&(t.delete(e),this.metrics?.onRemoveFromMesh(n,EC.Unsub,1)),"number"==typeof s&&s>0?this.doAddBackoff(e,n,1e3*s):this.addBackoff(e,n),i&&i.length){if(r<this.opts.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,r,n);continue}await this.pxConnect(i)}}}addBackoff(e,t){this.doAddBackoff(e,t,this.opts.pruneBackoff)}doAddBackoff(e,t,r){let n=this.backoff.get(t);n||(n=new Map,this.backoff.set(t,n));const s=Date.now()+r;(n.get(e)??0)<s&&n.set(e,s)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach(((e,t)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",t,e),this.score.addPenalty(t,e,vC.BrokenPromise)}))}clearBackoff(){if(this.heartbeatTicks%15!=0)return;const e=Date.now();this.backoff.forEach(((t,r)=>{t.forEach(((r,n)=>{r<e&&t.delete(n)})),0===t.size&&this.backoff.delete(r)}))}async directConnect(){const e=[];this.direct.forEach((t=>{this.streamsOutbound.has(t)||e.push(t)})),await Promise.all(e.map((async e=>await this.connect(e))))}async pxConnect(e){e.length>this.opts.prunePeers&&(j_(e),e=e.slice(0,this.opts.prunePeers));const t=[];await Promise.all(e.map((async e=>{if(!e.peerID)return;const r=Ra(e.peerID).toString();if(!this.peers.has(r))if(e.signedPeerRecord)try{const n=await __.openAndCertify(e.signedPeerRecord,"libp2p-peer-record"),s=n.peerId;if(!n.peerId.equals(r))return void this.log("bogus peer record obtained through px: peer ID %p doesn't match expected peer %p",s,r);if(!await this.components.peerStore.addressBook.consumePeerRecord(n))return void this.log("bogus peer record obtained through px: could not add peer record to address book");t.push(r)}catch(e){this.log("bogus peer record obtained through px: invalid signature or not a peer record")}else t.push(r)}))),t.length&&await Promise.all(t.map((async e=>await this.connect(e))))}async connect(e){this.log("Initiating connection with %s",e);const t=Ta(e),r=await this.components.connectionManager.openConnection(t);for(const e of this.multicodecs)for(const n of this.components.registrar.getTopologies(e))n.onConnect(t,r)}subscribe(e){if(this.status.code!==tS.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(e)){this.subscriptions.add(e);for(const t of this.peers.keys())this.sendSubscriptions(t,[e],!0)}this.join(e)}unsubscribe(e){if(this.status.code!==tS.started)throw new Error("Pubsub is not started");const t=this.subscriptions.delete(e);if(this.log("unsubscribe from %s - am subscribed %s",e,t),t)for(const t of this.peers.keys())this.sendSubscriptions(t,[e],!1);this.leave(e)}join(e){if(this.status.code!==tS.started)throw new Error("Gossipsub has not started");if(this.mesh.has(e))return;this.log("JOIN %s",e),this.metrics?.onJoin(e);const t=new Set,r=this.fanout.get(e);if(r&&(this.fanout.delete(e),this.fanoutLastpub.delete(e),r.forEach((e=>{!this.direct.has(e)&&this.score.score(e)>=0&&t.add(e)})),this.metrics?.onAddToMesh(e,bC.Fanout,t.size)),t.size<this.opts.D){const r=t.size;this.getRandomGossipPeers(e,this.opts.D,(e=>!t.has(e)&&!this.direct.has(e)&&this.score.score(e)>=0)).forEach((e=>{t.add(e)})),this.metrics?.onAddToMesh(e,bC.Random,t.size-r)}this.mesh.set(e,t),t.forEach((t=>{this.log("JOIN: Add mesh link to %s in %s",t,e),this.sendGraft(t,e)}))}leave(e){if(this.status.code!==tS.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e),this.metrics?.onLeave(e);const t=this.mesh.get(e);t&&(Promise.all(Array.from(t).map((async t=>(this.log("LEAVE: Remove mesh link to %s in %s",t,e),await this.sendPrune(t,e))))).catch((e=>{this.log("Error sending prunes to mesh peers",e)})),this.mesh.delete(e))}selectPeersToForward(e,t,r){const n=new Set,s=this.topics.get(e);s&&(this.direct.forEach((e=>{s.has(e)&&t!==e&&!r?.has(e)&&n.add(e)})),this.floodsubPeers.forEach((e=>{s.has(e)&&t!==e&&!r?.has(e)&&this.score.score(e)>=this.opts.scoreThresholds.publishThreshold&&n.add(e)})));const i=this.mesh.get(e);return i&&i.size>0&&i.forEach((e=>{t===e||r?.has(e)||n.add(e)})),n}selectPeersToPublish(e){const t=new Set,r={direct:0,floodsub:0,mesh:0,fanout:0},n=this.topics.get(e);if(n)if(this.opts.floodPublish)n.forEach((e=>{this.direct.has(e)?(t.add(e),r.direct++):this.score.score(e)>=this.opts.scoreThresholds.publishThreshold&&(t.add(e),r.floodsub++)}));else{this.direct.forEach((e=>{n.has(e)&&(t.add(e),r.direct++)})),this.floodsubPeers.forEach((e=>{n.has(e)&&this.score.score(e)>=this.opts.scoreThresholds.publishThreshold&&(t.add(e),r.floodsub++)}));const s=this.mesh.get(e);if(s&&s.size>0)s.forEach((e=>{t.add(e),r.mesh++}));else{const n=this.fanout.get(e);if(n&&n.size>0)n.forEach((e=>{t.add(e),r.fanout++}));else{const n=this.getRandomGossipPeers(e,this.opts.D,(e=>this.score.score(e)>=this.opts.scoreThresholds.publishThreshold));n.size>0&&(this.fanout.set(e,n),n.forEach((e=>{t.add(e),r.fanout++})))}this.fanoutLastpub.set(e,Date.now())}}return{tosend:t,tosendCount:r}}forwardMessage(e,t,r,n){r&&this.score.deliverMessage(r,e,t.topic);const s=this.selectPeersToForward(t.topic,r,n);s.forEach((e=>{this.sendRpc(e,{messages:[t]})})),this.metrics?.onForwardMsg(t.topic,s.size)}async publish(e,t,r){const n=this.dataTransform?this.dataTransform.outboundTransform(e,t):t;if(null==this.publishConfig)throw Error("PublishError.Uninitialized");const{raw:s,msg:i}=await async function(e,t,r,n){switch(e.type){case X_.Signing:{const s={from:e.author.toBytes(),data:n,seqno:bc(8),topic:t,signature:void 0,key:void 0},i=Fs([TC,M_.Message.encode(s).finish()]);return s.signature=await e.privateKey.sign(i),s.key=e.key,{raw:s,msg:{type:"signed",from:e.author,data:r,sequenceNumber:BigInt(`0x${Ts(s.seqno,"base16")}`),topic:t,signature:s.signature,key:s.key}}}case X_.Anonymous:return{raw:{from:void 0,data:n,seqno:void 0,topic:t,signature:void 0,key:void 0},msg:{type:"unsigned",data:r,topic:t}}}}(this.publishConfig,e,t,n),o=await this.msgIdFn(i),a=this.msgIdToStrFn(o),A=r?.ignoreDuplicatePublishError??this.opts.ignoreDuplicatePublishError;if(this.seenCache.has(a)){if(A)return this.metrics?.onPublishDuplicateMsg(e),{recipients:[]};throw Error("PublishError.Duplicate")}const{tosend:c,tosendCount:l}=this.selectPeersToPublish(e),u=!0===this.opts.emitSelf&&this.subscriptions.has(e),h=r?.allowPublishToZeroPeers??this.opts.allowPublishToZeroPeers;if(0===c.size&&!h&&!u)throw Error("PublishError.InsufficientPeers");this.seenCache.put(a),this.mcache.put({msgId:o,msgIdStr:a},s,!0),this.publishedMessageIds.put(a);for(const e of c){this.sendRpc(e,{messages:[s]})||c.delete(e)}return this.metrics?.onPublishMsg(e,l,c.size,null!=s.data?s.data.length:0),u&&(c.add(this.components.peerId.toString()),super.dispatchEvent(new F_("gossipsub:message",{detail:{propagationSource:this.components.peerId,msgId:a,msg:i}})),super.dispatchEvent(new F_("message",{detail:i}))),{recipients:Array.from(c.values()).map((e=>Ta(e)))}}reportMessageValidationResult(e,t,r){if(r===W_.Accept){const n=this.mcache.validate(e);if(this.metrics?.onReportValidationMcacheHit(null!==n),null!=n){const{message:s,originatingPeers:i}=n;this.score.deliverMessage(t.toString(),e,s.topic),this.forwardMessage(e,n.message,t.toString(),i),this.metrics?.onReportValidation(s.topic,r)}}else{const n=this.mcache.remove(e);if(this.metrics?.onReportValidationMcacheHit(null!==n),n){const s=tC(r),{message:i,originatingPeers:o}=n;this.score.rejectMessage(t.toString(),e,i.topic,s);for(const t of o)this.score.rejectMessage(t,e,i.topic,s);this.metrics?.onReportValidation(i.topic,r)}}}sendGraft(e,t){const r=[{topicID:t}];this.sendRpc(e,{control:{graft:r}})}async sendPrune(e,t){const r=[await this.makePrune(e,t,this.opts.doPX)];this.sendRpc(e,{control:{prune:r}})}sendRpc(e,t){const r=this.streamsOutbound.get(e);if(!r)return this.log(`Cannot send RPC to ${e} as there is no open stream to it available`),!1;const n=this.control.get(e);n&&(this.piggybackControl(e,t,n),this.control.delete(e));const s=this.gossip.get(e);s&&(this.piggybackGossip(e,t,s),this.gossip.delete(e));const i=M_.encode(t).finish();try{r.push(i)}catch(t){return this.log.error(`Cannot send rpc to ${e}`,t),n&&this.control.set(e,n),s&&this.gossip.set(e,s),!1}return this.metrics?.onRpcSent(t,i.length),!0}piggybackControl(e,t,r){if(r.graft){t.control||(t.control={}),t.control.graft||(t.control.graft=[]);for(const n of r.graft)n.topicID&&this.mesh.get(n.topicID)?.has(e)&&t.control.graft.push(n)}if(r.prune){t.control||(t.control={}),t.control.prune||(t.control.prune=[]);for(const n of r.prune)n.topicID&&!this.mesh.get(n.topicID)?.has(e)&&t.control.prune.push(n)}}piggybackGossip(e,t,r){t.control||(t.control={}),t.control.ihave=r}async sendGraftPrune(e,t,r){const n=this.opts.doPX;for(const[s,i]of e){const e=i.map((e=>({topicID:e})));let o=[];const a=t.get(s);a&&(o=await Promise.all(a.map((async e=>await this.makePrune(s,e,n&&!r.get(s))))),t.delete(s)),this.sendRpc(s,{control:{graft:e,prune:o}})}for(const[e,s]of t){const t=await Promise.all(s.map((async t=>await this.makePrune(e,t,n&&!r.get(e)))));this.sendRpc(e,{control:{prune:t}})}}emitGossip(e){const t=this.mcache.getGossipIDs(new Set(e.keys()));for(const[r,n]of e)this.doEmitGossip(r,n,t.get(r)??[])}doEmitGossip(e,t,r){if(!r.length)return;if(j_(r),r.length>z_&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",r.length),!t.size)return;let n=this.opts.Dlazy;const s=.25*t.size;let i=t;s>n&&(n=s),n>i.size?n=i.size:i=j_(Array.from(i)).slice(0,n),i.forEach((t=>{let n=r;r.length>z_&&(n=j_(n.slice()).slice(0,z_)),this.pushGossip(t,{topicID:e,messageIDs:n})}))}flush(){for(const[e,t]of this.gossip.entries())this.gossip.delete(e),this.sendRpc(e,{control:{ihave:t}});for(const[e,t]of this.control.entries())this.control.delete(e),this.sendRpc(e,{control:{graft:t.graft,prune:t.prune}})}pushGossip(e,t){this.log("Add gossip to %s",e);const r=this.gossip.get(e)||[];this.gossip.set(e,r.concat(t))}async makePrune(e,t,r){if(this.score.prune(e,t),this.streamsOutbound.get(e).protocol===K_)return{topicID:t,peers:[]};const n=this.opts.pruneBackoff/1e3;if(!r)return{topicID:t,peers:[],backoff:n};const s=this.getRandomGossipPeers(t,this.opts.prunePeers,(t=>t!==e&&this.score.score(t)>=0)),i=await Promise.all(Array.from(s).map((async e=>{const t=Ta(e);return{peerID:t.toBytes(),signedPeerRecord:await this.components.peerStore.addressBook.getRawEnvelope(t)}})));return{topicID:t,peers:i,backoff:n}}async heartbeat(){const{D:e,Dlo:t,Dhi:r,Dscore:n,Dout:s,fanoutTTL:i}=this.opts;this.heartbeatTicks++;const o=new Map,a=e=>{let t=o.get(e);return void 0===t&&(t=this.score.score(e),o.set(e,t)),t},A=new Map,c=new Map,l=new Map;this.clearBackoff(),this.peerhave.clear(),this.metrics?.cacheSize.set({cache:"iasked"},this.iasked.size),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%this.opts.directConnectTicks==0&&await this.directConnect(),this.fastMsgIdCache?.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune();const u=new Map;this.mesh.forEach(((i,o)=>{const h=this.topics.get(o),d=new Set,f=new Set;if(u.set(o,f),h){const e=j_(Array.from(h)),t=this.backoff.get(o);for(const r of e){const e=this.streamsOutbound.get(r);if(e&&this.multicodecs.includes(e.protocol)&&!i.has(r)&&!this.direct.has(r)){const e=a(r);t&&t.has(r)||!(e>=0)||d.add(r),e>=this.opts.scoreThresholds.gossipThreshold&&f.add(r)}}}const p=(e,t)=>{this.log("HEARTBEAT: Remove mesh link to %s in %s",e,o),this.addBackoff(e,o),i.delete(e),a(e)>=this.opts.scoreThresholds.gossipThreshold&&f.add(e),this.metrics?.onRemoveFromMesh(o,t,1);const r=c.get(e);r?r.push(o):c.set(e,[o])},g=(e,t)=>{this.log("HEARTBEAT: Add mesh link to %s in %s",e,o),this.score.graft(e,o),i.add(e),f.delete(e),this.metrics?.onAddToMesh(o,t,1);const r=A.get(e);r?r.push(o):A.set(e,[o])};if(i.forEach((e=>{const t=a(e);t<0&&(this.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",e,t,o),p(e,EC.BadScore),l.set(e,!0))})),i.size<t){const t=function(e,t){return dC(e,t,(()=>!0))}(d,e-i.size);t.forEach((e=>{g(e,bC.NotEnough)}))}if(i.size>r){let t=Array.from(i);t.sort(((e,t)=>a(t)-a(e))),t=t.slice(0,n).concat(j_(t.slice(n)));let r=0;if(t.slice(0,e).forEach((e=>{this.outbound.get(e)&&r++})),r<s){const n=e=>{const r=t[e];for(let r=e;r>0;r--)t[r]=t[r-1];t[0]=r};if(r>0){let s=r;for(let r=1;r<e&&s>0;r++)this.outbound.get(t[r])&&(n(r),s--)}let s=e-r;for(let r=e;r<t.length&&s>0;r++)this.outbound.get(t[r])&&(n(r),s--)}t.slice(e).forEach((e=>{p(e,EC.Excess)}))}if(i.size>=t){let e=0;if(i.forEach((t=>{this.outbound.get(t)&&e++})),e<s){dC(d,s-e,(e=>!0===this.outbound.get(e))).forEach((e=>{g(e,bC.Outbound)}))}}if(this.heartbeatTicks%this.opts.opportunisticGraftTicks==0&&i.size>1){const e=Array.from(i).sort(((e,t)=>a(e)-a(t))),t=Math.floor(i.size/2),r=a(e[t]);if(r<this.opts.scoreThresholds.opportunisticGraftThreshold){const e=dC(d,this.opts.opportunisticGraftPeers,(e=>a(e)>r));for(const t of e)this.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",t,o),g(t,bC.Opportunistic)}}}));const h=Date.now();this.fanoutLastpub.forEach(((e,t)=>{e+i<h&&(this.fanout.delete(t),this.fanoutLastpub.delete(t))})),this.fanout.forEach(((t,r)=>{const n=this.topics.get(r);t.forEach((e=>{(!n.has(e)||a(e)<this.opts.scoreThresholds.publishThreshold)&&t.delete(e)}));const s=this.topics.get(r),i=[],o=new Set;if(u.set(r,o),s){const e=j_(Array.from(s));for(const r of e){const e=this.streamsOutbound.get(r);if(e&&this.multicodecs.includes(e.protocol)&&!t.has(r)&&!this.direct.has(r)){const e=a(r);e>=this.opts.scoreThresholds.publishThreshold&&i.push(r),e>=this.opts.scoreThresholds.gossipThreshold&&o.add(r)}}}if(t.size<e){const r=e-t.size;i.slice(0,r).forEach((e=>{t.add(e),o?.delete(e)}))}})),this.emitGossip(u),await this.sendGraftPrune(A,c,l),this.flush(),this.mcache.shift(),this.dispatchEvent(new F_("gossipsub:heartbeat"))}getRandomGossipPeers(e,t,r=(()=>!0)){const n=this.topics.get(e);if(!n)return new Set;let s=[];return n.forEach((e=>{const t=this.streamsOutbound.get(e);t&&this.multicodecs.includes(t.protocol)&&r(e)&&s.push(e)})),s=j_(s),t>0&&s.length>t&&(s=s.slice(0,t)),new Set(s)}onScrapeMetrics(e){e.mcacheSize.set(this.mcache.size),e.mcacheNotValidatedCount.set(this.mcache.notValidatedCount),e.cacheSize.set({cache:"direct"},this.direct.size),e.cacheSize.set({cache:"seenCache"},this.seenCache.size),e.cacheSize.set({cache:"fastMsgIdCache"},this.fastMsgIdCache?.size??0),e.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),e.cacheSize.set({cache:"mcache"},this.mcache.size),e.cacheSize.set({cache:"score"},this.score.size),e.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),e.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),e.cacheSize.set({cache:"topics"},this.topics.size),e.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),e.cacheSize.set({cache:"mesh"},this.mesh.size),e.cacheSize.set({cache:"fanout"},this.fanout.size),e.cacheSize.set({cache:"peers"},this.peers.size),e.cacheSize.set({cache:"streamsOutbound"},this.streamsOutbound.size),e.cacheSize.set({cache:"streamsInbound"},this.streamsInbound.size),e.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),e.cacheSize.set({cache:"gossip"},this.gossip.size),e.cacheSize.set({cache:"control"},this.control.size),e.cacheSize.set({cache:"peerhave"},this.peerhave.size),e.cacheSize.set({cache:"outbound"},this.outbound.size);let t=0;for(const e of this.backoff.values())t+=e.size;e.cacheSize.set({cache:"backoff"},t);for(const[t,r]of this.topics)e.topicPeersCount.set({topicStr:t},r.size);for(const[t,r]of this.mesh)e.meshPeerCounts.set({topicStr:t},r.size);const r=[],n=new Map;e.behaviourPenalty.reset();for(const t of this.peers.keys()){const s=this.score.score(t);r.push(s),n.set(t,s),e.behaviourPenalty.observe(this.score.peerStats.get(t)?.behaviourPenalty??0)}e.registerScores(r,this.opts.scoreThresholds),e.registerScorePerMesh(this.mesh,n);const s=function(e,t,r,n,s){const i={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(const o of e){const e=t.get(o);if(e){const t=UC(o,e,r,n,s);for(const[e,r]of t.byTopic){let t=i.byTopic.get(e);t||(t={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},i.byTopic.set(e,t)),t.p1w.push(r.p1w),t.p2w.push(r.p2w),t.p3w.push(r.p3w),t.p3bw.push(r.p3bw),t.p4w.push(r.p4w)}i.p5w.push(t.p5w),i.p6w.push(t.p6w),i.p7w.push(t.p7w),i.score.push(t.score)}else i.p5w.push(0),i.p6w.push(0),i.p7w.push(0),i.score.push(0)}return i}(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,e.topicStrToLabel);e.registerScoreWeights(s)}}function nS(e={}){return t=>new rS(t,e)}rS.multicodec=V_;const sS=se("libp2p-delegated-peer-routing");var iS,oS;!function(e){e[e.SENDING_QUERY=0]="SENDING_QUERY",e[e.PEER_RESPONSE=1]="PEER_RESPONSE",e[e.FINAL_PEER=2]="FINAL_PEER",e[e.QUERY_ERROR=3]="QUERY_ERROR",e[e.PROVIDER=4]="PROVIDER",e[e.VALUE=5]="VALUE",e[e.ADDING_PEER=6]="ADDING_PEER",e[e.DIALING_PEER=7]="DIALING_PEER"}(iS||(iS={})),function(e){e[e.PUT_VALUE=0]="PUT_VALUE",e[e.GET_VALUE=1]="GET_VALUE",e[e.ADD_PROVIDER=2]="ADD_PROVIDER",e[e.GET_PROVIDERS=3]="GET_PROVIDERS",e[e.FIND_NODE=4]="FIND_NODE",e[e.PING=5]="PING"}(oS||(oS={}));class aS{constructor(e){if(null==e)throw new Error("missing ipfs http client");this.client=e,this.started=!1,this.abortController=new AbortController,this.httpQueue=new ua({concurrency:4});const{protocol:t,host:r,port:n}=e.getEndpointConfig();sS(`enabled DelegatedPeerRouting via ${t}://${r}:${n}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async findPeer(e,t={}){sS("findPeer starts: %p",e),t.timeout=t.timeout??3e4,t.signal=co([this.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const r=Oh(),n=Oh();this.httpQueue.add((async()=>(r.resolve(),await n.promise)));try{await r.promise;for await(const r of this.client.dht.findPeer(e,t))if("FINAL_PEER"===r.name){return{id:r.peer.id,multiaddrs:r.peer.multiaddrs,protocols:[]}}}catch(e){throw sS.error("findPeer errored: %o",e),e}finally{n.resolve(),sS("findPeer finished: %p",e)}throw ie(new Error("Not found"),"ERR_NOT_FOUND")}async*getClosestPeers(e,t={}){let r;const n=Ve.asCID(e);r=null!=n?n:Ra(e),sS("getClosestPeers starts: %s",r),t.timeout=t.timeout??3e4,t.signal=co([this.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const s=Oh(),i=Oh();this.httpQueue.add((async()=>(s.resolve(),await i.promise)));try{await s.promise;for await(const e of this.client.dht.query(r,t))"PEER_RESPONSE"===e.name&&(yield*e.closer.map((e=>({id:e.id,multiaddrs:e.multiaddrs,protocols:[]}))))}catch(e){throw sS.error("getClosestPeers errored:",e),e}finally{i.resolve(),sS("getClosestPeers finished: %b",e)}}}const AS=se("libp2p:delegated-content-routing"),cS=3e4;var lS,uS;!function(e){e[e.SENDING_QUERY=0]="SENDING_QUERY",e[e.PEER_RESPONSE=1]="PEER_RESPONSE",e[e.FINAL_PEER=2]="FINAL_PEER",e[e.QUERY_ERROR=3]="QUERY_ERROR",e[e.PROVIDER=4]="PROVIDER",e[e.VALUE=5]="VALUE",e[e.ADDING_PEER=6]="ADDING_PEER",e[e.DIALING_PEER=7]="DIALING_PEER"}(lS||(lS={})),function(e){e[e.PUT_VALUE=0]="PUT_VALUE",e[e.GET_VALUE=1]="GET_VALUE",e[e.ADD_PROVIDER=2]="ADD_PROVIDER",e[e.GET_PROVIDERS=3]="GET_PROVIDERS",e[e.FIND_NODE=4]="FIND_NODE",e[e.PING=5]="PING"}(uS||(uS={}));class hS{constructor(e){if(null==e)throw new Error("missing ipfs http client");this.client=e,this.started=!1,this.abortController=new AbortController,this.httpQueue=new ua({concurrency:4}),this.httpQueueRefs=new ua({concurrency:2});const{protocol:t,host:r,port:n}=e.getEndpointConfig();AS(`enabled DelegatedContentRouting via ${t}://${r}:${n}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.httpQueueRefs.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async*findProviders(e,t={}){AS("findProviders starts: %c",e),t.timeout=t.timeout??cS,t.signal=co([this.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const r=Oh(),n=Oh();this.httpQueue.add((async()=>(r.resolve(),await n.promise)));try{await r.promise;for await(const r of this.client.dht.findProvs(e,t))"PROVIDER"===r.name&&(yield*r.providers.map((e=>({id:e.id,protocols:[],multiaddrs:e.multiaddrs}))))}catch(e){throw AS.error("findProviders errored:",e),e}finally{n.resolve(),AS("findProviders finished: %c",e)}}async provide(e,t={}){AS("provide starts: %c",e),t.timeout=t.timeout??cS,t.signal=co([this.abortController.signal].concat(null!=t.signal?[t.signal]:[])),await this.httpQueueRefs.add((async()=>{await this.client.block.stat(e,t),await Qu(this.client.dht.provide(e,t))})),AS("provide finished: %c",e)}async put(e,t,r={}){AS("put value start: %b",e),r.timeout=r.timeout??cS,r.signal=co([this.abortController.signal].concat(null!=r.signal?[r.signal]:[])),await this.httpQueue.add((async()=>{await Qu(this.client.dht.put(e,t,r))})),AS("put value finished: %b",e)}async get(e,t={}){AS("get value start: %b",e),t.timeout=t.timeout??cS,t.signal=co([this.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const r=await this.httpQueue.add((async()=>{for await(const r of this.client.dht.get(e,t))if("VALUE"===r.name)return AS("get value finished: %b",e),r.value;throw ie(new Error("Not found"),"ERR_NOT_FOUND")}));if(void 0===r)throw ie(new Error("Not found"),"ERR_NOT_FOUND");return r}}const dS=e=>Promise.reject(new Error(`No base found for "${e}"`));class fS{constructor(e){this._basesByName={},this._basesByPrefix={},this._loadBase=e.loadBase||dS;for(const t of e.bases)this.addBase(t)}addBase(e){if(this._basesByName[e.name]||this._basesByPrefix[e.prefix])throw new Error(`Codec already exists for codec "${e.name}"`);this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}removeBase(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}async getBase(e){if(this._basesByName[e])return this._basesByName[e];if(this._basesByPrefix[e])return this._basesByPrefix[e];const t=await this._loadBase(e);return null==this._basesByName[t.name]&&null==this._basesByPrefix[t.prefix]&&this.addBase(t),t}listBases(){return Object.values(this._basesByName)}}const pS=e=>Promise.reject(new Error(`No codec found for "${e}"`));class gS{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||pS;for(const t of e.codecs)this.addCodec(t)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}async getCodec(e){const t="string"==typeof e?this._codecsByName:this._codecsByCode;if(t[e])return t[e];const r=await this._loadCodec(e);return null==t[e]&&this.addCodec(r),r}listCodecs(){return Object.values(this._codecsByName)}}const yS=e=>Promise.reject(new Error(`No hasher found for "${e}"`));class wS{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||yS;for(const t of e.hashers)this.addHasher(t)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}async getHasher(e){const t="string"==typeof e?this._hashersByName:this._hashersByCode;if(t[e])return t[e];const r=await this._loadHasher(e);return null==t[e]&&this.addHasher(r),r}listHashers(){return Object.values(this._hashersByName)}}function mS(e){try{e=fm(mi(e))}catch(e){}return e=e.toString()}const bS=se("ipfs-http-client:lib:error-handler"),ES=I.bind({ignoreUndefined:!0}),vS=T.isBrowser||T.isWebWorker?location.protocol:"http",BS=T.isBrowser||T.isWebWorker?location.hostname:"localhost",_S=T.isBrowser||T.isWebWorker?location.port:"5001",CS=async e=>{let t;try{if((e.headers.get("Content-Type")||"").startsWith("application/json")){const r=await e.json();bS(r),t=r.Message||r.message}else t=await e.text()}catch(e){bS("Failed to parse error response",e),t=e.message}let r=new ha.HTTPError(e);throw t&&(t.includes("deadline has elapsed")&&(r=new ha.TimeoutError),t&&t.includes("context deadline exceeded")&&(r=new ha.TimeoutError)),t&&t.includes("request timed out")&&(r=new ha.TimeoutError),t&&(r.message=t),r},SS=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,IS=e=>e.replace(SS,(function(e){return"-"+e.toLowerCase()})),TS=e=>"string"==typeof e?fo(e):e;class RS extends ha{constructor(e={}){const t=((e={})=>{let t,r,n={};if("string"==typeof e||yi(e))t=new URL(mS(e));else if(e instanceof URL)t=e;else if("string"==typeof e.url||yi(e.url))t=new URL(mS(e.url)),n=e;else if(e.url instanceof URL)t=e.url,n=e;else{n=e||{};const r=(n.protocol||vS).replace(":",""),s=(n.host||BS).split(":")[0],i=n.port||_S;t=new URL(`${r}://${s}:${i}`)}if(n.apiPath?t.pathname=n.apiPath:"/"!==t.pathname&&void 0!==t.pathname||(t.pathname="api/v0"),T.isNode){const e=void 0;r=n.agent||new e({keepAlive:!0,maxSockets:6})}return{...n,host:t.host,protocol:t.protocol.replace(":",""),port:Number(t.port),apiPath:t.pathname,url:t,agent:r}})(e);super({timeout:TS(t.timeout||0)||void 0,headers:t.headers,base:`${t.url}`,handleError:CS,transformSearchParams:e=>{const t=new URLSearchParams;for(const[r,n]of e)"undefined"!==n&&"null"!==n&&"signal"!==r&&t.append(IS(r),n),"timeout"!==r||isNaN(n)||t.append(IS(r),n);return t},agent:t.agent}),delete this.get,delete this.put,delete this.delete,delete this.options;const r=this.fetch;this.fetch=(e,n={})=>("string"!=typeof e||e.startsWith("/")||(e=`${t.url}/${e}`),r.call(this,e,ES(n,{method:"POST"})))}}ha.HTTPError;const kS=e=>t=>e(new RS(t),t);function US(e){if(null!=e)return"string"==typeof e?e:e.toString(8).padStart(4,"0")}function DS(e){if(null==e)return;let t;if(null!=e.secs&&(t={secs:e.secs,nsecs:e.nsecs}),null!=e.Seconds&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){const r=e.getTime(),n=Math.floor(r/1e3);t={secs:n,nsecs:1e3*(r-1e3*n)}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(null!=t&&null!=t.nsecs&&(t.nsecs<0||t.nsecs>999999999))throw ie(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}function PS({arg:e,searchParams:t,hashAlg:r,mtime:n,mode:s,...i}={}){t&&(i={...i,...t}),r&&(i.hash=r),null!=n&&(n=DS(n),i.mtime=n.secs,i.mtimeNsecs=n.nsecs),null!=s&&(i.mode=US(s)),i.timeout&&!isNaN(i.timeout)&&(i.timeout=`${i.timeout}ms`),null==e?e=[]:Array.isArray(e)||(e=[e]);const o=new URLSearchParams(i);return e.forEach((e=>o.append("arg",e))),o}const LS=kS((e=>async function(t={}){return((await(await e.post("bitswap/wantlist",{signal:t.signal,searchParams:PS(t),headers:t.headers})).json()).Keys||[]).map((e=>Ve.parse(e["/"])))})),NS=kS((e=>async function(t,r={}){return((await(await e.post("bitswap/wantlist",{signal:r.signal,searchParams:PS({...r,peer:t.toString()}),headers:r.headers})).json()).Keys||[]).map((e=>Ve.parse(e["/"])))})),OS=kS((e=>async function(t={}){const r=await e.post("bitswap/stat",{searchParams:PS(t),signal:t.signal,headers:t.headers});return function(e){return{provideBufLen:e.ProvideBufLen,wantlist:(e.Wantlist||[]).map((e=>Ve.parse(e["/"]))),peers:(e.Peers||[]).map((e=>Ta(e))),blocksReceived:BigInt(e.BlocksReceived),dataReceived:BigInt(e.DataReceived),blocksSent:BigInt(e.BlocksSent),dataSent:BigInt(e.DataSent),dupBlksReceived:BigInt(e.DupBlksReceived),dupDataReceived:BigInt(e.DupDataReceived)}}(await r.json())}));const FS=kS((e=>async function(t,r={}){return(await e.post("bitswap/unwant",{signal:r.signal,searchParams:PS({arg:t.toString(),...r}),headers:r.headers})).json()}));function QS(e){return{wantlist:LS(e),wantlistForPeer:NS(e),unwant:FS(e),stat:OS(e)}}const xS=kS((e=>async function(t,r={}){const n=await e.post("block/get",{signal:r.signal,searchParams:PS({arg:t.toString(),...r}),headers:r.headers});return new Uint8Array(await n.arrayBuffer())}));async function MS(e){if(Wh(e))return new Blob([e]);if("string"==typeof e||e instanceof String)return new Blob([e.toString()]);if(Yh(e))return e;if(Jh(e)&&(e=$h(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const t=qh(e),{value:r,done:n}=await t.peek();if(n)return HS(t);if(t.push(r),Number.isInteger(r))return new Blob([Uint8Array.from(await Ou(t))]);if(Wh(r)||"string"==typeof r||r instanceof String)return HS(t)}throw ie(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")}async function HS(e){const t=[];for await(const r of e)t.push(r);return new Blob(t)}function KS(e){if(null!=e)return"string"==typeof e?e:e.toString(8).padStart(4,"0")}async function VS(e,t,r={}){const n=[],s=new FormData;let i=0,o=0;for await(const{content:t,path:r,mode:a,mtime:A}of Zd(e,MS)){let e="";i>0&&(e=`-${i}`);let c=(t?"file":"dir")+e;const l=[];if(null!=a&&l.push(`mode=${KS(a)}`),null!=A){const{secs:e,nsecs:t}=A;l.push(`mtime=${e}`),null!=t&&l.push(`mtime-nsecs=${t}`)}if(l.length&&(c=`${c}?${l.join("&")}`),t){s.set(c,t,null!=r?encodeURIComponent(r):void 0);const e=o+t.size;n.push({name:r,start:o,end:e}),o=e}else{if(null==r)throw new Error("path or content or both must be set");s.set(c,new File([""],encodeURIComponent(r),{type:"application/x-directory"}))}i++}return{total:o,parts:n,headers:r,body:s}}function zS(...e){return(0,co.anySignal)(function(e){return e.filter(Boolean)}(e))}const jS=kS((e=>async function t(r,n={}){const s=new AbortController,i=zS(s.signal,n.signal);let o;try{const t=await e.post("block/put",{signal:i,searchParams:PS(n),...await VS([r],0,n.headers)});o=await t.json()}catch(e){if("dag-pb"===n.format)return t(r,{...n,format:"protobuf"});if("dag-cbor"===n.format)return t(r,{...n,format:"cbor"});throw e}return Ve.parse(o.Key)})),GS=kS((e=>async function*(t,r={}){Array.isArray(t)||(t=[t]);const n=await e.post("block/rm",{signal:r.signal,searchParams:PS({arg:t.map((e=>e.toString())),"stream-channels":!0,...r}),headers:r.headers});for await(const e of n.ndjson())yield $S(e)}));function $S(e){const t={cid:Ve.parse(e.Hash)};return e.Error&&(t.error=new Error(e.Error)),t}const qS=kS((e=>async function(t,r={}){const n=await e.post("block/stat",{signal:r.signal,searchParams:PS({arg:t.toString(),...r}),headers:r.headers}),s=await n.json();return{cid:Ve.parse(s.Key),size:s.Size}}));function WS(e){return{get:xS(e),put:jS(e),rm:GS(e),stat:qS(e)}}const YS=kS((e=>async function(t,r={}){const n=await e.post("bootstrap/add",{signal:r.signal,searchParams:PS({arg:t,...r}),headers:r.headers}),{Peers:s}=await n.json();return{Peers:s.map((e=>mi(e)))}})),XS=kS((e=>async function(t={}){const r=await e.post("bootstrap/rm",{signal:t.signal,searchParams:PS({...t,all:!0}),headers:t.headers}),{Peers:n}=await r.json();return{Peers:n.map((e=>mi(e)))}})),JS=kS((e=>async function(t={}){const r=await e.post("bootstrap/list",{signal:t.signal,searchParams:PS(t),headers:t.headers}),{Peers:n}=await r.json();return{Peers:n.map((e=>mi(e)))}})),ZS=kS((e=>async function(t={}){const r=await e.post("bootstrap/add",{signal:t.signal,searchParams:PS({...t,default:!0}),headers:t.headers}),{Peers:n}=await r.json();return{Peers:n.map((e=>mi(e)))}})),eI=kS((e=>async function(t,r={}){const n=await e.post("bootstrap/rm",{signal:r.signal,searchParams:PS({arg:t,...r}),headers:r.headers}),{Peers:s}=await n.json();return{Peers:s.map((e=>mi(e)))}}));function tI(e){return{add:YS(e),clear:XS(e),list:JS(e),reset:ZS(e),rm:eI(e)}}const rI=kS((e=>async function(t,r={}){const n=await e.post("config/profile/apply",{signal:r.signal,searchParams:PS({arg:t,...r}),headers:r.headers}),s=await n.json();return{original:s.OldCfg,updated:s.NewCfg}}));function nI(e){if(null==e)return e;const t=/^[A-Z]+$/;return Object.keys(e).reduce(((r,n)=>(t.test(n)?r[n.toLowerCase()]=e[n]:t.test(n[0])?r[n[0].toLowerCase()+n.slice(1)]=e[n]:r[n]=e[n],r)),{})}const sI=kS((e=>async function(t={}){const r=await e.post("config/profile/list",{signal:t.signal,searchParams:PS(t),headers:t.headers});return(await r.json()).map((e=>nI(e)))}));function iI(e){return{apply:rI(e),list:sI(e)}}const oI=kS((e=>async(t,r={})=>{if(!t)throw new Error("key argument is required");const n=await e.post("config",{signal:r.signal,searchParams:PS({arg:t,...r}),headers:r.headers});return(await n.json()).Value})),aI=kS((e=>async(t={})=>{const r=await e.post("config/show",{signal:t.signal,searchParams:PS({...t}),headers:t.headers});return await r.json()})),AI=kS((e=>async(t,r={})=>{const n=new AbortController,s=zS(n.signal,r.signal),i=await e.post("config/replace",{signal:s,searchParams:PS(r),...await VS([vs(JSON.stringify(t))],0,r.headers)});await i.text()})),cI=kS((e=>async(t,r,n={})=>{if("string"!=typeof t)throw new Error("Invalid key type");const s={...n,...lI(t,r)},i=await e.post("config",{signal:n.signal,searchParams:PS(s),headers:n.headers});await i.text()})),lI=(e,t)=>{switch(typeof t){case"boolean":return{arg:[e,t.toString()],bool:!0};case"string":return{arg:[e,t]};default:return{arg:[e,JSON.stringify(t)],json:!0}}};function uI(e){return{getAll:aI(e),get:oI(e),set:cI(e),replace:AI(e),profiles:iI(e)}}const hI=kS((e=>async function*(t,r={}){const n=await e.post("dag/export",{signal:r.signal,searchParams:PS({arg:t.toString()}),headers:r.headers});yield*n.iterator()}));async function*dI(e,t,r,n,s){const i=async e=>{const t=await r.getCodec(e.code),i=await n(e,s);return t.decode(i)},o=t.split("/").filter(Boolean);let a=await i(e),A=e;for(;o.length;){const e=o.shift();if(!e)throw ie(new Error(`Could not resolve path "${t}"`),"ERR_INVALID_PATH");if(!Object.prototype.hasOwnProperty.call(a,e))throw ie(new Error(`no link named "${e}" under ${A}`),"ERR_NO_LINK");a=a[e],yield{value:a,remainderPath:o.join("/")};const r=Ve.asCID(a);r&&(A=r,a=await i(a))}yield{value:a,remainderPath:""}}const fI=(e,t)=>{const r=kS(((t,r)=>{const n=xS(r);return async(t,r={})=>{if(r.path){const s=r.localResolve?await rm(dI(t,r.path,e,n,r)):await Da(dI(t,r.path,e,n,r));if(!s)throw ie(new Error("Not found"),"ERR_NOT_FOUND");return s}const s=await e.getCodec(t.code),i=await n(t,r);return{value:s.decode(i),remainderPath:""}}}));return r(t)},pI=kS((e=>async function*(t,r={}){const n=new AbortController,s=zS(n.signal,r.signal),{headers:i,body:o}=await VS(t,0,r.headers),a=await e.post("dag/import",{signal:s,headers:i,body:o,searchParams:PS({"pin-roots":r.pinRoots})});for await(const{Root:e}of a.ndjson())if(void 0!==e){const{Cid:{"/":t},PinErrorMsg:r}=e;yield{root:{cid:Ve.parse(t),pinErrorMsg:r}}}})),gI=(e,t)=>{const r=kS((t=>async(r,n={})=>{const s={storeCodec:"dag-cbor",hashAlg:"sha2-256",...n};let i;if(s.inputCodec){if(!(r instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");i=r}else{i=(await e.getCodec(s.storeCodec)).encode(r),s.inputCodec=s.storeCodec}const o=new AbortController,a=zS(o.signal,s.signal),A=await t.post("dag/put",{timeout:s.timeout,signal:a,searchParams:PS(s),...await VS([i],0,s.headers)}),c=await A.json();return Ve.parse(c.Cid["/"])}));return r(t)},yI=kS((e=>async(t,r={})=>{const n=await e.post("dag/resolve",{signal:r.signal,searchParams:PS({arg:`${t}${r.path?`/${r.path}`.replace(/\/[/]+/g,"/"):""}`,...r}),headers:r.headers}),s=await n.json();return{cid:Ve.parse(s.Cid["/"]),remainderPath:s.RemPath}}));function wI(e,t){return{export:hI(t),get:fI(e,t),import:pI(t),put:gI(e,t),resolve:yI(t)}}const mI=e=>{if(0===e.Type)return{name:"SENDING_QUERY",type:e.Type};if(1===e.Type)return{from:Ta(e.ID),name:"PEER_RESPONSE",type:e.Type,messageType:0,messageName:"PUT_VALUE",closer:(e.Responses||[]).map((({ID:e,Addrs:t})=>({id:Ta(e),multiaddrs:t.map((e=>mi(e))),protocols:[]}))),providers:(e.Responses||[]).map((({ID:e,Addrs:t})=>({id:Ta(e),multiaddrs:t.map((e=>mi(e))),protocols:[]})))};if(2===e.Type){let t={id:e.ID??Ta(e.ID),multiaddrs:[],protocols:[]};return e.Responses&&e.Responses.length&&(t={id:Ta(e.Responses[0].ID),multiaddrs:e.Responses[0].Addrs.map((e=>mi(e))),protocols:[]}),{name:"FINAL_PEER",type:e.Type,peer:t}}if(3===e.Type)return{name:"QUERY_ERROR",type:e.Type,error:new Error(e.Extra)};if(4===e.Type)return{name:"PROVIDER",type:e.Type,providers:e.Responses.map((({ID:e,Addrs:t})=>({id:Ta(e),multiaddrs:t.map((e=>mi(e))),protocols:[]})))};if(5===e.Type)return{name:"VALUE",type:e.Type,value:vs(e.Extra,"base64pad")};if(6===e.Type){const t=e.Responses.map((({ID:e})=>Ta(e)));if(!t.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:e.Type,peer:t[0]}}if(7===e.Type)return{name:"DIALING_PEER",type:e.Type,peer:Ta(e.ID)};throw new Error("Unknown DHT event type")},bI=kS((e=>async function*(t,r={}){const n=await e.post("dht/findpeer",{signal:r.signal,searchParams:PS({arg:t,...r}),headers:r.headers});for await(const e of n.ndjson())yield mI(e)})),EI=kS((e=>async function*(t,r={}){const n=await e.post("dht/findprovs",{signal:r.signal,searchParams:PS({arg:t.toString(),...r}),headers:r.headers});for await(const e of n.ndjson())yield mI(e)})),vI=kS((e=>async function*(t,r={}){const n=await e.post("dht/get",{signal:r.signal,searchParams:PS({arg:t instanceof Uint8Array?Ts(t):t.toString(),...r}),headers:r.headers});for await(const e of n.ndjson())yield mI(e)})),BI=kS((e=>async function*(t,r={recursive:!1}){const n=Array.isArray(t)?t:[t],s=await e.post("dht/provide",{signal:r.signal,searchParams:PS({arg:n.map((e=>e.toString())),...r}),headers:r.headers});for await(const e of s.ndjson())yield mI(e)})),_I=kS((e=>async function*(t,r,n={}){const s=new AbortController,i=zS(s.signal,n.signal),o=await e.post("dht/put",{signal:i,searchParams:PS({arg:t instanceof Uint8Array?Ts(t):t.toString(),...n}),...await VS([r],0,n.headers)});for await(const e of o.ndjson())yield mI(e)})),CI=kS((e=>async function*(t,r={}){const n=await e.post("dht/query",{signal:r.signal,searchParams:PS({arg:t.toString(),...r}),headers:r.headers});for await(const e of n.ndjson())yield mI(e)}));function SI(e){return{findPeer:bI(e),findProvs:EI(e),get:vI(e),provide:BI(e),put:_I(e),query:CI(e)}}const II=kS((e=>async function(t={}){return(await e.post("diag/cmds",{signal:t.signal,searchParams:PS(t),headers:t.headers})).json()})),TI=kS((e=>async function(t={}){return(await e.post("diag/net",{signal:t.signal,searchParams:PS(t),headers:t.headers})).json()})),RI=kS((e=>async function(t={}){return(await e.post("diag/sys",{signal:t.signal,searchParams:PS(t),headers:t.headers})).json()}));function kI(e){return{cmds:II(e),net:TI(e),sys:RI(e)}}const UI=kS((e=>async function(t,r,n={}){const s=await e.post("files/chmod",{signal:n.signal,searchParams:PS({arg:t,mode:r,...n}),headers:n.headers});await s.text()})),DI=kS((e=>async function(t,r,n={}){const s=Array.isArray(t)?t:[t],i=await e.post("files/cp",{signal:n.signal,searchParams:PS({arg:s.concat(r).map((e=>Ve.asCID(e)?`/ipfs/${e}`:e)),...n}),headers:n.headers});await i.text()})),PI=kS((e=>async function(t,r={}){if(!t||"string"!=typeof t)throw new Error("ipfs.files.flush requires a path");const n=await e.post("files/flush",{signal:r.signal,searchParams:PS({arg:t,...r}),headers:r.headers}),s=await n.json();return Ve.parse(s.Cid)}));function LI(e){const t=nI(e);return Object.prototype.hasOwnProperty.call(t,"mode")&&(t.mode=parseInt(t.mode,8)),Object.prototype.hasOwnProperty.call(t,"mtime")&&(t.mtime={secs:t.mtime,nsecs:t.mtimeNsecs||0},delete t.mtimeNsecs),t}const NI=kS((e=>async function*(t,r={}){if(!t)throw new Error("ipfs.files.ls requires a path");const n=await e.post("files/ls",{signal:r.signal,searchParams:PS({arg:Ve.asCID(t)?`/ipfs/${t}`:t,long:!0,...r,stream:!0}),headers:r.headers});for await(const e of n.ndjson())if("Entries"in e)for(const t of e.Entries||[])yield OI(LI(t));else yield OI(LI(e))}));function OI(e){return e.hash&&(e.cid=Ve.parse(e.hash)),delete e.hash,e.type=1===e.type?"directory":"file",e}const FI=kS((e=>async function(t,r={}){const n=await e.post("files/mkdir",{signal:r.signal,searchParams:PS({arg:t,...r}),headers:r.headers});await n.text()})),QI=kS((e=>async function(t,r,n={}){Array.isArray(t)||(t=[t]);const s=await e.post("files/mv",{signal:n.signal,searchParams:PS({arg:t.concat(r),...n}),headers:n.headers});await s.text()}));var xI=r(50590);const MI=kS((e=>async function*(t,r={}){const n=await e.post("files/read",{signal:r.signal,searchParams:PS({arg:t,count:r.length,...r}),headers:r.headers});yield*xI(n.body)})),HI=kS((e=>async function(t,r={}){const n=await e.post("files/rm",{signal:r.signal,searchParams:PS({arg:t,...r}),headers:r.headers}),s=await n.text();if(""!==s){const e=new ha.HTTPError(n);throw e.message=s,e}})),KI=kS((e=>async function(t,r={}){const n=await e.post("files/stat",{signal:r.signal,searchParams:PS({arg:t,...r}),headers:r.headers}),s=await n.json();return s.WithLocality=s.WithLocality||!1,(i=LI(s)).cid=Ve.parse(i.hash),delete i.hash,i;var i}));const VI=kS((e=>async function(t,r={}){const n=await e.post("files/touch",{signal:r.signal,searchParams:PS({arg:t,...r}),headers:r.headers});await n.text()})),zI=kS((e=>async function(t,r,n={}){const s=new AbortController,i=zS(s.signal,n.signal),o=await e.post("files/write",{signal:i,searchParams:PS({arg:t,streamChannels:!0,count:n.length,...n}),...await VS([{content:r,path:"arg",mode:US(n.mode),mtime:DS(n.mtime)}],0,n.headers)});await o.text()}));function jI(e){return{chmod:UI(e),cp:DI(e),flush:PI(e),ls:NI(e),mkdir:FI(e),mv:QI(e),read:MI(e),rm:HI(e),stat:KI(e),touch:VI(e),write:zI(e)}}const GI=kS((e=>async(e,t,r={})=>{throw ie(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})),$I=kS((e=>async function(t,r){const n=r??{type:"Ed25519"},s=await e.post("key/gen",{signal:n.signal,searchParams:PS({arg:t,...n}),headers:n.headers});return nI(await s.json())})),qI=kS((e=>async function(t,r,n,s={}){const i=await e.post("key/import",{signal:s.signal,searchParams:PS({arg:t,pem:r,password:n,...s}),headers:s.headers});return nI(await i.json())})),WI=kS((e=>async(e,t={})=>{throw ie(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})),YI=kS((e=>async function(t={}){const r=await e.post("key/list",{signal:t.signal,searchParams:PS(t),headers:t.headers});return((await r.json()).Keys||[]).map((e=>nI(e)))})),XI=kS((e=>async function(t,r,n={}){const s=await e.post("key/rename",{signal:n.signal,searchParams:PS({arg:[t,r],...n}),headers:n.headers});return nI(await s.json())})),JI=kS((e=>async function(t,r={}){const n=await e.post("key/rm",{signal:r.signal,searchParams:PS({arg:t,...r}),headers:r.headers});return nI((await n.json()).Keys[0])}));function ZI(e){return{export:GI(e),gen:$I(e),import:qI(e),info:WI(e),list:YI(e),rename:XI(e),rm:JI(e)}}const eT=kS((e=>async function(t,r,n={}){const s=await e.post("log/level",{signal:n.signal,searchParams:PS({arg:[t,r],...n}),headers:n.headers});return nI(await s.json())})),tT=kS((e=>async function(t={}){const r=await e.post("log/ls",{signal:t.signal,searchParams:PS(t),headers:t.headers});return(await r.json()).Strings})),rT=kS((e=>async function*(t={}){const r=await e.post("log/tail",{signal:t.signal,searchParams:PS(t),headers:t.headers});yield*r.ndjson()}));function nT(e){return{level:eT(e),ls:tT(e),tail:rT(e)}}const sT=kS((e=>async function(t,r={}){const n=await e.post("name/publish",{signal:r.signal,searchParams:PS({arg:`${t}`,...r}),headers:r.headers});return nI(await n.json())})),iT=kS((e=>async function*(t,r={}){const n=await e.post("name/resolve",{signal:r.signal,searchParams:PS({arg:t,stream:!0,...r}),headers:r.headers});for await(const e of n.ndjson())yield e.Path})),oT=kS((e=>async function(t,r={}){const n=await e.post("name/pubsub/cancel",{signal:r.signal,searchParams:PS({arg:t,...r}),headers:r.headers});return nI(await n.json())})),aT=kS((e=>async function(t={}){const r=await e.post("name/pubsub/state",{signal:t.signal,searchParams:PS(t),headers:t.headers});return nI(await r.json())})),AT=kS((e=>async function(t={}){const r=await e.post("name/pubsub/subs",{signal:t.signal,searchParams:PS(t),headers:t.headers});return(await r.json()).Strings||[]}));function cT(e){return{cancel:oT(e),state:aT(e),subs:AT(e)}}function lT(e){return{publish:sT(e),resolve:iT(e),pubsub:cT(e)}}const uT=kS((e=>async function(t,r={}){const n=await e.post("object/data",{signal:r.signal,searchParams:PS({arg:`${t instanceof Uint8Array?Ve.decode(t):t}`,...r}),headers:r.headers}),s=await n.arrayBuffer();return new Uint8Array(s,0,s.byteLength)})),hT=kS((e=>async function(t,r={}){const n=await e.post("object/get",{signal:r.signal,searchParams:PS({arg:`${t instanceof Uint8Array?Ve.decode(t):t}`,dataEncoding:"base64",...r}),headers:r.headers}),s=await n.json();return{Data:vs(s.Data,"base64pad"),Links:(s.Links||[]).map((e=>({Name:e.Name,Hash:Ve.parse(e.Hash),Tsize:e.Size})))}})),dT=kS((e=>async function(t,r={}){const n=await e.post("object/links",{signal:r.signal,searchParams:PS({arg:`${t instanceof Uint8Array?Ve.decode(t):t}`,...r}),headers:r.headers});return((await n.json()).Links||[]).map((e=>({Name:e.Name,Tsize:e.Size,Hash:Ve.parse(e.Hash)})))})),fT=kS((e=>async function(t={}){const r=await e.post("object/new",{signal:t.signal,searchParams:PS({arg:t.template,...t}),headers:t.headers}),{Hash:n}=await r.json();return Ve.parse(n)})),pT=(e,t)=>{const r=kS((r=>{const n=gI(e,t);return async function(e,t={}){return n(e,{...t,storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})}}));return r(t)},gT=kS((e=>async function(t,r={}){const n=await e.post("object/stat",{signal:r.signal,searchParams:PS({arg:`${t}`,...r}),headers:r.headers}),s=await n.json();return{...s,Hash:Ve.parse(s.Hash)}})),yT=kS((e=>async function(t,r,n={}){const s=await e.post("object/patch/add-link",{signal:n.signal,searchParams:PS({arg:[`${t}`,r.Name||r.name||"",(r.Hash||r.cid||"").toString()||null],...n}),headers:n.headers}),{Hash:i}=await s.json();return Ve.parse(i)})),wT=kS((e=>async function(t,r,n={}){const s=new AbortController,i=zS(s.signal,n.signal),o=await e.post("object/patch/append-data",{signal:i,searchParams:PS({arg:`${t}`,...n}),...await VS([r],0,n.headers)}),{Hash:a}=await o.json();return Ve.parse(a)})),mT=kS((e=>async function(t,r,n={}){const s=await e.post("object/patch/rm-link",{signal:n.signal,searchParams:PS({arg:[`${t}`,r.Name||r.name||null],...n}),headers:n.headers}),{Hash:i}=await s.json();return Ve.parse(i)})),bT=kS((e=>async function(t,r,n={}){const s=new AbortController,i=zS(s.signal,n.signal),o=await e.post("object/patch/set-data",{signal:i,searchParams:PS({arg:[`${t}`],...n}),...await VS([r],0,n.headers)}),{Hash:a}=await o.json();return Ve.parse(a)}));function ET(e){return{addLink:yT(e),appendData:wT(e),rmLink:mT(e),setData:bT(e)}}function vT(e,t){return{data:uT(t),get:hT(t),links:dT(t),new:fT(t),put:pT(e,t),stat:gT(t),patch:ET(t)}}const BT=kS((e=>async function*(t,r={}){for await(const{path:n,recursive:s,metadata:i}of La(t)){const t=await e.post("pin/add",{signal:r.signal,searchParams:PS({...r,arg:n,recursive:s,metadata:i?JSON.stringify(i):void 0,stream:!0}),headers:r.headers});for await(const e of t.ndjson())if(e.Pins)for(const t of e.Pins)yield Ve.parse(t);else yield Ve.parse(e)}}));function _T(e){const t=BT(e);return kS((()=>async function(e,r={}){return Da(t([{path:e,...r}],r))}))(e)}function CT(e,t,r){const n={type:e,cid:Ve.parse(t)};return r&&(n.metadata=r),n}const ST=kS((e=>async function*(t={}){let r=[];t.paths&&(r=Array.isArray(t.paths)?t.paths:[t.paths]);const n=await e.post("pin/ls",{signal:t.signal,searchParams:PS({...t,arg:r.map((e=>`${e}`)),stream:!0}),headers:t.headers});for await(const e of n.ndjson()){if(e.Keys){for(const t of Object.keys(e.Keys))yield CT(e.Keys[t].Type,t,e.Keys[t].Metadata);return}yield CT(e.Type,e.Cid,e.Metadata)}})),IT=kS((e=>async function*(t,r={}){for await(const{path:n,recursive:s}of La(t)){const t=new URLSearchParams(r.searchParams);t.append("arg",`${n}`),null!=s&&t.set("recursive",String(s));const i=await e.post("pin/rm",{signal:r.signal,headers:r.headers,searchParams:PS({...r,arg:`${n}`,recursive:s})});for await(const e of i.ndjson())e.Pins?yield*e.Pins.map((e=>Ve.parse(e))):yield Ve.parse(e)}})),TT=e=>{const t=IT(e);return kS((()=>async function(e,r={}){return Da(t([{path:e,...r}],r))}))(e)},RT=({Name:e,Status:t,Cid:r})=>({cid:Ve.parse(r),name:e,status:t}),kT=e=>{if("string"==typeof e&&""!==e)return e;throw new TypeError("service name must be passed")},UT=e=>{if(Ve.asCID(e))return e.toString();throw new TypeError("CID instance expected instead of "+typeof e)},DT=({service:e,cid:t,name:r,status:n,all:s})=>{const i=PS({service:kT(e),name:r,force:!!s||void 0});if(t)for(const e of t)i.append("cid",UT(e));if(n)for(const e of n)i.append("status",e);return i},PT=({cid:e,service:t,background:r,name:n,origins:s})=>{const i=PS({arg:UT(e),service:kT(t),name:n,background:!!r||void 0});if(s)for(const e of s)i.append("origin",e.toString());return i};function LT(e){return async function(t,{timeout:r,signal:n,headers:s,...i}){const o=await e.post("pin/remote/add",{timeout:r,signal:n,headers:s,searchParams:PT({cid:t,...i})});return RT(await o.json())}}function NT(e){return async function*({timeout:t,signal:r,headers:n,...s}){const i=await e.post("pin/remote/ls",{timeout:t,signal:r,headers:n,searchParams:DT(s)});for await(const e of i.ndjson())yield RT(e)}}function OT(e){return async function({timeout:t,signal:r,headers:n,...s}){await e.post("pin/remote/rm",{timeout:t,signal:r,headers:n,searchParams:DT({...s,all:!1})})}}function FT(e){return async function({timeout:t,signal:r,headers:n,...s}){await e.post("pin/remote/rm",{timeout:t,signal:r,headers:n,searchParams:DT({...s,all:!0})})}}function QT(e){const t=String(e);if("undefined"===t)throw Error("endpoint is required");return"/"===t[t.length-1]?t.slice(0,-1):t}function xT(e){return{service:e.Service,endpoint:new URL(e.ApiEndpoint),...e.Stat&&{stat:MT(e.Stat)}}}function MT(e){switch(e.Status){case"valid":{const{Pinning:t,Pinned:r,Queued:n,Failed:s}=e.PinCount;return{status:"valid",pinCount:{queued:n,pinning:t,pinned:r,failed:s}}}case"invalid":return{status:"invalid"};default:return{status:e.Status}}}function HT(e){return async function(t,r){const{endpoint:n,key:s,headers:i,timeout:o,signal:a}=r;await e.post("pin/remote/service/add",{timeout:o,signal:a,searchParams:PS({arg:[t,QT(n),s]}),headers:i})}}function KT(e){return async function(t={}){const{stat:r,headers:n,timeout:s,signal:i}=t,o=await e.post("pin/remote/service/ls",{timeout:s,signal:i,headers:n,searchParams:!0===r?PS({stat:r}):void 0}),{RemoteServices:a}=await o.json();return a.map(xT)}}function VT(e){return async function(t,r={}){await e.post("pin/remote/service/rm",{signal:r.signal,headers:r.headers,searchParams:PS({arg:t})})}}function zT(e){const t=new RS(e);return{add:HT(t),ls:KT(t),rm:VT(t)}}function jT(e){const t=new RS(e);return{add:LT(t),ls:NT(t),rm:OT(t),rmAll:FT(t),service:zT(e)}}function GT(e){return{addAll:BT(e),add:_T(e),ls:ST(e),rmAll:IT(e),rm:TT(e),remote:jT(e)}}const $T=e=>Ts(qT(e)),qT=e=>re.decode(e),WT=e=>BigInt(`0x${Ts(re.decode(e),"base16")}`),YT=e=>re.encode(vs(e)),XT=kS((e=>async function(t={}){const{Strings:r}=await(await e.post("pubsub/ls",{signal:t.signal,searchParams:PS(t),headers:t.headers})).json();return(e=>Array.isArray(e)?e.map($T):e)(r)||[]})),JT=kS((e=>async function(t,r={}){const n=await e.post("pubsub/peers",{signal:r.signal,searchParams:PS({arg:YT(t),...r}),headers:r.headers}),{Strings:s}=await n.json();return s||[]})),ZT=kS((e=>async function(t,r,n={}){const s=PS({arg:YT(t),...n}),i=new AbortController,o=zS(i.signal,n.signal),a=await e.post("pubsub/pub",{signal:o,searchParams:s,...await VS([r],0,n.headers)});await a.text()})),eR=se("ipfs-http-client:pubsub:subscribe"),tR=(e,t)=>kS((e=>async function(r,n,s={}){let i,o;s.signal=t.subscribe(r,n,s.signal);const a=new Promise(((e,t)=>{i=e,o=t})),A=setTimeout((()=>i()),1e3);return e.post("pubsub/sub",{signal:s.signal,searchParams:PS({arg:YT(r),...s}),headers:s.headers}).catch((e=>{t.unsubscribe(r,n),o(e)})).then((e=>{clearTimeout(A),e&&(!async function(e,{onMessage:t,onEnd:r,onError:n}){n=n||eR;try{for await(const r of e.ndjson())try{if(!r.from)continue;null!=r.from&&null!=r.seqno?t({type:"signed",from:Ta(r.from),data:qT(r.data),sequenceNumber:WT(r.seqno),topic:$T(r.topicIDs[0]),key:qT(r.key??"u"),signature:qT(r.signature??"u")}):t({type:"unsigned",data:qT(r.data),topic:$T(r.topicIDs[0])})}catch(e){e.message=`Failed to parse pubsub message: ${e.message}`,n(e,!1,r)}}catch(e){rR(e)||n(e,!0)}finally{r()}}(e,{onMessage:e=>{n&&("function"!=typeof n?"function"==typeof n.handleEvent&&n.handleEvent(e):n(e))},onEnd:()=>t.unsubscribe(r,n),onError:s.onError}),i())})),a}))(e);const rR=e=>{switch(e.type){case"aborted":case"abort":return!0;default:return"AbortError"===e.name}};class nR{constructor(){this._subs=new Map}subscribe(e,t,r){const n=this._subs.get(e)||[];if(n.find((e=>e.handler===t)))throw new Error(`Already subscribed to ${e} with this handler`);const s=new AbortController;return this._subs.set(e,[{handler:t,controller:s}].concat(n)),r&&r.addEventListener("abort",(()=>this.unsubscribe(e,t))),s.signal}unsubscribe(e,t){const r=this._subs.get(e)||[];let n;t?(this._subs.set(e,r.filter((e=>e.handler!==t))),n=r.filter((e=>e.handler===t))):(this._subs.set(e,[]),n=r),(this._subs.get(e)||[]).length||this._subs.delete(e),n.forEach((e=>e.controller.abort()))}}function sR(e){const t=new nR;return{ls:XT(e),peers:JT(e),publish:ZT(e),subscribe:tR(e,t),unsubscribe:(r=t,async function(e,t){r.unsubscribe(e,t)})};var r}const iR=kS((e=>async function*(t={}){const r=await e.post("refs/local",{signal:t.signal,transform:nI,searchParams:PS(t),headers:t.headers});yield*r.ndjson()})),oR=kS(((e,t)=>Object.assign((async function*(t,r={}){const n=Array.isArray(t)?t:[t],s=await e.post("refs",{signal:r.signal,searchParams:PS({arg:n.map((e=>`${e instanceof Uint8Array?Ve.decode(e):e}`)),...r}),headers:r.headers,transform:nI});yield*s.ndjson()}),{local:iR(t)}))),aR=kS((e=>async function*(t={}){const r=await e.post("repo/gc",{signal:t.signal,searchParams:PS(t),headers:t.headers,transform:e=>({err:e.Error?new Error(e.Error):null,cid:(e.Key||{})["/"]?Ve.parse(e.Key["/"]):null})});yield*r.ndjson()})),AR=kS((e=>async function(t={}){const r=await e.post("repo/stat",{signal:t.signal,searchParams:PS(t),headers:t.headers}),n=await r.json();return{numObjects:BigInt(n.NumObjects),repoSize:BigInt(n.RepoSize),repoPath:n.RepoPath,version:n.Version,storageMax:BigInt(n.StorageMax)}})),cR=kS((e=>async function(t={}){return(await(await e.post("repo/version",{signal:t.signal,searchParams:PS(t),headers:t.headers})).json()).Version}));function lR(e){return{gc:aR(e),stat:AR(e),version:cR(e)}}const uR=kS((e=>async function*(t={}){const r=await e.post("stats/bw",{signal:t.signal,searchParams:PS(t),headers:t.headers,transform:e=>({totalIn:BigInt(e.TotalIn),totalOut:BigInt(e.TotalOut),rateIn:parseFloat(e.RateIn),rateOut:parseFloat(e.RateOut)})});yield*r.ndjson()}));function hR(e){return{bitswap:OS(e),repo:AR(e),bw:uR(e)}}const dR=kS((e=>async function(t={}){const r=await e.post("swarm/addrs",{signal:t.signal,searchParams:PS(t),headers:t.headers}),{Addrs:n}=await r.json();return Object.keys(n).map((e=>({id:Ta(e),addrs:(n[e]||[]).map((e=>mi(e)))})))})),fR=kS((e=>async function(t,r={}){const n=await e.post("swarm/connect",{signal:r.signal,searchParams:PS({arg:t,...r}),headers:r.headers}),{Strings:s}=await n.json();return s||[]})),pR=kS((e=>async function(t,r={}){const n=await e.post("swarm/disconnect",{signal:r.signal,searchParams:PS({arg:t,...r}),headers:r.headers}),{Strings:s}=await n.json();return s||[]})),gR=kS((e=>async function(t={}){const r=await e.post("swarm/addrs/local",{signal:t.signal,searchParams:PS(t),headers:t.headers}),{Strings:n}=await r.json();return(n||[]).map((e=>mi(e)))})),yR=kS((e=>async function(t={}){const r=await e.post("swarm/peers",{signal:t.signal,searchParams:PS(t),headers:t.headers}),{Peers:n}=await r.json();return(n||[]).map((e=>({addr:mi(e.Addr),peer:Ta(e.Peer),muxer:e.Muxer,latency:e.Latency,streams:e.Streams,direction:null==e.Direction?void 0:0===e.Direction?"inbound":"outbound"})))}));function wR(e){return{addrs:dR(e),connect:fR(e),disconnect:pR(e),localAddrs:gR(e),peers:yR(e)}}const mR=kS((e=>async function*(t,r={}){const n=new AbortController,s=zS(n.signal,r.signal),{headers:i,body:o,total:a,parts:A}=await VS(t,0,r.headers),[c,l]="function"==typeof r.progress?bR(a,A,r.progress):[void 0,void 0],u=await e.post("add",{searchParams:PS({"stream-channels":!0,...r,progress:Boolean(c)}),onUploadProgress:l,signal:s,headers:i,body:o});for await(let e of u.ndjson())e=nI(e),void 0!==e.hash?yield vR(e):c&&c(e.bytes||0,e.name)})),bR=(e,t,r)=>t?[void 0,ER(e,t,r)]:[r,void 0],ER=(e,t,r)=>{let n=0;const s=t.length;return({loaded:i,total:o})=>{const a=Math.floor(i/o*e);for(;n<s;){const{start:e,end:s,name:i}=t[n];if(a<s){r(a-e,i);break}r(s-e,i),n+=1}}};function vR({name:e,hash:t,size:r,mode:n,mtime:s,mtimeNsecs:i}){const o={path:e,cid:Ve.parse(t),size:parseInt(r)};return null!=n&&(o.mode=parseInt(n,8)),null!=s&&(o.mtime={secs:s,nsecs:i||0}),o}function BR(e){const t=mR(e);return kS((()=>async function(e,r={}){return await Da(t(nd(e),r))}))(e)}const _R=kS((e=>async function*(t,r={}){const n=await e.post("cat",{signal:r.signal,searchParams:PS({arg:t.toString(),...r}),headers:r.headers});yield*n.iterator()})),CR=kS((e=>async(t={})=>(await e.post("commands",{signal:t.signal,searchParams:PS(t),headers:t.headers})).json())),SR=kS((e=>async(t,r={})=>{const n=await e.post("dns",{signal:r.signal,searchParams:PS({arg:t,...r}),headers:r.headers});return(await n.json()).Path})),IR=kS((e=>()=>{const t=new URL(e.opts.base||"");return{host:t.hostname,port:t.port,protocol:t.protocol,pathname:t.pathname,"api-path":t.pathname}})),TR=kS((e=>async function*(t,r={}){const n={arg:`${t instanceof Uint8Array?Ve.decode(t):t}`,...r};n.compressionLevel&&(n["compression-level"]=n.compressionLevel,delete n.compressionLevel);const s=await e.post("get",{signal:r.signal,searchParams:PS(n),headers:r.headers});yield*s.iterator()})),RR=kS((e=>async function(t={}){const r=await e.post("id",{signal:t.signal,searchParams:PS({arg:t.peerId?t.peerId.toString():void 0,...t}),headers:t.headers}),n={...nI(await r.json())};return n.id=Ta(n.id),n.addresses&&(n.addresses=n.addresses.map((e=>mi(e)))),n})),kR=e=>{const t=RR(e);return async function(e={}){const r=await t(e);return Boolean(r&&r.addresses&&r.addresses.length)}},UR=kS(((e,t)=>async function*(r,n={}){const s=`${r instanceof Uint8Array?Ve.decode(r):r}`;async function i(e){let r=e.Hash;if(r.includes("/")){const e=r.startsWith("/ipfs/")?r:`/ipfs/${r}`;r=(await KI(t)(e)).cid}else r=Ve.parse(r);const n={name:e.Name,path:s+(e.Name?`/${e.Name}`:""),size:e.Size,cid:r,type:DR(e)};return e.Mode&&(n.mode=parseInt(e.Mode,8)),void 0!==e.Mtime&&null!==e.Mtime&&(n.mtime={secs:e.Mtime},void 0!==e.MtimeNsecs&&null!==e.MtimeNsecs&&(n.mtime.nsecs=e.MtimeNsecs)),n}const o=await e.post("ls",{signal:n.signal,searchParams:PS({arg:s,...n}),headers:n.headers});for await(let e of o.ndjson()){if(e=e.Objects,!e)throw new Error("expected .Objects in results");if(e=e[0],!e)throw new Error("expected one array in results.Objects");const t=e.Links;if(!Array.isArray(t))throw new Error("expected one array in results.Objects[0].Links");if(!t.length)return void(yield i(e));yield*t.map(i)}}));function DR(e){switch(e.Type){case 1:case 5:return"dir";default:return"file"}}const PR=kS((e=>async function(t={}){const r=await e.post("dns",{signal:t.signal,searchParams:PS(t),headers:t.headers});return nI(await r.json())})),LR=kS((e=>async function*(t,r={}){const n=await e.post("ping",{signal:r.signal,searchParams:PS({arg:`${t}`,...r}),headers:r.headers,transform:nI});yield*n.ndjson()})),NR=kS((e=>async function(t,r={}){const n=await e.post("resolve",{signal:r.signal,searchParams:PS({arg:t,...r}),headers:r.headers}),{Path:s}=await n.json();return s})),OR=kS((e=>async(e={})=>{throw ie(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})),FR=kS((e=>async function(t={}){const r=await e.post("shutdown",{signal:t.signal,searchParams:PS(t),headers:t.headers});await r.text()})),QR=kS((e=>async function(t={}){const r=await e.post("version",{signal:t.signal,searchParams:PS(t),headers:t.headers});return{...nI(await r.json()),"ipfs-http-client":"1.0.0"}}));r(63897),r(46953);const xR=Object.create(null);xR.open="0",xR.close="1",xR.ping="2",xR.pong="3",xR.message="4",xR.upgrade="5",xR.noop="6";const MR=Object.create(null);Object.keys(xR).forEach((e=>{MR[xR[e]]=e}));const HR={type:"error",data:"parser error"},KR="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),VR="function"==typeof ArrayBuffer,zR=(e,t)=>{const r=new FileReader;return r.onload=function(){const e=r.result.split(",")[1];t("b"+(e||""))},r.readAsDataURL(e)};var jR=({type:e,data:t},r,n)=>{return KR&&t instanceof Blob?r?n(t):zR(t,n):VR&&(t instanceof ArrayBuffer||(s=t,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer))?r?n(t):zR(new Blob([t]),n):n(xR[e]+(t||""));var s};const GR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$R="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let e=0;e<GR.length;e++)$R[GR.charCodeAt(e)]=e;const qR="function"==typeof ArrayBuffer,WR=(e,t)=>{if(qR){const r=(e=>{let t,r,n,s,i,o=.75*e.length,a=e.length,A=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);const c=new ArrayBuffer(o),l=new Uint8Array(c);for(t=0;t<a;t+=4)r=$R[e.charCodeAt(t)],n=$R[e.charCodeAt(t+1)],s=$R[e.charCodeAt(t+2)],i=$R[e.charCodeAt(t+3)],l[A++]=r<<2|n>>4,l[A++]=(15&n)<<4|s>>2,l[A++]=(3&s)<<6|63&i;return c})(e);return YR(r,t)}return{base64:!0,data:e}},YR=(e,t)=>"blob"===t&&e instanceof ArrayBuffer?new Blob([e]):e;var XR=(e,t)=>{if("string"!=typeof e)return{type:"message",data:YR(e,t)};const r=e.charAt(0);if("b"===r)return{type:"message",data:WR(e.substring(1),t)};return MR[r]?e.length>1?{type:MR[r],data:e.substring(1)}:{type:MR[r]}:HR};const JR=String.fromCharCode(30);function ZR(e){if(e)return function(e){for(var t in ZR.prototype)e[t]=ZR.prototype[t];return e}(e)}ZR.prototype.on=ZR.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},ZR.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},ZR.prototype.off=ZR.prototype.removeListener=ZR.prototype.removeAllListeners=ZR.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var s=0;s<n.length;s++)if((r=n[s])===t||r.fn===t){n.splice(s,1);break}return 0===n.length&&delete this._callbacks["$"+e],this},ZR.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){n=0;for(var s=(r=r.slice(0)).length;n<s;++n)r[n].apply(this,t)}return this},ZR.prototype.emitReserved=ZR.prototype.emit,ZR.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},ZR.prototype.hasListeners=function(e){return!!this.listeners(e).length};const ek="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function tk(e,...t){return t.reduce(((t,r)=>(e.hasOwnProperty(r)&&(t[r]=e[r]),t)),{})}const rk=ek.setTimeout,nk=ek.clearTimeout;function sk(e,t){t.useNativeTimers?(e.setTimeoutFn=rk.bind(ek),e.clearTimeoutFn=nk.bind(ek)):(e.setTimeoutFn=ek.setTimeout.bind(ek),e.clearTimeoutFn=ek.clearTimeout.bind(ek))}class ik extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}}class ok extends ZR{constructor(e){super(),this.writable=!1,sk(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,r){return super.emitReserved("error",new ik(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=XR(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}}const ak="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Ak={};let ck,lk=0,uk=0;function hk(e){let t="";do{t=ak[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function dk(){const e=hk(+new Date);return e!==ck?(lk=0,ck=e):e+"."+hk(lk++)}for(;uk<64;uk++)Ak[ak[uk]]=uk;function fk(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}let pk=!1;try{pk="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(dg){}const gk=pk;function yk(e){const t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||gk))return new XMLHttpRequest}catch(e){}if(!t)try{return new(ek[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}function wk(){}const mk=null!=new yk({xdomain:!1}).responseType;class bk extends ZR{constructor(e,t){super(),sk(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.create()}create(){const e=tk(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;const t=this.xhr=new yk(e);try{t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&t.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(e){}if("POST"===this.method)try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),t.onreadystatechange=()=>{4===t.readyState&&(200===t.status||1223===t.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"==typeof t.status?t.status:0)}),0))},t.send(this.data)}catch(e){return void this.setTimeoutFn((()=>{this.onError(e)}),0)}"undefined"!=typeof document&&(this.index=bk.requestsCount++,bk.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=wk,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete bk.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(bk.requestsCount=0,bk.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",Ek);else if("function"==typeof addEventListener){addEventListener("onpagehide"in ek?"pagehide":"unload",Ek,!1)}function Ek(){for(let e in bk.requests)bk.requests.hasOwnProperty(e)&&bk.requests[e].abort()}const vk="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),Bk=ek.WebSocket||ek.MozWebSocket;r(48764).Buffer;const _k="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();const Ck={websocket:class extends ok{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,r=_k?{}:tk(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=_k?new Bk(e,t,r):t?new Bk(e,t):new Bk(e)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],n=t===e.length-1;jR(r,this.supportsBinary,(e=>{try{this.ws.send(e)}catch(e){}n&&vk((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{};const t=this.opts.secure?"wss":"ws";let r="";this.opts.port&&("wss"===t&&443!==Number(this.opts.port)||"ws"===t&&80!==Number(this.opts.port))&&(r=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=dk()),this.supportsBinary||(e.b64=1);const n=fk(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(n.length?"?"+n:"")}check(){return!!Bk}},polling:class extends ok{constructor(e){if(super(e),this.polling=!1,"undefined"!=typeof location){const t="https:"===location.protocol;let r=location.port;r||(r=t?"443":"80"),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||r!==e.port,this.xs=e.secure!==t}const t=e&&e.forceBase64;this.supportsBinary=mk&&!t}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let e=0;this.polling&&(e++,this.once("pollComplete",(function(){--e||t()}))),this.writable||(e++,this.once("drain",(function(){--e||t()})))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,t)=>{const r=e.split(JR),n=[];for(let e=0;e<r.length;e++){const s=XR(r[e],t);if(n.push(s),"error"===s.type)break}return n})(e,this.socket.binaryType).forEach((e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((e,t)=>{const r=e.length,n=new Array(r);let s=0;e.forEach(((e,i)=>{jR(e,!1,(e=>{n[i]=e,++s===r&&t(n.join(JR))}))}))})(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){let e=this.query||{};const t=this.opts.secure?"https":"http";let r="";!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=dk()),this.supportsBinary||e.sid||(e.b64=1),this.opts.port&&("https"===t&&443!==Number(this.opts.port)||"http"===t&&80!==Number(this.opts.port))&&(r=":"+this.opts.port);const n=fk(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(n.length?"?"+n:"")}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new bk(this.uri(),e)}doWrite(e,t){const r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",((e,t)=>{this.onError("xhr post error",e,t)}))}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",((e,t)=>{this.onError("xhr poll error",e,t)})),this.pollXhr=e}}},Sk=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Ik=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Tk(e){const t=e,r=e.indexOf("["),n=e.indexOf("]");-1!=r&&-1!=n&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));let s=Sk.exec(e||""),i={},o=14;for(;o--;)i[Ik[o]]=s[o]||"";return-1!=r&&-1!=n&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=function(e,t){const r=/\/{2,9}/g,n=t.replace(r,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||n.splice(0,1);"/"==t.slice(-1)&&n.splice(n.length-1,1);return n}(0,i.path),i.queryKey=function(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,n){t&&(r[t]=n)})),r}(0,i.query),i}class Rk extends ZR{constructor(e,t={}){super(),this.writeBuffer=[],e&&"object"==typeof e&&(t=e,e=null),e?(e=Tk(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=Tk(t.host).host),sk(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(e){let t={},r=e.split("&");for(let e=0,n=r.length;e<n;e++){let n=r[e].split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return t}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const r=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new Ck[e](r)}open(){let e;if(this.opts.rememberUpgrade&&Rk.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(e=>this.onClose("transport close",e)))}probe(e){let t=this.createTransport(e),r=!1;Rk.priorWebsocketSuccess=!1;const n=()=>{r||(t.send([{type:"ping",data:"probe"}]),t.once("packet",(e=>{if(!r)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Rk.priorWebsocketSuccess="websocket"===t.name,this.transport.pause((()=>{r||"closed"!==this.readyState&&(c(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())}))}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}})))};function s(){r||(r=!0,c(),t.close(),t=null)}const i=e=>{const r=new Error("probe error: "+e);r.transport=t.name,s(),this.emitReserved("upgradeError",r)};function o(){i("transport closed")}function a(){i("socket closed")}function A(e){t&&e.name!==t.name&&s()}const c=()=>{t.removeListener("open",n),t.removeListener("error",i),t.removeListener("close",o),this.off("close",a),this.off("upgrading",A)};t.once("open",n),t.once("error",i),t.once("close",o),this.once("close",a),this.once("upgrading",A),t.open()}onOpen(){if(this.readyState="open",Rk.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let r=0;r<this.writeBuffer.length;r++){const n=this.writeBuffer[r].data;if(n&&(e+="string"==typeof(t=n)?function(e){let t=0,r=0;for(let n=0,s=e.length;n<s;n++)t=e.charCodeAt(n),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(n++,r+=4);return r}(t):Math.ceil(1.33*(t.byteLength||t.size))),r>0&&e>this.maxPayload)return this.writeBuffer.slice(0,r);e+=2}var t;return this.writeBuffer}write(e,t,r){return this.sendPacket("message",e,t,r),this}send(e,t,r){return this.sendPacket("message",e,t,r),this}sendPacket(e,t,r,n){if("function"==typeof t&&(n=t,t=void 0),"function"==typeof r&&(n=r,r=null),"closing"===this.readyState||"closed"===this.readyState)return;(r=r||{}).compress=!1!==r.compress;const s={type:e,data:t,options:r};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),n&&this.once("flush",n),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?r():e()})):this.upgrading?r():e()),this}onError(e){Rk.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let r=0;const n=e.length;for(;r<n;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}Rk.protocol=4;Rk.protocol;const kk="function"==typeof ArrayBuffer,Uk=Object.prototype.toString,Dk="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Uk.call(Blob),Pk="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===Uk.call(File);function Lk(e){return kk&&(e instanceof ArrayBuffer||(e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||Dk&&e instanceof Blob||Pk&&e instanceof File}function Nk(e,t){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e)){for(let t=0,r=e.length;t<r;t++)if(Nk(e[t]))return!0;return!1}if(Lk(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return Nk(e.toJSON(),!0);for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&Nk(e[t]))return!0;return!1}function Ok(e){const t=[],r=e.data,n=e;return n.data=Fk(r,t),n.attachments=t.length,{packet:n,buffers:t}}function Fk(e,t){if(!e)return e;if(Lk(e)){const r={_placeholder:!0,num:t.length};return t.push(e),r}if(Array.isArray(e)){const r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=Fk(e[n],t);return r}if("object"==typeof e&&!(e instanceof Date)){const r={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=Fk(e[n],t));return r}return e}function Qk(e,t){return e.data=xk(e.data,t),delete e.attachments,e}function xk(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=xk(e[r],t);else if("object"==typeof e)for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=xk(e[r],t));return e}const Mk=5;var Hk;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(Hk||(Hk={}));class Kk{constructor(e){this.replacer=e}encode(e){return e.type!==Hk.EVENT&&e.type!==Hk.ACK||!Nk(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===Hk.EVENT?Hk.BINARY_EVENT:Hk.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==Hk.BINARY_EVENT&&e.type!==Hk.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=Ok(e),r=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(r),n}}class Vk extends ZR{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const r=t.type===Hk.BINARY_EVENT;r||t.type===Hk.BINARY_ACK?(t.type=r?Hk.EVENT:Hk.ACK,this.reconstructor=new zk(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!Lk(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const r={type:Number(e.charAt(0))};if(void 0===Hk[r.type])throw new Error("unknown packet type "+r.type);if(r.type===Hk.BINARY_EVENT||r.type===Hk.BINARY_ACK){const n=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const s=e.substring(n,t);if(s!=Number(s)||"-"!==e.charAt(t))throw new Error("Illegal attachments");r.attachments=Number(s)}if("/"===e.charAt(t+1)){const n=t+1;for(;++t;){if(","===e.charAt(t))break;if(t===e.length)break}r.nsp=e.substring(n,t)}else r.nsp="/";const n=e.charAt(t+1);if(""!==n&&Number(n)==n){const n=t+1;for(;++t;){const r=e.charAt(t);if(null==r||Number(r)!=r){--t;break}if(t===e.length)break}r.id=Number(e.substring(n,t+1))}if(e.charAt(++t)){const n=this.tryParse(e.substr(t));if(!Vk.isPayloadValid(r.type,n))throw new Error("invalid payload");r.data=n}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}static isPayloadValid(e,t){switch(e){case Hk.CONNECT:return"object"==typeof t;case Hk.DISCONNECT:return void 0===t;case Hk.CONNECT_ERROR:return"string"==typeof t||"object"==typeof t;case Hk.EVENT:case Hk.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case Hk.ACK:case Hk.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class zk{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=Qk(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function jk(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const Gk=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class $k extends ZR{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[jk(e,"open",this.onopen.bind(this)),jk(e,"packet",this.onpacket.bind(this)),jk(e,"error",this.onerror.bind(this)),jk(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(Gk.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const r={type:Hk.EVENT,data:t,options:{}};if(r.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){const e=this.ids++,n=t.pop();this._registerAckCallback(e,n),r.id=e}const n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!n||!this.connected)||(this.connected?(this.notifyOutgoingListeners(r),this.packet(r)):this.sendBuffer.push(r)),this.flags={},this}_registerAckCallback(e,t){var r;const n=null!==(r=this.flags.timeout)&&void 0!==r?r:this._opts.ackTimeout;if(void 0===n)return void(this.acks[e]=t);const s=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))}),n);this.acks[e]=(...e)=>{this.io.clearTimeoutFn(s),t.apply(this,[null,...e])}}emitWithAck(e,...t){const r=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise(((n,s)=>{t.push(((e,t)=>r?e?s(e):n(t):n(e))),this.emit(e,...t)}))}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(((e,...n)=>{if(r!==this._queue[0])return;return null!==e?r.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(e)):(this._queue.shift(),t&&t(null,...n)),r.pending=!1,this._drainQueue()})),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth((e=>{this._sendConnectPacket(e)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Hk.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Hk.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Hk.EVENT:case Hk.BINARY_EVENT:this.onevent(e);break;case Hk.ACK:case Hk.BINARY_ACK:this.onack(e);break;case Hk.DISCONNECT:this.ondisconnect();break;case Hk.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const r of t)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let r=!1;return function(...n){r||(r=!0,t.packet({type:Hk.ACK,id:e,data:n}))}}onack(e){const t=this.acks[e.id];"function"==typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>{this.notifyOutgoingListeners(e),this.packet(e)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Hk.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const r of t)r.apply(this,e.data)}}}function qk(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}qk.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,this.max)},qk.prototype.reset=function(){this.attempts=0},qk.prototype.setMin=function(e){this.ms=e},qk.prototype.setMax=function(e){this.max=e},qk.prototype.setJitter=function(e){this.jitter=e};class Wk extends ZR{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,sk(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(r=t.randomizationFactor)&&void 0!==r?r:.5),this.backoff=new qk({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const n=t.parser||C;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Rk(this.uri,this.opts);const t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const n=jk(t,"open",(function(){r.onopen(),e&&e()})),s=jk(t,"error",(t=>{r.cleanup(),r._readyState="closed",this.emitReserved("error",t),e?e(t):r.maybeReconnectOnOpen()}));if(!1!==this._timeout){const e=this._timeout;0===e&&n();const r=this.setTimeoutFn((()=>{n(),t.close(),t.emit("error",new Error("timeout"))}),e);this.opts.autoUnref&&r.unref(),this.subs.push((function(){clearTimeout(r)}))}return this.subs.push(n),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(jk(e,"ping",this.onping.bind(this)),jk(e,"data",this.ondata.bind(this)),jk(e,"error",this.onerror.bind(this)),jk(e,"close",this.onclose.bind(this)),jk(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}ondecoded(e){vk((()=>{this.emitReserved("packet",e)}),this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new $k(this,e,t),this.nsps[e]=r),r}_destroy(e){const t=Object.keys(this.nsps);for(const e of t){if(this.nsps[e].active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn((()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()})))}),t);this.opts.autoUnref&&r.unref(),this.subs.push((function(){clearTimeout(r)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Yk={};function Xk(e,t){"object"==typeof e&&(t=e,e=void 0);const r=function(e,t="",r){let n=e;r=r||"undefined"!=typeof location&&location,null==e&&(e=r.protocol+"//"+r.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?r.protocol+e:r.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==r?r.protocol+"//"+e:"https://"+e),n=Tk(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const s=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port+t,n.href=n.protocol+"://"+s+(r&&r.port===n.port?"":":"+n.port),n}(e,(t=t||{}).path||"/socket.io"),n=r.source,s=r.id,i=r.path,o=Yk[s]&&i in Yk[s].nsps;let a;return t.forceNew||t["force new connection"]||!1===t.multiplex||o?a=new Wk(n,t):(Yk[s]||(Yk[s]=new Wk(n,t)),a=Yk[s]),r.query&&!t.query&&(t.query=r.queryKey),a.socket(r.path,t)}Object.assign(Xk,{Manager:Wk,Socket:$k,io:Xk,connect:Xk});var Jk=r(1914);class Zk{constructor(e,t){this.label=e.label,this.open=Oh(),this.channel=e,this.channel.binaryType="arraybuffer",this.log=t.log,"number"==typeof this.channel.bufferedAmountLowThreshold&&(this.channel.bufferedAmountLowThreshold=65536),e.addEventListener("message",(e=>{t.onMessage(e)})),e.addEventListener("bufferedamountlow",(()=>{this.log("stop backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open.resolve()})),e.addEventListener("open",(()=>{this.open.resolve(),t.onOpen()})),e.addEventListener("close",(()=>{t.onClose()})),e.addEventListener("error",(r=>{if("Transport channel closed"===r.error?.message)return this.close();t.log.error('channel encounter an error in state "%s" message: "%s" detail: "%s',e.readyState,r.error?.message,r.error?.errorDetail);const n=r.error instanceof Error?r.error:new Error(`datachannel error: ${r.error?.message} ${r.error?.errorDetail}`);t.onError(ie(n,"ERR_DATA_CHANNEL"))}));let r=!1;this.closingInterval=setInterval((()=>{"closing"===e.readyState?(r&&t.onClose(),r=!0):r=!1}),5e3)}async send(e){await this.open.promise,this.channel.send(e),this.channel.bufferedAmount>65536&&(this.log("start backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open=Oh())}close(){clearInterval(this.closingInterval),this.channel.close()}get bufferedAmount(){return this.channel.bufferedAmount}}var eU=r(65780);const tU={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}]};class rU extends N_{constructor(e){super(),this.id=e.id??Ts(Jk(4),"hex").slice(0,7),this.log=se(`libp2p:webrtc-peer:${e.logPrefix}:${this.id}`),this.wrtc=e.wrtc??function(){if("undefined"==typeof globalThis)throw ie(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");const e={RTCPeerConnection:globalThis.RTCPeerConnection??globalThis.mozRTCPeerConnection??globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription??globalThis.mozRTCSessionDescription??globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate??globalThis.mozRTCIceCandidate??globalThis.webkitRTCIceCandidate};if(null==e.RTCPeerConnection)throw ie(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");return e}(),this.peerConnection=new this.wrtc.RTCPeerConnection(Object.assign({},tU,e.peerConnectionConfig)),this.closed=!1,this.connected=Oh(),this.source=zu(),this.sink=async e=>{if(await this.connected.promise,null==this.channel)throw ie(new Error("Connected but no channel?!"),"ERR_DATA_CHANNEL");for await(const t of e)await this.channel.send(t);await this.close()}}handleDataChannelEvent(e){const t=e.channel;null!=t?this.channel=new Zk(t,{log:this.log,onMessage:e=>{this.source.push(new Uint8Array(e.data))},onOpen:()=>{this.connected.resolve(),this.dispatchEvent(new F_("ready"))},onClose:()=>{this.close().catch((e=>{this.log("error closing connection after channel close",e)}))},onError:e=>{this.close(e).catch((e=>{this.log("error closing connection after channel error",e)}))}}):this.close(ie(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL")).catch((e=>{this.log("Error closing after event channel was found to be null",e)}))}async close(e){if(this.closed=!0,null==e&&null!=this.channel)for(;this.channel.bufferedAmount>0;)await eU(100);this.channel?.close(),this.peerConnection.close(),this.source.end(e),this.dispatchEvent(new F_("close"))}}class nU extends N_{constructor(e){super(),this.log=e.log,this.peerConnection=e.peerConnection,this.wrtc=e.wrtc,this.status="idle",this.peerConnection.addEventListener("negotiationneeded",(()=>{this.log("peer connection negotiation needed"),this.handleRenegotiate({type:"renegotiate"}).catch((e=>{this.log.error("could not renegotiate %o",e)}))}))}async handleSignal(e){return this.log('incoming signal "%s"',e.type),"offer"===e.type?await this.handleOffer(e):"answer"===e.type?await this.handleAnswer(e):"candidate"===e.type?await this.handleCandidate(e):"renegotiate"===e.type?await this.handleRenegotiate(e):"goodbye"===e.type?await this.handleGoodye(e):void this.log(`Unknown signal type ${e.type}`)}async handleOffer(e){}async handleAnswer(e){}async handleRenegotiate(e){}async handleGoodye(e){this.peerConnection.close()}async handleCandidate(e){const t=new this.wrtc.RTCIceCandidate(e.candidate);try{await this.peerConnection.addIceCandidate(t)}catch(e){if(null!=t.address&&!t.address.endsWith(".local"))throw ie(e,"ERR_ADD_ICE_CANDIDATE");this.log("ignoring unsupported ICE candidate.")}}}const sU=se("libp2p:webrtc-peer:receiver");class iU extends rU{constructor(e={}){super({...e,logPrefix:"receiver"}),this.handshake=new oU({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,answerOptions:e.answerOptions}),this.handshake.addEventListener("signal",(e=>this.dispatchEvent(new F_("signal",{detail:e.detail})))),this.peerConnection.addEventListener("datachannel",(e=>{this.handleDataChannelEvent(e)}))}handleSignal(e){this.handshake.handleSignal(e).catch((t=>{this.log("error handling signal %o %o",e,t)}))}}class oU extends nU{constructor(e){super(e),this.options=e,this.status="idle",this.iceCandidates=[]}async handleRenegotiate(){sU.trace("renegotiate"),this.dispatchEvent(new F_("signal",{detail:{type:"renegotiate"}}))}async handleOffer(e){await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(e));for(const e of this.iceCandidates)await this.handleCandidate(e);this.iceCandidates=[];const t=await this.peerConnection.createAnswer(this.options.answerOptions);await this.peerConnection.setLocalDescription(t),sU.trace("handle offer",this.peerConnection.localDescription),this.dispatchEvent(new F_("signal",{detail:this.peerConnection.localDescription??t}))}async handleCandidate(e){null!=this.peerConnection.remoteDescription&&null!=this.peerConnection.remoteDescription.type?await super.handleCandidate(e):this.iceCandidates.push(e)}}class aU extends Error{constructor(e){super(e),this.name="TimeoutError"}}class AU extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const cU=e=>void 0===globalThis.DOMException?new AU(e):new DOMException(e),lU=e=>{const t=void 0===e.reason?cU("This operation was aborted."):e.reason;return t instanceof Error?t:cU(t)};const uU=e=>{const t=e.on||e.addListener||e.addEventListener,r=e.off||e.removeListener||e.removeEventListener;if(!t||!r)throw new TypeError("Emitter is not compatible");return{addListener:t.bind(e),removeListener:r.bind(e)}};function hU(e,t,r){let n;const s=new Promise(((s,i)=>{if(!((r={rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1,...r}).count>=0)||r.count!==Number.POSITIVE_INFINITY&&!Number.isInteger(r.count))throw new TypeError("The `count` option should be at least 0 or more");const o=[t].flat(),a=[],{addListener:A,removeListener:c}=uU(e),l=(...e)=>{const t=r.multiArgs?e:e[0];r.filter&&!r.filter(t)||(a.push(t),r.count===a.length&&(n(),s(a)))},u=e=>{n(),i(e)};n=()=>{for(const e of o)c(e,l);for(const e of r.rejectionEvents)c(e,u)};for(const e of o)A(e,l);for(const e of r.rejectionEvents)A(e,u);r.resolveImmediately&&s(a)}));if(s.cancel=n,"number"==typeof r.timeout){const e=function(e,t,r,n){let s;const i=new Promise(((i,o)=>{if("number"!=typeof t||1!==Math.sign(t))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t!==Number.POSITIVE_INFINITY){if((n={customTimers:{setTimeout:setTimeout,clearTimeout:clearTimeout},...n}).signal){const{signal:e}=n;e.aborted&&o(lU(e)),e.addEventListener("abort",(()=>{o(lU(e))}))}s=n.customTimers.setTimeout.call(void 0,(()=>{if("function"==typeof r){try{i(r())}catch(e){o(e)}return}const n=r instanceof Error?r:new aU("string"==typeof r?r:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),o(n)}),t),(async()=>{try{i(await e)}catch(e){o(e)}finally{n.customTimers.clearTimeout.call(void 0,s)}})()}else i(e)}));return i.clear=()=>{clearTimeout(s),s=void 0},i}(s,r.timeout);return e.cancel=n,e}return s}const dU=se("libp2p:webrtc-peer:initator");class fU extends rU{constructor(e={}){super({...e,logPrefix:"initiator"}),this.handleDataChannelEvent({channel:this.peerConnection.createDataChannel(e.dataChannelLabel??Ts(Jk(20),"hex").slice(0,7),e.dataChannelInit)}),this.handshake=new pU({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,offerOptions:e.offerOptions}),this.handshake.addEventListener("signal",(e=>{this.dispatchEvent(new F_("signal",{detail:e.detail}))}))}handleSignal(e){this.handshake.handleSignal(e).catch((t=>{this.log("error handling signal %o %o",e,t)}))}}class pU extends nU{constructor(e){super(e),this.options=e,this.status="idle",this.peerConnection.addEventListener("icecandidate",(e=>{if(null==e.candidate)return;const t={type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}};dU.trace("create candidate",t),this.dispatchEvent(new F_("signal",{detail:t})),this.dispatchEvent(new F_("ice-candidate"))}))}async handleRenegotiate(){if("negotiating"===this.status)return void this.log("already negotiating, queueing");this.status="negotiating";const e=await this.peerConnection.createOffer(this.options.offerOptions);await this.peerConnection.setLocalDescription(e),await function(e,t,r){"function"==typeof r&&(r={filter:r});const n=hU(e,t,r={...r,count:1,resolveImmediately:!1}),s=n.then((e=>e[0]));return s.cancel=n.cancel,s}(this,"ice-candidate"),await eU(1e3),dU.trace("renegotiate",this.peerConnection.localDescription),this.dispatchEvent(new F_("signal",{detail:this.peerConnection.localDescription??e}))}async handleAnswer(e){dU.trace("handle answer",e),await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(e)),this.status="idle"}}const gU=se("libp2p:webrtc-star:socket");function yU(e,t){const{sink:r,source:n}=e,s={remoteAddr:t.remoteAddr,async sink(e){null!=t.signal&&(e=PC(e,t.signal));try{await r(e)}catch(e){"aborted"!==e.type&&gU.error(e)}},source:null!=t.signal?PC(n,t.signal):n,timeline:{open:Date.now()},async close(){if(e.closed)return;const t=Date.now(),r=setTimeout((()=>{if(null!=s.remoteAddr){const{host:e,port:r}=s.remoteAddr.toOptions();gU("timeout closing socket to %s:%s after %dms, destroying it manually",e,r,Date.now()-t)}e.closed||e.close().catch((e=>{gU.error("could not close socket",e)}))}),2e3);try{await e.close()}finally{clearTimeout(r)}}};return e.addEventListener("close",(()=>{null==s.timeline.close&&(s.timeline.close=Date.now())}),{once:!0}),s}function wU(e){const t=e.toString().split("/"),r=e.protos()[1].name,n=e.protos()[2].name,s=e.stringTuples()[1][1];if("tcp"!==r||"ws"!==n&&"wss"!==n)throw new Error(`invalid multiaddr: ${e.toString()}`);if(!yi(i=e)||!i.protos().some((e=>e.resolvable)))return`http://${t[2]}:${t[4]}`;var i;if("ws"===n)return`http://${t[2]}${null==s||"80"===s?"":`:${s}`}`;if("wss"===n)return`https://${t[2]}${null==s||"443"===s?"":`:${s}`}`;throw new Error("invalid multiaddr: "+e.toString())}const mU=se("libp2p:webrtc-star:listener"),bU={transports:["websocket"],path:"/socket.io-next/"};class EU extends N_{constructor(e,t,r,n,s){super(),this.signallingAddr=t,this.socket=Xk(e,bU),this.connections=[],this.channels=new Map,this.pendingSignals=new Map,this.upgrader=r,this.handler=n,this.channelOptions=s,this.handleWsHandshake=this.handleWsHandshake.bind(this);let i=!1;this.socket.on("connect_error",(e=>{i&&"TransportError"===e.type||this.dispatchEvent(new F_("error",{detail:e}))})),this.socket.on("error",(e=>{this.dispatchEvent(new F_("error",{detail:e}))})),this.socket.on("ws-handshake",this.handleWsHandshake),this.socket.on("ws-peer",(e=>{this.dispatchEvent(new F_("peer",{detail:e}))})),this.socket.on("connect",(()=>{this.socket.emit("ss-join",this.signallingAddr.toString()),i&&this.dispatchEvent(new F_("reconnect"))})),this.socket.once("connect",(()=>{i=!0,this.dispatchEvent(new F_("listening"))})),this.socket.on("disconnect",(()=>{this.dispatchEvent(new F_("disconnect"))}))}_createChannel(e,t,r){const n={...this.channelOptions},s=new iU(n),i=e=>{const t=e.detail;mU.error("incoming connection errored",t)};return s.addEventListener("error",i),s.addEventListener("close",(()=>{s.removeEventListener("error",i)}),{once:!0}),s.addEventListener("signal",(n=>{const s=n.detail;this.socket.emit("ss-handshake",{intentId:e,srcMultiaddr:t,dstMultiaddr:r,answer:!0,signal:s})})),s.addEventListener("ready",(()=>{const t=yU(s,{remoteAddr:this.signallingAddr});mU("new inbound connection %s",t.remoteAddr);try{this.upgrader.upgradeInbound(t).then((r=>{mU("inbound connection %s upgraded",t.remoteAddr),this.connections.push(t);s.addEventListener("close",(()=>{this.connections=this.connections.filter((e=>e!==t)),this.channels.delete(e),this.pendingSignals.delete(e)}),{once:!0}),this.dispatchEvent(new F_("connection",{detail:r})),this.handler(r)})).catch((e=>{mU.error("inbound connection failed to upgrade",e),t.close().catch((e=>{mU.error("inbound connection failed to close after failing to upgrade",e)}))}))}catch(e){mU.error("inbound connection failed to upgrade",e),t.close().catch((e=>{mU.error("inbound connection failed to close after failing to upgrade",e)}))}}),{once:!0}),s}handleWsHandshake(e){if(mU('incoming handshake. signal type "%s" is answer %s',e.signal.type,e.answer),!0===e.answer||null!=e.err||null==e.intentId)return;const t=e.intentId;let r=this.pendingSignals.get(t);null==r&&(r=[],this.pendingSignals.set(t,r)),r.push(e);let n=this.channels.get(t);if(null==n){if("offer"!==e.signal.type)return void mU("handshake is not an offer and channel does not exist, buffering until we receive an offer");mU("creating new channel to handle offer handshake"),n=this._createChannel(e.intentId,e.srcMultiaddr,e.dstMultiaddr),this.channels.set(t,n)}else mU("channel already exists, using it to handle handshake");for(;r.length>0;){const e=r.shift();null!=e?.signal&&n.handleSignal(e.signal)}}async close(){this.socket.emit("ss-leave",this.signallingAddr.toString()),this.socket.removeAllListeners(),this.socket.close(),await Promise.all([...this.connections.map((async e=>await e.close())),...Array.from(this.channels.values()).map((async e=>await e.close()))]),this.dispatchEvent(new F_("close"))}}class vU extends N_{constructor(e,t,r,n,s){super(),this.upgrader=e,this.handler=t,this.peerId=r,this.transport=n,this.options=s}async listen(e){if(null!=this.listeningAddr)throw ie(new Error("listener already in use"),"ERR_ALREADY_LISTENING");const t=Oh();let r;this.listeningAddr=e,r=e.protoCodes().includes(421)?e:e.encapsulate(`/p2p/${this.peerId.toString()}`);const n=this.signallingUrl=wU(e);mU("connecting to signalling server on: %s",this.signallingUrl);const s=new EU(this.signallingUrl,r,this.upgrader,this.handler,this.options.channelOptions);return s.addEventListener("error",(e=>{const r=e.detail;mU("error connecting to signalling server %o",r),s.close().catch((e=>{mU.error("error closing server after error",e)})),t.reject(r)})),s.addEventListener("listening",(()=>{mU("connected to signalling server"),this.dispatchEvent(new F_("listening")),t.resolve()})),s.addEventListener("peer",(e=>{this.transport.peerDiscovered(e.detail)})),s.addEventListener("connection",(t=>{const r=t.detail;if(null==r.remoteAddr)try{r.remoteAddr=e.decapsulateCode(421).encapsulate(`/p2p/${r.remotePeer.toString()}`)}catch(e){mU.error("could not determine remote address",e)}this.dispatchEvent(new F_("connection",{detail:r}))})),s.addEventListener("disconnect",(()=>{this.transport.sigServers.delete(n)})),s.addEventListener("reconnect",(()=>{this.transport.sigServers.set(n,s)})),this.transport.sigServers.set(this.signallingUrl,s),await t.promise}async close(){if(null!=this.signallingUrl){const e=this.transport.sigServers.get(this.signallingUrl);null!=e&&(await e.close(),this.transport.sigServers.delete(this.signallingUrl))}this.dispatchEvent(new F_("close")),this.listeningAddr=void 0}getAddrs(){return null!=this.listeningAddr?[this.listeningAddr]:[]}}const BU=Symbol.for("@libp2p/transport");var _U;!function(e){e[e.FATAL_ALL=0]="FATAL_ALL",e[e.NO_FATAL=1]="NO_FATAL"}(_U||(_U={}));const CU=Symbol.for("@libp2p/peer-discovery");const SU="RTCPeerConnection"in globalThis,IU=se("libp2p:webrtc-star"),TU=()=>{};class RU extends N_{constructor(){super(...arguments),this.started=!1}get[CU](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star-discovery"}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}dispatchEvent(e){return!!this.isStarted()&&super.dispatchEvent(e)}}class kU{constructor(e){null!=e?.wrtc&&(this.wrtc=e.wrtc),this.sigServers=new Map,this._discovery=new RU,this.discovery=()=>this._discovery,this.peerDiscovered=this.peerDiscovered.bind(this)}get[BU](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star"}async dial(e,t){const r=yU(await this._connect(e,t),{remoteAddr:e,signal:t.signal});IU("new outbound connection %s",r.remoteAddr);const n=await t.upgrader.upgradeOutbound(r);return IU("outbound connection %s upgraded",r.remoteAddr),n}async _connect(e,t){if(!0===t.signal?.aborted)throw new DC;const r={...t.channelOptions??{}};null!=this.wrtc&&(r.wrtc=this.wrtc);const n=e.toOptions(),s=Ts(Jk(36),"hex");return await new Promise(((i,o)=>{const a=this.sigServers.get(wU(e));if(null==a?.socket)return o(ie(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let A=!1;IU("dialing %s:%s",n.host,n.port);const c=new fU(r),l=e=>{const t=e.detail;if(!A){const e=`connection error ${n.host}:${n.port}: ${t.message}`;IU.error(e),d(t)}},u=()=>{A=!0,IU("connection opened %s:%s",n.host,n.port),d()},h=()=>{IU.error("connection aborted %s:%s",n.host,n.port),c.close().finally((()=>{d(new DC)}))},d=e=>{c.removeEventListener("ready",u),t.signal?.removeEventListener("abort",h),null==e?i(c):o(e)};c.addEventListener("ready",u,{once:!0}),c.addEventListener("close",(()=>{c.removeEventListener("error",l)})),t.signal?.addEventListener("abort",h),c.addEventListener("signal",(t=>{const r=t.detail;a.socket.emit("ss-handshake",{intentId:s,srcMultiaddr:a.signallingAddr.toString(),dstMultiaddr:e.toString(),signal:r})})),a.socket.on("ws-handshake",(e=>{e.intentId===s&&null!=e.err&&c.close().finally((()=>{o(ie(new Error(e.err),"ERR_SIGNALLING_FAILED"))})),e.intentId!==s||null==e.answer||c.closed||c.handleSignal(e.signal)}))}))}createListener(e){if(!SU&&null==this.wrtc)throw ie(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");if(e.channelOptions=e.channelOptions??{},null!=this.wrtc&&(e.channelOptions.wrtc=this.wrtc),null==this.peerId)throw ie(new Error("PeerId not set"),"ERR_MISSING_PEER_ID");return function(e,t,r,n,s){return new vU(e,t,r,n,s)}(e.upgrader,e.handler??TU,this.peerId,this,e)}filter(e){return(e=Array.isArray(e)?e:[e]).filter((e=>!e.protoCodes().includes(290)&&Ni.matches(e)))}peerDiscovered(e){IU("peer discovered: %s",e),e=function(e){const t="/libp2p-webrtc-star";if(e.startsWith(t)){let r=mi(e=e.substring(t.length,e.length));const n=r.stringTuples().filter((e=>421===e[0]))[0];if(null==n[1])throw new Error("invalid multiaddr: "+e);r=r.decapsulate("p2p"),r=r.encapsulate("/p2p-webrtc-star"),r=r.encapsulate(`/p2p/${n[1]}`),e=r.toString()}return e}(e);const t=mi(e),r=t.getPeerId();if(null==r)return;const n=Ta(r);this._discovery.dispatchEvent(new F_("peer",{detail:{id:n,multiaddrs:[t],protocols:[]}}))}}function UU(){const e=function(e={}){const t=new kU(e);return{transport:e=>(t.peerId=e.peerId,t),discovery:t.discovery}}();return{transports:[e.transport],peerDiscovery:[e.discovery],connectionManager:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4,autoDial:!0},nat:{enabled:!1}}}function DU(e){return null!=e&&"function"==typeof e.start&&"function"==typeof e.stop}var PU,LU;async function*NU(e,t){yield*xh(e,(async e=>(await t.addressBook.add(e.id,e.multiaddrs),e)))}function OU(e){const t=new Set;return xu(e,(e=>!t.has(e.id.toString())&&(t.add(e.id.toString()),!0)))}async function*FU(e,t=1){let r=0;for await(const t of e)r++,yield t;if(r<t)throw ie(new Error("not found"),"NOT_FOUND")}!function(e){e.NOT_STARTED_YET="The libp2p node is not started yet",e.DHT_DISABLED="DHT is not available",e.PUBSUB_DISABLED="PubSub is not available",e.CONN_ENCRYPTION_REQUIRED="At least one connection encryption module is required",e.ERR_TRANSPORTS_REQUIRED="At least one transport module is required",e.ERR_PROTECTOR_REQUIRED="Private network is enforced, but no protector was provided",e.NOT_FOUND="Not found"}(PU||(PU={})),function(e){e.DHT_DISABLED="ERR_DHT_DISABLED",e.ERR_PUBSUB_DISABLED="ERR_PUBSUB_DISABLED",e.PUBSUB_NOT_STARTED="ERR_PUBSUB_NOT_STARTED",e.DHT_NOT_STARTED="ERR_DHT_NOT_STARTED",e.CONN_ENCRYPTION_REQUIRED="ERR_CONN_ENCRYPTION_REQUIRED",e.ERR_TRANSPORTS_REQUIRED="ERR_TRANSPORTS_REQUIRED",e.ERR_PROTECTOR_REQUIRED="ERR_PROTECTOR_REQUIRED",e.ERR_PEER_DIAL_INTERCEPTED="ERR_PEER_DIAL_INTERCEPTED",e.ERR_CONNECTION_INTERCEPTED="ERR_CONNECTION_INTERCEPTED",e.ERR_INVALID_PROTOCOLS_FOR_STREAM="ERR_INVALID_PROTOCOLS_FOR_STREAM",e.ERR_CONNECTION_ENDED="ERR_CONNECTION_ENDED",e.ERR_CONNECTION_FAILED="ERR_CONNECTION_FAILED",e.ERR_NODE_NOT_STARTED="ERR_NODE_NOT_STARTED",e.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",e.ERR_TOO_MANY_ADDRESSES="ERR_TOO_MANY_ADDRESSES",e.ERR_NO_VALID_ADDRESSES="ERR_NO_VALID_ADDRESSES",e.ERR_RELAYED_DIAL="ERR_RELAYED_DIAL",e.ERR_DIALED_SELF="ERR_DIALED_SELF",e.ERR_DISCOVERED_SELF="ERR_DISCOVERED_SELF",e.ERR_DUPLICATE_TRANSPORT="ERR_DUPLICATE_TRANSPORT",e.ERR_ENCRYPTION_FAILED="ERR_ENCRYPTION_FAILED",e.ERR_HOP_REQUEST_FAILED="ERR_HOP_REQUEST_FAILED",e.ERR_INVALID_KEY="ERR_INVALID_KEY",e.ERR_INVALID_MESSAGE="ERR_INVALID_MESSAGE",e.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",e.ERR_INVALID_PEER="ERR_INVALID_PEER",e.ERR_MUXER_UNAVAILABLE="ERR_MUXER_UNAVAILABLE",e.ERR_NOT_FOUND="ERR_NOT_FOUND",e.ERR_TIMEOUT="ERR_TIMEOUT",e.ERR_TRANSPORT_UNAVAILABLE="ERR_TRANSPORT_UNAVAILABLE",e.ERR_TRANSPORT_DIAL_FAILED="ERR_TRANSPORT_DIAL_FAILED",e.ERR_UNSUPPORTED_PROTOCOL="ERR_UNSUPPORTED_PROTOCOL",e.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED="ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED",e.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",e.ERR_SIGNATURE_NOT_VALID="ERR_SIGNATURE_NOT_VALID",e.ERR_FIND_SELF="ERR_FIND_SELF",e.ERR_NO_ROUTERS_AVAILABLE="ERR_NO_ROUTERS_AVAILABLE",e.ERR_CONNECTION_NOT_MULTIPLEXED="ERR_CONNECTION_NOT_MULTIPLEXED",e.ERR_NO_DIAL_TOKENS="ERR_NO_DIAL_TOKENS",e.ERR_KEYCHAIN_REQUIRED="ERR_KEYCHAIN_REQUIRED",e.ERR_INVALID_CMS="ERR_INVALID_CMS",e.ERR_MISSING_KEYS="ERR_MISSING_KEYS",e.ERR_NO_KEY="ERR_NO_KEY",e.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",e.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",e.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",e.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",e.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",e.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",e.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",e.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",e.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",e.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",e.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",e.ERR_MISSING_PUBLIC_KEY="ERR_MISSING_PUBLIC_KEY",e.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",e.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",e.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH",e.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",e.ERR_WRONG_PING_ACK="ERR_WRONG_PING_ACK",e.ERR_INVALID_RECORD="ERR_INVALID_RECORD",e.ERR_ALREADY_SUCCEEDED="ERR_ALREADY_SUCCEEDED",e.ERR_NO_HANDLER_FOR_PROTOCOL="ERR_NO_HANDLER_FOR_PROTOCOL",e.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS",e.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",e.ERR_CONNECTION_DENIED="ERR_CONNECTION_DENIED"}(LU||(LU={}));var QU=r(27695),xU=r(17187);const MU=se("libp2p:peer-routing");class HU{constructor(e,t){this.components=e,this.routers=t.routers??[],this.refreshManagerInit=t.refreshManager??{},this.started=!1,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}isStarted(){return this.started}async start(){this.started||0===this.routers.length||null!=this.timeoutId||!1===this.refreshManagerInit.enabled||(this.timeoutId=(0,QU.setDelayedInterval)(this._findClosestPeersTask,this.refreshManagerInit.interval,this.refreshManagerInit.bootDelay),this.started=!0)}async _findClosestPeersTask(){if(null==this.abortController)try{this.abortController=new Bs.TimeoutController(this.refreshManagerInit.timeout??1e4);try{(0,xU.setMaxListeners)?.(1/0,this.abortController.signal)}catch{}await Qu(this.getClosestPeers(this.components.peerId.toBytes(),{signal:this.abortController.signal}))}catch(e){MU.error(e)}finally{this.abortController?.clear(),this.abortController=void 0}}async stop(){(0,QU.clearDelayedInterval)(this.timeoutId),this.abortController?.abort(),this.started=!1}async findPeer(e,t){if(0===this.routers.length)throw ie(new Error("No peer routers available"),LU.ERR_NO_ROUTERS_AVAILABLE);if(e.toString()===this.components.peerId.toString())throw ie(new Error("Should not try to find self"),LU.ERR_FIND_SELF);const r=await zh(Mh(...this.routers.map((r=>async function*(){try{yield await r.findPeer(e,t)}catch(e){MU.error(e)}}()))),(e=>xu(e,Boolean)),(e=>NU(e,this.components.peerStore)),(async e=>await rm(e)));if(null!=r)return r;throw ie(new Error(PU.NOT_FOUND),LU.ERR_NOT_FOUND)}async*getClosestPeers(e,t){if(0===this.routers.length)throw ie(new Error("No peer routers available"),LU.ERR_NO_ROUTERS_AVAILABLE);yield*zh(Mh(...this.routers.map((r=>r.getClosestPeers(e,t)))),(e=>NU(e,this.components.peerStore)),(e=>OU(e)),(e=>FU(e)))}}class KU{constructor(e,t){this.routers=t.routers??[],this.started=!1,this.components=e}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}async*findProviders(e,t={}){if(0===this.routers.length)throw ie(new Error("No content this.routers available"),LU.ERR_NO_ROUTERS_AVAILABLE);yield*zh(Mh(...this.routers.map((r=>r.findProviders(e,t)))),(e=>NU(e,this.components.peerStore)),(e=>OU(e)),(e=>FU(e)))}async provide(e,t={}){if(0===this.routers.length)throw ie(new Error("No content routers available"),LU.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map((async r=>await r.provide(e,t))))}async put(e,t,r){if(!this.isStarted())throw ie(new Error(PU.NOT_STARTED_YET),LU.DHT_NOT_STARTED);const n=this.components.dht;null!=n&&await Qu(n.put(e,t,r))}async get(e,t){if(!this.isStarted())throw ie(new Error(PU.NOT_STARTED_YET),LU.DHT_NOT_STARTED);const r=this.components.dht;if(null!=r)for await(const n of r.get(e,t))if("VALUE"===n.name)return n.value;throw ie(new Error(PU.NOT_FOUND),LU.ERR_NOT_FOUND)}async*getMany(e,t,r){if(!this.isStarted())throw ie(new Error(PU.NOT_STARTED_YET),LU.DHT_NOT_STARTED);if(null==t||0===t)return;let n=0;const s=this.components.dht;if(null!=s)for await(const i of s.get(e,r))if("VALUE"===i.name&&(yield{from:i.from,val:i.value},n++,n===t))break;if(0===n)throw ie(new Error(PU.NOT_FOUND),LU.ERR_NOT_FOUND)}}const VU=e=>e;class zU extends N_{constructor(e,t){super();const{listen:r=[],announce:n=[]}=t;this.components=e,this.listen=r.map((e=>e.toString())),this.announce=new Set(n.map((e=>e.toString()))),this.observed=new Set,this.announceFilter=t.announceFilter??VU}getListenAddrs(){return Array.from(this.listen).map((e=>mi(e)))}getAnnounceAddrs(){return Array.from(this.announce).map((e=>mi(e)))}getObservedAddrs(){return Array.from(this.observed).map((e=>mi(e)))}confirmObservedAddr(e){}removeObservedAddr(e){}addObservedAddr(e){let t=mi(e);const r=t.getPeerId();if(null!=r){Ta(r).equals(this.components.peerId)&&(t=t.decapsulate(mi(`/p2p/${this.components.peerId.toString()}`)))}const n=t.toString();this.observed.has(n)||(this.observed.add(n),this.dispatchEvent(new F_("change:addresses")))}getAddresses(){let e=this.getAnnounceAddrs().map((e=>e.toString()));0===e.length&&(e=this.components.transportManager.getAddrs().map((e=>e.toString()))),e=e.concat(this.getObservedAddrs().map((e=>e.toString())));const t=new Set(e);return this.announceFilter(Array.from(t).map((e=>mi(e)))).map((e=>!0===e.protos().pop()?.path||e.getPeerId()===this.components.peerId.toString()?e:e.encapsulate(`/p2p/${this.components.peerId.toString()}`)))}}const jU=se("libp2p:connection-manager:latency-monitor:visibility-change-emitter");class GU extends N_{constructor(){super(),this.hidden="hidden",this.visibilityChange="visibilityChange",null!=globalThis.document&&(this._initializeVisibilityVarNames(),this._addVisibilityChangeListener())}_initializeVisibilityVarNames(){let e="hidden",t="visibilitychange";void 0!==globalThis.document.hidden?(e="hidden",t="visibilitychange"):void 0!==globalThis.document.mozHidden?(e="mozHidden",t="mozvisibilitychange"):void 0!==globalThis.document.msHidden?(e="msHidden",t="msvisibilitychange"):void 0!==globalThis.document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange"),this.hidden=e,this.visibilityChange=t}_addVisibilityChangeListener(){void 0===globalThis.document.addEventListener||void 0===document[this.hidden]?jU("Checking page visibility requires a browser that supports the Page Visibility API."):globalThis.document.addEventListener(this.visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(void 0!==this.hidden&&void 0!==document[this.hidden])return null==document[this.hidden]}_handleVisibilityChange(){const e=!1===globalThis.document[this.hidden];jU(e?"Page Visible":"Page Hidden"),this.dispatchEvent(new F_("visibilityChange",{detail:e}))}}const $U=se("libp2p:connection-manager:latency-monitor");class qU extends N_{constructor(e={}){super();const{latencyCheckIntervalMs:t,dataEmitIntervalMs:r,asyncTestFn:n,latencyRandomPercentage:s}=e;this.latencyCheckIntervalMs=t??500,this.latencyRandomPercentage=s??10,this.latencyCheckMultiply=this.latencyRandomPercentage/100*2*this.latencyCheckIntervalMs,this.latencyCheckSubtract=this.latencyCheckMultiply/2,this.dataEmitIntervalMs=null===r||0===r?void 0:r??5e3,$U("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",this.latencyCheckIntervalMs,this.dataEmitIntervalMs),null!=this.dataEmitIntervalMs?$U("Expecting ~%s events per summary",this.latencyCheckIntervalMs/this.dataEmitIntervalMs):$U("Not emitting summaries"),this.asyncTestFn=n,null!=globalThis.process?.hrtime?($U("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=e=>{const t=this.now(e);return 1e3*t[0]+t[1]/1e6}):"undefined"!=typeof window&&null!=window.performance?.now?($U("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=e=>Math.round(this.now()-e)):($U("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=e=>this.now()-e),this.latencyData=this.initLatencyData()}start(){void 0!==globalThis.window&&(this.visibilityChangeEmitter=new GU,this.visibilityChangeEmitter.addEventListener("visibilityChange",(e=>{const{detail:t}=e;t?this._startTimers():(this._emitSummary(),this._stopTimers())}))),!0===this.visibilityChangeEmitter?.isVisible()&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){null==this.checkLatencyID&&(this.checkLatency(),null!=this.dataEmitIntervalMs&&(this.emitIntervalID=setInterval((()=>this._emitSummary()),this.dataEmitIntervalMs),"function"==typeof this.emitIntervalID.unref&&this.emitIntervalID.unref()))}_stopTimers(){null!=this.checkLatencyID&&(clearTimeout(this.checkLatencyID),this.checkLatencyID=void 0),null!=this.emitIntervalID&&(clearInterval(this.emitIntervalID),this.emitIntervalID=void 0)}_emitSummary(){const e=this.getSummary();e.events>0&&this.dispatchEvent(new F_("data",{detail:e}))}getSummary(){const e={events:this.latencyData.events,minMs:this.latencyData.minMs,maxMs:this.latencyData.maxMs,avgMs:this.latencyData.events>0?this.latencyData.totalMs/this.latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this.latencyData.startTime)};return this.latencyData=this.initLatencyData(),$U.trace("Summary: %O",e),e}checkLatency(){const e=Math.random()*this.latencyCheckMultiply-this.latencyCheckSubtract,t={deltaOffset:Math.ceil(this.latencyCheckIntervalMs+e),startTime:this.now()},r=()=>{if(null==this.checkLatencyID)return;const e=this.getDeltaMS(t.startTime)-t.deltaOffset;this.checkLatency(),this.latencyData.events++,this.latencyData.minMs=Math.min(this.latencyData.minMs,e),this.latencyData.maxMs=Math.max(this.latencyData.maxMs,e),this.latencyData.totalMs+=e,$U.trace("MS: %s Data: %O",e,this.latencyData)};$U.trace("localData: %O",t),this.checkLatencyID=setTimeout((()=>{null!=this.asyncTestFn?(t.deltaOffset=0,t.startTime=this.now(),this.asyncTestFn(r)):(t.deltaOffset-=1,r())}),t.deltaOffset),"function"==typeof this.checkLatencyID.unref&&this.checkLatencyID.unref()}initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}}const WU="OPEN",YU="CLOSING",XU="CLOSED";function JU(e,t){const r={[Symbol.iterator]:()=>r,next:()=>{const r=e.next(),n=r.value;if(!0===r.done||null==n){return{done:!0,value:void 0}}return{done:!1,value:t(n)}}};return r}class ZU{constructor(e){if(this.map=new Map,null!=e)for(const[t,r]of e.entries())this.map.set(t.toString(),r)}[Symbol.iterator](){return this.entries()}clear(){this.map.clear()}delete(e){this.map.delete(e.toString())}entries(){return JU(this.map.entries(),(e=>[Ta(e[0]),e[1]]))}forEach(e){this.map.forEach(((t,r)=>{e(t,Ta(r),this)}))}get(e){return this.map.get(e.toString())}has(e){return this.map.has(e.toString())}set(e,t){this.map.set(e.toString(),t)}keys(){return JU(this.map.keys(),(e=>Ta(e)))}values(){return this.map.values()}get size(){return this.map.size}}class eD{constructor(e){if(this.set=new Set,null!=e)for(const t of e)this.set.add(t.toString())}get size(){return this.set.size}[Symbol.iterator](){return this.values()}add(e){this.set.add(e.toString())}clear(){this.set.clear()}delete(e){this.set.delete(e.toString())}entries(){return JU(this.set.entries(),(e=>{const t=Ta(e[0]);return[t,t]}))}forEach(e){this.set.forEach((t=>{const r=Ta(t);e(r,r,this)}))}has(e){return this.set.has(e.toString())}values(){return JU(this.set.values(),(e=>Ta(e)))}intersection(e){const t=new eD;for(const r of e)this.has(r)&&t.add(r);return t}difference(e){const t=new eD;for(const r of this)e.has(r)||t.add(r);return t}union(e){const t=new eD;for(const r of e)t.add(r);for(const e of this)t.add(e);return t}}class tD{constructor(e){if(this.list=[],null!=e)for(const t of e)this.list.push(t.toString())}[Symbol.iterator](){return mapIterable(this.list.entries(),(e=>peerIdFromString(e[1])))}concat(e){const t=new tD(this);for(const r of e)t.push(r);return t}entries(){return mapIterable(this.list.entries(),(e=>[e[0],peerIdFromString(e[1])]))}every(e){return this.list.every(((t,r)=>e(peerIdFromString(t),r,this)))}filter(e){const t=new tD;return this.list.forEach(((r,n)=>{const s=peerIdFromString(r);e(s,n,this)&&t.push(s)})),t}find(e){const t=this.list.find(((t,r)=>e(peerIdFromString(t),r,this)));if(null!=t)return peerIdFromString(t)}findIndex(e){return this.list.findIndex(((t,r)=>e(peerIdFromString(t),r,this)))}forEach(e){this.list.forEach(((t,r)=>{e(peerIdFromString(t),r,this)}))}includes(e){return this.list.includes(e.toString())}indexOf(e){return this.list.indexOf(e.toString())}pop(){const e=this.list.pop();if(null!=e)return peerIdFromString(e)}push(...e){for(const t of e)this.list.push(t.toString())}shift(){const e=this.list.shift();if(null!=e)return peerIdFromString(e)}unshift(...e){let t=this.list.length;for(let t=e.length-1;t>-1;t--)this.list.unshift(e[t].toString());return t}get length(){return this.list.length}}var rD=r(8558);function nD(e){if(ba(e))return{peerId:e};if(yi(e)){const t=e.getPeerId();return{multiaddr:e,peerId:null==t?void 0:Ta(t)}}throw ie(new Error(`${e} is not a PeerId or a Multiaddr`),LU.ERR_INVALID_MULTIADDR)}const sD=se("libp2p:connection-manager"),iD={maxConnections:1/0,minConnections:0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,inboundConnectionThreshold:5,maxIncomingPendingConnections:10};class oD extends N_{constructor(e,t){if(super(),this.opts=I.call({ignoreUndefined:!0},iD,t),this.opts.maxConnections<this.opts.minConnections)throw ie(new Error("Connection Manager maxConnections must be greater than minConnections"),LU.ERR_INVALID_PARAMETERS);sD("options: %o",this.opts),this.components=e,this.connections=new Map,this.started=!1,null!=t.maxEventLoopDelay&&t.maxEventLoopDelay>0&&t.maxEventLoopDelay!==1/0&&(this.latencyMonitor=new qU({latencyCheckIntervalMs:t.pollInterval,dataEmitIntervalMs:t.pollInterval}));try{(0,xU.setMaxListeners)?.(1/0,this)}catch{}this.onConnect=this.onConnect.bind(this),this.onDisconnect=this.onDisconnect.bind(this),this.startupReconnectTimeout=t.startupReconnectTimeout??6e4,this.dialTimeout=t.dialTimeout??3e4,this.allow=(t.allow??[]).map((e=>mi(e))),this.deny=(t.deny??[]).map((e=>mi(e))),this.inboundConnectionRateLimiter=new rD.RateLimiterMemory({points:this.opts.inboundConnectionThreshold,duration:1}),this.incomingPendingConnections=0}isStarted(){return this.started}async start(){this.components.metrics?.registerMetricGroup("libp2p_connection_manager_connections",{calculate:()=>{const e={inbound:0,outbound:0};for(const t of this.connections.values())for(const r of t)"inbound"===r.stat.direction?e.inbound++:e.outbound++;return e}}),this.components.metrics?.registerMetricGroup("libp2p_protocol_streams_total",{label:"protocol",calculate:()=>{const e={};for(const t of this.connections.values())for(const r of t)for(const t of r.streams){const r=`${t.stat.direction} ${t.stat.protocol??"unnegotiated"}`;e[r]=(e[r]??0)+1}return e}}),this.components.metrics?.registerMetricGroup("libp2p_connection_manager_protocol_streams_per_connection_90th_percentile",{label:"protocol",calculate:()=>{const e={};for(const t of this.connections.values())for(const r of t){const t={};for(const e of r.streams){const r=`${e.stat.direction} ${e.stat.protocol??"unnegotiated"}`;t[r]=(t[r]??0)+1}for(const[r,n]of Object.entries(t))e[r]=e[r]??[],e[r].push(n)}const t={};for(let[r,n]of Object.entries(e)){n=n.sort(((e,t)=>e-t));const e=Math.floor(.9*n.length);t[r]=n[e]}return t}}),this.latencyMonitor?.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this.latencyMonitor?.addEventListener("data",this._onLatencyMeasure),this.started=!0,sD("started")}async afterStart(){this.components.upgrader.addEventListener("connection",this.onConnect),this.components.upgrader.addEventListener("connectionEnd",this.onDisconnect),Promise.resolve().then((async()=>{const e=[];for(const t of await this.components.peerStore.all()){(await this.components.peerStore.getTags(t.id)).filter((e=>"keep-alive"===e.name)).length>0&&e.push(t.id)}this.connectOnStartupController?.clear(),this.connectOnStartupController=new Bs.TimeoutController(this.startupReconnectTimeout);try{(0,xU.setMaxListeners)?.(1/0,this.connectOnStartupController.signal)}catch{}await Promise.all(e.map((async e=>{await this.openConnection(e,{signal:this.connectOnStartupController?.signal}).catch((e=>{sD.error(e)}))})))})).catch((e=>{sD.error(e)})).finally((()=>{this.connectOnStartupController?.clear()}))}async beforeStop(){this.connectOnStartupController?.abort(),this.components.upgrader.removeEventListener("connection",this.onConnect),this.components.upgrader.removeEventListener("connectionEnd",this.onDisconnect)}async stop(){this.latencyMonitor?.removeEventListener("data",this._onLatencyMeasure),this.latencyMonitor?.stop(),this.started=!1,await this._close(),sD("stopped")}async _close(){const e=[];for(const t of this.connections.values())for(const r of t)e.push((async()=>{try{await r.close()}catch(e){sD.error(e)}})());sD("closing %d connections",e.length),await Promise.all(e),this.connections.clear()}onConnect(e){this._onConnect(e).catch((e=>{sD.error(e)}))}async _onConnect(e){const{detail:t}=e;if(!this.started)return void await t.close();const r=t.remotePeer,n=r.toString(),s=this.connections.get(n);null!=s?s.push(t):this.connections.set(n,[t]),null!=r.publicKey&&await this.components.peerStore.keyBook.set(r,r.publicKey);const i=this.getConnections().length,o=i-this.opts.maxConnections;await this._checkMaxLimit("maxConnections",i,o),this.dispatchEvent(new F_("peer:connect",{detail:t}))}onDisconnect(e){const{detail:t}=e;if(!this.started)return;const r=t.remotePeer.toString();let n=this.connections.get(r);null!=n&&n.length>1?(n=n.filter((e=>e.id!==t.id)),this.connections.set(r,n)):null!=n&&(this.connections.delete(r),this.dispatchEvent(new F_("peer:disconnect",{detail:t})))}getConnections(e){if(null!=e)return this.connections.get(e.toString())??[];let t=[];for(const e of this.connections.values())t=t.concat(e);return t}async openConnection(e,t={}){const{peerId:r,multiaddr:n}=nD(e);if(null==r&&null==n)throw ie(new TypeError("Can only open connections to PeerIds or Multiaddrs"),LU.ERR_INVALID_PARAMETERS);if(null!=r){sD("dial to",r);const e=this.getConnections(r);if(e.length>0)return sD("had an existing connection to %p",r),e[0]}let s;if(null==t?.signal){s=new Bs.TimeoutController(this.dialTimeout),t.signal=s.signal;try{(0,xU.setMaxListeners)?.(1/0,s.signal)}catch{}}try{const r=await this.components.dialer.dial(e,t);let n=this.connections.get(r.remotePeer.toString());null==n&&(n=[],this.connections.set(r.remotePeer.toString(),n));let i=!1;for(const e of n)e.id===r.id&&(i=!0);return i||n.push(r),r}finally{null!=s&&s.clear()}}async closeConnections(e){const t=this.connections.get(e.toString())??[];await Promise.all(t.map((async e=>await e.close())))}getAll(e){if(!ba(e))throw ie(new Error("peerId must be an instance of peer-id"),LU.ERR_INVALID_PARAMETERS);const t=e.toString(),r=this.connections.get(t);return null!=r?r.filter((e=>e.stat.status===WU)):[]}_onLatencyMeasure(e){const{detail:t}=e;this._checkMaxLimit("maxEventLoopDelay",t.avgMs,1).catch((e=>{sD.error(e)}))}async _checkMaxLimit(e,t,r=1){const n=this.opts[e];null!=n?(sD.trace("checking limit of %s. current value: %d of %d",e,t,n),t>n&&(sD("%s: limit exceeded: %p, %d/%d, pruning %d connection(s)",this.components.peerId,e,t,n,r),await this._pruneConnections(r))):sD.trace("limit %s was not set so it cannot be applied",e)}async _pruneConnections(e){const t=this.getConnections(),r=new ZU;for(const e of t){const t=e.remotePeer;if(r.has(t))continue;const n=await this.components.peerStore.getTags(t);r.set(t,n.reduce(((e,t)=>e+t.value),0))}const n=t.sort(((e,t)=>{const n=r.get(e.remotePeer)??0,s=r.get(t.remotePeer)??0;if(n>s)return 1;if(n<s)return-1;const i=e.stat.timeline.open,o=t.stat.timeline.open;return i<o?1:i>o?-1:0})),s=[];for(const t of n)if(sD("too many connections open - closing a connection to %p",t.remotePeer),s.push(t),s.length===e)break;await Promise.all(s.map((async e=>{try{await e.close()}catch(e){sD.error(e)}this.onDisconnect(new F_("connectionEnd",{detail:e}))})))}async acceptIncomingConnection(e){if(this.deny.some((t=>e.remoteAddr.toString().startsWith(t.toString()))))return sD("connection from %s refused - connection remote address was in deny list",e.remoteAddr),!1;if(this.allow.some((t=>e.remoteAddr.toString().startsWith(t.toString()))))return this.incomingPendingConnections++,!0;if(this.incomingPendingConnections===this.opts.maxIncomingPendingConnections)return sD("connection from %s refused - incomingPendingConnections exceeded by peer %s",e.remoteAddr),!1;if(e.remoteAddr.isThinWaistAddress()){const t=e.remoteAddr.nodeAddress().address;try{await this.inboundConnectionRateLimiter.consume(t,1)}catch{return sD("connection from %s refused - inboundConnectionThreshold exceeded by host %s",t,e.remoteAddr),!1}}return this.getConnections().length<this.opts.maxConnections?(this.incomingPendingConnections++,!0):(sD("connection from %s refused - maxConnections exceeded",e.remoteAddr),!1)}afterUpgradeInbound(){this.incomingPendingConnections--}}var aD=r(82916);const AD=se("libp2p:connection-manager:auto-dialler"),cD={enabled:!0,minConnections:0,autoDialInterval:1e4};class lD{constructor(e,t){this.components=e,this.options=I.call({ignoreUndefined:!0},cD,t),this.running=!1,this._autoDial=this._autoDial.bind(this),AD("options: %j",this.options)}isStarted(){return this.running}async start(){this.options.enabled?(this.running=!0,this._autoDial().catch((e=>{AD.error("could start autodial",e)})),AD("started")):AD("not enabled")}async stop(){this.options.enabled?(this.running=!1,null!=this.autoDialTimeout&&this.autoDialTimeout.clear(),AD("stopped")):AD("not enabled")}async _autoDial(){null!=this.autoDialTimeout&&this.autoDialTimeout.clear();const e=this.options.minConnections;if(this.components.connectionManager.getConnections().length>=e)return void(this.autoDialTimeout=aD(this._autoDial,this.options.autoDialInterval));const t=await this.components.peerStore.all(),r=await zh(t.sort((()=>Math.random()>.5?1:-1)),(e=>xu(e,(e=>!e.id.equals(this.components.peerId)))),(e=>ZB(e,((e,t)=>t.protocols.length>e.protocols.length||null!=t.id.publicKey&&null==e.id.publicKey?1:-1))),(async e=>await Ou(e)));for(let t=0;this.running&&t<r.length&&this.components.connectionManager.getConnections().length<e;t++){if(!this.running)return;const e=r[t];if(0===this.components.connectionManager.getConnections(e.id).length){AD("connecting to a peerStore stored peer %p",e.id);try{await this.components.connectionManager.openConnection(e.id)}catch(e){AD.error("could not connect to peerStore stored peer",e)}}}this.running&&(this.autoDialTimeout=aD(this._autoDial,this.options.autoDialInterval))}}var uD;!function(e){let t,r,n,s,i,o;!function(e){e.SUCCESS="SUCCESS",e.HOP_SRC_ADDR_TOO_LONG="HOP_SRC_ADDR_TOO_LONG",e.HOP_DST_ADDR_TOO_LONG="HOP_DST_ADDR_TOO_LONG",e.HOP_SRC_MULTIADDR_INVALID="HOP_SRC_MULTIADDR_INVALID",e.HOP_DST_MULTIADDR_INVALID="HOP_DST_MULTIADDR_INVALID",e.HOP_NO_CONN_TO_DST="HOP_NO_CONN_TO_DST",e.HOP_CANT_DIAL_DST="HOP_CANT_DIAL_DST",e.HOP_CANT_OPEN_DST_STREAM="HOP_CANT_OPEN_DST_STREAM",e.HOP_CANT_SPEAK_RELAY="HOP_CANT_SPEAK_RELAY",e.HOP_CANT_RELAY_TO_SELF="HOP_CANT_RELAY_TO_SELF",e.STOP_SRC_ADDR_TOO_LONG="STOP_SRC_ADDR_TOO_LONG",e.STOP_DST_ADDR_TOO_LONG="STOP_DST_ADDR_TOO_LONG",e.STOP_SRC_MULTIADDR_INVALID="STOP_SRC_MULTIADDR_INVALID",e.STOP_DST_MULTIADDR_INVALID="STOP_DST_MULTIADDR_INVALID",e.STOP_RELAY_REFUSED="STOP_RELAY_REFUSED",e.MALFORMED_MESSAGE="MALFORMED_MESSAGE"}(t=e.Status||(e.Status={})),function(e){e[e.SUCCESS=100]="SUCCESS",e[e.HOP_SRC_ADDR_TOO_LONG=220]="HOP_SRC_ADDR_TOO_LONG",e[e.HOP_DST_ADDR_TOO_LONG=221]="HOP_DST_ADDR_TOO_LONG",e[e.HOP_SRC_MULTIADDR_INVALID=250]="HOP_SRC_MULTIADDR_INVALID",e[e.HOP_DST_MULTIADDR_INVALID=251]="HOP_DST_MULTIADDR_INVALID",e[e.HOP_NO_CONN_TO_DST=260]="HOP_NO_CONN_TO_DST",e[e.HOP_CANT_DIAL_DST=261]="HOP_CANT_DIAL_DST",e[e.HOP_CANT_OPEN_DST_STREAM=262]="HOP_CANT_OPEN_DST_STREAM",e[e.HOP_CANT_SPEAK_RELAY=270]="HOP_CANT_SPEAK_RELAY",e[e.HOP_CANT_RELAY_TO_SELF=280]="HOP_CANT_RELAY_TO_SELF",e[e.STOP_SRC_ADDR_TOO_LONG=320]="STOP_SRC_ADDR_TOO_LONG",e[e.STOP_DST_ADDR_TOO_LONG=321]="STOP_DST_ADDR_TOO_LONG",e[e.STOP_SRC_MULTIADDR_INVALID=350]="STOP_SRC_MULTIADDR_INVALID",e[e.STOP_DST_MULTIADDR_INVALID=351]="STOP_DST_MULTIADDR_INVALID",e[e.STOP_RELAY_REFUSED=390]="STOP_RELAY_REFUSED",e[e.MALFORMED_MESSAGE=400]="MALFORMED_MESSAGE"}(r||(r={})),function(e){e.codec=()=>oA(r)}(t=e.Status||(e.Status={})),function(e){e.HOP="HOP",e.STOP="STOP",e.STATUS="STATUS",e.CAN_HOP="CAN_HOP"}(n=e.Type||(e.Type={})),function(e){e[e.HOP=1]="HOP",e[e.STOP=2]="STOP",e[e.STATUS=3]="STATUS",e[e.CAN_HOP=4]="CAN_HOP"}(s||(s={})),function(e){e.codec=()=>oA(s)}(n=e.Type||(e.Type={})),function(e){let t;e.codec=()=>(null==t&&(t=aA(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),(!0===r.writeDefaults||null!=e.id&&e.id.byteLength>0)&&(t.uint32(10),t.bytes(e.id)),null!=e.addrs)for(const r of e.addrs)t.uint32(18),t.bytes(r);!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={id:new Uint8Array(0),addrs:[]},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.id=e.bytes();break;case 2:r.addrs.push(e.bytes());break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>Za(t,e.codec()),e.decode=t=>Ja(t,e.codec())}(i=e.Peer||(e.Peer={})),e.codec=()=>(null==o&&(o=aA(((t,r,n={})=>{!1!==n.lengthDelimited&&r.fork(),null!=t.type&&(r.uint32(8),e.Type.codec().encode(t.type,r)),null!=t.srcPeer&&(r.uint32(18),e.Peer.codec().encode(t.srcPeer,r,{writeDefaults:!1})),null!=t.dstPeer&&(r.uint32(26),e.Peer.codec().encode(t.dstPeer,r,{writeDefaults:!1})),null!=t.code&&(r.uint32(32),e.Status.codec().encode(t.code,r)),!1!==n.lengthDelimited&&r.ldelim()}),((t,r)=>{const n={},s=null==r?t.len:t.pos+r;for(;t.pos<s;){const r=t.uint32();switch(r>>>3){case 1:n.type=e.Type.codec().decode(t);break;case 2:n.srcPeer=e.Peer.codec().decode(t,t.uint32());break;case 3:n.dstPeer=e.Peer.codec().decode(t,t.uint32());break;case 4:n.code=e.Status.codec().decode(t);break;default:t.skipType(7&r)}}return n}))),o),e.encode=t=>Za(t,e.codec()),e.decode=t=>Ja(t,e.codec())}(uD||(uD={}));const hD=se("libp2p:stream:converter");function dD(e,t={}){const{stream:r,remoteAddr:n}=e,{sink:s,source:i}=r,o=async function*(){for await(const e of i)yield*e}(),a={async sink(e){null!=t.signal&&(e=PC(e,t.signal));try{await s(e),await A()}catch(e){"aborted"!==e.type&&hD(e)}},source:null!=t.signal?PC(o,t.signal):o,remoteAddr:n,timeline:{open:Date.now(),close:void 0},async close(){await s(async function*(){yield new Uint8Array(0)}()),await A()}};async function A(){return null==a.timeline.close&&(a.timeline.close=Date.now()),await Promise.resolve()}return a}const fD="/libp2p/circuit/relay/0.1.0";function pD(e,t){e.write({type:uD.Type.STATUS,code:t})}function gD(e,t){try{null!=e.dstPeer?.addrs&&e.dstPeer.addrs.forEach((e=>mi(e)))}catch(r){throw pD(t,e.type===uD.Type.HOP?uD.Status.HOP_DST_MULTIADDR_INVALID:uD.Status.STOP_DST_MULTIADDR_INVALID),r}try{null!=e.srcPeer?.addrs&&e.srcPeer.addrs.forEach((e=>mi(e)))}catch(r){throw pD(t,e.type===uD.Type.HOP?uD.Status.HOP_SRC_MULTIADDR_INVALID:uD.Status.STOP_SRC_MULTIADDR_INVALID),r}}function yD(e){const t=zu(),r=function(e){const t=async function*(){let t=yield,r=new Bd;for await(const n of e)if(null!=t)for(r.append(n);r.length>=t;){const e=r.sublist(0,t);if(r.consume(t),t=yield e,null==t){r.length>0&&(t=yield r,r=new Bd);break}}else r.append(n),t=yield r,r=new Bd;if(null!=t)throw Object.assign(new Error(`stream ended before ${t} bytes became available`),{code:"ERR_UNDER_READ",buffer:r})}();return t.next(),t}(e.source),n=Oh();let s;const i=e.sink(async function*(){yield*t;const e=await n.promise;yield*e}());i.catch((e=>{s=e}));return{reader:r,writer:t,stream:{sink:async e=>null!=s?await Promise.reject(s):(n.resolve(e),await i),source:r},rest:()=>t.end(),write:t.push,read:async()=>{const e=await r.next();if(null!=e.value)return e.value}}}const wD=se("libp2p:circuit:stream-handler");class mD{constructor(e){const{stream:t,maxLength:r=4096}=e;this.stream=t,this.shake=yD(this.stream),this.decoder=MC.fromReader(this.shake.reader,{maxDataLength:r})}async read(){const e=await this.decoder.next();if(null!=e.value){const t=uD.decode(e.value);return wD("read message type",t.type),t}wD("read received no value, closing stream"),this.close()}write(e){wD("write message type %s",e.type),this.shake.write(FC.single(uD.encode(e)))}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){wD("closing the stream"),this.rest().sink([]).catch((e=>{wD.error(e)}))}}const bD=se("libp2p:circuit:stop");const ED=se("libp2p:circuit:hop");async function vD(e){const{connection:t,request:r,streamHandler:n,circuit:s,connectionManager:i}=e;if(!s.hopEnabled())return ED("HOP request received but we are not acting as a relay"),n.end({type:uD.Type.STATUS,code:uD.Status.HOP_CANT_SPEAK_RELAY});try{gD(r,n)}catch(e){return void ED.error("invalid hop request via peer %p %o",t.remotePeer,e)}if(null==r.dstPeer)return void ED("HOP request received but we do not receive a dstPeer");const o=Ra(r.dstPeer.id),a=i.getConnections(o);if(0===a.length&&!s.hopActive())return ED("HOP request received but we are not connected to the destination peer"),n.end({type:uD.Type.STATUS,code:uD.Status.HOP_NO_CONN_TO_DST});if(0===a.length)return ED("did not have connection to remote peer"),n.end({type:uD.Type.STATUS,code:uD.Status.HOP_NO_CONN_TO_DST});const A={type:uD.Type.STOP,dstPeer:r.dstPeer,srcPeer:r.srcPeer};let c;try{ED("performing STOP request");const e=await async function(e){const{connection:t,request:r,signal:n}=e,s=await t.newStream(fD,{signal:n});bD("starting stop request to %p",t.remotePeer);const i=new mD({stream:s});i.write(r);const o=await i.read();if(null!=o){if(o.code===uD.Status.SUCCESS)return bD("stop request to %p was successful",t.remotePeer),i.rest();bD("stop request failed with code %d",o.code),i.close()}else i.close()}({connection:a[0],request:A});if(null==e)throw new Error("Could not stop");c=e}catch(e){return void ED.error(e)}ED("hop request from %p is valid",t.remotePeer),n.write({type:uD.Type.STATUS,code:uD.Status.SUCCESS});const l=n.rest();return ED("creating related connections"),await zh(l,c,l)}const BD=se("libp2p:circuit");class _D{constructor(e,t){this._init=t,this.components=e,this._started=!1}isStarted(){return this._started}async start(){this._started||(this._started=!0,await this.components.registrar.handle(fD,(e=>{this._onProtocol(e).catch((e=>{BD.error(e)}))}),{...this._init}).catch((e=>{BD.error(e)})))}async stop(){await this.components.registrar.unhandle(fD)}hopEnabled(){return!0}hopActive(){return!0}get[BU](){return!0}get[Symbol.toStringTag](){return"libp2p/circuit-relay-v1"}async _onProtocol(e){const{connection:t,stream:r}=e,n=new Bs.TimeoutController(this._init.hop.timeout);try{(0,xU.setMaxListeners)?.(1/0,n.signal)}catch{}try{const e=NC(r,n.signal),s=new mD({stream:{...r,...e}}),i=await s.read();if(null==i)return BD("request was invalid, could not read from stream"),s.write({type:uD.Type.STATUS,code:uD.Status.MALFORMED_MESSAGE}),void s.close();let o;switch(i.type){case uD.Type.CAN_HOP:BD("received CAN_HOP request from %p",t.remotePeer),await function(e){const{connection:t,streamHandler:r,circuit:n}=e,s=n.hopEnabled();ED("can hop (%s) request from %p",s,t.remotePeer),r.end({type:uD.Type.STATUS,code:s?uD.Status.SUCCESS:uD.Status.HOP_CANT_SPEAK_RELAY})}({circuit:this,connection:t,streamHandler:s});break;case uD.Type.HOP:BD("received HOP request from %p",t.remotePeer),await vD({connection:t,request:i,streamHandler:s,circuit:this,connectionManager:this.components.connectionManager});break;case uD.Type.STOP:BD("received STOP request from %p",t.remotePeer),o=await function(e){const{connection:t,request:r,streamHandler:n}=e;try{gD(r,n)}catch(e){return void bD.error("invalid stop request via peer %p %o",t.remotePeer,e)}return bD("stop request is valid"),n.write({type:uD.Type.STATUS,code:uD.Status.SUCCESS}),n.rest()}({connection:t,request:i,streamHandler:s});break;default:return BD("Request of type %s not supported",i.type),s.write({type:uD.Type.STATUS,code:uD.Status.MALFORMED_MESSAGE}),void s.close()}if(null!=o){const e=t.remoteAddr.encapsulate("/p2p-circuit").encapsulate(mi(i.dstPeer?.addrs[0])),r=dD({stream:o,remoteAddr:e,localAddr:mi(i.srcPeer?.addrs[0])}),n=i.type===uD.Type.HOP?"relay":"inbound";BD("new %s connection %s",n,r.remoteAddr);const s=await this.components.upgrader.upgradeInbound(r);BD("%s connection %s upgraded",n,r.remoteAddr),null!=this.handler&&this.handler(s)}}finally{n.clear()}}async dial(e,t={}){const r=e.toString().split("/p2p-circuit"),n=mi(r[0]),s=mi(r[r.length-1]),i=n.getPeerId(),o=s.getPeerId();if(null==i||null==o){const e="Circuit relay dial failed as addresses did not have peer id";throw BD.error(e),ie(new Error(e),LU.ERR_RELAYED_DIAL)}const a=Ta(i),A=Ta(o);let c=!1;let l=this.components.connectionManager.getConnections(a)[0];null==l&&(await this.components.peerStore.addressBook.add(a,[n]),l=await this.components.connectionManager.openConnection(a,t),c=!0);try{const r=await async function(e){const{connection:t,request:r,signal:n}=e,s=await t.newStream(fD,{signal:n}),i=new mD({stream:s});i.write(r);const o=await i.read();if(null==o)throw ie(new Error("HOP request had no response"),LU.ERR_HOP_REQUEST_FAILED);if(o.code===uD.Status.SUCCESS)return ED("hop request was successful"),i.rest();throw ED("hop request failed with code %d, closing stream",o.code),i.close(),ie(new Error(`HOP request failed with code "${o.code??"unknown"}"`),LU.ERR_HOP_REQUEST_FAILED)}({...t,connection:l,request:{type:uD.Type.HOP,srcPeer:{id:this.components.peerId.toBytes(),addrs:this.components.addressManager.getAddresses().map((e=>e.bytes))},dstPeer:{id:A.toBytes(),addrs:[mi(s).bytes]}}}),i=dD({stream:r,remoteAddr:e,localAddr:n.encapsulate(`/p2p-circuit/p2p/${this.components.peerId.toString()}`)});return BD("new outbound connection %s",i.remoteAddr),await this.components.upgrader.upgradeOutbound(i)}catch(e){throw BD.error("Circuit relay dial failed",e),c&&await l.close(),e}}createListener(e){return this.handler=e.handler,function(e){const t=new Map,r=Object.assign(new N_,{close:async()=>await Promise.resolve(),listen:async function(n){const s=mi(n.toString().split("/p2p-circuit").find((e=>""!==e))),i=s.getPeerId();if(null==i)throw new Error("Could not determine relay peer from multiaddr");const o=Ta(i);await e.peerStore.addressBook.add(o,[s]);const a=await e.connectionManager.openConnection(o),A=a.remoteAddr.encapsulate("/p2p-circuit");t.set(a.remotePeer.toString(),A),r.dispatchEvent(new F_("listening"))},getAddrs:function(){const e=[];for(const r of t.values())e.push(r);return e}});return e.connectionManager.addEventListener("peer:disconnect",(e=>{const{detail:n}=e;t.delete(n.remotePeer.toString())&&r.dispatchEvent(new F_("close"))})),r}({connectionManager:this.components.connectionManager,peerStore:this.components.peerStore})}filter(e){return(e=Array.isArray(e)?e:[e]).filter((e=>Hi.matches(e)))}}async function CD(e){const t=(new TextEncoder).encode(e),r=await $n.digest(t);return Ve.createV0(r)}const SD="hop_relay",ID="true",TD="/libp2p/relay";var RD=r(28951);const kD="[a-fA-F\\d:]",UD=e=>e&&e.includeBoundaries?`(?:(?<=\\s|^)(?=${kD})|(?<=${kD})(?=\\s|$))`:"",DD="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",PD="[a-fA-F\\d]{1,4}",LD=`\n(?:\n(?:${PD}:){7}(?:${PD}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:${PD}:){6}(?:${DD}|:${PD}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:${PD}:){5}(?::${DD}|(?::${PD}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:${PD}:){4}(?:(?::${PD}){0,1}:${DD}|(?::${PD}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:${PD}:){3}(?:(?::${PD}){0,2}:${DD}|(?::${PD}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:${PD}:){2}(?:(?::${PD}){0,3}:${DD}|(?::${PD}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:${PD}:){1}(?:(?::${PD}){0,4}:${DD}|(?::${PD}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::${PD}){0,5}:${DD}|(?::${PD}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),ND=new RegExp(`(?:^${DD}$)|(?:^${LD}$)`),OD=new RegExp(`^${DD}$`),FD=new RegExp(`^${LD}$`),QD=e=>e&&e.exact?ND:new RegExp(`(?:${UD(e)}${DD}${UD(e)})|(?:${UD(e)}${LD}${UD(e)})`,"g");QD.v4=e=>e&&e.exact?OD:new RegExp(`${UD(e)}${DD}${UD(e)}`,"g"),QD.v6=e=>e&&e.exact?FD:new RegExp(`${UD(e)}${LD}${UD(e)}`,"g");var xD=QD,MD=r(56512);const{isValid:HD,parse:KD}=MD,VD=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"].map((e=>new RD.Netmask(e)));function zD(e){return/^::$/.test(e)||/^::1$/.test(e)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(e)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(e)||/^ff([0-9a-fA-F]{2,2}):/i.test(e)}var jD=e=>{if(HD(e)){const t=KD(e);if("ipv4"===t.kind())return function(e){for(let t of VD)if(t.contains(e))return!0;return!1}(t.toNormalizedString());if("ipv6"===t.kind())return zD(e)}else if(Is(e)&&xD.v6().test(e))return zD(e)};function GD(e){const{address:t}=e.nodeAddress();return Boolean(jD(t))}function $D(e,t){const r=GD(e.multiaddr),n=GD(t.multiaddr);return r&&!n?1:!r&&n||e.isCertified&&!t.isCertified?-1:!e.isCertified&&t.isCertified?1:0}const qD=se("libp2p:auto-relay"),WD=()=>{};class YD{constructor(e,t){this.components=e,this.addressSorter=t.addressSorter??$D,this.maxListeners=t.maxListeners??1,this.listenRelays=new Set,this.onError=t.onError??WD,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this.components.peerStore.addEventListener("change:protocols",(e=>{this._onProtocolChange(e).catch((e=>{qD.error(e)}))})),this.components.connectionManager.addEventListener("peer:disconnect",this._onPeerDisconnected)}async _onProtocolChange(e){const{peerId:t,protocols:r}=e.detail,n=t.toString(),s=r.find((e=>e===fD));if(null!=s){if(!this.listenRelays.has(n))try{const e=this.components.connectionManager.getConnections(t);if(0===e.length)return;const r=e[0];if(r.remoteAddr.protoCodes().includes(290))return void qD(`relayed connection to ${n} will not be used to hop on`);const s=await async function(e){const{connection:t,signal:r}=e,n=await t.newStream(fD,{signal:r}),s=new mD({stream:n});s.write({type:uD.Type.CAN_HOP});const i=await s.read();return await s.close(),null!=i&&i.code===uD.Status.SUCCESS}({connection:r});s&&(await this.components.peerStore.metadataBook.setValue(t,SD,vs(ID)),await this._addListenRelay(r,n))}catch(e){this.onError(e)}}else this.listenRelays.has(n)&&await this._removeListenRelay(n)}_onPeerDisconnected(e){const t=e.detail.remotePeer.toString();this.listenRelays.has(t)&&this._removeListenRelay(t).catch((e=>{qD.error(e)}))}async _addListenRelay(e,t){try{if(this.listenRelays.size>=this.maxListeners)return;const r=await zh(await this.components.peerStore.addressBook.get(e.remotePeer),(e=>ZB(e,this.addressSorter)),(async e=>await Ou(e))),n=await Promise.all(r.map((async t=>{try{let r=t.multiaddr;return null==r.getPeerId()&&(r=r.encapsulate(`/p2p/${e.remotePeer.toString()}`)),r=r.encapsulate("/p2p-circuit"),await this.components.transportManager.listen([r]),!0}catch(e){qD.error("error listening on circuit address",e),this.onError(e)}return!1})));n.includes(!0)&&this.listenRelays.add(t)}catch(e){this.onError(e),this.listenRelays.delete(t)}}async _removeListenRelay(e){this.listenRelays.delete(e)&&await this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this.listenRelays.size>=this.maxListeners)return;const t=[],r=await this.components.peerStore.all();for(const{id:n,metadata:s}of r){const r=n.toString();if(this.listenRelays.has(r))continue;if(e.includes(r))continue;const i=s.get(SD);if(null==i||Ts(i)!==ID)continue;const o=this.components.connectionManager.getConnections(n);if(0!==o.length){if(await this._addListenRelay(o[0],r),this.listenRelays.size>=this.maxListeners)return}else t.push(n)}for(const e of t)if(await this._tryToListenOnRelay(e),this.listenRelays.size>=this.maxListeners)return;try{const e=await CD(TD);for await(const t of this.components.contentRouting.findProviders(e)){if(0===t.multiaddrs.length)continue;const e=t.id;if(!e.equals(this.components.peerId)&&(await this.components.peerStore.addressBook.add(e,t.multiaddrs),await this._tryToListenOnRelay(e),this.listenRelays.size>=this.maxListeners))return}}catch(e){this.onError(e)}}async _tryToListenOnRelay(e){try{const t=await this.components.connectionManager.openConnection(e);await this._addListenRelay(t,e.toString())}catch(t){qD.error("Could not use %p as relay",e,t),this.onError(t,`could not connect and listen on known hop relay ${e.toString()}`)}}}const XD=se("libp2p:relay");class JD{constructor(e,t){this.components=e,this.autoRelay=!1!==t.autoRelay?.enabled?new YD(e,{addressSorter:t.addressSorter,...t.autoRelay}):void 0,this.started=!1,this.init=t,this._advertiseService=this._advertiseService.bind(this)}isStarted(){return this.started}async start(){!1!==this.init.hop.enabled&&!1!==this.init.advertise.enabled&&(this.timeout=(0,QU.setDelayedInterval)(this._advertiseService,this.init.advertise.ttl,this.init.advertise.bootDelay)),this.started=!0}async stop(){null!=this.timeout&&(0,QU.clearDelayedInterval)(this.timeout),this.started=!1}async _advertiseService(){try{const e=await CD(TD);await this.components.contentRouting.provide(e)}catch(e){e.code===LU.ERR_NO_ROUTERS_AVAILABLE?(XD.error("a content router, such as a DHT, must be provided in order to advertise the relay service",e),await this.stop()):XD.error(e)}}}var ZD=r(50202);r(79437),r(25414);const eP=AA.pki;const tP=se("libp2p:keychain:cms"),rP=new WeakMap;class nP{constructor(e,t){if(null==e)throw ie(new Error("keychain is required"),LU.ERR_KEYCHAIN_REQUIRED);this.keychain=e,rP.set(this,{dek:t})}async encrypt(e,t){if(!(t instanceof Uint8Array))throw ie(new Error("Plain data must be a Uint8Array"),LU.ERR_INVALID_PARAMETERS);const r=await this.keychain.findKeyByName(e),n=await this.keychain.getPrivateKey(e),s=rP.get(this);if(null==s)throw ie(new Error("dek missing"),LU.ERR_INVALID_PARAMETERS);const i=s.dek,o=AA.pki.decryptRsaPrivateKey(n,i),a=await((e,t)=>{const r=eP.rsa.setPublicKey(t.n,t.e),n=eP.createCertificate();n.publicKey=r,n.serialNumber="01",n.validity.notBefore=new Date,n.validity.notAfter=new Date,n.validity.notAfter.setFullYear(n.validity.notBefore.getFullYear()+10);const s=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:e.id}];return n.setSubject(s),n.setIssuer(s),n.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),n.sign(t),n})(r,o),A=AA.pkcs7.createEnvelopedData();A.addRecipient(a),A.content=AA.util.createBuffer(t),A.encrypt();return vs(AA.asn1.toDer(A.toAsn1()).getBytes(),"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw ie(new Error("CMS data is required"),LU.ERR_INVALID_PARAMETERS);let t;try{const r=AA.util.createBuffer(Ts(e,"ascii")),n=AA.asn1.fromDer(r);t=AA.pkcs7.messageFromAsn1(n)}catch(e){throw tP.error(e),ie(new Error("Invalid CMS"),LU.ERR_INVALID_CMS)}const r=t.recipients.filter((e=>e.issuer.find((e=>"O"===e.shortName&&"ipfs"===e.value)))).filter((e=>e.issuer.find((e=>"CN"===e.shortName)))).map((e=>({recipient:e,keyId:e.issuer.find((e=>"CN"===e.shortName)).value}))),n=await async function(e,t){const r=e.map(t);return e[(await Promise.all(r)).findIndex((e=>e))]}(r,(async e=>{try{if(null!=await this.keychain.findKeyById(e.keyId))return!0}catch(e){return!1}return!1}));if(null==n){const e=r.map((e=>e.keyId));throw ie(new Error(`Decryption needs one of the key(s): ${e.join(", ")}`),LU.ERR_MISSING_KEYS,{missingKeys:e})}const s=await this.keychain.findKeyById(n.keyId);if(null==s)throw ie(new Error("No key available to decrypto"),LU.ERR_NO_KEY);const i=await this.keychain.getPrivateKey(s.name),o=rP.get(this);if(null==o)throw ie(new Error("dek missing"),LU.ERR_INVALID_PARAMETERS);const a=o.dek,A=AA.pki.decryptRsaPrivateKey(i,a);return t.decrypt(n.recipient,A),vs(t.content.getBytes(),"ascii")}}const sP=se("libp2p:keychain"),iP="/info/",oP=new WeakMap,aP=14,AP=16,cP=1e3,lP={dek:{keyLength:64,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function uP(e){return null!=e&&("string"==typeof e&&(e===ZD(e.trim())&&e.length>0))}async function hP(){const e=800*Math.random()+200;await new Promise((t=>setTimeout(t,e)))}function dP(e){return new Ao("/pkcs8/"+e)}function fP(e){return new Ao(iP+e)}class pP{constructor(e,t){if(this.components=e,this.init=I(lP,t),null!=this.init.pass&&this.init.pass?.length<20)throw new Error("pass must be least 20 characters");if(null!=this.init.dek?.keyLength&&this.init.dek.keyLength<aP)throw new Error(`dek.keyLength must be least ${aP} bytes`);if(null!=this.init.dek?.salt?.length&&this.init.dek.salt.length<AP)throw new Error(`dek.saltLength must be least ${AP} bytes`);if(null!=this.init.dek?.iterationCount&&this.init.dek.iterationCount<cP)throw new Error(`dek.iterationCount must be least ${cP}`);const r=null!=this.init.pass&&null!=this.init.dek?.salt?IC(this.init.pass,this.init.dek?.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";oP.set(this,{dek:r}),this.started=!1}isStarted(){return this.started}async start(){const e=fP("self");await this.components.datastore.has(e)||await this.importPeer("self",this.components.peerId),this.started=!0}stop(){this.started=!1}get cms(){const e=oP.get(this);if(null==e)throw ie(new Error("dek missing"),LU.ERR_INVALID_PARAMETERS);const t=e.dek;return new nP(this,t)}static generateOptions(){const e=Object.assign({},lP),t=3*Math.ceil(AP/3);return e.dek.salt=Ts(bc(t),"base64"),e}static get options(){return lP}async createKey(e,t,r=2048){if(!uP(e)||"self"===e)throw await hP(),ie(new Error("Invalid key name"),LU.ERR_INVALID_KEY_NAME);if("string"!=typeof t)throw await hP(),ie(new Error("Invalid key type"),LU.ERR_INVALID_KEY_TYPE);const n=dP(e);if(await this.components.datastore.has(n))throw await hP(),ie(new Error("Key name already exists"),LU.ERR_KEY_ALREADY_EXISTS);if("rsa"===t.toLowerCase())if(!Number.isSafeInteger(r)||r<2048)throw await hP(),ie(new Error("Invalid RSA key size"),LU.ERR_INVALID_KEY_SIZE);let s;try{const i=await Zl(t,r),o=await i.id(),a=oP.get(this);if(null==a)throw ie(new Error("dek missing"),LU.ERR_INVALID_PARAMETERS);const A=a.dek,c=await i.export(A);s={name:e,id:o};const l=this.components.datastore.batch();l.put(n,vs(c)),l.put(fP(e),vs(JSON.stringify(s))),await l.commit()}catch(e){throw await hP(),e}return s}async listKeys(){const e={prefix:iP},t=[];for await(const r of this.components.datastore.query(e))t.push(JSON.parse(Ts(r.value)));return t}async findKeyById(e){try{return(await this.listKeys()).find((t=>t.id===e))}catch(e){throw await hP(),e}}async findKeyByName(e){if(!uP(e))throw await hP(),ie(new Error(`Invalid key name '${e}'`),LU.ERR_INVALID_KEY_NAME);const t=fP(e);try{const e=await this.components.datastore.get(t);return JSON.parse(Ts(e))}catch(t){throw await hP(),sP.error(t),ie(new Error(`Key '${e}' does not exist.`),LU.ERR_KEY_NOT_FOUND)}}async removeKey(e){if(!uP(e)||"self"===e)throw await hP(),ie(new Error(`Invalid key name '${e}'`),LU.ERR_INVALID_KEY_NAME);const t=dP(e),r=await this.findKeyByName(e),n=this.components.datastore.batch();return n.delete(t),n.delete(fP(e)),await n.commit(),r}async renameKey(e,t){if(!uP(e)||"self"===e)throw await hP(),ie(new Error(`Invalid old key name '${e}'`),LU.ERR_OLD_KEY_NAME_INVALID);if(!uP(t)||"self"===t)throw await hP(),ie(new Error(`Invalid new key name '${t}'`),LU.ERR_NEW_KEY_NAME_INVALID);const r=dP(e),n=dP(t),s=fP(e),i=fP(t);if(await this.components.datastore.has(n))throw await hP(),ie(new Error(`Key '${t}' already exists`),LU.ERR_KEY_ALREADY_EXISTS);try{const e=await this.components.datastore.get(r),o=await this.components.datastore.get(s),a=JSON.parse(Ts(o));a.name=t;const A=this.components.datastore.batch();return A.put(n,e),A.put(i,vs(JSON.stringify(a))),A.delete(r),A.delete(s),await A.commit(),a}catch(e){throw await hP(),e}}async exportKey(e,t){if(!uP(e))throw await hP(),ie(new Error(`Invalid key name '${e}'`),LU.ERR_INVALID_KEY_NAME);if(null==t)throw await hP(),ie(new Error("Password is required"),LU.ERR_PASSWORD_REQUIRED);const r=dP(e);try{const e=Ts(await this.components.datastore.get(r)),n=oP.get(this);if(null==n)throw ie(new Error("dek missing"),LU.ERR_INVALID_PARAMETERS);const s=n.dek,i=await nu(e,s);return await i.export(t)}catch(e){throw await hP(),e}}async exportPeerId(e){const t="temporary-password",r=await this.exportKey(e,t),n=await nu(r,t);return await ka(n.public.bytes,n.bytes)}async importKey(e,t,r){if(!uP(e)||"self"===e)throw await hP(),ie(new Error(`Invalid key name '${e}'`),LU.ERR_INVALID_KEY_NAME);if(null==t)throw await hP(),ie(new Error("PEM encoded key is required"),LU.ERR_PEM_REQUIRED);const n=dP(e);if(await this.components.datastore.has(n))throw await hP(),ie(new Error(`Key '${e}' already exists`),LU.ERR_KEY_ALREADY_EXISTS);let s,i;try{s=await nu(t,r)}catch(e){throw await hP(),ie(new Error("Cannot read the key, most likely the password is wrong"),LU.ERR_CANNOT_READ_KEY)}try{i=await s.id();const e=oP.get(this);if(null==e)throw ie(new Error("dek missing"),LU.ERR_INVALID_PARAMETERS);const r=e.dek;t=await s.export(r)}catch(e){throw await hP(),e}const o={name:e,id:i},a=this.components.datastore.batch();return a.put(n,vs(t)),a.put(fP(e),vs(JSON.stringify(o))),await a.commit(),o}async importPeer(e,t){try{if(!uP(e))throw ie(new Error(`Invalid key name '${e}'`),LU.ERR_INVALID_KEY_NAME);if(null==t)throw ie(new Error("PeerId is required"),LU.ERR_MISSING_PRIVATE_KEY);if(null==t.privateKey)throw ie(new Error("PeerId.privKey is required"),LU.ERR_MISSING_PRIVATE_KEY);const r=await ru(t.privateKey),n=dP(e);if(await this.components.datastore.has(n))throw await hP(),ie(new Error(`Key '${e}' already exists`),LU.ERR_KEY_ALREADY_EXISTS);const s=oP.get(this);if(null==s)throw ie(new Error("dek missing"),LU.ERR_INVALID_PARAMETERS);const i=s.dek,o=await r.export(i),a={name:e,id:t.toString()},A=this.components.datastore.batch();return A.put(n,vs(o)),A.put(fP(e),vs(JSON.stringify(a))),await A.commit(),a}catch(e){throw await hP(),e}}async getPrivateKey(e){if(!uP(e))throw await hP(),ie(new Error(`Invalid key name '${e}'`),LU.ERR_INVALID_KEY_NAME);try{const t=dP(e);return Ts(await this.components.datastore.get(t))}catch(t){throw await hP(),sP.error(t),ie(new Error(`Key '${e}' does not exist.`),LU.ERR_KEY_NOT_FOUND)}}async rotateKeychainPass(e,t){if("string"!=typeof e)throw await hP(),ie(new Error(`Invalid old pass type '${typeof e}'`),LU.ERR_INVALID_OLD_PASS_TYPE);if("string"!=typeof t)throw await hP(),ie(new Error(`Invalid new pass type '${typeof t}'`),LU.ERR_INVALID_NEW_PASS_TYPE);if(t.length<20)throw await hP(),ie(new Error(`Invalid pass length ${t.length}`),LU.ERR_INVALID_PASS_LENGTH);sP("recreating keychain");const r=oP.get(this);if(null==r)throw ie(new Error("dek missing"),LU.ERR_INVALID_PARAMETERS);const n=r.dek;this.init.pass=t;const s=null!=t&&null!=this.init.dek?.salt?IC(t,this.init.dek.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";oP.set(this,{dek:s});const i=await this.listKeys();for(const e of i){const t=Ts(await this.components.datastore.get(dP(e.name))),r=await nu(t,n),i=s.toString(),o=await r.export(i),a=this.components.datastore.batch(),A={name:e.name,id:e.id};a.put(dP(e.name),vs(o)),a.put(fP(e.name),vs(JSON.stringify(A))),await a.commit()}sP("keychain reconstructed")}}async function gP(e){try{return{status:"fulfilled",value:await e,isFulfilled:!0,isRejected:!1}}catch(e){return{status:"rejected",reason:e,isFulfilled:!1,isRejected:!0}}}class yP{value;next;constructor(e){this.value=e}}class wP{#e;#t;#r;constructor(){this.clear()}enqueue(e){const t=new yP(e);this.#e?(this.#t.next=t,this.#t=t):(this.#e=t,this.#t=t),this.#r++}dequeue(){const e=this.#e;if(e)return this.#e=this.#e.next,this.#r--,e.value}clear(){this.#e=void 0,this.#t=void 0,this.#r=0}get size(){return this.#r}*[Symbol.iterator](){let e=this.#e;for(;e;)yield e.value,e=e.next}}function mP(e){if(!Number.isInteger(e)&&e!==Number.POSITIVE_INFINITY||!(e>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const t=new wP;let r=0;const n=async(e,n,s)=>{r++;const i=(async()=>e(...s))();n(i);try{await i}catch{}r--,t.size>0&&t.dequeue()()},s=(s,...i)=>new Promise((o=>{((s,i,o)=>{t.enqueue(n.bind(void 0,s,i,o)),(async()=>{await Promise.resolve(),r<e&&t.size>0&&t.dequeue()()})()})(s,o,i)}));return Object.defineProperties(s,{activeCount:{get:()=>r},pendingCount:{get:()=>t.size},clearQueue:{value:()=>{t.clear()}}}),s}async function bP(e,t={}){const{concurrency:r=Number.POSITIVE_INFINITY}=t,n=mP(r);return Promise.all(e.map((e=>e&&"function"==typeof e.then?gP(e):gP("function"==typeof e?n((()=>e())):Promise.resolve(e)))))}class EP extends Map{constructor(e){super();const{name:t,metrics:r}=e;this.metric=r.registerMetric(t),this.updateComponentMetric()}set(e,t){return super.set(e,t),this.updateComponentMetric(),this}delete(e){const t=super.delete(e);return this.updateComponentMetric(),t}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metric.update(this.size)}}function vP(e){const{name:t,metrics:r}=e;let n;return n=null!=r?new EP({name:t,metrics:r}):new Map,n}const BP=se("libp2p:transports");class _P extends N_{constructor(e,t={}){super(),this.components=e,this.started=!1,this.transports=new Map,this.listeners=vP({name:"libp2p_transport_manager_listeners",metrics:this.components.metrics}),this.faultTolerance=t.faultTolerance??_U.FATAL_ALL}add(e){const t=e[Symbol.toStringTag];if(null==t)throw ie(new Error("Transport must have a valid tag"),LU.ERR_INVALID_KEY);if(this.transports.has(t))throw ie(new Error("There is already a transport with this tag"),LU.ERR_DUPLICATE_TRANSPORT);BP("adding transport %s",t),this.transports.set(t,e),this.listeners.has(t)||this.listeners.set(t,[])}isStarted(){return this.started}async start(){const e=this.components.addressManager.getListenAddrs();await this.listen(e),this.started=!0}async stop(){const e=[];for(const[t,r]of this.listeners)for(BP("closing listeners for %s",t);r.length>0;){const t=r.pop();null!=t&&e.push(t.close())}await Promise.all(e),BP("all listeners closed");for(const e of this.listeners.keys())this.listeners.set(e,[]);this.started=!1}async dial(e,t){const r=this.transportForMultiaddr(e);if(null==r)throw ie(new Error(`No transport available for address ${String(e)}`),LU.ERR_TRANSPORT_UNAVAILABLE);try{return await r.dial(e,{...t,upgrader:this.components.upgrader})}catch(e){throw null==e.code&&(e.code=LU.ERR_TRANSPORT_DIAL_FAILED),e}}getAddrs(){let e=[];for(const t of this.listeners.values())for(const r of t)e=[...e,...r.getAddrs()];return e}getTransports(){return Array.of(...this.transports.values())}transportForMultiaddr(e){for(const t of this.transports.values()){if(t.filter([e]).length>0)return t}}async listen(e){if(null==e||0===e.length)return void BP("no addresses were provided for listening, this node is dial only");const t=[];for(const[r,n]of this.transports.entries()){const s=n.filter(e),i=[];for(const e of s){BP("creating listener for %s on %s",r,e);const t=n.createListener({upgrader:this.components.upgrader});let s=this.listeners.get(r);null==s&&(s=[],this.listeners.set(r,s)),s.push(t),t.addEventListener("listening",(()=>{this.dispatchEvent(new F_("listener:listening",{detail:t}))})),t.addEventListener("close",(()=>{this.dispatchEvent(new F_("listener:close",{detail:t}))})),i.push(t.listen(e))}if(0===i.length){t.push(r);continue}if(null==(await bP(i)).find((e=>e.isFulfilled))&&this.faultTolerance!==_U.NO_FATAL)throw ie(new Error(`Transport (${r}) could not listen on any available address`),LU.ERR_NO_VALID_ADDRESSES)}if(t.length===this.transports.size){const e=`no valid addresses were provided for transports [${t.join(", ")}]`;if(this.faultTolerance===_U.FATAL_ALL)throw ie(new Error(e),LU.ERR_NO_VALID_ADDRESSES);BP(`libp2p in dial mode only: ${e}`)}}async remove(e){BP("removing %s",e);for(const t of this.listeners.get(e)??[])await t.close();this.transports.delete(e),this.listeners.delete(e)}async removeAll(){const e=[];for(const t of this.transports.keys())e.push(this.remove(t));await Promise.all(e)}}const CP="/multistream/1.0.0",SP=se("libp2p:mss"),IP=vs("\n");function TP(e){const t=new Bd(e,IP);return FC.single(t)}function RP(e,t,r={}){const n=TP(t);!0===r.writeBytes?e.push(n.subarray()):e.push(n)}async function kP(e,t){const r=await async function(e,t){let r=1;const n={[Symbol.asyncIterator]:()=>n,next:async()=>await e.next(r)};let s=n;null!=t?.signal&&(s=PC(n,t.signal));const i=await zh(s,MC({onLength:e=>{r=e},maxDataLength:1024}),(async e=>await rm(e)));if(null==i||0===i.length)throw ie(new Error("no buffer returned"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");if(i.get(i.byteLength-1)!==IP[0])throw SP.error("Invalid mss message - missing newline - %s",i.subarray()),ie(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return i.sublist(0,-1)}(e,t);return Ts(r.subarray())}const UP=se("libp2p:mss:select");async function DP(e,t,r={}){t=Array.isArray(t)?[...t]:[t];const{reader:n,writer:s,rest:i,stream:o}=yD(e),a=t.shift();if(null==a)throw new Error("At least one protocol must be specified");UP('select: write ["%s", "%s"]',CP,a);!function(e,t,r={}){const n=new Bd;for(const e of t)n.append(TP(e));!0===r.writeBytes?e.push(n.subarray()):e.push(n)}(s,[vs(CP),vs(a)],r);let A=await kP(n,r);if(UP('select: read "%s"',A),A===CP&&(A=await kP(n,r),UP('select: read "%s"',A)),A===a)return i(),{stream:o,protocol:a};for(const e of t){UP('select: write "%s"',e),RP(s,vs(e),r);const t=await kP(n,r);if(UP('select: read "%s" for "%s"',t,e),t===e)return i(),{stream:o,protocol:e}}throw i(),ie(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}const PP=se("libp2p:mss:handle");async function LP(e,t,r){t=Array.isArray(t)?t:[t];const{writer:n,reader:s,rest:i,stream:o}=yD(e);for(;;){const e=await kP(s,r);if(PP('read "%s"',e),e!==CP){if(t.includes(e))return RP(n,vs(e),r),PP('respond with "%s" for "%s"',e,e),i(),{stream:o,protocol:e};"ls"!==e?(RP(n,vs("na"),r),PP('respond with "na" for "%s"',e)):(RP(n,new Bd(...t.map((e=>TP(vs(e))))),r),PP('respond with "%s" for %s',t,e))}else PP('respond with "%s" for "%s"',CP,e),RP(n,vs(CP),r)}}const NP=Symbol.for("@libp2p/connection");const OP=se("libp2p:connection");class FP{constructor(e){const{remoteAddr:t,remotePeer:r,newStream:n,close:s,getStreams:i,stat:o}=e;this.id=`${parseInt(String(1e9*Math.random())).toString(36)}${Date.now()}`,this.remoteAddr=t,this.remotePeer=r,this.stat={...o,status:WU},this._newStream=n,this._close=s,this._getStreams=i,this.tags=[],this._closing=!1}get[Symbol.toStringTag](){return"Connection"}get[NP](){return!0}get streams(){return this._getStreams()}async newStream(e,t){if(this.stat.status===YU)throw ie(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===XU)throw ie(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);const r=await this._newStream(e,t);return r.stat.direction="outbound",r}addStream(e){e.stat.direction="inbound"}removeStream(e){}async close(){if(this.stat.status!==XU&&!this._closing){this.stat.status=YU;try{this.streams.forEach((e=>e.close()))}catch(e){OP.error(e)}this._closing=!0,await this._close(),this._closing=!1,this.stat.timeline.close=Date.now(),this.stat.status=XU}}}const QP=se("libp2p:registrar");class xP{constructor(e){this.topologies=new Map,this.handlers=new Map,this.components=e,this._onDisconnect=this._onDisconnect.bind(this),this._onProtocolChange=this._onProtocolChange.bind(this),this._onConnect=this._onConnect.bind(this),this.components.connectionManager.addEventListener("peer:disconnect",this._onDisconnect),this.components.connectionManager.addEventListener("peer:connect",this._onConnect),this.components.peerStore.addEventListener("change:protocols",this._onProtocolChange)}getProtocols(){return Array.from(new Set([...this.topologies.keys(),...this.handlers.keys()])).sort()}getHandler(e){const t=this.handlers.get(e);if(null==t)throw ie(new Error(`No handler registered for protocol ${e}`),LU.ERR_NO_HANDLER_FOR_PROTOCOL);return t}getTopologies(e){const t=this.topologies.get(e);return null==t?[]:[...t.values()]}async handle(e,t,r){if(this.handlers.has(e))throw ie(new Error(`Handler already registered for protocol ${e}`),LU.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED);const n=I.bind({ignoreUndefined:!0})({maxInboundStreams:32,maxOutboundStreams:64},r);this.handlers.set(e,{handler:t,options:n}),await this.components.peerStore.protoBook.add(this.components.peerId,[e])}async unhandle(e){const t=Array.isArray(e)?e:[e];t.forEach((e=>{this.handlers.delete(e)})),await this.components.peerStore.protoBook.remove(this.components.peerId,t)}async register(e,t){if(null==(r=t)||!Boolean(r[R_]))throw QP.error("topology must be an instance of interfaces/topology"),ie(new Error("topology must be an instance of interfaces/topology"),LU.ERR_INVALID_PARAMETERS);var r;const n=`${(1e9*Math.random()).toString(36)}${Date.now()}`;let s=this.topologies.get(e);return null==s&&(s=new Map,this.topologies.set(e,s)),s.set(n,t),await t.setRegistrar(this),n}unregister(e){for(const[t,r]of this.topologies.entries())r.has(e)&&(r.delete(e),0===r.size&&this.topologies.delete(t))}_onDisconnect(e){const t=e.detail;this.components.peerStore.protoBook.get(t.remotePeer).then((e=>{for(const r of e){const e=this.topologies.get(r);if(null!=e)for(const r of e.values())r.onDisconnect(t.remotePeer)}})).catch((e=>{QP.error(e)}))}_onConnect(e){const t=e.detail;this.components.peerStore.protoBook.get(t.remotePeer).then((e=>{for(const r of e){const e=this.topologies.get(r);if(null!=e)for(const r of e.values())r.onConnect(t.remotePeer,t)}})).catch((e=>{QP.error(e)}))}_onProtocolChange(e){const{peerId:t,protocols:r,oldProtocols:n}=e.detail,s=n.filter((e=>!r.includes(e))),i=r.filter((e=>!n.includes(e)));for(const e of s){const r=this.topologies.get(e);if(null!=r)for(const e of r.values())e.onDisconnect(t)}for(const e of i){const r=this.topologies.get(e);if(null!=r)for(const e of r.values()){const r=this.components.connectionManager.getConnections(t)[0];null!=r&&e.onConnect(t,r)}}}}const MP=se("libp2p:upgrader");function HP(e,t,r){let n=0;return r.streams.forEach((r=>{r.stat.direction===t&&r.stat.protocol===e&&n++})),n}class KP extends N_{constructor(e,t){super(),this.components=e,this.connectionEncryption=new Map,t.connectionEncryption.forEach((e=>{this.connectionEncryption.set(e.protocol,e)})),this.muxers=new Map,t.muxers.forEach((e=>{this.muxers.set(e.protocol,e)})),this.inboundUpgradeTimeout=t.inboundUpgradeTimeout}async upgradeInbound(e,t){if(!await this.components.connectionManager.acceptIncomingConnection(e))throw ie(new Error("connection denied"),LU.ERR_CONNECTION_DENIED);let r,n,s,i,o;const a=new Bs.TimeoutController(this.inboundUpgradeTimeout);try{(0,xU.setMaxListeners)?.(1/0,a.signal)}catch{}try{const A=NC(e,a.signal);if(e.source=A.source,e.sink=A.sink,await this.components.connectionGater.denyInboundConnection(e))throw ie(new Error("The multiaddr connection is blocked by gater.acceptConnection"),LU.ERR_CONNECTION_INTERCEPTED);this.components.metrics?.trackMultiaddrConnection(e),MP("starting the inbound connection upgrade");let c=e;if(!0!==t?.skipProtection){const t=this.components.connectionProtector;null!=t&&(MP("protecting the inbound connection"),c=await t.protect(e))}try{if(r=c,!0!==t?.skipEncryption){if(({conn:r,remotePeer:n,protocol:o}=await this._encryptInbound(c)),await this.components.connectionGater.denyInboundEncryptedConnection(n,{...c,...r}))throw ie(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),LU.ERR_CONNECTION_INTERCEPTED)}else{const t=e.remoteAddr.getPeerId();if(null==t)throw ie(new Error("inbound connection that skipped encryption must have a peer id"),LU.ERR_INVALID_MULTIADDR);const r=Ta(t);o="native",n=r}if(s=r,null!=t?.muxerFactory)i=t.muxerFactory;else if(this.muxers.size>0){const e=await this._multiplexInbound({...c,...r},this.muxers);i=e.muxerFactory,s=e.stream}}catch(e){throw MP.error("Failed to upgrade inbound connection",e),e}if(await this.components.connectionGater.denyInboundUpgradedConnection(n,{...c,...r}))throw ie(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),LU.ERR_CONNECTION_INTERCEPTED);return MP("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:o,direction:"inbound",maConn:e,upgradedConn:s,muxerFactory:i,remotePeer:n})}finally{this.components.connectionManager.afterUpgradeInbound(),a.clear()}}async upgradeOutbound(e,t){const r=e.remoteAddr.getPeerId();let n,s,i,o,a,A;if(null!=r&&(n=Ta(r),await this.components.connectionGater.denyOutboundConnection(n,e)))throw ie(new Error("The multiaddr connection is blocked by connectionGater.denyOutboundConnection"),LU.ERR_CONNECTION_INTERCEPTED);this.components.metrics?.trackMultiaddrConnection(e),MP("Starting the outbound connection upgrade");let c=e;if(!0!==t?.skipProtection){const t=this.components.connectionProtector;null!=t&&(c=await t.protect(e))}try{if(s=c,!0!==t?.skipEncryption){if(({conn:s,remotePeer:i,protocol:a}=await this._encryptOutbound(c,n)),await this.components.connectionGater.denyOutboundEncryptedConnection(i,{...c,...s}))throw ie(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),LU.ERR_CONNECTION_INTERCEPTED)}else{if(null==n)throw ie(new Error("Encryption was skipped but no peer id was passed"),LU.ERR_INVALID_PEER);a="native",i=n}if(o=s,null!=t?.muxerFactory)A=t.muxerFactory;else if(this.muxers.size>0){const e=await this._multiplexOutbound({...c,...s},this.muxers);A=e.muxerFactory,o=e.stream}}catch(t){throw MP.error("Failed to upgrade outbound connection",t),await e.close(t),t}if(await this.components.connectionGater.denyOutboundUpgradedConnection(i,{...c,...s}))throw ie(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),LU.ERR_CONNECTION_INTERCEPTED);return MP("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:a,direction:"outbound",maConn:e,upgradedConn:o,muxerFactory:A,remotePeer:i})}_createConnection(e){const{cryptoProtocol:t,direction:r,maConn:n,upgradedConn:s,remotePeer:i,muxerFactory:o}=e;let a,A,c;null!=o&&(a=o.createStreamMuxer({direction:r,onIncomingStream:e=>{null!=c&&Promise.resolve().then((async()=>{const t=this.components.registrar.getProtocols(),{stream:n,protocol:s}=await LP(e,t);if(MP("%s: incoming stream opened on %s",r,s),null==c)return;const o=function(e,t){try{const{options:r}=t.getHandler(e);return r.maxInboundStreams}catch(e){if(e.code!==LU.ERR_NO_HANDLER_FOR_PROTOCOL)throw e}return 32}(s,this.components.registrar);HP(s,"inbound",c)!==o?(e.source=n.source,e.sink=n.sink,e.stat.protocol=s,this.components.peerStore.protoBook.add(i,[s]).catch((e=>MP.error(e))),c.addStream(e),this.components.metrics?.trackProtocolStream(e,c),this._onStream({connection:c,stream:e,protocol:s})):e.abort(ie(new Error(`Too many inbound protocol streams for protocol "${s}" - limit ${o}`),LU.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS))})).catch((t=>{MP.error(t),null==e.stat.timeline.close&&e.close()}))},onStreamEnd:e=>{c?.removeStream(e.id)}}),A=async(e,t={})=>{if(null==a)throw ie(new Error("Stream is not multiplexed"),LU.ERR_MUXER_UNAVAILABLE);MP("%s: starting new stream on %s",r,e);const n=await a.newStream();let s;try{if(null==t.signal){MP("No abort signal was passed while trying to negotiate protocols %s falling back to default timeout",e),s=new Bs.TimeoutController(3e4),t.signal=s.signal;try{(0,xU.setMaxListeners)?.(1/0,s.signal)}catch{}}const{stream:r,protocol:o}=await DP(n,e,t),a=function(e,t){try{const{options:r}=t.getHandler(e);return r.maxOutboundStreams}catch(e){if(e.code!==LU.ERR_NO_HANDLER_FOR_PROTOCOL)throw e}return 64}(o,this.components.registrar);if(HP(o,"outbound",c)===a){const e=ie(new Error(`Too many outbound protocol streams for protocol "${o}" - limit ${a}`),LU.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS);throw n.abort(e),e}return this.components.peerStore.protoBook.add(i,[o]).catch((e=>MP.error(e))),n.source=r.source,n.sink=r.sink,n.stat.protocol=o,this.components.metrics?.trackProtocolStream(n,c),n}catch(e){if(MP.error("could not create new stream",e),null==n.stat.timeline.close&&n.close(),null!=e.code)throw e;throw ie(e,LU.ERR_UNSUPPORTED_PROTOCOL)}finally{null!=s&&s.clear()}},Promise.all([a.sink(s.source),s.sink(a.source)]).catch((e=>{MP.error(e)})));const l=n.timeline;n.timeline=new Proxy(l,{set:(...e)=>(null!=c&&"close"===e[1]&&null!=e[2]&&null==l.close&&(async()=>{try{"OPEN"===c.stat.status&&await c.close()}catch(e){MP.error(e)}finally{this.dispatchEvent(new F_("connectionEnd",{detail:c}))}})().catch((e=>{MP.error(e)})),Reflect.set(...e))}),n.timeline.upgraded=Date.now();const u=()=>{throw ie(new Error("connection is not multiplexed"),LU.ERR_CONNECTION_NOT_MULTIPLEXED)};var h;return h={remoteAddr:n.remoteAddr,remotePeer:i,stat:{status:"OPEN",direction:r,timeline:n.timeline,multiplexer:a?.protocol,encryption:t},newStream:A??u,getStreams:()=>null!=a?a.streams:u(),close:async()=>{await n.close(),null!=a&&a.close()}},c=new FP(h),this.dispatchEvent(new F_("connection",{detail:c})),c}_onStream(e){const{connection:t,stream:r,protocol:n}=e,{handler:s}=this.components.registrar.getHandler(n);s({connection:t,stream:r})}async _encryptInbound(e){const t=Array.from(this.connectionEncryption.keys());MP("handling inbound crypto protocol selection",t);try{const{stream:r,protocol:n}=await LP(e,t,{writeBytes:!0}),s=this.connectionEncryption.get(n);if(null==s)throw new Error(`no crypto module found for ${n}`);return MP("encrypting inbound connection..."),{...await s.secureInbound(this.components.peerId,r),protocol:n}}catch(e){throw ie(e,LU.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,t){const r=Array.from(this.connectionEncryption.keys());MP("selecting outbound crypto protocol",r);try{const{stream:n,protocol:s}=await DP(e,r,{writeBytes:!0}),i=this.connectionEncryption.get(s);if(null==i)throw new Error(`no crypto module found for ${s}`);return MP("encrypting outbound connection to %p",t),{...await i.secureOutbound(this.components.peerId,n,t),protocol:s}}catch(e){throw ie(e,LU.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,t){const r=Array.from(t.keys());MP("outbound selecting muxer %s",r);try{const{stream:n,protocol:s}=await DP(e,r,{writeBytes:!0});MP("%s selected as muxer protocol",s);return{stream:n,muxerFactory:t.get(s)}}catch(e){throw MP.error("error multiplexing outbound stream",e),ie(e,LU.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,t){const r=Array.from(t.keys());MP("inbound handling muxers %s",r);try{const{stream:n,protocol:s}=await LP(e,r,{writeBytes:!0});return{stream:n,muxerFactory:t.get(s)}}catch(e){throw MP.error("error multiplexing inbound stream",e),ie(e,LU.ERR_MUXER_UNAVAILABLE)}}}var VP;!function(e){let t;e.codec=()=>(null==t&&(t=aA(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),null!=e.protocolVersion&&(t.uint32(42),t.string(e.protocolVersion)),null!=e.agentVersion&&(t.uint32(50),t.string(e.agentVersion)),null!=e.publicKey&&(t.uint32(10),t.bytes(e.publicKey)),null!=e.listenAddrs)for(const r of e.listenAddrs)t.uint32(18),t.bytes(r);if(null!=e.observedAddr&&(t.uint32(34),t.bytes(e.observedAddr)),null!=e.protocols)for(const r of e.protocols)t.uint32(26),t.string(r);null!=e.signedPeerRecord&&(t.uint32(66),t.bytes(e.signedPeerRecord)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={listenAddrs:[],protocols:[]},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 5:r.protocolVersion=e.string();break;case 6:r.agentVersion=e.string();break;case 1:r.publicKey=e.bytes();break;case 2:r.listenAddrs.push(e.bytes());break;case 4:r.observedAddr=e.bytes();break;case 3:r.protocols.push(e.string());break;case 8:r.signedPeerRecord=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>Za(t,e.codec()),e.decode=t=>Ja(t,e.codec())}(VP||(VP={}));const zP="0.0.0",jP=`js-libp2p/${zP}`,GP=se("libp2p:identify");class $P{constructor(e,t){this.components=e,this.started=!1,this.init=t,this.identifyProtocolStr=`/${t.protocolPrefix}/id/1.0.0`,this.identifyPushProtocolStr=`/${t.protocolPrefix}/id/push/1.0.0`,this.host={protocolVersion:`${t.protocolPrefix}/0.1.0`,...t.host},this.components.connectionManager.addEventListener("peer:connect",(e=>{const t=e.detail;this.identify(t).catch(GP.error)})),this.components.peerStore.addEventListener("change:multiaddrs",(e=>{const{peerId:t}=e.detail;this.components.peerId.equals(t)&&this.pushToPeerStore().catch((e=>GP.error(e)))})),this.components.peerStore.addEventListener("change:protocols",(e=>{const{peerId:t}=e.detail;this.components.peerId.equals(t)&&this.pushToPeerStore().catch((e=>GP.error(e)))}))}isStarted(){return this.started}async start(){this.started||(await this.components.peerStore.metadataBook.setValue(this.components.peerId,"AgentVersion",vs(this.host.agentVersion)),await this.components.peerStore.metadataBook.setValue(this.components.peerId,"ProtocolVersion",vs(this.host.protocolVersion)),await this.components.registrar.handle(this.identifyProtocolStr,(e=>{this._handleIdentify(e).catch((e=>{GP.error(e)}))}),{maxInboundStreams:this.init.maxInboundStreams,maxOutboundStreams:this.init.maxOutboundStreams}),await this.components.registrar.handle(this.identifyPushProtocolStr,(e=>{this._handlePush(e).catch((e=>{GP.error(e)}))}),{maxInboundStreams:this.init.maxPushIncomingStreams,maxOutboundStreams:this.init.maxPushOutgoingStreams}),this.started=!0)}async stop(){await this.components.registrar.unhandle(this.identifyProtocolStr),await this.components.registrar.unhandle(this.identifyPushProtocolStr),this.started=!1}async push(e){const t=await this.components.peerStore.addressBook.getRawEnvelope(this.components.peerId),r=this.components.addressManager.getAddresses().map((e=>e.bytes)),n=await this.components.peerStore.protoBook.get(this.components.peerId),s=e.map((async e=>{let s;const i=new Bs.TimeoutController(this.init.timeout);try{(0,xU.setMaxListeners)?.(1/0,i.signal)}catch{}try{s=await e.newStream([this.identifyPushProtocolStr],{signal:i.signal});const o=NC(s,i.signal);await o.sink(zh([VP.encode({listenAddrs:r,signedPeerRecord:t,protocols:n})],FC()))}catch(e){GP.error("could not push identify update to peer",e)}finally{null!=s&&s.close(),i.clear()}}));await Promise.all(s)}async pushToPeerStore(){if(!this.isStarted())return;const e=[];for(const t of this.components.connectionManager.getConnections()){const r=t.remotePeer;(await this.components.peerStore.get(r)).protocols.includes(this.identifyPushProtocolStr)&&e.push(t)}await this.push(e)}async _identify(e,t={}){let r,n,s=t.signal;if(null==s){r=new Bs.TimeoutController(this.init.timeout),s=r.signal;try{(0,xU.setMaxListeners)?.(1/0,r.signal)}catch{}}try{n=await e.newStream([this.identifyProtocolStr],{signal:s});const t=NC(n,s),i=await zh([],t,MC({maxDataLength:this.init.maxIdentifyMessageSize??8192}),(async e=>await rm(e)));if(null==i)throw ie(new Error("No data could be retrieved"),LU.ERR_CONNECTION_ENDED);try{return VP.decode(i)}catch(e){throw ie(e,LU.ERR_INVALID_MESSAGE)}}finally{null!=r&&r.clear(),null!=n&&n.close()}}async identify(e,t={}){const r=await this._identify(e,t),{publicKey:n,listenAddrs:s,protocols:i,observedAddr:o,signedPeerRecord:a,agentVersion:A,protocolVersion:c}=r;if(null==n)throw ie(new Error("public key was missing from identify message"),LU.ERR_MISSING_PUBLIC_KEY);const l=await ka(n);if(!e.remotePeer.equals(l))throw ie(new Error("identified peer does not match the expected peer"),LU.ERR_INVALID_PEER);if(this.components.peerId.equals(l))throw ie(new Error("identified peer is our own peer id?"),LU.ERR_INVALID_PEER);const u=$P.getCleanMultiaddr(o);if(null!=a){GP("received signed peer record from %p",l);try{const e=await __.openAndCertify(a,T_.DOMAIN);if(!e.peerId.equals(l))throw ie(new Error("identified peer does not match the expected peer"),LU.ERR_INVALID_PEER);if(await this.components.peerStore.addressBook.consumePeerRecord(e))return await this.components.peerStore.protoBook.set(l,i),null!=A&&await this.components.peerStore.metadataBook.setValue(l,"AgentVersion",vs(A)),null!=c&&await this.components.peerStore.metadataBook.setValue(l,"ProtocolVersion",vs(c)),void GP("identify completed for peer %p and protocols %o",l,i)}catch(e){GP("received invalid envelope, discard it and fallback to listenAddrs is available",e)}}else GP("no signed peer record received from %p",l);GP("falling back to legacy addresses from %p",l);try{await this.components.peerStore.addressBook.set(l,s.map((e=>mi(e))))}catch(e){GP.error("received invalid addrs",e)}await this.components.peerStore.protoBook.set(l,i),null!=A&&await this.components.peerStore.metadataBook.setValue(l,"AgentVersion",vs(A)),null!=c&&await this.components.peerStore.metadataBook.setValue(l,"ProtocolVersion",vs(c)),GP("identify completed for peer %p and protocols %o",l,i),GP("received observed address of %s",u?.toString())}async _handleIdentify(e){const{connection:t,stream:r}=e,n=new Bs.TimeoutController(this.init.timeout);try{(0,xU.setMaxListeners)?.(1/0,n.signal)}catch{}try{const e=this.components.peerId.publicKey??new Uint8Array(0),s=await this.components.peerStore.get(this.components.peerId),i=this.components.addressManager.getAddresses().map((e=>e.decapsulateCode(Ns("p2p").code)));let o=s.peerRecordEnvelope;if(i.length>0&&null==o){const e=new T_({peerId:this.components.peerId,multiaddrs:i}),t=await __.seal(e,this.components.peerId);await this.components.peerStore.addressBook.consumePeerRecord(t),o=t.marshal().subarray()}const a=VP.encode({protocolVersion:this.host.protocolVersion,agentVersion:this.host.agentVersion,publicKey:e,listenAddrs:i.map((e=>e.bytes)),signedPeerRecord:o,observedAddr:t.remoteAddr.bytes,protocols:s.protocols}),A=NC(r,n.signal),c=zh([a],FC());await A.sink(c)}catch(e){GP.error("could not respond to identify request",e)}finally{r.close(),n.clear()}}async _handlePush(e){const{connection:t,stream:r}=e,n=new Bs.TimeoutController(this.init.timeout);try{(0,xU.setMaxListeners)?.(1/0,n.signal)}catch{}let s;try{const e=NC(r,n.signal),t=await zh([],e,MC({maxDataLength:this.init.maxIdentifyMessageSize??8192}),(async e=>await rm(e)));null!=t&&(s=VP.decode(t))}catch(e){return GP.error("received invalid message",e)}finally{r.close(),n.clear()}if(null==s)return GP.error("received invalid message");const i=t.remotePeer;if(this.components.peerId.equals(i))GP("received push from ourselves?");else{if(GP("received push from %p",i),null!=s.signedPeerRecord){GP("received signedPeerRecord in push");try{const e=await __.openAndCertify(s.signedPeerRecord,T_.DOMAIN);if(await this.components.peerStore.addressBook.consumePeerRecord(e))return GP("consumed signedPeerRecord sent in push"),void await this.components.peerStore.protoBook.set(i,s.protocols);GP("failed to consume signedPeerRecord sent in push")}catch(e){GP("received invalid envelope, discard it and fallback to listenAddrs is available",e)}}else GP("did not receive signedPeerRecord in push");try{await this.components.peerStore.addressBook.set(i,s.listenAddrs.map((e=>mi(e))))}catch(e){GP.error("received invalid addrs",e)}try{await this.components.peerStore.protoBook.set(i,s.protocols)}catch(e){GP.error("received invalid protocols",e)}GP("handled push from %p",i)}}static getCleanMultiaddr(e){if(null!=e&&e.length>0)try{return mi(e)}catch{}}}var qP,WP;!function(e){let t;e.codec=()=>(null==t&&(t=aA(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),!0!==r.writeDefaults&&""===e.identifier||(t.uint32(10),t.string(e.identifier)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={identifier:""},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();if(t>>>3==1)r.identifier=e.string();else e.skipType(7&t)}return r}))),t),e.encode=t=>Za(t,e.codec()),e.decode=t=>Ja(t,e.codec())}(qP||(qP={})),function(e){let t,r,n;!function(e){e.OK="OK",e.NOT_FOUND="NOT_FOUND",e.ERROR="ERROR"}(t=e.StatusCode||(e.StatusCode={})),function(e){e[e.OK=0]="OK",e[e.NOT_FOUND=1]="NOT_FOUND",e[e.ERROR=2]="ERROR"}(r||(r={})),function(e){e.codec=()=>oA(r)}(t=e.StatusCode||(e.StatusCode={})),e.codec=()=>(null==n&&(n=aA(((t,n,s={})=>{!1!==s.lengthDelimited&&n.fork(),(!0===s.writeDefaults||null!=t.status&&0!==r[t.status])&&(n.uint32(8),e.StatusCode.codec().encode(t.status,n)),(!0===s.writeDefaults||null!=t.data&&t.data.byteLength>0)&&(n.uint32(18),n.bytes(t.data)),!1!==s.lengthDelimited&&n.ldelim()}),((r,n)=>{const s={status:t.OK,data:new Uint8Array(0)},i=null==n?r.len:r.pos+n;for(;r.pos<i;){const t=r.uint32();switch(t>>>3){case 1:s.status=e.StatusCode.codec().decode(r);break;case 2:s.data=r.bytes();break;default:r.skipType(7&t)}}return s}))),n),e.encode=t=>Za(t,e.codec()),e.decode=t=>Ja(t,e.codec())}(WP||(WP={}));const YP=se("libp2p:fetch");class XP{constructor(e,t){this.started=!1,this.components=e,this.protocol=`/${t.protocolPrefix??"libp2p"}/fetch/0.0.1`,this.lookupFunctions=new Map,this.handleMessage=this.handleMessage.bind(this),this.init=t}async start(){await this.components.registrar.handle(this.protocol,(e=>{this.handleMessage(e).catch((e=>{YP.error(e)})).finally((()=>{e.stream.close()}))}),{maxInboundStreams:this.init.maxInboundStreams,maxOutboundStreams:this.init.maxOutboundStreams}),this.started=!0}async stop(){await this.components.registrar.unhandle(this.protocol),this.started=!1}isStarted(){return this.started}async fetch(e,t,r={}){YP("dialing %s to %p",this.protocol,e);const n=await this.components.connectionManager.openConnection(e,r);let s,i,o=r.signal;if(null==o){YP("using default timeout of %d ms",this.init.timeout),s=new Bs.TimeoutController(this.init.timeout),o=s.signal;try{(0,xU.setMaxListeners)?.(1/0,s.signal)}catch{}}try{i=await n.newStream(this.protocol,{signal:o});const e=NC(i,o);YP("fetch %s",t);const r=await zh([qP.encode({identifier:t})],FC(),e,MC(),(async function(e){const r=await rm(e);if(null==r)throw ie(new Error("No data received"),LU.ERR_INVALID_MESSAGE);const n=WP.decode(r);switch(n.status){case WP.StatusCode.OK:return YP("received status for %s ok",t),n.data;case WP.StatusCode.NOT_FOUND:return YP("received status for %s not found",t),null;case WP.StatusCode.ERROR:{YP("received status for %s error",t);const e=Ts(n.data);throw ie(new Error("Error in fetch protocol response: "+e),LU.ERR_INVALID_PARAMETERS)}default:throw YP("received status for %s unknown",t),ie(new Error("Unknown response status"),LU.ERR_INVALID_MESSAGE)}}));return r??null}finally{null!=s&&s.clear(),null!=i&&i.close()}}async handleMessage(e){const{stream:t}=e,r=this;await zh(t,MC(),(async function*(e){const t=await rm(e);if(null==t)throw ie(new Error("No data received"),LU.ERR_INVALID_MESSAGE);const n=qP.decode(t);let s;const i=r._getLookupFunction(n.identifier);if(null!=i){YP("look up data with identifier %s",n.identifier);const e=await i(n.identifier);null!=e?(YP("sending status for %s ok",n.identifier),s={status:WP.StatusCode.OK,data:e}):(YP("sending status for %s not found",n.identifier),s={status:WP.StatusCode.NOT_FOUND,data:new Uint8Array(0)})}else{YP("sending status for %s error",n.identifier);const e=vs(`No lookup function registered for key: ${n.identifier}`);s={status:WP.StatusCode.ERROR,data:e}}yield WP.encode(s)}),FC(),t)}_getLookupFunction(e){for(const t of this.lookupFunctions.keys())if(e.startsWith(t))return this.lookupFunctions.get(t)}registerLookupFunction(e,t){if(this.lookupFunctions.has(e))throw ie(new Error("Fetch protocol handler for key prefix '"+e+"' already registered"),LU.ERR_KEY_ALREADY_EXISTS);this.lookupFunctions.set(e,t)}unregisterLookupFunction(e,t){if(null!=t){if(this.lookupFunctions.get(e)!==t)return}this.lookupFunctions.delete(e)}}const JP=se("libp2p:ping");class ZP{constructor(e,t){this.components=e,this.started=!1,this.protocol=`/${t.protocolPrefix}/ping/1.0.0`,this.init=t}async start(){await this.components.registrar.handle(this.protocol,this.handleMessage,{maxInboundStreams:this.init.maxInboundStreams,maxOutboundStreams:this.init.maxOutboundStreams}),this.started=!0}async stop(){await this.components.registrar.unhandle(this.protocol),this.started=!1}isStarted(){return this.started}handleMessage(e){const{stream:t}=e;zh(t,t).catch((e=>{JP.error(e)}))}async ping(e,t={}){JP("dialing %s to %p",this.protocol,e);const r=Date.now(),n=bc(32),s=await this.components.connectionManager.openConnection(e,t);let i,o,a=t.signal;if(null==a){i=new Bs.TimeoutController(this.init.timeout),a=i.signal;try{(0,xU.setMaxListeners)?.(1/0,i.signal)}catch{}}try{o=await s.newStream([this.protocol],{signal:a});const e=NC(o,a),t=await zh([n],e,(async e=>await rm(e))),A=Date.now();if(null==t||!ii(n,t.subarray()))throw ie(new Error("Received wrong ping ack"),LU.ERR_WRONG_PING_ACK);return A-r}finally{null!=i&&i.clear(),null!=o&&o.close()}}}var eL=r(59134);const tL="object"==typeof window&&"object"==typeof document&&9===document.nodeType,rL=eL(),nL=tL&&!rL,sL=rL&&!tL,iL=rL&&tL,oL=void 0!==globalThis.process&&void 0!==globalThis.process.release&&"node"===globalThis.process.release.name&&!rL,aL="function"==typeof importScripts&&"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,AL=(void 0!==globalThis.process&&void 0!==globalThis.process.env&&globalThis.process.env.NODE_ENV,"undefined"!=typeof navigator&&"ReactNative"===navigator.product);function cL(e){const{address:t}=e.nodeAddress();return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(r=t)||/^::1$/.test(r);var r}const lL=se("libp2p:nat"),uL=7200;function hL(e=1024,t=65535){return Math.floor(Math.random()*(t-e+1)+e)}class dL{constructor(e,t){if(this.components=e,this.started=!1,this.enabled=t.enabled,this.externalAddress=t.externalAddress,this.localAddress=t.localAddress,this.description=t.description??`libp2p@${zP} ${this.components.peerId.toString()}`,this.ttl=t.ttl??uL,this.keepAlive=t.keepAlive??!0,this.gateway=t.gateway,this.ttl<uL)throw ie(new Error("NatManager ttl should be at least 7200 seconds"),LU.ERR_INVALID_PARAMETERS)}isStarted(){return this.started}start(){}afterStart(){nL||!this.enabled||this.started||(this.started=!0,this._start().catch((e=>{lL.error(e)})))}async _start(){const e=this.components.transportManager.getAddrs();for(const t of e){const{family:e,host:r,port:n,transport:s}=t.toOptions();if(!t.isThinWaistAddress()||"tcp"!==s)continue;if(cL(t))continue;if(4!==e)continue;const i=await this._getClient(),o=this.externalAddress??await i.externalIp(),a=jD(o);if(!0===a)throw new Error(`${o} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);if(null==a)throw new Error(`${o} is not an IP address`);const A=hL();lL(`opening uPnP connection from ${o}:${A} to ${r}:${n}`),await i.map({publicPort:A,localPort:n,localAddress:this.localAddress,protocol:"TCP"===s.toUpperCase()?"TCP":"UDP"}),this.components.addressManager.addObservedAddr(gi({family:4,address:o,port:A},s))}}async _getClient(){return null!=this.client||(this.client=await async function(){throw new Error("Not supported in browsers")}((this.description,this.ttl,this.keepAlive,this.gateway))),this.client}async stop(){if(!nL&&null!=this.client)try{await this.client.close(),this.client=void 0}catch(e){lL.error(e)}}}const fL=se("libp2p:peer-record-updater");class pL{constructor(e){this.components=e,this.started=!1,this.update=this.update.bind(this)}isStarted(){return this.started}async start(){this.started=!0,this.components.transportManager.addEventListener("listener:listening",this.update),this.components.transportManager.addEventListener("listener:close",this.update),this.components.addressManager.addEventListener("change:addresses",this.update)}async stop(){this.started=!1,this.components.transportManager.removeEventListener("listener:listening",this.update),this.components.transportManager.removeEventListener("listener:close",this.update),this.components.addressManager.removeEventListener("change:addresses",this.update)}update(){Promise.resolve().then((async()=>{const e=new T_({peerId:this.components.peerId,multiaddrs:this.components.addressManager.getAddresses().map((e=>e.decapsulateCode(Ns("p2p").code)))}),t=await __.seal(e,this.components.peerId);await this.components.peerStore.addressBook.consumePeerRecord(t)})).catch((e=>{fL.error("Could not update self peer record: %o",e)}))}}class gL{constructor(e){this.dht=e}async findPeer(e,t={}){for await(const r of this.dht.findPeer(e,t))if("FINAL_PEER"===r.name)return r.peer;throw ie(new Error(PU.NOT_FOUND),LU.ERR_NOT_FOUND)}async*getClosestPeers(e,t={}){for await(const r of this.dht.getClosestPeers(e,t))"FINAL_PEER"===r.name&&(yield r.peer)}}const yL="ERR_INVALID_PARAMETERS",wL="ERR_NOT_FOUND",mL=se("libp2p:peer-store:address-book"),bL="change:multiaddrs";async function EL(){return!0}class vL{constructor(e,t,r){this.dispatchEvent=e,this.store=t,this.addressFilter=r??EL}async consumePeerRecord(e){mL.trace("consumePeerRecord await write lock");const t=await this.store.lock.writeLock();let r,n,s;mL.trace("consumePeerRecord got write lock");try{let i;try{i=T_.createFromProtobuf(e.payload)}catch(e){return mL.error("invalid peer record received"),!1}r=i.peerId;const o=i.multiaddrs;if(!r.equals(e.peerId))return mL("signing key does not match PeerId in the PeerRecord"),!1;if(null==o||0===o.length)return!1;if(await this.store.has(r)&&(n=await this.store.load(r),null!=n.peerRecordEnvelope)){const e=await __.createFromProtobuf(n.peerRecordEnvelope),t=T_.createFromProtobuf(e.payload);if(t.seqNumber>=i.seqNumber)return mL("sequence number was lower or equal to existing sequence number - stored: %d received: %d",t.seqNumber,i.seqNumber),!1}const a=await BL(r,o,this.addressFilter,!0);s=await this.store.patchOrCreate(r,{addresses:a,peerRecordEnvelope:e.marshal().subarray()}),mL("stored provided peer record for %p",i.peerId)}finally{mL.trace("consumePeerRecord release write lock"),t()}return this.dispatchEvent(new F_(bL,{detail:{peerId:r,multiaddrs:s.addresses.map((({multiaddr:e})=>e)),oldMultiaddrs:null==n?[]:n.addresses.map((({multiaddr:e})=>e))}})),!0}async getRawEnvelope(e){mL.trace("getRawEnvelope await read lock");const t=await this.store.lock.readLock();mL.trace("getRawEnvelope got read lock");try{return(await this.store.load(e)).peerRecordEnvelope}catch(e){if(e.code!==wL)throw e}finally{mL.trace("getRawEnvelope release read lock"),t()}}async getPeerRecord(e){const t=await this.getRawEnvelope(e);if(null!=t)return await __.createFromProtobuf(t)}async get(e){e=Ia(e),mL.trace("get wait for read lock");const t=await this.store.lock.readLock();mL.trace("get got read lock");try{return(await this.store.load(e)).addresses}catch(e){if(e.code!==wL)throw e}finally{mL.trace("get release read lock"),t()}return[]}async set(e,t){if(e=Ia(e),!Array.isArray(t))throw mL.error("multiaddrs must be an array of Multiaddrs"),new wa("multiaddrs must be an array of Multiaddrs",yL);mL.trace("set await write lock");const r=await this.store.lock.writeLock();mL.trace("set got write lock");let n,s,i=!1;try{const o=await BL(e,t,this.addressFilter);if(0===o.length)return;try{if(n=await this.store.load(e),i=!0,new Set([...o.map((({multiaddr:e})=>e.toString())),...n.addresses.map((({multiaddr:e})=>e.toString()))]).size===n.addresses.length&&o.length===n.addresses.length)return}catch(e){if(e.code!==wL)throw e}s=await this.store.patchOrCreate(e,{addresses:o}),mL("set multiaddrs for %p",e)}finally{mL.trace("set multiaddrs for %p",e),mL("set release write lock"),r()}this.dispatchEvent(new F_(bL,{detail:{peerId:e,multiaddrs:s.addresses.map((e=>e.multiaddr)),oldMultiaddrs:null==n?[]:n.addresses.map((({multiaddr:e})=>e))}})),i||this.dispatchEvent(new F_("peer",{detail:{id:e,multiaddrs:s.addresses.map((e=>e.multiaddr)),protocols:s.protocols}}))}async add(e,t){if(e=Ia(e),!Array.isArray(t))throw mL.error("multiaddrs must be an array of Multiaddrs"),new wa("multiaddrs must be an array of Multiaddrs",yL);mL.trace("add await write lock");const r=await this.store.lock.writeLock();let n,s,i;mL.trace("add got write lock");try{const o=await BL(e,t,this.addressFilter);if(0===o.length)return;try{if(s=await this.store.load(e),n=!0,new Set([...o.map((({multiaddr:e})=>e.toString())),...s.addresses.map((({multiaddr:e})=>e.toString()))]).size===s.addresses.length)return}catch(e){if(e.code!==wL)throw e}i=await this.store.mergeOrCreate(e,{addresses:o}),mL("added multiaddrs for %p",e)}finally{mL.trace("set release write lock"),r()}this.dispatchEvent(new F_(bL,{detail:{peerId:e,multiaddrs:i.addresses.map((e=>e.multiaddr)),oldMultiaddrs:null==s?[]:s.addresses.map((({multiaddr:e})=>e))}})),!0===n&&this.dispatchEvent(new F_("peer",{detail:{id:e,multiaddrs:i.addresses.map((e=>e.multiaddr)),protocols:i.protocols}}))}async delete(e){e=Ia(e),mL.trace("delete await write lock");const t=await this.store.lock.writeLock();let r;mL.trace("delete got write lock");try{try{r=await this.store.load(e)}catch(e){if(e.code!==wL)throw e}await this.store.patchOrCreate(e,{addresses:[]})}finally{mL.trace("delete release write lock"),t()}null!=r&&this.dispatchEvent(new F_(bL,{detail:{peerId:e,multiaddrs:[],oldMultiaddrs:null==r?[]:r.addresses.map((({multiaddr:e})=>e))}}))}}async function BL(e,t,r,n=!1){const s=[];return await Promise.all(t.map((async t=>{if(!yi(t))throw mL.error("multiaddr must be an instance of Multiaddr"),new wa("multiaddr must be an instance of Multiaddr",yL);await r(e,t)&&s.push({multiaddr:t,isCertified:n})}))),s}const _L=se("libp2p:peer-store:key-book"),CL="change:pubkey";class SL{constructor(e,t){this.dispatchEvent=e,this.store=t}async set(e,t){if(e=Ia(e),!(t instanceof Uint8Array))throw _L.error("publicKey must be an instance of Uint8Array to store data"),new wa("publicKey must be an instance of PublicKey",yL);_L.trace("set await write lock");const r=await this.store.lock.writeLock();_L.trace("set got write lock");let n,s=!1;try{try{if(n=await this.store.load(e),null!=n.pubKey&&ii(n.pubKey,t))return}catch(e){if(e.code!==wL)throw e}await this.store.patchOrCreate(e,{pubKey:t}),s=!0}finally{_L.trace("set release write lock"),r()}s&&this.dispatchEvent(new F_(CL,{detail:{peerId:e,publicKey:t,oldPublicKey:null==n?void 0:n.pubKey}}))}async get(e){e=Ia(e),_L.trace("get await write lock");const t=await this.store.lock.readLock();_L.trace("get got write lock");try{return(await this.store.load(e)).pubKey}catch(e){if(e.code!==wL)throw e}finally{_L("get release write lock"),t()}}async delete(e){e=Ia(e),_L.trace("delete await write lock");const t=await this.store.lock.writeLock();let r;_L.trace("delete got write lock");try{try{r=await this.store.load(e)}catch(e){if(e.code!==wL)throw e}await this.store.patchOrCreate(e,{pubKey:void 0})}catch(e){if(e.code!==wL)throw e}finally{_L.trace("delete release write lock"),t()}this.dispatchEvent(new F_(CL,{detail:{peerId:e,publicKey:void 0,oldPublicKey:null==r?void 0:r.pubKey}}))}}const IL=se("libp2p:peer-store:metadata-book"),TL="change:metadata";class RL{constructor(e,t){this.dispatchEvent=e,this.store=t}async get(e){e=Ia(e),IL.trace("get await read lock");const t=await this.store.lock.readLock();IL.trace("get got read lock");try{return(await this.store.load(e)).metadata}catch(e){if(e.code!==wL)throw e}finally{IL.trace("get release read lock"),t()}return new Map}async getValue(e,t){e=Ia(e),IL.trace("getValue await read lock");const r=await this.store.lock.readLock();IL.trace("getValue got read lock");try{return(await this.store.load(e)).metadata.get(t)}catch(e){if(e.code!==wL)throw e}finally{IL.trace("getValue release write lock"),r()}}async set(e,t){if(e=Ia(e),!(t instanceof Map))throw IL.error("valid metadata must be provided to store data"),new wa("valid metadata must be provided",yL);IL.trace("set await write lock");const r=await this.store.lock.writeLock();let n;IL.trace("set got write lock");try{try{n=await this.store.load(e)}catch(e){if(e.code!==wL)throw e}await this.store.mergeOrCreate(e,{metadata:t})}finally{IL.trace("set release write lock"),r()}this.dispatchEvent(new F_(TL,{detail:{peerId:e,metadata:t,oldMetadata:null==n?new Map:n.metadata}}))}async setValue(e,t,r){if(e=Ia(e),"string"!=typeof t||!(r instanceof Uint8Array))throw IL.error("valid key and value must be provided to store data"),new wa("valid key and value must be provided",yL);IL.trace("setValue await write lock");const n=await this.store.lock.writeLock();let s,i;IL.trace("setValue got write lock");try{try{s=await this.store.load(e);const n=s.metadata.get(t);if(null!=n&&ii(r,n))return}catch(e){if(e.code!==wL)throw e}i=await this.store.mergeOrCreate(e,{metadata:new Map([[t,r]])})}finally{IL.trace("setValue release write lock"),n()}this.dispatchEvent(new F_(TL,{detail:{peerId:e,metadata:i.metadata,oldMetadata:null==s?new Map:s.metadata}}))}async delete(e){e=Ia(e),IL.trace("delete await write lock");const t=await this.store.lock.writeLock();let r;IL.trace("delete got write lock");try{try{r=await this.store.load(e)}catch(e){if(e.code!==wL)throw e}null!=r&&await this.store.patch(e,{metadata:new Map})}finally{IL.trace("delete release write lock"),t()}null!=r&&this.dispatchEvent(new F_(TL,{detail:{peerId:e,metadata:new Map,oldMetadata:r.metadata}}))}async deleteValue(e,t){e=Ia(e),IL.trace("deleteValue await write lock");const r=await this.store.lock.writeLock();let n,s;IL.trace("deleteValue got write lock");try{s=await this.store.load(e),n=s.metadata,n.delete(t),await this.store.patch(e,{metadata:n})}catch(e){if(e.code!==wL)throw e}finally{IL.trace("deleteValue release write lock"),r()}null!=n&&this.dispatchEvent(new F_(TL,{detail:{peerId:e,metadata:n,oldMetadata:null==s?new Map:s.metadata}}))}}const kL=se("libp2p:peer-store:proto-book"),UL="change:protocols";class DL{constructor(e,t){this.dispatchEvent=e,this.store=t}async get(e){kL.trace("get wait for read lock");const t=await this.store.lock.readLock();kL.trace("get got read lock");try{return(await this.store.load(e)).protocols}catch(e){if(e.code!==wL)throw e}finally{kL.trace("get release read lock"),t()}return[]}async set(e,t){if(e=Ia(e),!Array.isArray(t))throw kL.error("protocols must be provided to store data"),new wa("protocols must be provided",yL);kL.trace("set await write lock");const r=await this.store.lock.writeLock();let n,s;kL.trace("set got write lock");try{try{if(n=await this.store.load(e),new Set([...t]).size===n.protocols.length)return}catch(e){if(e.code!==wL)throw e}s=await this.store.patchOrCreate(e,{protocols:t}),kL("stored provided protocols for %p",e)}finally{kL.trace("set release write lock"),r()}this.dispatchEvent(new F_(UL,{detail:{peerId:e,protocols:s.protocols,oldProtocols:null==n?[]:n.protocols}}))}async add(e,t){if(e=Ia(e),!Array.isArray(t))throw kL.error("protocols must be provided to store data"),new wa("protocols must be provided",yL);kL.trace("add await write lock");const r=await this.store.lock.writeLock();let n,s;kL.trace("add got write lock");try{try{if(n=await this.store.load(e),new Set([...n.protocols,...t]).size===n.protocols.length)return}catch(e){if(e.code!==wL)throw e}s=await this.store.mergeOrCreate(e,{protocols:t}),kL("added provided protocols for %p",e)}finally{kL.trace("add release write lock"),r()}this.dispatchEvent(new F_(UL,{detail:{peerId:e,protocols:s.protocols,oldProtocols:null==n?[]:n.protocols}}))}async remove(e,t){if(e=Ia(e),!Array.isArray(t))throw kL.error("protocols must be provided to store data"),new wa("protocols must be provided",yL);kL.trace("remove await write lock");const r=await this.store.lock.writeLock();let n,s;kL.trace("remove got write lock");try{try{n=await this.store.load(e);const r=new Set(n.protocols);for(const e of t)r.delete(e);if(n.protocols.length===r.size)return;t=Array.from(r)}catch(e){if(e.code!==wL)throw e}s=await this.store.patchOrCreate(e,{protocols:t})}finally{kL.trace("remove release write lock"),r()}this.dispatchEvent(new F_(UL,{detail:{peerId:e,protocols:s.protocols,oldProtocols:null==n?[]:n.protocols}}))}async delete(e){e=Ia(e),kL.trace("delete await write lock");const t=await this.store.lock.writeLock();let r;kL.trace("delete got write lock");try{try{r=await this.store.load(e)}catch(e){if(e.code!==wL)throw e}await this.store.patchOrCreate(e,{protocols:[]})}finally{kL.trace("delete release write lock"),t()}null!=r&&this.dispatchEvent(new F_(UL,{detail:{peerId:e,protocols:[],oldProtocols:r.protocols}}))}}qa._configure(),za._configure(ja),Ga._configure($a);const PL=["uint64","int64","sint64","fixed64","sfixed64"];function LL(e){return function(e){for(const t of PL){if(null==e[t])continue;const r=e[t];e[t]=function(){return BigInt(r.call(this).toString())}}return e}(new za(e))}function NL(){return function(e){for(const t of PL){if(null==e[t])continue;const r=e[t];e[t]=function(e){return r.call(this,e.toString())}}return e}(Ga.create())}function OL(e,t){const r=LL(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}function FL(e,t){const r=NL();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var QL,xL,ML,HL;function KL(e,t){return function(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}("message",QL.LENGTH_DELIMITED,e,t)}!function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"}(QL||(QL={})),function(e){let t;e.codec=()=>(null==t&&(t=KL(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),null!=e.addresses)for(const r of e.addresses)t.uint32(10),ML.codec().encode(r,t);if(null!=e.protocols)for(const r of e.protocols)t.uint32(18),t.string(r);if(null!=e.metadata)for(const r of e.metadata)t.uint32(26),HL.codec().encode(r,t);null!=e.pubKey&&(t.uint32(34),t.bytes(e.pubKey)),null!=e.peerRecordEnvelope&&(t.uint32(42),t.bytes(e.peerRecordEnvelope)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={addresses:[],protocols:[],metadata:[]},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.addresses.push(ML.codec().decode(e,e.uint32()));break;case 2:r.protocols.push(e.string());break;case 3:r.metadata.push(HL.codec().decode(e,e.uint32()));break;case 4:r.pubKey=e.bytes();break;case 5:r.peerRecordEnvelope=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>FL(t,e.codec()),e.decode=t=>OL(t,e.codec())}(xL||(xL={})),function(e){let t;e.codec=()=>(null==t&&(t=KL(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.multiaddr&&e.multiaddr.byteLength>0&&(t.uint32(10),t.bytes(e.multiaddr)),null!=e.isCertified&&(t.uint32(16),t.bool(e.isCertified)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={multiaddr:new Uint8Array(0)},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.multiaddr=e.bytes();break;case 2:r.isCertified=e.bool();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>FL(t,e.codec()),e.decode=t=>OL(t,e.codec())}(ML||(ML={})),function(e){let t;e.codec=()=>(null==t&&(t=KL(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.key&&""!==e.key&&(t.uint32(10),t.string(e.key)),null!=e.value&&e.value.byteLength>0&&(t.uint32(18),t.bytes(e.value)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={key:"",value:new Uint8Array(0)},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.key=e.string();break;case 2:r.value=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>FL(t,e.codec()),e.decode=t=>OL(t,e.codec())}(HL||(HL={}));const VL=se("libp2p:peer-store:store"),zL="/peers/";class jL{constructor(e){this.components=e,this.lock=Km({name:"peer-store",singleProcess:!0})}_peerIdToDatastoreKey(e){if(null==e.type)throw VL.error("peerId must be an instance of peer-id to store data"),new wa("peerId must be an instance of peer-id",yL);const t=e.toCID().toString();return new Ao(`${zL}${t}`)}async has(e){return await this.components.datastore.has(this._peerIdToDatastoreKey(e))}async delete(e){await this.components.datastore.delete(this._peerIdToDatastoreKey(e))}async load(e){const t=await this.components.datastore.get(this._peerIdToDatastoreKey(e)),r=xL.decode(t),n=new Map;for(const e of r.metadata)n.set(e.key,e.value);return{...r,id:e,addresses:r.addresses.map((({multiaddr:e,isCertified:t})=>({multiaddr:mi(e),isCertified:t??!1}))),metadata:n,pubKey:r.pubKey??void 0,peerRecordEnvelope:r.peerRecordEnvelope??void 0}}async save(e){if(null!=e.pubKey&&null!=e.id.publicKey&&!ii(e.pubKey,e.id.publicKey))throw VL.error("peer publicKey bytes do not match peer id publicKey bytes"),new wa("publicKey bytes do not match peer id publicKey bytes",yL);const t=new Set,r=e.addresses.filter((e=>!t.has(e.multiaddr.toString())&&(t.add(e.multiaddr.toString()),!0))).sort(((e,t)=>e.multiaddr.toString().localeCompare(t.multiaddr.toString()))).map((({multiaddr:e,isCertified:t})=>({multiaddr:e.bytes,isCertified:t}))),n=[];[...e.metadata.keys()].sort().forEach((t=>{const r=e.metadata.get(t);null!=r&&n.push({key:t,value:r})}));const s=xL.encode({addresses:r,protocols:e.protocols.sort(),pubKey:e.pubKey,metadata:n,peerRecordEnvelope:e.peerRecordEnvelope});return await this.components.datastore.put(this._peerIdToDatastoreKey(e.id),s.subarray()),await this.load(e.id)}async patch(e,t){const r=await this.load(e);return await this._patch(e,t,r)}async patchOrCreate(e,t){let r;try{r=await this.load(e)}catch(t){if(t.code!==wL)throw t;r={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._patch(e,t,r)}async _patch(e,t,r){return await this.save({...r,...t,id:e})}async merge(e,t){const r=await this.load(e);return await this._merge(e,t,r)}async mergeOrCreate(e,t){let r;try{r=await this.load(e)}catch(t){if(t.code!==wL)throw t;r={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._merge(e,t,r)}async _merge(e,t,r){const n=new Map;return r.addresses.forEach((e=>{n.set(e.multiaddr.toString(),e.isCertified)})),(t.addresses??[]).forEach((e=>{const t=e.multiaddr.toString(),r=Boolean(n.get(t))||e.isCertified;n.set(t,r)})),await this.save({id:e,addresses:Array.from(n.entries()).map((([e,t])=>({multiaddr:mi(e),isCertified:t}))),protocols:Array.from(new Set([...r.protocols??[],...t.protocols??[]])),metadata:new Map([...r.metadata?.entries()??[],...t.metadata?.entries()??[]]),pubKey:t.pubKey??(null!=r?r.pubKey:void 0),peerRecordEnvelope:t.peerRecordEnvelope??(null!=r?r.peerRecordEnvelope:void 0)})}async*all(){for await(const e of this.components.datastore.queryKeys({prefix:zL})){const t=e.toString().split("/")[2],r=j.decode(t);yield this.load(Ra(r))}}}var GL,$L;!function(e){let t;e.codec=()=>(null==t&&(t=KL(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),null!=e.tags)for(const r of e.tags)t.uint32(10),$L.codec().encode(r,t);!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={tags:[]},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();if(t>>>3==1)r.tags.push($L.codec().decode(e,e.uint32()));else e.skipType(7&t)}return r}))),t),e.encode=t=>FL(t,e.codec()),e.decode=t=>OL(t,e.codec())}(GL||(GL={})),function(e){let t;e.codec=()=>(null==t&&(t=KL(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.name&&""!==e.name&&(t.uint32(10),t.string(e.name)),null!=e.value&&(t.uint32(16),t.uint32(e.value)),null!=e.expiry&&(t.uint32(24),t.uint64(e.expiry)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={name:""},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.name=e.string();break;case 2:r.value=e.uint32();break;case 3:r.expiry=e.uint64();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>FL(t,e.codec()),e.decode=t=>OL(t,e.codec())}($L||($L={}));const qL=se("libp2p:peer-store");class WL extends N_{constructor(e,t={}){super(),this.components=e,this.store=new jL(e),this.addressBook=new vL(this.dispatchEvent.bind(this),this.store,t.addressFilter),this.keyBook=new SL(this.dispatchEvent.bind(this),this.store),this.metadataBook=new RL(this.dispatchEvent.bind(this),this.store),this.protoBook=new DL(this.dispatchEvent.bind(this),this.store)}async forEach(e){qL.trace("getPeers await read lock");const t=await this.store.lock.readLock();qL.trace("getPeers got read lock");try{for await(const t of this.store.all())t.id.equals(this.components.peerId)||e(t)}finally{qL.trace("getPeers release read lock"),t()}}async all(){const e=[];return await this.forEach((t=>{e.push(t)})),e}async delete(e){qL.trace("delete await write lock");const t=await this.store.lock.writeLock();qL.trace("delete got write lock");try{await this.store.delete(e)}finally{qL.trace("delete release write lock"),t()}}async get(e){qL.trace("get await read lock");const t=await this.store.lock.readLock();qL.trace("get got read lock");try{return await this.store.load(e)}finally{qL.trace("get release read lock"),t()}}async has(e){qL.trace("has await read lock");const t=await this.store.lock.readLock();qL.trace("has got read lock");try{return await this.store.has(e)}finally{qL.trace("has release read lock"),t()}}async tagPeer(e,t,r={}){const n=r.value??0,s=Math.round(n),i=r.ttl??void 0;if(s!==n||s<0||s>100)throw new wa("Tag value must be between 0-100","ERR_TAG_VALUE_OUT_OF_BOUNDS");const o=await this.metadataBook.getValue(e,"tags");let a=[];null!=o&&(a=GL.decode(o).tags),a=a.filter((e=>e.name!==t)),a.push({name:t,value:s,expiry:null==i?void 0:BigInt(Date.now()+i)}),await this.metadataBook.setValue(e,"tags",GL.encode({tags:a}).subarray())}async unTagPeer(e,t){const r=await this.metadataBook.getValue(e,"tags");let n=[];null!=r&&(n=GL.decode(r).tags),n=n.filter((e=>e.name!==t)),await this.metadataBook.setValue(e,"tags",GL.encode({tags:n}).subarray())}async getTags(e){const t=await this.metadataBook.getValue(e,"tags");let r=[];null!=t&&(r=GL.decode(t).tags);const n=BigInt(Date.now()),s=r.filter((e=>null==e.expiry||e.expiry>n));return s.length!==r.length&&await this.metadataBook.setValue(e,"tags",GL.encode({tags:s}).subarray()),s.map((e=>({name:e.name,value:e.value??0})))}}class YL{constructor(e){this.dht=e}async provide(e){await Qu(this.dht.provide(e))}async*findProviders(e,t={}){for await(const r of this.dht.findProviders(e,t))"PROVIDER"===r.name&&(yield*r.providers)}async put(e,t,r){await Qu(this.dht.put(e,t,r))}async get(e,t){for await(const r of this.dht.get(e,t))if("VALUE"===r.name)return r.value;throw ie(new Error("Not found"),"ERR_NOT_FOUND")}}class XL{constructor(e={}){this._started=!1,this._peerId=e.peerId,this._addressManager=e.addressManager,this._peerStore=e.peerStore,this._upgrader=e.upgrader,this._metrics=e.metrics,this._registrar=e.registrar,this._connectionManager=e.connectionManager,this._transportManager=e.transportManager,this._connectionGater=e.connectionGater,this._contentRouting=e.contentRouting,this._peerRouting=e.peerRouting,this._datastore=e.datastore,this._connectionProtector=e.connectionProtector,this._dht=e.dht,this._pubsub=e.pubsub,this._dialer=e.dialer}isStarted(){return this._started}async beforeStart(){await Promise.all(Object.values(this).filter((e=>DU(e))).map((async e=>{null!=e.beforeStart&&await e.beforeStart()})))}async start(){await Promise.all(Object.values(this).filter((e=>DU(e))).map((async e=>{await e.start()}))),this._started=!0}async afterStart(){await Promise.all(Object.values(this).filter((e=>DU(e))).map((async e=>{null!=e.afterStart&&await e.afterStart()})))}async beforeStop(){await Promise.all(Object.values(this).filter((e=>DU(e))).map((async e=>{null!=e.beforeStop&&await e.beforeStop()})))}async stop(){await Promise.all(Object.values(this).filter((e=>DU(e))).map((async e=>{await e.stop()}))),this._started=!1}async afterStop(){await Promise.all(Object.values(this).filter((e=>DU(e))).map((async e=>{null!=e.afterStop&&await e.afterStop()})))}get peerId(){if(null==this._peerId)throw ie(new Error("peerId not set"),"ERR_SERVICE_MISSING");return this._peerId}set peerId(e){this._peerId=e}get addressManager(){if(null==this._addressManager)throw ie(new Error("addressManager not set"),"ERR_SERVICE_MISSING");return this._addressManager}set addressManager(e){this._addressManager=e}get peerStore(){if(null==this._peerStore)throw ie(new Error("peerStore not set"),"ERR_SERVICE_MISSING");return this._peerStore}set peerStore(e){this._peerStore=e}get upgrader(){if(null==this._upgrader)throw ie(new Error("upgrader not set"),"ERR_SERVICE_MISSING");return this._upgrader}set upgrader(e){this._upgrader=e}get registrar(){if(null==this._registrar)throw ie(new Error("registrar not set"),"ERR_SERVICE_MISSING");return this._registrar}set registrar(e){this._registrar=e}get connectionManager(){if(null==this._connectionManager)throw ie(new Error("connectionManager not set"),"ERR_SERVICE_MISSING");return this._connectionManager}set connectionManager(e){this._connectionManager=e}get transportManager(){if(null==this._transportManager)throw ie(new Error("transportManager not set"),"ERR_SERVICE_MISSING");return this._transportManager}set transportManager(e){this._transportManager=e}get connectionGater(){if(null==this._connectionGater)throw ie(new Error("connectionGater not set"),"ERR_SERVICE_MISSING");return this._connectionGater}set connectionGater(e){this._connectionGater=e}get contentRouting(){if(null==this._contentRouting)throw ie(new Error("contentRouting not set"),"ERR_SERVICE_MISSING");return this._contentRouting}set contentRouting(e){this._contentRouting=e}get peerRouting(){if(null==this._peerRouting)throw ie(new Error("peerRouting not set"),"ERR_SERVICE_MISSING");return this._peerRouting}set peerRouting(e){this._peerRouting=e}get datastore(){if(null==this._datastore)throw ie(new Error("datastore not set"),"ERR_SERVICE_MISSING");return this._datastore}set datastore(e){this._datastore=e}get connectionProtector(){return this._connectionProtector}set connectionProtector(e){this._connectionProtector=e}get dialer(){if(null==this._dialer)throw ie(new Error("dialer not set"),"ERR_SERVICE_MISSING");return this._dialer}set dialer(e){this._dialer=e}get metrics(){return this._metrics}set metrics(e){this._metrics=e}get dht(){return this._dht}set dht(e){this._dht=e}get pubsub(){return this._pubsub}set pubsub(e){this._pubsub=e}}var JL=r(73692);const ZL=globalThis.fetch,eN=globalThis.Headers;globalThis.Request,globalThis.Response;function tN(e,t,r){return`${e}?name=${t}&type=${r}`}async function rN(e,t){const r=await ZL(e,{headers:new eN({accept:"application/dns-json"}),signal:t});return await r.json()}function nN(e,t){return`${t}_${e}`}const sN=Object.assign(R("dns-over-http-resolver"),{error:R("dns-over-http-resolver:error")});var iN=class{constructor(e={}){this._cache=new JL({max:e?.maxCache??100}),this._TXTcache=new JL({max:e?.maxCache??100}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"],this._request=e.request??rN,this._abortControllers=[]}cancel(){this._abortControllers.forEach((e=>e.abort()))}getServers(){return this._servers}_getShuffledServers(){const e=[...this._servers];for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*t),n=e[t];e[t]=e[r],e[r]=n}return e}setServers(e){this._servers=e}async resolve(e,t="A"){switch(t){case"A":return await this.resolve4(e);case"AAAA":return await this.resolve6(e);case"TXT":return await this.resolveTxt(e);default:throw new Error(`${t} is not supported`)}}async resolve4(e){const t="A",r=this._cache.get(nN(e,t));if(null!=r)return r;let n=!1;for(const r of this._getShuffledServers()){const s=new AbortController;this._abortControllers.push(s);try{const n=await this._request(tN(r,e,t),s.signal),i=n.Answer.map((e=>e.data)),o=Math.min(...n.Answer.map((e=>e.TTL)));return this._cache.set(nN(e,t),i,{ttl:o}),i}catch(i){s.signal.aborted&&(n=!0),sN.error(`${r} could not resolve ${e} record ${t}`)}finally{this._abortControllers=this._abortControllers.filter((e=>e!==s))}}if(n)throw Object.assign(new Error("queryA ECANCELLED"),{code:"ECANCELLED"});throw new Error(`Could not resolve ${e} record ${t}`)}async resolve6(e){const t="AAAA",r=this._cache.get(nN(e,t));if(null!=r)return r;let n=!1;for(const r of this._getShuffledServers()){const s=new AbortController;this._abortControllers.push(s);try{const n=await this._request(tN(r,e,t),s.signal),i=n.Answer.map((e=>e.data)),o=Math.min(...n.Answer.map((e=>e.TTL)));return this._cache.set(nN(e,t),i,{ttl:o}),i}catch(i){s.signal.aborted&&(n=!0),sN.error(`${r} could not resolve ${e} record ${t}`)}finally{this._abortControllers=this._abortControllers.filter((e=>e!==s))}}if(n)throw Object.assign(new Error("queryAaaa ECANCELLED"),{code:"ECANCELLED"});throw new Error(`Could not resolve ${e} record ${t}`)}async resolveTxt(e){const t="TXT",r=this._TXTcache.get(nN(e,t));if(null!=r)return r;let n=!1;for(const r of this._getShuffledServers()){const s=new AbortController;this._abortControllers.push(s);try{const n=await this._request(tN(r,e,t),s.signal),i=n.Answer.map((e=>[e.data.replace(/['"]+/g,"")])),o=Math.min(...n.Answer.map((e=>e.TTL)));return this._TXTcache.set(nN(e,t),i,{ttl:o}),i}catch(i){s.signal.aborted&&(n=!0),sN.error(`${r} could not resolve ${e} record ${t}`)}finally{this._abortControllers=this._abortControllers.filter((e=>e!==s))}}if(n)throw Object.assign(new Error("queryTxt ECANCELLED"),{code:"ECANCELLED"});throw new Error(`Could not resolve ${e} record ${t}`)}clearCache(){this._cache.clear(),this._TXTcache.clear()}},oN=iN;const{code:aN}=Ns("dnsaddr");const AN={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:e=>e},connectionManager:{maxConnections:300,minConnections:50,autoDial:!0,autoDialInterval:1e4,maxParallelDials:100,maxDialsPerPeer:4,dialTimeout:3e4,inboundUpgradeTimeout:3e4,resolvers:{dnsaddr:async function(e,t={}){const r=new oN;null!=t.signal&&t.signal.addEventListener("abort",(()=>{r.cancel()}));const n=e.getPeerId(),[,s]=e.stringTuples().find((([e])=>e===aN))??[];if(null==s)throw new Error("No hostname found in multiaddr");let i=(await r.resolveTxt(`_dnsaddr.${s}`)).flat().map((e=>e.split("=")[1]));return null!=n&&(i=i.filter((e=>e.includes(n)))),i}},addressSorter:$D},connectionGater:{},transportManager:{faultTolerance:_U.FATAL_ALL},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},nat:{enabled:!0,ttl:7200,keepAlive:!0},relay:{enabled:!0,advertise:{bootDelay:9e5,enabled:!1,ttl:18e5},hop:{enabled:!1,active:!1,timeout:3e4},autoRelay:{enabled:!1,maxListeners:2}},identify:{protocolPrefix:"ipfs",host:{agentVersion:jP},timeout:6e4,maxInboundStreams:1,maxOutboundStreams:1,maxPushIncomingStreams:1,maxPushOutgoingStreams:1},ping:{protocolPrefix:"ipfs",maxInboundStreams:1,maxOutboundStreams:1,timeout:1e4},fetch:{protocolPrefix:"libp2p",maxInboundStreams:1,maxOutboundStreams:1,timeout:1e4}};var cN;!function(e){let t;e.codec=()=>(null==t&&(t=aA(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),(!0===r.writeDefaults||null!=e.id&&e.id.byteLength>0)&&(t.uint32(10),t.bytes(e.id)),null!=e.pubKey&&(t.uint32(18),t.bytes(e.pubKey)),null!=e.privKey&&(t.uint32(26),t.bytes(e.privKey)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={id:new Uint8Array(0)},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.id=e.bytes();break;case 2:r.pubKey=e.bytes();break;case 3:r.privKey=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>Za(t,e.codec()),e.decode=t=>Ja(t,e.codec())}(cN||(cN={}));const lN=async()=>{const e=await Zl("Ed25519"),t=await uN(e);if("Ed25519"===t.type)return t;throw new Error(`Generated unexpected PeerId type "${t.type}"`)};async function uN(e){return await ka(tu(e.public),(t=e,Jl(r=(r??"rsa").toLowerCase()),t.bytes));var t,r}class hN extends N_{get[CU](){return!0}get[Symbol.toStringTag](){return"@libp2p/dummy-dht"}get wan(){throw ie(new Error(PU.DHT_DISABLED),LU.DHT_DISABLED)}get lan(){throw ie(new Error(PU.DHT_DISABLED),LU.DHT_DISABLED)}get(){throw ie(new Error(PU.DHT_DISABLED),LU.DHT_DISABLED)}findProviders(){throw ie(new Error(PU.DHT_DISABLED),LU.DHT_DISABLED)}findPeer(){throw ie(new Error(PU.DHT_DISABLED),LU.DHT_DISABLED)}getClosestPeers(){throw ie(new Error(PU.DHT_DISABLED),LU.DHT_DISABLED)}provide(){throw ie(new Error(PU.DHT_DISABLED),LU.DHT_DISABLED)}put(){throw ie(new Error(PU.DHT_DISABLED),LU.DHT_DISABLED)}async getMode(){throw ie(new Error(PU.DHT_DISABLED),LU.DHT_DISABLED)}async setMode(){throw ie(new Error(PU.DHT_DISABLED),LU.DHT_DISABLED)}async refreshRoutingTable(){throw ie(new Error(PU.DHT_DISABLED),LU.DHT_DISABLED)}}class dN extends N_{constructor(){super(...arguments),this.topicValidators=new Map}isStarted(){return!1}start(){}stop(){}get globalSignaturePolicy(){throw ie(new Error(PU.PUBSUB_DISABLED),LU.ERR_PUBSUB_DISABLED)}get multicodecs(){throw ie(new Error(PU.PUBSUB_DISABLED),LU.ERR_PUBSUB_DISABLED)}getPeers(){throw ie(new Error(PU.PUBSUB_DISABLED),LU.ERR_PUBSUB_DISABLED)}getTopics(){throw ie(new Error(PU.PUBSUB_DISABLED),LU.ERR_PUBSUB_DISABLED)}subscribe(){throw ie(new Error(PU.PUBSUB_DISABLED),LU.ERR_PUBSUB_DISABLED)}unsubscribe(){throw ie(new Error(PU.PUBSUB_DISABLED),LU.ERR_PUBSUB_DISABLED)}getSubscribers(){throw ie(new Error(PU.PUBSUB_DISABLED),LU.ERR_PUBSUB_DISABLED)}async publish(){throw ie(new Error(PU.PUBSUB_DISABLED),LU.ERR_PUBSUB_DISABLED)}}var fN=r(35103);const pN=se("libp2p:dialer:dial-request");class gN{constructor(e){const{addrs:t,dialAction:r,dialer:n}=e;this.addrs=t,this.dialer=n,this.dialAction=r}async run(e={}){const t=this.dialer.getTokens(this.addrs.length);if(t.length<1)throw ie(new Error("No dial tokens available"),LU.ERR_NO_DIAL_TOKENS);const r=new fN;for(const e of t)r.push(e).catch((e=>{pN.error(e)}));const n=this.addrs.map((()=>{const e=new AbortController;try{(0,xU.setMaxListeners)?.(1/0,e.signal)}catch{}return e}));if(null!=e.signal)try{(0,xU.setMaxListeners)?.(1/0,e.signal)}catch{}let s=0,i=!1;try{return await Promise.any(this.addrs.map((async(o,a)=>{const A=await r.shift();if(i)throw this.dialer.releaseToken(t.splice(t.indexOf(A),1)[0]),ie(new Error("dialAction already succeeded"),LU.ERR_ALREADY_SUCCEEDED);const c=n[a];if(null==c)throw ie(new Error("dialAction did not come with an AbortController"),LU.ERR_INVALID_PARAMETERS);let l;try{const i=c.signal;l=await this.dialAction(o,{...e,signal:null!=e.signal?(0,co.anySignal)([i,e.signal]):i}),n[a]=void 0}finally{s++,this.addrs.length-s>=t.length?r.push(A).catch((e=>{pN.error(e)})):this.dialer.releaseToken(t.splice(t.indexOf(A),1)[0])}if(null==l)throw ie(new Error("dialAction led to empty object"),LU.ERR_TRANSPORT_DIAL_FAILED);return i=!0,l})))}finally{n.forEach((e=>{void 0!==e&&e.abort()})),t.forEach((e=>this.dialer.releaseToken(e)))}}}const yN=se("libp2p:dialer");class wN{constructor(e,t={}){this.started=!1,this.addressSorter=t.addressSorter??$D,this.maxAddrsToDial=t.maxAddrsToDial??25,this.timeout=t.dialTimeout??3e4,this.maxDialsPerPeer=t.maxDialsPerPeer??4,this.tokens=[...new Array(t.maxParallelDials??100)].map(((e,t)=>t)),this.components=e,this.pendingDials=vP({name:"libp2p_dialler_pending_dials",metrics:e.metrics}),this.pendingDialTargets=vP({name:"libp2p_dialler_pending_dial_targets",metrics:e.metrics});for(const[e,r]of Object.entries(t.resolvers??{}))fi.set(e,r)}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1;for(const e of this.pendingDials.values())try{e.controller.abort()}catch(e){yN.error(e)}this.pendingDials.clear();for(const e of this.pendingDialTargets.values())e.abort();this.pendingDialTargets.clear()}async dial(e,t={}){const{peerId:r,multiaddr:n}=nD(e);if(null!=r){if(this.components.peerId.equals(r))throw ie(new Error("Tried to dial self"),LU.ERR_DIALED_SELF);if(null!=n&&(yN("storing multiaddrs %p",r,n),await this.components.peerStore.addressBook.add(r,[n])),await this.components.connectionGater.denyDialPeer(r))throw ie(new Error("The dial request is blocked by gater.allowDialPeer"),LU.ERR_PEER_DIAL_INTERCEPTED)}yN("creating dial target for %p",r);const s=new AbortController,i=bN();this.pendingDialTargets.set(i,s);let o,a=s.signal;null!=t.signal&&(a=(0,co.anySignal)([a,t.signal]));try{o=await this._createDialTarget({peerId:r,multiaddr:n},{...t,signal:a})}finally{this.pendingDialTargets.delete(i)}if(0===o.addrs.length)throw ie(new Error("The dial request has no valid addresses"),LU.ERR_NO_VALID_ADDRESSES);const A=this.pendingDials.get(o.id)??this._createPendingDial(o,t);try{const e=await A.promise;return yN("dial succeeded to %s",o.id),e}catch(e){throw yN("dial failed to %s",o.id,e),A.controller.signal.aborted&&(e.code=LU.ERR_TIMEOUT),yN.error(e),e}finally{A.destroy()}}async _createDialTarget(e,t){let r=[];if(yi(e.multiaddr)&&r.push(e.multiaddr),!yi(e.multiaddr)&&ba(e.peerId)&&r.push(...await this._loadAddresses(e.peerId)),r=(await Promise.all(r.map((async e=>await this._resolve(e,t))))).flat().filter((e=>Boolean(this.components.transportManager.transportForMultiaddr(e)))),r=[...new Set(r.map((e=>e.toString())))].map((e=>mi(e))),r.length>this.maxAddrsToDial)throw ie(new Error("dial with more addresses than allowed"),LU.ERR_TOO_MANY_ADDRESSES);const n=ba(e.peerId)?e.peerId:void 0;if(null!=n){const e=`/p2p/${n.toString()}`;r=r.map((t=>{const r=t.getPeerId();return null!=r&&n.equals(r)?t:t.encapsulate(e)}))}return{id:null==n?bN():n.toString(),addrs:r}}async _loadAddresses(e){const t=await this.components.peerStore.addressBook.get(e);return(await Promise.all(t.map((async t=>!await this.components.connectionGater.denyDialMultiaddr(e,t.multiaddr)&&t)))).filter(mN).sort(this.addressSorter).map((e=>e.multiaddr))}_createPendingDial(e,t={}){const r=new gN({addrs:e.addrs,dialAction:async(e,t={})=>{if(!0===t.signal?.aborted)throw ie(new Error("already aborted"),LU.ERR_ALREADY_ABORTED);return await this.components.transportManager.dial(e,t).catch((t=>{throw yN.error("dial to %s failed",e,t),t}))},dialer:this}),n=new Bs.TimeoutController(this.timeout),s=[n.signal];null!=t.signal&&s.push(t.signal);const i=(0,co.anySignal)(s);try{(0,xU.setMaxListeners)?.(1/0,i)}catch{}const o={dialRequest:r,controller:n,promise:r.run({...t,signal:i}),destroy:()=>{n.clear(),this.pendingDials.delete(e.id)}};return this.pendingDials.set(e.id,o),o}getTokens(e){const t=Math.min(e,this.maxDialsPerPeer,this.tokens.length),r=this.tokens.splice(0,t);return yN("%d tokens request, returning %d, %d remaining",e,t,this.tokens.length),r}releaseToken(e){this.tokens.includes(e)||(yN("token %d released",e),this.tokens.push(e))}async _resolve(e,t){if(!e.protoNames().includes("dnsaddr"))return[e];const r=await this._resolveRecord(e,t);return(await Promise.all(r.map((async e=>await this._resolve(e,t))))).flat().reduce(((e,t)=>(null==e.find((e=>e.equals(t)))&&e.push(t),e)),[])}async _resolveRecord(e,t){try{e=mi(e.toString());return await e.resolve(t)}catch(t){return yN.error(`multiaddr ${e.toString()} could not be resolved`,t),[]}}}function mN(e){return Boolean(e)}function bN(){return`${parseInt(String(1e9*Math.random()),10).toString()}${Date.now()}`}const EN=se("libp2p");class vN extends N_{constructor(e){super(),this.started=!1,this.peerId=e.peerId;const t=this.components=new XL({peerId:e.peerId,datastore:e.datastore??new Xu,connectionGater:{denyDialPeer:async()=>await Promise.resolve(!1),denyDialMultiaddr:async()=>await Promise.resolve(!1),denyInboundConnection:async()=>await Promise.resolve(!1),denyOutboundConnection:async()=>await Promise.resolve(!1),denyInboundEncryptedConnection:async()=>await Promise.resolve(!1),denyOutboundEncryptedConnection:async()=>await Promise.resolve(!1),denyInboundUpgradedConnection:async()=>await Promise.resolve(!1),denyOutboundUpgradedConnection:async()=>await Promise.resolve(!1),filterMultiaddrForPeer:async()=>await Promise.resolve(!0),...e.connectionGater}});t.peerStore=new WL(t,{addressFilter:this.components.connectionGater.filterMultiaddrForPeer,...e.peerStore}),this.services=[t],null!=e.metrics&&(this.metrics=this.components.metrics=this.configureComponent(e.metrics(this.components))),this.peerStore=this.components.peerStore,this.peerStore.addEventListener("peer",(e=>{const{detail:t}=e;this.dispatchEvent(new F_("peer:discovery",{detail:t}))})),null!=e.connectionProtector&&(this.components.connectionProtector=e.connectionProtector(t)),this.components.upgrader=new KP(this.components,{connectionEncryption:(e.connectionEncryption??[]).map((e=>this.configureComponent(e(this.components)))),muxers:(e.streamMuxers??[]).map((e=>this.configureComponent(e(this.components)))),inboundUpgradeTimeout:e.connectionManager.inboundUpgradeTimeout}),this.components.dialer=new wN(this.components,e.connectionManager),this.connectionManager=this.components.connectionManager=new oD(this.components,e.connectionManager),this.components.connectionManager.addEventListener("peer:disconnect",(e=>{this.dispatchEvent(new F_("peer:disconnect",{detail:e.detail}))})),this.components.connectionManager.addEventListener("peer:connect",(e=>{this.dispatchEvent(new F_("peer:connect",{detail:e.detail}))})),this.registrar=this.components.registrar=new xP(this.components),this.components.transportManager=new _P(this.components,e.transportManager),this.components.addressManager=new zU(this.components,e.addresses),this.configureComponent(new pL(this.components)),this.configureComponent(new lD(this.components,{enabled:e.connectionManager.autoDial,minConnections:e.connectionManager.minConnections,autoDialInterval:e.connectionManager.autoDialInterval}));const r=pP.generateOptions();this.keychain=this.configureComponent(new pP(this.components,{...r,...e.keychain})),this.services.push(new dL(this.components,e.nat)),e.transports.forEach((e=>{this.components.transportManager.add(this.configureComponent(e(this.components)))})),this.identifyService=new $P(this.components,{...e.identify}),this.configureComponent(this.identifyService),null!=e.dht?this.dht=this.components.dht=e.dht(this.components):this.dht=new hN,null!=e.pubsub?this.pubsub=this.components.pubsub=e.pubsub(this.components):this.pubsub=new dN;const n=(e.peerRouters??[]).map((e=>this.configureComponent(e(this.components))));null!=e.dht&&(n.push(this.configureComponent(new gL(this.dht))),this.dht.addEventListener("peer",(e=>{this.onDiscoveryPeer(e)}))),this.peerRouting=this.components.peerRouting=this.configureComponent(new HU(this.components,{...e.peerRouting,routers:n}));const s=(e.contentRouters??[]).map((e=>this.configureComponent(e(this.components))));null!=e.dht&&s.push(this.configureComponent(new YL(this.dht))),this.contentRouting=this.components.contentRouting=this.configureComponent(new KU(this.components,{routers:s})),e.relay.enabled&&(this.components.transportManager.add(this.configureComponent(new _D(this.components,e.relay))),this.configureComponent(new JD(this.components,{addressSorter:e.connectionManager.addressSorter,...e.relay}))),this.fetchService=this.configureComponent(new XP(this.components,{...e.fetch})),this.pingService=this.configureComponent(new ZP(this.components,{...e.ping}));for(const t of e.peerDiscovery??[]){this.configureComponent(t(this.components)).addEventListener("peer",(e=>{this.onDiscoveryPeer(e)}))}}configureComponent(e){return DU(e)&&this.services.push(e),e}async start(){if(!this.started){this.started=!0,EN("libp2p is starting");try{await Promise.all(this.services.map((async e=>{null!=e.beforeStart&&await e.beforeStart()}))),await Promise.all(this.services.map((e=>e.start()))),await Promise.all(this.services.map((async e=>{null!=e.afterStart&&await e.afterStart()}))),EN("libp2p has started")}catch(e){throw EN.error("An error occurred starting libp2p",e),await this.stop(),e}}}async stop(){this.started&&(EN("libp2p is stopping"),this.started=!1,await Promise.all(this.services.map((async e=>{null!=e.beforeStop&&await e.beforeStop()}))),await Promise.all(this.services.map((e=>e.stop()))),await Promise.all(this.services.map((async e=>{null!=e.afterStop&&await e.afterStop()}))),EN("libp2p has stopped"))}isStarted(){return this.started}getConnections(e){return this.components.connectionManager.getConnections(e)}getPeers(){const e=new eD;for(const t of this.components.connectionManager.getConnections())e.add(t.remotePeer);return Array.from(e)}async dial(e,t={}){return await this.components.connectionManager.openConnection(e,t)}async dialProtocol(e,t,r={}){if(null==t)throw ie(new Error("no protocols were provided to open a stream"),LU.ERR_INVALID_PROTOCOLS_FOR_STREAM);if(0===(t=Array.isArray(t)?t:[t]).length)throw ie(new Error("no protocols were provided to open a stream"),LU.ERR_INVALID_PROTOCOLS_FOR_STREAM);const n=await this.dial(e,r);return await n.newStream(t,r)}getMultiaddrs(){return this.components.addressManager.getAddresses()}getProtocols(){return this.components.registrar.getProtocols()}async hangUp(e){yi(e)&&(e=Ta(e.getPeerId()??"")),await this.components.connectionManager.closeConnections(e)}async getPublicKey(e,t={}){if(EN("getPublicKey %p",e),null!=e.publicKey)return e.publicKey;const r=await this.peerStore.get(e);if(null!=r.pubKey)return r.pubKey;if(null==this.dht)throw ie(new Error("Public key was not in the peer store and the DHT is not enabled"),LU.ERR_NO_ROUTERS_AVAILABLE);const n=Fs([vs("/pk/"),e.multihash.digest]);for await(const r of this.dht.get(n,t))if("VALUE"===r.name){const t=eu(r.value);return await this.peerStore.keyBook.set(e,r.value),t.bytes}throw ie(new Error(`Node not responding with its public key: ${e.toString()}`),LU.ERR_INVALID_RECORD)}async fetch(e,t,r={}){if(yi(e)){const t=Ta(e.getPeerId()??"");await this.components.peerStore.addressBook.add(t,[e]),e=t}return await this.fetchService.fetch(e,t,r)}async ping(e,t={}){if(yi(e)){const t=Ta(e.getPeerId()??"");await this.components.peerStore.addressBook.add(t,[e]),e=t}return await this.pingService.ping(e,t)}async handle(e,t,r){Array.isArray(e)||(e=[e]),await Promise.all(e.map((async e=>{await this.components.registrar.handle(e,t,r)})))}async unhandle(e){Array.isArray(e)||(e=[e]),await Promise.all(e.map((async e=>{await this.components.registrar.unhandle(e)})))}async register(e,t){return await this.registrar.register(e,t)}unregister(e){this.registrar.unregister(e)}onDiscoveryPeer(e){const{detail:t}=e;t.id.toString()!==this.peerId.toString()?(t.multiaddrs.length>0&&this.components.peerStore.addressBook.add(t.id,t.multiaddrs).catch((e=>EN.error(e))),t.protocols.length>0&&this.components.peerStore.protoBook.set(t.id,t.protocols).catch((e=>EN.error(e))),this.dispatchEvent(new F_("peer:discovery",{detail:t}))):EN.error(new Error(LU.ERR_DISCOVERED_SELF))}}async function BN(e){if(null==e.peerId){const t=e.datastore;if(null!=t)try{const r=new pP({datastore:t},{...pP.generateOptions(),...e.keychain??{}});e.peerId=await r.exportPeerId("self")}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}}return null==e.peerId&&(e.peerId=await lN()),new vN(function(e){const t=I(AN,e);if(null==t.transports||t.transports.length<1)throw ie(new Error(PU.ERR_TRANSPORTS_REQUIRED),LU.ERR_TRANSPORTS_REQUIRED);if(null==t.connectionEncryption||0===t.connectionEncryption.length)throw ie(new Error(PU.CONN_ENCRYPTION_REQUIRED),LU.CONN_ENCRYPTION_REQUIRED);if(null===t.connectionProtector&&null!=globalThis.process?.env?.LIBP2P_FORCE_PNET)throw ie(new Error(PU.ERR_PROTECTOR_REQUIRED),LU.ERR_PROTECTOR_REQUIRED);return t.identify.host.agentVersion===jP&&(oL||sL?t.identify.host.agentVersion+=` UserAgent=${globalThis.process.version}`:(nL||aL||iL||AL)&&(t.identify.host.agentVersion+=` UserAgent=${globalThis.navigator.userAgent}`)),t}(e))}var _N=r(99507);const CN="/dht/provider",SN=20,IN=3,TN=Number(3e5),RN=Number(3e4),kN=Number(3e5),UN=Number(3e4),DN=Number(3e4),PN=vs("/pk/");function LN(e){return{...e,multiaddrs:e.multiaddrs.filter((e=>{const[[t,r]]=e.stringTuples();if(53===t||54===t||55===t)return"localhost"!==r;if(4!==t&&6!==t)return!1;if(null==r)return!1;const n=jD(r);return null==n||!n}))}}function NN(e){return{...e,multiaddrs:e.multiaddrs.filter((e=>{const[[t,r]]=e.stringTuples();if("localhost"===r)return!0;if(4!==t&&6!==t)return!1;if(null==r)return!1;const n=jD(r);return null!=n&&n}))}}async function ON(e){return(await $n.digest(e)).digest}async function FN(e){return await ON(e.toBytes())}function QN(e){return new Ao(`/dht/record/${Ts(e,"base32")}`,!1)}function xN(e,t){const r=new Date;return new ah(e,t,r).serialize()}class MN{constructor(e,t){const{kBucketSize:r,pingTimeout:n,lan:s,pingConcurrency:i,protocol:o,tagName:a,tagValue:A}=t;this.components=e,this.log=se(`libp2p:kad-dht:${s?"lan":"wan"}:routing-table`),this.kBucketSize=r??20,this.pingTimeout=n??1e4,this.pingConcurrency=i??10,this.lan=s,this.running=!1,this.protocol=o,this.tagName=a??"kad-close",this.tagValue=A??50;const c=()=>{this.metrics?.pingQueueSize.update(this.pingQueue.size),this.metrics?.pingRunning.update(this.pingQueue.pending)};this.pingQueue=new ua({concurrency:this.pingConcurrency}),this.pingQueue.addListener("add",c),this.pingQueue.addListener("next",c),this._onPing=this._onPing.bind(this)}isStarted(){return this.running}async start(){this.running=!0,null!=this.components.metrics&&(this.metrics={routingTableSize:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_routing_table_size`),pingQueueSize:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_ping_queue_size`),pingRunning:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_ping_running`)});const e=new _N({localNodeId:await FN(this.components.peerId),numberOfNodesPerKBucket:this.kBucketSize,numberOfNodesToPing:1});this.kb=e,e.on("ping",this._onPing),this._tagPeers(e)}async stop(){this.running=!1,this.pingQueue.clear(),this.kb=void 0}_tagPeers(e){let t=new eD;const r=function(e,t=100){let r;return()=>{clearTimeout(r),r=setTimeout((()=>e()),t)}}((()=>{const r=new eD(e.closest(e.localNodeId,20).map((e=>e.peer))),n=r.difference(t),s=t.difference(r);Promise.resolve().then((async()=>{for(const e of n)await this.components.peerStore.tagPeer(e,this.tagName,{value:this.tagValue});for(const e of s)await this.components.peerStore.unTagPeer(e,this.tagName)})).catch((e=>{this.log.error("Could not update peer tags",e)})),t=r}));e.on("added",(()=>{r()})),e.on("removed",(()=>{r()}))}_onPing(e,t){this.pingQueue.add((async()=>{if(!this.running)return;let r=0;try{await Promise.all(e.map((async e=>{let t;try{t=new Bs.TimeoutController(this.pingTimeout);const n={signal:t.signal};this.log("pinging old contact %p",e.peer);const s=await this.components.connectionManager.openConnection(e.peer,n);(await s.newStream(this.protocol,n)).close(),r++}catch(t){this.running&&null!=this.kb&&(this.log.error("could not ping peer %p",e.peer,t),this.log("evicting old contact after ping failed %p",e),this.kb.remove(e.id))}finally{null!=t&&t.clear(),this.metrics?.routingTableSize.update(this.size)}}))),this.running&&r<e.length&&null!=this.kb&&(this.log("adding new contact %p",t.peer),this.kb.add(t))}catch(e){this.log.error("could not process k-bucket ping event",e)}})).catch((e=>{this.log.error("could not process k-bucket ping event",e)}))}get size(){return null==this.kb?0:this.kb.count()}async find(e){const t=await FN(e),r=this.closestPeer(t);if(null!=r&&e.equals(r))return r}closestPeer(e){const t=this.closestPeers(e,1);if(t.length>0)return t[0]}closestPeers(e,t=this.kBucketSize){if(null==this.kb)return[];return this.kb.closest(e,t).map((e=>e.peer))}async add(e){if(null==this.kb)throw new Error("RoutingTable is not started");const t=await FN(e);this.kb.add({id:t,peer:e}),this.log("added %p with kad id %b",e,t),this.metrics?.routingTableSize.update(this.size)}async remove(e){if(null==this.kb)throw new Error("RoutingTable is not started");const t=await FN(e);this.kb.remove(t),this.metrics?.routingTableSize.update(this.size)}}function HN(e,t){if(e.length!==t.length)throw new Error("Inputs should have the same length");const r=ys(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return ps(r)}var KN=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,198469,91876,172043,83898,101992,26084,94570,3635,76958,22853,76497,38266,176590,168403,44464,142840,79180,184594,1984,41806,83147,11985,6546,366068,59732,24533,271505,8736,39084,222992,93429,28962,58985,86665,8432,30028,14548,32439,54424,165029,55175,27458,69046,121277,46168,33732,20661,24581,135574,123110,37556,79260,72611,16957,12939,46162,58238,44907,72936,253758,41324,32518,96480,11949,124438,65280,43256,34107,53533,43531,37037,28366,45970,32741,173438,6121,194202,62969,26355,30314,58370,28455,1848,50519,82830,90393,21761,295490,10936,256940,133568,44050,20269,4089,27457,21610,219460,36743,14821,101388,52005,13124,30979,140816,167362,26054,18458,60789,34917,40447,26606,33422,9066,3452,83614,5761,20263,137238,25038,91310,101,52322,74548,42572,38084,214054,186568,31802,17665,30620,141936,37730,14420,4265,187218,49640,188208,51441,55388,96452,66659,40869,42039,60967,221027,19234,178581,29105,96050,9165,196118,157335,3738,40354,117436,2965,34136,59659,15570,50843,230035,31444,71260,43886,18316,5387,38500,168508,17406,32174,8828,103373,143806,90367,3560,18719,122310,16508,26719,2541,105429,6645,37998,73190,10591,235916,49737,87112,233941,53188,32193,79154,4544,52905,126477,7580,63501,57314,3216,31337,6541,103083,60846,49,9756,15481,1355,43840,14319,13743,27486,10222,73114,230718,418644,16706,6674,279748,23058,45273,295831,86306,2743,5535,88773,21829,35253,120938,31153,3169,16839,42847,8751,80974,33942,36867,35514,16485,26474,77775,56877,5391,48346,3882,108713,31403,27804,55248,26235,43821,136104,40118,175507,28034,203908,18732,1788,34030,106427,36958,54359,7251,44936,15356,69139,455,157915,22173,140291,50348,43275,82066,49621,54952,15216,36226,96695,66855,6936,1987,8227,196087,4631,68827,99004,47541,110265,17953,147605,110242,58520,31312,38724,329975,642,3155,34497,75937,6207,73843,6120,17249,51429,117746,3218,910,68961,319671,14938,29555,34700,1649,66673,72268,9655,76800,153087,6941,210168,27130,35398,1780,73242,3135,56689,19556,165307,8765,35967,121458,13333,70453,17350,117253,22265,13340,44265,39869,441,3742,135025,23581,33309,16543,17731,13291,157637,283005,21408,101360,63887,52312,83873,5338,233779,23759,186949,34531,177320,38069,156465,91004,19353,59852,68160,14891,1338,1072,29823,1950,28901,81407,313445,73038,84807,162348,240257,37162,138934,16111,58013,41253,102951,16457,96056,19541,56402,67217,41638,94381,89674,29481,37456,80815,151579,13937,13683,132537,19699,134545,67020,29816,222341,141235,427578,48868,129557,233342,23077,87871,16213,18728,16184,9469,37913,19680,2798,171356,178328,13216,50049,72690,71904,124644,55455,7504,29052,41036,266546,19899,30391,188755,8659,59469,16,104298,112943,53865,76203,138226,68857,139953,14125,107625,119795,173133,4398,50273,48808,54390,16466,122086,31835,67035,50971,48859,7508,46427,66477,73021,84615,39985,83076,46779,201569,53336,36443,60865,168164,143810,51393,25548,169307,32896,24485,38424,21837,29087,275813,51674,6714,64883,46169,187369,55186,76192,12852,12018,62134,31067,118303,16542,12125,10579,4928,26291,43854,7091,10946,253716,109062,39283,17261,113012,258512,47764,125126,32646,55892,80279,201623,149872,3192,385,1208,48750,5376,58738,22335,5427,82416,47811,32435,143086,38930,94128,59975,156037,37977,38224,62485,7698,50405,71027,16462,21559,136153,34131,107506,162069,63703,3101,215029,40407,4178,3774,9187,80019,17880,97926,67579,2600,18405,8351,47924,86638,70820,92206,86453,29610,42241,119200,3198,15466,67813,57863,35454,4779,99518,4649,104641,144269,33730,38073,65864,6838,109456,193298,154007,5623,45741,30846,182578,25573,157224,1543,58575,138703,146140,44971,49356,18275,59064,20300,13122,11848,24453,11973,9797,86843,2919,25530,49210,1130,161220,76788,75373,85604,34926,36014,17777,17255,51533,11676,92226,51845,119859,21525,5936,18507,28050,1140,31418,14857,34207,47859,10750,36382,32079,106909,59426,87757,38393,110042,15965,97104,33757,35344,97993,53979,33651,45407,41884,82515,173089,7177,58371,35365,47543,51927,35587,10670,23544,29306,84233,39976,76076,62097,9007,8668,28119,78281,120790,19835,143020,54968,18670,64959,20649,34469,42570,33001,136570,87796,120044,1106,58700,63951,127623,12805,83057,40212,31773,49850,7361,54336,347524,101314,23751,19569,48791,29174,49369,20467,7465,75842,38281,623,112457,60210,28849,51003,94720,6426,90047,85560,43761,3579,85105,34607,90410,118528,7224,42907,111163,18168,6960,161135,191298,5247,100584,127552,171568,20121,91173,12636,54615,20199,63730,98105,2396,40387,14438,125012,4765,33235,12865,45299,37728,82098,77872,114037,59253,19675,24838,398016,102561,11446,17069,57508,178277,65836,99941,26114,2585,271882,136866,50126,11027,155648,118367,14585,8910,123015,335383,40434,41016,53021,14439,87098,176860,201543,121888,2358,9286,5739,22666,54270,37884,169381,33984,93859,16124,89364,72207,51639,76366,99029,65812,2198,12147,174891,194289,6986,30252,88822,21284,11445,288337,160821,33034,100869,43852,25761,52882,1144,103809,1924,84458,86079,43411,13542,139276,18141,34978,41298,7276,26481,173800,33210,17951,142652,33616,33677,2210,19941,98568,2486,192414,80136,12058,235883,50963,249638,29572,27221,47034,6124,72107,63346,97620,158513,299699,40388,23235,37176,224244,198386,121323,67992,23827,63170,17838,106622,158590,26807,5345,23489,91891,55474,74834,37981,13058,5977,72552,34706,26828,145172,19904,21367,34043,960,77092,91381,4733,47446,7680,41697,5170,16960,14741,46101,13656,473,51842,37433,11103,11551,121951,13191,97536,165932,50397,51628,129028,9069,44885,6590,59195,47045,32940,225472,90345,21833,13303,29407,96615,141951,5198,6028,18395,7181,3861,14966,156358,167182,36529,55253,25942,173153,30959,27261,50691,150176,162201,38467,48462,80602,42163,118482,168,108756,26011,17166,54149,456538,22512,91374,13816,90358,131615,18132,226707,1824,28139,26860,42253,93877,77351,65575,8980,80574,22020,27948,40422,91324,76376,13528,39281,91685,82215,122541,144066,1983,193851,17283,26320,2739,194978,4790,26845,42627,61300,65815,174612,55133,4200,191130,79771,158321,52280,166796,221620,62461,11278,4067,88152,83409,31717,121367,13522,47325,37945,10406,174348,249321,154101,64912,29938,51775,17220,15776,166138,78890,84425,54121,42861,16368,24572,291647,10197,32073,22651,11677,97509,26952,35787,18424,41910,71614,94977,72318,41594,70024,275419,37702,60199,7335,39107,61315,18271,18394,33768,87884,104277,123724,7277,56288,71981,189803,49320,3352,6798,14240,8954,69220,94433,57372,28620,68863,193727,85575,42309,41667,67689,42081,22543,44824,12719,28540,114236,101553,27638,27296,4300,5353,4663,19379,94098,3758,95888,95144,80344,87320,28447,259518,12718,71391,152731,37063,24132,31911,104896,15672,103782,1521,4945,72541,23717,122632,15619,87175,206120,29428,189780,61416,28350,44457,972,1175,47233,198738,95789,41907,21953,97034,59341,22864,53713,16873,32971,20693,20954,31336,21477,16169,38370,16412,9019,3841,24599,21938,17085,6484,81198,76413,5849,72514,12320,65247,276175,37234,59796,52642,16312,57349,198507,94148,46134,18958,125552,1747,18725,151873,14901,5490,68287,29470,3689,64794,40814,26018,25692,54450,2703,88278,124886,173087,174e3,24159,179477,24276,46004,201876,209202,445,52876,31948,30206,157610,39180,18439,44124,50469,5774,96278,222758,200216,50290,45486,20435,46986,46276,140133,142326,15569,13363,47522,92583,2182,7135,16853,22998,30272,4952,63263,35623,39096,53789,44864,20053,110392,124213,4630,16087,28221,127787,25839,77481,44693,13464,113146,6983,27069,55717,50102,4760,7107,26186,66507,59145,36032,104182,71328,29425,64317,50781,47465,94298,69706,74899,22754,120756,25108,93077,56834,73286,39928,16218,41699,176763,7555,70819,50083,26895,23315,26014,16773,123079,41712,5719,31516,90427,158540,85051,183128,40864,27505,55392,9058,45224,96857,30901,136622,96557,56304,120061,11501,151448,5773,89743,7769,86069,2935,18471,41628,10114,33660,110170,49479,26745,92846,33221,26731,18795,87076,8550,2100,29972,120289,3077,72490,33784,2630,208722,50861,63483,79029,6419,39467,14302,45286,64207,9686,67513,44170,1050,77246,59266,17055,53801,7150,11111,42432,4278,94579,362117,36175,42902,41933,39002,98489,22913,74161,84773,57036,17556,162288,74485,178760,93867,73635,128860,50362,261,67455,80001,46080,35662,4368,25247,19230,74393,22588,1822,27682,235324,13798,85998,13194,235067,23514,71669,147632,23191,134748,214683,105101,1518,25489,247114,7380,54842,26922,3971,26361,20844,68642,170517,77339,123255,8963,77818,150998,48466,36806,2732,23261,11741,236162,18243,126216,28690,50546,16385,92760,197383,246558,201295,88255,67588,71687,176076,172653,169058,33906,63747,24835,157621,43338,30050,46152,132741,2770,51371,94835,6614,15112,11749,56936,1250,19027,399017,58036,100215,23388,55815,308768,124152,94803,9521,64186,8971,28,30427,62163,7616,103838,35079,29203,131235,7743,17389,10882,37420,61460,228512,85363,41581,131077,62822,119647,10130,54445,26925,19968,29016,24446,74028,24176,61448,67185,9254,8563,119129,9771,99184,37716,39514,10532,221512,258753,218630,55980,23394,32141,61924,66749,32411,3741,36475,26678,77010,44946,91203,128749,116953,20476,49625,53116,13735,102335,29376,51946,83407,67892,59212,34685,21083,1546,112982,32972,74397,1078,190545,16082,86140,58591,89611,101531,10061,105104,76319,20035,17551,52611,169061,190842,100780,23907,90413,115619,9675,34710,193435,49443,129734,11183,258877,16318,136182,126808,44635,27304,192375,2599,125648,47051,12091,23814,721,58800,40137,66726,97930,60877,74487,7942,54326,9841,41428,13762,8211,85383,6950,99177,79806,201786,296464,124087,13144,29741,41721,47634,55088,254286,106408,17041,99064,12942,64086,45233,14005,2612,55827,255,7984,13980,38574,12776,46654,73499,249951,2101,26676,25996,132326,116415,119062,50449,31033,23038,11589,179252,20007,14860,129270,21143,17796,144715,60106,70758,69842,34674,282133,44014,16774,57268,38528,24053,46373,201667,28327,471023,51889,102667,21193,114909,84132,69317,96723,67969,16134,68145,15058,28765,32035,2524,101089,98664,25045,76571,14957,86040,118506,262428,154764,81573,39681,283900,73287,127825,544,80448,52347,38512,175971,15180,45467,33086,46552,48894,81107,43213,36672,54025,76703,8053,7608,13299,56619,20752,238099,54164,105133,1444,32942,953,37564,8e3,66316,119463,106817,404,13667,149108,128597,31267,10269,49836,106150,1484,52330,76965,160486,171648,38456,31263,22424,37738,66245,67467,143369,60471,75610,20895,115528,86070,60854,40796,49347,18989,15030,11371,37578,15779,79867,10187,86462,46402,155626,93200,40229,7090,57547,108053,99598,11088,47505,41218,206017,2173,20988,30219,22919,80563,57566,42369,93141,41675,2407,182519,120495,27154,16702,29456,14349,7958,16688,117177,140375,42467,261919,74916,153569,10836,34742,49526,7621,105997,12212,2270,392377,7755,17959,25086,232152,138791,33847,13860,35316,5811,1344,71259,50452,207539,92635,50359,5821,33674,30255,2086,2587,96264,17543,42,6029,9580,43007,139248,82831,12917,29607,25786,51467,42137,85161,100698,31561,88989,121990,278500,3602,109344,37982,15279,116442,28936,30880,87894,58079,128661,126731,67392,28051,146885,4861,16216,97344,42827,147561,153948,22684,21335,47685,1853,43349,15185,59642,10229,25520,187921,108972,5579,98037,24945,6697,19193,63734,137934,75056,89740,19767,224268,56138,63643,151661,39313,70618,84031,89723,84074,13703,85626,35460,8867,64845,3439,57906,99776,63968,49270,81130,34356,16210,23547,36446,34090,140028,72439,2221,22163,57058,363492,113754,18913,95451,48663,54464,54037,176097,68425,3023,34906,29482,117389,341780,80431,58330,16753,92616,60907,94846,147486,4498,48646,7773,46801,7778,18946,464978,47558,33223,177444,7328,15626,63337,94700,11743,9351,255024,39098,16447,42647,96230,39769,58840,10068,63439,35800,65843,58823,413844,9156,51258,7434,61791,85018,6872,3692,28096,7121,33024,6009,75532,31997,192535,9661,3304,9547,14753,31987,25314,55689,15896,20430,39472,31340,99744,25398,115569,54883,28719,205423,23071,57855,64638,149867,25671,82403,37616,20668,39989,77996,74948,140555,175248,64810,36515,46595,4958,248773,24045,28728,136673,168704,20804,114833,100325,27135,21205,96151,153134,45992,7093,13992,76047,1980,19432,145001,75159,87462,17710,1013,45556,34297,144882,20648,26061,11319,129567,108555,18872,464580,33386,22717,65948,167189,5603,135042,79542,8801,202632,18114,91882,5973,5239,67315,4431,60916,47819,71693,32597,32606,18183,45072,80329,76385,24749,51305,40314,156514,14693,130345,13168,66214,18029,12858,34801,27628,14544,10823,40522,40185,33739,148694,23548,9923,61012,28859,17933,19442,34364,99849,164107,141167,30629,21054,6744,36491,8096,42474,41706,155060,30650,10600,163442,1143,96655,61390,52359,7559,51568,64256,203854,4467,22453,14504,436398,7878,6980,8293,63610,293747,16167,35763,19627,147603,15419,18032,110744,51346,33681,54571,40472,48615,39073,21604,13754,173027,92560,11083,47299,63062,11813,52007,29883,9734,139722,15953,1550,20651,13616,49306,16113,90089,92326,7584,30712,72424,164858,6831,152871,55746,197721,34167,196442,6022,112107,55215,7538,123381,4920,43539,77165,8939,50392,34192,20225,79762,22505,58667,40770,29788,97180,82835,4568,8579,13273,363569,35898,49983,436,36598,3237,131691,62418,35591,8101,4073,379438,65218,76072,33887,2968,27573,212619,288680,68278,72851,150504,217896,6913,121339,22017,35340,51072,43616,75043,31437,10833,81487,4364,22968,41454,106687,85446,19863,109625,149241,524,141850,214404,54376,657,237023,9401,108137,53800,32474,49712,53334,126876,27337,45552,177696,8269,15036,12097,42240,2328,125374,119295,99715,2500,19624,39441,27220,102691,60957,94543,39101,18566,67362,13975,78230,25017,34017,239007,90027,39351,41681,35354,43822,1043,916,58587,141983,94818,38799,75459,41114,67432,16195,36606,59568,22272,126769,31424,68659,12287,134302,257977,5756,207285,95637,47248,117689,19583,77451,22373,12200,54993,117118,34244,29386,34562,53819,71267,64172,77665,49368,7716,59301,25749,45426,194789,17297,2650,1766,32501,45198,20403,20984,6600,14171,94604,19037,5402,29896,9938,59935,109708,88081,145182,44844,39167,352626,164173,35374,45982,6122,154,73419,220487,53834,53601,17992,8609,229321,5610,68098,66815,71012,95069,140968,27396,8957,134489,24656,86659,56598,134852,17316,123838,255436,6613,41610,138033,81452,32023,32396,123687,63398,8693,29712,30407,19296,121188,3551,36099,20032,111948,56624,16547,27453,35916,15378,52039,56849,13489,22214,73177,53097,277349,2157,14029,187886,10260,141743,246460,91880,50869,3788,49486,133566,54950,33120,129337,53768,18333,9525,26902,312251,10297,9020,70759,16647,112432,59260,84609,9818,82766,73569,468,46001,75780,55028,52106,11498,43645,108069,17150,17753,29417,16705,31799,9606,289,122254,115975,8620,6133,255357,56908,14456,133464,43554,79224,11247,29630,160,12756,25464,65960,350428,62521,321796,100359,67358,35169,46172,113128,48988,88868,31094,33266,6847,60887,98188,49659,69117,92977,220228,13947,80181,35103,62170,97351,13475,2440,199768,19498,36597,46971,25234,67806,62881,84717,73648,181966,10488,94149,21550,26655,63436,48375,14405,165650,9621,24439,28043,42735,4490,29963,56674,45373,1934,262446,50855,67098,26898,5261,52696,40644,33900,9440,180286,87162,22940,19704,26936,69769,10254,101759,27406,12243,48e3,73926,113215,54935,5726,192787,4312,106216,9366,11550,52949,23457,212271,277152,133895,108374,6191,96477,29980,218916,58024,54696,40853,91124,65894,91170,65908,252552,6793,29212,15389,44516,122515,52617,35058,9017,103536,39510,49136,19242,130652,662077,74699,47024,31422,8517,73351,24399,13867,128360,4810,4434,61779,111983,61036,17798,110240,59722,102960,39688,10001,23803,23039,176498,56659,44814,134295,17188,77577,74466,226175,102472,154333,63900,111747,18062,41171,79669,32773,408933,42562,28931,30907,107388,43487,2946,240310,23938,24354,319,184983,7927,6488,1422,10790,68809,68209,64775,4361,202,17123,59634,51200,44391,18188,17843,2619,74278,3230,9540,47187,21702,36274,56894,43907,16310,34790,16866,6150,5561,13587,107545,108873,126867,86986,28640,33427,19017,5762,80637,17430,46903,2047,131055,25958,13558,5444,47152,13900,44563,122857,45348,70863,39593,54332,38068,33637,318,40310,143467,18502,24520,11377,62013,28942,27246,28269,83545,17999,59015,90707,30065,15161,34720,1263,37008,2012,6060,98575,92933,5721,299,199555,24578,29223,2985,743,115825,109523,136657,47454,26378,53586,3733,174945,93340,244456,5693,37386,28782,89767,27545,23573,18798,136425,34320,84778,20041,48453,38215,7477,71958,40621,8773,5874,187927,105965,51100,43533,18083,8443,10180,43597,2003,183999,69689,12216,129696,146188,62389,34044,68410,12765,43273,26949,266807,3345,34477,79197,5688,47539,213110,21634,22257,50092,32222,42346,39530,63668,98,134978,74022,5152,59088,174145,37220,9934,9545,118937,5724,87240,19875,15784,40143,23263,87513,181654,285152,37881,263241,4966,43934,10433,186657,6470,74416,225854,25908,142677,246262,32280,6192,75890,45546,143264,135305,29742,47013,77787,11732,126658,8763,37950,21806,57557,113464,89465,108995,164574,23894,22996,23169,15369,23117,17642,130607,40503,36239,280990,44666,9981,40427,147487,26869,168452,32886,32991,46798,240839,15111,70502,65697,88548,44145,28701,48767,31139,206777,35659,181164,166262,14554,171445,31786,66523,76607,17956,6507,31279,90476,116611,167918,6560,1243,115324,80128,41867,55897,187323,37069,32596,189444,145931,13390,105530,65709,26805,6999,55714,41300,22915,68951,22138,21120,22264,10058,19945,33635,56123,99085,10032,5818,6016,46649,57476,35264,94413,112522,262288,93686,83038,14341,23204,28807,66084,77987,6101,126673,7133,38126,5923,122091,170240,97772,46874,215746,43948,41622,3272,55596,8332,146411,251315,13533,8561,81521,115449,48616,175175,2063,186556,3036,134537,75772,29728,82360,22973,186559,86348,89100,38388,82297,45610,2613,87082,9986,177812,57884,23591,47485,42543,33582,44713,74439,257444,252451,31825,35631,38540,33066,5147,13973,4343,51830,70378,22827,26448,95560,36896,241741,48067,203953,298860,61620,20450,3220,67272,6586,107662,100160,108684,6929,57226,4762,7457,1320,40404,77204,99309,62750,208653,59977,44e3,74315,34332,5819,172217,64904,114077,18147,84012,1791,98456,90930,21446,116669,103938,7422,85140,59713,5768,326211,16239,75411,13229,29398,10758,236107,1539,112472,95979,152154,151294,306,21196,38146,10700,6891,84282,109646,56492,40539,6589,119491,51354,30685,140209,136906,29622,73617,49553,70525,51671,166869,139616,74395,37439,49595,45678,11959,33211,86560,52434,9282,62690,112155,130810,5243,108261,99970,265613,72551,80049,6391,33365,90721,66737,69872,87011,1860,9032,112544,60905,37371,89015,140351,19076,850,373531,2802,36725,218795,72062,28990,16550,24614,7815,6187,26336,33373,32162,42791,73555,32062,23386,10244,56392,49442,27076,136262,12412,14883,1134,33675,97153,199281,15608,100152,74072,47942,254301,36451,16026,10687,65067,56708,254030,30290,50490,13864,57941,259331,35588,23485,43486,24869,21620,92971,22072,88645,1048,182050,13343,32452,14825,19509,3325,216938,45740,99716,189082,53740,78245,25609,24311,176777,47340,308354,40669,66085,14102,125339,9225,128709,97207,1271,200933,78439,113451,88975,18324,46521,11819,18570,141756,72512,170020,52754,63550,118515,103073,93330,32736,50499,14722,31600,68452,398867,29316,172786,18417,104924,2606,5670,84818,16288,67106,59580,82929,607401,291,85829,359,15897,35830,50696,65630,52672,22115,356968,29895,40837,231192,34024,38957,26722,406,23335,124952,72068,68804,13268,147101,164740,276569,162596,66943,11569,26654,66358,4777,23229,102127,5848,978,2921,59666,5371,28212,90108,42938,39320,2499,4271,108792,33510,125072,71653,65239,38250,66357,38577,13964,86251,35708,50755,36010,29448,12209,3844,38222,206337,100876,67827,137088,14167,252225,84163,195270,1306,5703,54198,779,46802,22028,51124,86759,70560,113164,35685,162145,45471,34561,422,2611,6464,47486,19223,38246,9191,18331,89942,243642,212364,15893,17518,22617,6409,30046,126182,59716,36560,104428,18846,26592,19458,50793,147333,30826,1388,27647,10922,14495,33545,19269,135828,39727,41601,46931,233379,49169,131130,182112,16276,82381,118209,142445,128310,19672,28740,82907,33436,3118,102206,28723,24819,41937,38854,5157,3881,111491,1142,9776,421673,152241,29309,14961,87854,6054,15424,3796,82656,54996,2108,55367,239450,154525,9643,118103,106041,64601,68549,48707,30266,25772,18740,9462,229669,91798,112152,191327,14493,72828,8175,66636,236474,25817,87351,129027,76653,20422,22983,71240,27846,44661,12399,46158,77704,53101,35032,11072,17300,109294,33638,24408,1895,11241,760,17584,82479,125877,63150,141075,34259,23274,81698,15732,43577,48340,91584,14688,16379,24481,150280,96420,262050,48635,43727,61819,56268,72003,88178,17281,79912,13218,122519,125295,166396,11811,2171,118930,67746,17636,178278,174656,95661,173039,83845,79689,17473,98555,127696,203415,54730,22925,232239,9309,12136,175026,20740,180188,10747,39816,314017,266131,10040,175732,112550,220651,31974,37393,888,23008,86799,4303,64905,148467,75337,251,3284,370102,50264,9835,5438,23655,4481,29851,329,12855,7162,64931,78141,12804,42372,296771,83547,18624,34874,86271,3360,48665,77735,88767,11463,63527,28889,22258,29140,194315,113924,25499,6406,31334,1845,4802,49184,43455,35469,127594,92970,61038,115005,38840,87761,106838,8811,20572,55637,11162,96721,132425,108925,2948,125457,36356,3502,75270,27622,127192,2561,123095,49394,61155,16897,110064,9699,89448,53356,19628,220310,21622,83036,9885,112214,6087,26713,17901,161912,91492,3440,68594,9266,92238,8087,6866,150194,72175,80701,13459,31836,43243,239700,95846,44749,50647,21945,230538,120612,132371,244604,5193,105637,34661,41341,68775,85393,1874,8771,33718,49672,77403,595452,99507,6490,58895,128742,7704,39239,73217,43816,62824,37804,199976,22361,80005,87514,94832,14089,4574,139975,59142,75523,100268,43906,53442,15152,2547,186002,17011,19513,204282,3343,60568,128318,119250,4298,51871,41336,71759,21921,45074,98169,145889,99427,11350,1237,5520,28799,7803,53702,21026,136352,38293,128690,12158,90132,44600,10184,26957,39459,126025,78904,82999,59373,39301,150198,120529,153042,20177,50089,14764,271571,30530,123161,38975,101562,22941,5648,124654,109243,69817,71675,49162,106884,21241,107795,30258,16572,188262,141456,7688,60718,8271,11044,32440,104608,103419,236109,93156,43293,128929,42107,67180,25201,115254,185488,130954,72813,167547,20537,39969,38432,22582,184022,1139,27199,5655,17767,97412,122606,209377,27070,35871,326617,188954,42680,73512,80911,22629,3011,95021,315242,157737,383,41821,41808,19335,27950,15674,25677,110950,35375,76835,59108,57370,35262,16569,160415,37706,78086,32041,49691,137143,9782,172080,50148,77917,6323,10110,69172,17711,21795,59511,76184,135114,31046,132319,59105,157578,20549,80778,57649,158421,65143,4575,72235,21899,10797,92745,34035,106079,80159,4508,78304,25350,75457,46458,32937,25623,47,8531,104751,84953,8138,36508,187199,66310,115274,13253,32461,38536,1916,42007,187160,35055,26325,84394,35963,94216,45590,97782];class VN{constructor(e){const{peerRouting:t,routingTable:r,refreshInterval:n,refreshQueryTimeout:s,lan:i}=e;this.log=se(`libp2p:kad-dht:${i?"lan":"wan"}:routing-table:refresh`),this.peerRouting=t,this.routingTable=r,this.refreshInterval=n??kN,this.refreshQueryTimeout=s??UN,this.commonPrefixLengthRefreshedAt=[],this.refreshTable=this.refreshTable.bind(this)}async start(){this.log(`refreshing routing table every ${this.refreshInterval}ms`),this.refreshTable(!0)}async stop(){null!=this.refreshTimeoutId&&clearTimeout(this.refreshTimeoutId)}refreshTable(e=!1){this.log("refreshing routing table");const t=this._maxCommonPrefix(),r=this._getTrackedCommonPrefixLengthsForRefresh(t);this.log(`max common prefix length ${t}`),this.log(`tracked CPLs [ ${r.map((e=>e.toISOString())).join(", ")} ]`),Promise.all(r.map((async(n,s)=>{try{if(await this._refreshCommonPrefixLength(s,n,e),0===this._numPeersForCpl(t)){const t=Math.min(2*(s+1),r.length-1);for(let r=s+1;r<t+1;r++)try{await this._refreshCommonPrefixLength(r,n,e)}catch(e){this.log.error(e)}}}catch(e){this.log.error(e)}}))).catch((e=>{this.log.error(e)})).then((()=>{this.refreshTimeoutId=setTimeout(this.refreshTable,this.refreshInterval),null!=this.refreshTimeoutId.unref&&this.refreshTimeoutId.unref()})).catch((e=>{this.log.error(e)}))}async _refreshCommonPrefixLength(e,t,r){if(!r&&t.getTime()>Date.now()-this.refreshInterval)return void this.log("not running refresh for cpl %s as time since last refresh not above interval",e);const n=await this._generateRandomPeerId(e);this.log("starting refreshing cpl %s with key %p (routing table size was %s)",e,n,this.routingTable.size);const s=new Bs.TimeoutController(this.refreshQueryTimeout);try{const t=await ME(this.peerRouting.getClosestPeers(n.toBytes(),{signal:s.signal}));this.log(`found ${t} peers that were close to imaginary peer %p`,n),this.log("finished refreshing cpl %s with key %p (routing table size is now %s)",e,n,this.routingTable.size)}finally{s.clear()}}_getTrackedCommonPrefixLengthsForRefresh(e){e>15&&(e=15);const t=[];for(let r=0;r<=e;r++)t[r]=this.commonPrefixLengthRefreshedAt[r]??new Date;return t}async _generateRandomPeerId(e){if(null==this.routingTable.kb)throw new Error("Routing table not started");const t=bc(2),r=(t[1]<<8)+t[0];return Ra(await this._makePeerId(this.routingTable.kb.localNodeId,r,e))}async _makePeerId(e,t,r){if(r>15)throw new Error("Cannot generate peer ID for common prefix length greater than 15");const n=new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1),s=65535<<16-(r+1),i=KN[(n^32768>>r)&s|t&~s],o=new ArrayBuffer(34),a=new DataView(o,0,o.byteLength);return a.setUint8(0,$n.code),a.setUint8(1,32),a.setUint32(2,i,!1),new Uint8Array(a.buffer,a.byteOffset,a.byteLength)}_maxCommonPrefix(){let e=0;for(const t of this._prefixLengths())t>e&&(e=t);return e}_numPeersForCpl(e){let t=0;for(const r of this._prefixLengths())r===e&&t++;return t}*_prefixLengths(){if(null!=this.routingTable.kb)for(const{id:e}of this.routingTable.kb.toIterable()){const t=HN(this.routingTable.kb.localNodeId,e);let r=0;for(const e of t){if(0!==e)break;r++}yield r}}}var zN,jN;!function(e){let t;e.codec=()=>(null==t&&(t=aA(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.key&&(t.uint32(10),t.bytes(e.key)),null!=e.value&&(t.uint32(18),t.bytes(e.value)),null!=e.author&&(t.uint32(26),t.bytes(e.author)),null!=e.signature&&(t.uint32(34),t.bytes(e.signature)),null!=e.timeReceived&&(t.uint32(42),t.string(e.timeReceived)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.key=e.bytes();break;case 2:r.value=e.bytes();break;case 3:r.author=e.bytes();break;case 4:r.signature=e.bytes();break;case 5:r.timeReceived=e.string();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>Za(t,e.codec()),e.decode=t=>Ja(t,e.codec())}(zN||(zN={})),function(e){let t,r,n,s,i,o;!function(e){e.PUT_VALUE="PUT_VALUE",e.GET_VALUE="GET_VALUE",e.ADD_PROVIDER="ADD_PROVIDER",e.GET_PROVIDERS="GET_PROVIDERS",e.FIND_NODE="FIND_NODE",e.PING="PING"}(t=e.MessageType||(e.MessageType={})),function(e){e[e.PUT_VALUE=0]="PUT_VALUE",e[e.GET_VALUE=1]="GET_VALUE",e[e.ADD_PROVIDER=2]="ADD_PROVIDER",e[e.GET_PROVIDERS=3]="GET_PROVIDERS",e[e.FIND_NODE=4]="FIND_NODE",e[e.PING=5]="PING"}(r||(r={})),function(e){e.codec=()=>oA(r)}(t=e.MessageType||(e.MessageType={})),function(e){e.NOT_CONNECTED="NOT_CONNECTED",e.CONNECTED="CONNECTED",e.CAN_CONNECT="CAN_CONNECT",e.CANNOT_CONNECT="CANNOT_CONNECT"}(n=e.ConnectionType||(e.ConnectionType={})),function(e){e[e.NOT_CONNECTED=0]="NOT_CONNECTED",e[e.CONNECTED=1]="CONNECTED",e[e.CAN_CONNECT=2]="CAN_CONNECT",e[e.CANNOT_CONNECT=3]="CANNOT_CONNECT"}(s||(s={})),function(e){e.codec=()=>oA(s)}(n=e.ConnectionType||(e.ConnectionType={})),function(t){let r;t.codec=()=>(null==r&&(r=aA(((t,r,n={})=>{if(!1!==n.lengthDelimited&&r.fork(),null!=t.id&&(r.uint32(10),r.bytes(t.id)),null==t.addrs)throw new Error('Protocol error: required field "addrs" was not found in object');for(const e of t.addrs)r.uint32(18),r.bytes(e);null!=t.connection&&(r.uint32(24),e.ConnectionType.codec().encode(t.connection,r)),!1!==n.lengthDelimited&&r.ldelim()}),((t,r)=>{const n={addrs:[]},s=null==r?t.len:t.pos+r;for(;t.pos<s;){const r=t.uint32();switch(r>>>3){case 1:n.id=t.bytes();break;case 2:n.addrs.push(t.bytes());break;case 3:n.connection=e.ConnectionType.codec().decode(t);break;default:t.skipType(7&r)}}return n}))),r),t.encode=e=>Za(e,t.codec()),t.decode=e=>Ja(e,t.codec())}(i=e.Peer||(e.Peer={})),e.codec=()=>(null==o&&(o=aA(((t,r,n={})=>{if(!1!==n.lengthDelimited&&r.fork(),null!=t.type&&(r.uint32(8),e.MessageType.codec().encode(t.type,r)),null!=t.clusterLevelRaw&&(r.uint32(80),r.int32(t.clusterLevelRaw)),null!=t.key&&(r.uint32(18),r.bytes(t.key)),null!=t.record&&(r.uint32(26),r.bytes(t.record)),null==t.closerPeers)throw new Error('Protocol error: required field "closerPeers" was not found in object');for(const n of t.closerPeers)r.uint32(66),e.Peer.codec().encode(n,r);if(null==t.providerPeers)throw new Error('Protocol error: required field "providerPeers" was not found in object');for(const n of t.providerPeers)r.uint32(74),e.Peer.codec().encode(n,r);!1!==n.lengthDelimited&&r.ldelim()}),((t,r)=>{const n={closerPeers:[],providerPeers:[]},s=null==r?t.len:t.pos+r;for(;t.pos<s;){const r=t.uint32();switch(r>>>3){case 1:n.type=e.MessageType.codec().decode(t);break;case 10:n.clusterLevelRaw=t.int32();break;case 2:n.key=t.bytes();break;case 3:n.record=t.bytes();break;case 8:n.closerPeers.push(e.Peer.codec().decode(t,t.uint32()));break;case 9:n.providerPeers.push(e.Peer.codec().decode(t,t.uint32()));break;default:t.skipType(7&r)}}return n}))),o),e.encode=t=>Za(t,e.codec()),e.decode=t=>Ja(t,e.codec())}(jN||(jN={}));const GN=jN.MessageType,$N=jN.ConnectionType,qN=Object.keys(GN);class WN{constructor(e,t,r){if(!(t instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=e,this.key=t,this.clusterLevelRaw=r,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){const e=this.clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this.clusterLevelRaw=e}serialize(){return jN.encode({key:this.key,type:this.type,clusterLevelRaw:this.clusterLevelRaw,closerPeers:this.closerPeers.map(YN),providerPeers:this.providerPeers.map(YN),record:null==this.record?void 0:this.record.serialize().subarray()})}static deserialize(e){const t=jN.decode(e),r=new WN(t.type??jN.MessageType.PUT_VALUE,t.key??Uint8Array.from([]),t.clusterLevelRaw??0);return r.closerPeers=t.closerPeers.map(XN),r.providerPeers=t.providerPeers.map(XN),null!=t.record?.length&&(r.record=ah.deserialize(t.record)),r}}function YN(e){return{id:e.id.toBytes(),addrs:(e.multiaddrs??[]).map((e=>e.bytes)),connection:$N.CONNECTED}}function XN(e){if(null==e.id)throw new Error("Invalid peer in message");return{id:Ra(e.id),multiaddrs:(e.addrs??[]).map((e=>mi(e))),protocols:[]}}function JN(e){return{...e,name:"SENDING_QUERY",type:0,messageName:e.type,messageType:qN.indexOf(e.type.toString())}}function ZN(e){return{...e,name:"PEER_RESPONSE",type:1,messageName:e.messageType,closer:null!=e.closer?e.closer:[],providers:null!=e.providers?e.providers:[]}}function eO(e){return{...e,name:"FINAL_PEER",type:2}}function tO(e){return{...e,name:"QUERY_ERROR",type:3}}function rO(e){return{...e,name:"PROVIDER",type:4}}function nO(e){return{...e,name:"VALUE",type:5}}function sO(e){return{...e,name:"DIALING_PEER",type:7}}class iO extends N_{constructor(e,t){super();const{protocol:r,lan:n}=t;this.components=e,this.log=se(`libp2p:kad-dht:${n?"lan":"wan"}:network`),this.running=!1,this.protocol=r}async start(){this.running||(this.running=!0)}async stop(){this.running=!1}isStarted(){return this.running}async*sendRequest(e,t,r={}){if(!this.running)return;this.log("sending %s to %p",t.type,e),yield sO({peer:e}),yield JN({to:e,type:t.type});try{const n=await this.components.connectionManager.openConnection(e,r),s=await n.newStream(this.protocol,r),i=await this._writeReadMessage(s,t.serialize(),r);yield ZN({from:e,messageType:i.type,closer:i.closerPeers,providers:i.providerPeers,record:i.record})}catch(t){yield tO({from:e,error:t})}finally{null!=s&&s.close()}}async*sendMessage(e,t,r={}){if(!this.running)return;this.log("sending %s to %p",t.type,e),yield sO({peer:e}),yield JN({to:e,type:t.type});try{const n=await this.components.connectionManager.openConnection(e,r),s=await n.newStream(this.protocol,r);await this._writeMessage(s,t.serialize(),r),yield ZN({from:e,messageType:t.type})}catch(t){yield tO({from:e,error:t})}finally{null!=s&&s.close()}}async _writeMessage(e,t,r){null!=r.signal&&(e=NC(e,r.signal)),await zh([t],FC(),e,Qu)}async _writeReadMessage(e,t,r){null!=r.signal&&(e=NC(e,r.signal));const n=await zh([t],FC(),e,MC(),(async e=>{const t=await rm(e);if(null!=t)return t;throw ie(new Error("No message received"),"ERR_NO_MESSAGE_RECEIVED")})),s=WN.deserialize(n);return s.closerPeers.forEach((e=>{this.dispatchEvent(new F_("peer",{detail:e}))})),s.providerPeers.forEach((e=>{this.dispatchEvent(new F_("peer",{detail:e}))})),s}}function oO(e,t){const r=t.key,n=Ts(r).split("/");if(n.length<3)return;const s=e[n[1].toString()];if(null==s){throw ie(new Error("Invalid record keytype"),"ERR_INVALID_RECORD_KEY_TYPE")}return s(r,t.value)}const aO={pk:async(e,t)=>{if(!(e instanceof Uint8Array))throw ie(new Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(e.byteLength<5)throw ie(new Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");if("/pk/"!==Ts(e.subarray(0,4)))throw ie(new Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");if(!ii(e.slice(4),(await $n.digest(t)).bytes))throw ie(new Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")}};const AO={pk:function(e,t){return 0}};class cO{constructor(e,t){const{validators:r,selectors:n,peerRouting:s,queryManager:i,routingTable:o,network:a,lan:A}=t;this.components=e,this.log=se(`libp2p:kad-dht:${A?"lan":"wan"}:content-fetching`),this.validators=r,this.selectors=n,this.peerRouting=s,this.queryManager=i,this.routingTable=o,this.network=a}async putLocal(e,t){const r=QN(e);await this.components.datastore.put(r,t)}async getLocal(e){this.log("getLocal %b",e);const t=QN(e);this.log("fetching record for key %k",t);const r=await this.components.datastore.get(t);this.log("found %k in local datastore",t);const n=ah.deserialize(r);return await oO(this.validators,n),n}async*sendCorrectionRecord(e,t,r,n={}){this.log("sendCorrection for %b",e);const s=await xN(e,r);for(const{value:i,from:o}of t){if(ii(i,r)){this.log("record was ok");continue}if(this.components.peerId.equals(o)){try{const t=QN(e);this.log(`Storing corrected record for key ${t.toString()}`),await this.components.datastore.put(t,s.subarray())}catch(e){this.log.error("Failed error correcting self",e)}continue}let t=!1;const a=new WN(GN.PUT_VALUE,e,0);a.record=ah.deserialize(s);for await(const e of this.network.sendRequest(o,a,n))"PEER_RESPONSE"===e.name&&null!=e.record&&ii(e.record.value,ah.deserialize(s).value)&&(t=!0),yield e;t||(yield tO({from:o,error:ie(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})),this.log.error("Failed error correcting entry")}}async*put(e,t,r={}){this.log("put key %b value %b",e,t);const n=await xN(e,t),s=QN(e);this.log(`storing record for key ${s.toString()}`),await this.components.datastore.put(s,n.subarray()),yield*zh(this.peerRouting.getClosestPeers(e,{signal:r.signal}),(t=>xh(t,(t=>async()=>{if("FINAL_PEER"!==t.name)return[t];const s=[],i=new WN(GN.PUT_VALUE,e,0);i.record=ah.deserialize(n),this.log("send put to %p",t.peer.id);for await(const e of this.network.sendRequest(t.peer.id,i,r))s.push(e),"PEER_RESPONSE"===e.name&&(null!=e.record&&ii(e.record.value,ah.deserialize(n).value)||s.push(tO({from:t.peer.id,error:ie(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})));return s}))),(e=>Qh(e,{ordered:!1,concurrency:IN})),(async function*(e){for await(const t of e)yield*t}))}async*get(e,t={}){this.log("get %b",e);const r=[];for await(const n of this.getMany(e,t))"VALUE"===n.name&&r.push(n),yield n;if(0===r.length)return;const n=r.map((e=>e.value));let s=0;try{s=function(e,t,r){if(0===r.length)throw ie(new Error("No records given"),"ERR_NO_RECORDS_RECEIVED");const n=Ts(t).split("/");if(n.length<3)throw ie(new Error("Record key does not have a selector function"),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY");const s=e[n[1].toString()];if(null==s){const e=`Unrecognized key prefix: ${n[1]}`;throw ie(new Error(e),"ERR_UNRECOGNIZED_KEY_PREFIX")}return 1===r.length?0:s(t,r)}(this.selectors,e,n)}catch(e){if("ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY"!==e.code)throw e}const i=n[s];if(this.log("GetValue %b %b",e,i),null==i)throw ie(new Error("best value was not found"),"ERR_NOT_FOUND");yield*this.sendCorrectionRecord(e,r,i,t),yield r[s]}async*getMany(e,t={}){this.log("getMany values for %b",e);try{const t=await this.getLocal(e);yield nO({value:t.value,from:this.components.peerId})}catch(t){this.log("error getting local value for %b",e,t)}const r=await ON(e),n=this.routingTable.closestPeers(r);this.log("found %d peers in routing table",n.length);const s=this;yield*this.queryManager.run(e,n,(async function*({peer:t,signal:r}){for await(const n of s.peerRouting.getValueOrPeers(t,e,{signal:r}))yield n,"PEER_RESPONSE"===n.name&&null!=n.record&&(yield nO({from:t,value:n.record.value}))}),t)}}class lO{constructor(e,t){const{network:r,peerRouting:n,queryManager:s,routingTable:i,providers:o,lan:a}=t;this.components=e,this.log=se(`libp2p:kad-dht:${a?"lan":"wan"}:content-routing`),this.network=r,this.peerRouting=n,this.queryManager=s,this.routingTable=i,this.providers=o}async*provide(e,t,r={}){this.log("provide %s",e),await this.providers.addProvider(e,this.components.peerId);const n=new WN(GN.ADD_PROVIDER,e.multihash.bytes,0);n.providerPeers=[{id:this.components.peerId,multiaddrs:t,protocols:[]}];let s=0;const i=t=>async()=>{if("FINAL_PEER"!==t.name)return[t];const i=[];this.log("putProvider %s to %p",e,t.peer.id);try{this.log("sending provider record for %s to %p",e,t.peer.id);for await(const o of this.network.sendMessage(t.peer.id,n,r))"PEER_RESPONSE"===o.name&&(this.log("sent provider record for %s to %p",e,t.peer.id),s++),i.push(o)}catch(e){this.log.error("error sending provide record to peer %p",t.peer.id,e),i.push(tO({from:t.peer.id,error:e}))}return i};yield*zh(this.peerRouting.getClosestPeers(e.multihash.bytes,r),(e=>xh(e,(e=>i(e)))),(e=>Qh(e,{ordered:!1,concurrency:IN})),(async function*(e){for await(const t of e)yield*t})),this.log("sent provider records to %d peers",s)}async*findProviders(e,t){const r=this.routingTable.kBucketSize,n=e.multihash.bytes,s=await ON(n),i=this;this.log("findProviders %c",e);const o=await this.providers.getProviders(e);if(o.length>0){const e=[];for(const t of o.slice(0,r))e.push({id:t,multiaddrs:(await this.components.peerStore.addressBook.get(t)??[]).map((e=>e.multiaddr)),protocols:[]});yield ZN({from:this.components.peerId,messageType:GN.GET_PROVIDERS,providers:e}),yield rO({from:this.components.peerId,providers:e})}if(o.length>=r)return;const a=async function*({peer:e,signal:t}){const r=new WN(GN.GET_PROVIDERS,n,0);yield*i.network.sendRequest(e,r,{signal:t})},A=new Set(o.map((e=>e.toString())));for await(const i of this.queryManager.run(n,this.routingTable.closestPeers(s),a,t))if(yield i,"PEER_RESPONSE"===i.name){this.log("Found %d provider entries for %c and %d closer peers",i.providers.length,e,i.closer.length);const t=[];for(const e of i.providers)A.has(e.id.toString())||(A.add(e.id.toString()),t.push(e));if(t.length>0&&(yield rO({from:i.from,providers:t})),A.size===r)return}}}class uO{constructor(e,t){this.originDhtKey=e,this.capacity=t,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map((e=>e.peerId))}async add(e){if(null!=this.peerDistances.find((t=>t.peerId.equals(e))))return;const t=await FN(e),r={peerId:e,distance:HN(this.originDhtKey,t)};this.peerDistances.push(r),this.peerDistances.sort(((e,t)=>nv(e.distance,t.distance))),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(e){if(0===e.length)return!1;if(0===this.length)return!0;const t=await Promise.all(e.map(FN)),r=this.peerDistances[this.peerDistances.length-1].distance;for(const e of t){if(nv(HN(this.originDhtKey,e),r)<0)return!0}return!1}}class hO{constructor(e,t){const{routingTable:r,network:n,validators:s,queryManager:i,lan:o}=t;this.components=e,this.routingTable=r,this.network=n,this.validators=s,this.queryManager=i,this.log=se(`libp2p:kad-dht:${o?"lan":"wan"}:peer-routing`)}async findPeerLocal(e){let t;const r=await this.routingTable.find(e);if(null!=r){this.log("findPeerLocal found %p in routing table",e);try{t=await this.components.peerStore.get(r)}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}}if(null==t)try{t=await this.components.peerStore.get(e)}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}if(null!=t)return this.log("findPeerLocal found %p in peer store",e),{id:t.id,multiaddrs:t.addresses.map((e=>e.multiaddr)),protocols:[]}}async*_getValueSingle(e,t,r={}){const n=new WN(GN.GET_VALUE,t,0);yield*this.network.sendRequest(e,n,r)}async*getPublicKeyFromNode(e,t={}){const r=function(e){return Fs([PN,e.toBytes()])}(e);for await(const n of this._getValueSingle(e,r,t))if(yield n,"PEER_RESPONSE"===n.name&&null!=n.record){const t=await ka(tu({bytes:n.record.value}));if(!t.equals(e))throw ie(new Error("public key does not match id"),"ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");if(null==t.publicKey)throw ie(new Error("public key missing"),"ERR_PUBLIC_KEY_MISSING");yield nO({from:e,value:t.publicKey})}throw ie(new Error(`Node not responding with its public key: ${e.toString()}`),"ERR_INVALID_RECORD")}async*findPeer(e,t={}){this.log("findPeer %p",e);const r=await this.findPeerLocal(e);if(null!=r)return this.log("found local"),void(yield eO({from:this.components.peerId,peer:r}));const n=await FN(e),s=this.routingTable.closestPeers(n);if(null!=s.find((t=>t.equals(e))))try{const t=await this.components.peerStore.get(e);return this.log("found in peerStore"),void(yield eO({from:this.components.peerId,peer:{id:t.id,multiaddrs:t.addresses.map((e=>e.multiaddr)),protocols:[]}}))}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}const i=this,o=async function*({peer:t,signal:r}){const n=new WN(GN.FIND_NODE,e.toBytes(),0);for await(const s of i.network.sendRequest(t,n,{signal:r}))if(yield s,"PEER_RESPONSE"===s.name){const t=s.closer.find((t=>t.id.equals(e)));null!=t&&(yield eO({from:s.from,peer:t}))}};let a=!1;for await(const r of this.queryManager.run(e.toBytes(),s,o,t))"FINAL_PEER"===r.name&&(a=!0),yield r;a||(yield tO({from:this.components.peerId,error:ie(new Error("Not found"),"ERR_NOT_FOUND")}))}async*getClosestPeers(e,t={}){this.log("getClosestPeers to %b",e);const r=await ON(e),n=this.routingTable.closestPeers(r),s=this,i=new uO(r,this.routingTable.kBucketSize);await Promise.all(n.map((async e=>await i.add(e))));const o=async function*({peer:t,signal:r}){s.log("closerPeersSingle %s from %p",Ts(e,"base32"),t);const n=new WN(GN.FIND_NODE,e,0);yield*s.network.sendRequest(t,n,{signal:r})};for await(const r of this.queryManager.run(e,n,o,t))yield r,"PEER_RESPONSE"===r.name&&await Promise.all(r.closer.map((async e=>await i.add(e.id))));this.log("found %d peers close to %b",i.length,e);for(const e of i.peers)yield eO({from:this.components.peerId,peer:{id:e,multiaddrs:(await this.components.peerStore.addressBook.get(e)??[]).map((e=>e.multiaddr)),protocols:[]}})}async*getValueOrPeers(e,t,r={}){for await(const n of this._getValueSingle(e,t,r)){if("PEER_RESPONSE"===n.name&&null!=n.record)try{await this._verifyRecordOnline(n.record)}catch(e){const t="invalid record received, discarded";this.log(t),yield tO({from:n.from,error:ie(new Error(t),"ERR_INVALID_RECORD")});continue}yield n}}async _verifyRecordOnline(e){if(null==e.timeReceived)throw ie(new Error("invalid record received"),"ERR_INVALID_RECORD");await oO(this.validators,new ah(e.key,e.value,e.timeReceived))}async getCloserPeersOffline(e,t){const r=await ON(e),n=this.routingTable.closestPeers(r),s=[];for(const e of n)if(!e.equals(t))try{const t=await this.components.peerStore.addressBook.get(e),r=await this.components.peerStore.protoBook.get(e);s.push({id:e,multiaddrs:t.map((e=>e.multiaddr)),protocols:r})}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}return s.length>0?this.log("getCloserPeersOffline found %d peer(s) closer to %b than %p",s.length,e,t):this.log("getCloserPeersOffline could not find peer closer to %b than %p",e,t),s}}const dO=se("libp2p:kad-dht:providers");class fO{constructor(e,t={}){const{cacheSize:r,cleanupInterval:n,provideValidity:s}=t;this.components=e,this.cleanupInterval=n??36e5,this.provideValidity=s??864e5,this.cache=Io(r??256),this.syncQueue=new ua({concurrency:1}),this.started=!1}isStarted(){return this.started}async start(){this.started||(this.started=!0,this.cleaner=setInterval((()=>{this._cleanup().catch((e=>{dO.error(e)}))}),this.cleanupInterval))}async stop(){this.started=!1,null!=this.cleaner&&(clearInterval(this.cleaner),this.cleaner=void 0)}async _cleanup(){return await this.syncQueue.add((async()=>{const e=Date.now();let t=0,r=0;const n=new Map,s=this.components.datastore.batch(),i=this.components.datastore.query({prefix:CN});for await(const e of i)try{const{cid:i,peerId:o}=gO(e.key),a=yO(e.value).getTime(),A=Date.now(),c=A-a,l=c>this.provideValidity;if(dO("comparing: %d - %d = %d > %d %s",A,a,c,this.provideValidity,l?"(expired)":""),l){r++,s.delete(e.key);const t=n.get(i)??new Set;t.add(o),n.set(i,t)}t++}catch(e){dO.error(e.message)}n.size>0?(dO("deleting %d / %d entries",r,t),await s.commit()):dO("nothing to delete");for(const[e,t]of n){const r=pO(e),n=this.cache.get(r);if(null!=n){for(const e of t)n.delete(e);0===n.size?this.cache.remove(r):this.cache.set(r,n)}}dO("Cleanup successful (%dms)",Date.now()-e)}))}async _getProvidersMap(e){const t=pO(e);let r=this.cache.get(t);return null==r&&(r=await async function(e,t){const r=new Map,n=e.query({prefix:pO(t)});for await(const e of n){const{peerId:t}=gO(e.key);r.set(t,yO(e.value))}return r}(this.components.datastore,e),this.cache.set(t,r)),r}async addProvider(e,t){return await this.syncQueue.add((async()=>{dO("%p provides %s",t,e);const r=await this._getProvidersMap(e);dO("loaded %s provs",r.size);const n=new Date;r.set(t.toString(),n);const s=pO(e);this.cache.set(s,r),await async function(e,t,r,n){const s=[pO(t),"/",r.toString()].join(""),i=new Ao(s),o=Uint8Array.from(Os.encode(n.getTime()));return await e.put(i,o)}(this.components.datastore,e,t,n)}))}async getProviders(e){return await this.syncQueue.add((async()=>{dO("get providers for %s",e);return[...(await this._getProvidersMap(e)).keys()].map((e=>Ta(e)))}))}}function pO(e){const t="string"==typeof e?e:Ts(e.multihash.bytes,"base32");return`${CN}/${t}`}function gO(e){const t=e.toString().split("/");if(5!==t.length)throw new Error(`incorrectly formatted provider entry key in datastore: ${e.toString()}`);return{cid:t[3],peerId:t[4]}}function yO(e){return new Date(Os.decode(e))}const wO=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");async function*mO(e){const{key:t,startingPeer:r,ourPeerId:n,signal:s,query:i,alpha:o,pathIndex:a,numPaths:A,cleanUp:c,queryFuncTimeout:l,log:u,peersSeen:h}=e,d=new ua({concurrency:o}),f=await ON(t);!function e(r,o){if(null==r)return;h.add(r);const c=BigInt("0x"+Ts(HN(o,f),"base16"));d.add((async()=>{let o;const p=[s];null!=l&&(o=new Bs.TimeoutController(l),p.push(o.signal));const g=(0,co.anySignal)(p);try{for await(const s of i({key:t,peer:r,signal:g,pathIndex:a,numPaths:A})){if(g.aborted)return;if("PEER_RESPONSE"===s.name)for(const i of s.closer){if(h.has(i.id)){u("already seen %p in query",i.id);continue}if(n.equals(i.id)){u("not querying ourselves");continue}const s=await FN(i.id);BigInt("0x"+Ts(HN(s,f),"base16"))>c?u("skipping %p as they are not closer to %b than %p",i.id,t,r):(u("querying closer peer %p",i.id),e(i.id,s))}d.emit("completed",s)}o?.clear()}catch(e){s.aborted?d.emit("error",e):d.emit("completed",tO({from:r,error:e}))}finally{o?.clear()}}),{priority:wO-c}).catch((e=>{u.error(e)}))}(r,await FN(r)),yield*async function*(e,t,r,n){let s=Oh(),i=!0;const o=[],a=()=>{i&&(n("clean up queue, results %d, queue size %d, pending tasks %d",o.length,e.size,e.pending),i=!1,e.clear(),o.splice(0,o.length))};e.on("completed",(e=>{o.push(e),s.resolve()})),e.on("error",(e=>{n("queue error",e),a(),s.reject(e)})),e.on("idle",(()=>{n("queue idle"),i=!1,s.resolve()})),t.addEventListener("abort",(()=>{n("abort queue");const e=i;a(),e&&s.reject(ie(new Error("Query aborted"),"ERR_QUERY_ABORTED"))})),r.addEventListener("cleanup",(()=>{a(),s.resolve()}));for(;i;)for(await s.promise,s=Oh();o.length>0;){const e=o.shift();null!=e&&(yield e)}yield*o}(d,s,c,u)}class bO{constructor(e,t){const{lan:r=!1,disjointPaths:n=SN,alpha:s=IN}=t;this.components=e,this.disjointPaths=n??SN,this.controllers=new Set,this.running=!1,this.alpha=s??IN,this.lan=r,this.queries=0}isStarted(){return this.running}async start(){this.running=!0,null!=this.components.metrics&&null==this.metrics&&(this.metrics={runningQueries:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_running_queries`),queryTime:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_query_time_seconds`)})}async stop(){this.running=!1;for(const e of this.controllers)e.abort();this.controllers.clear()}async*run(e,t,r,n={}){if(!this.running)throw new Error("QueryManager not started");const s=this.metrics?.queryTime.timer();let i;if(null==n.signal){i=new Bs.TimeoutController(DN),n.signal=i.signal;try{null!=xU.setMaxListeners&&(0,xU.setMaxListeners)(1/0,i.signal)}catch{}}const o=new AbortController;this.controllers.add(o);const a=[o.signal];null!=n.signal&&a.push(n.signal);const A=(0,co.anySignal)(a);try{null!=xU.setMaxListeners&&(0,xU.setMaxListeners)(1/0,A)}catch{}const c=se(`libp2p:kad-dht:${this.lan?"lan":"wan"}:query:`+Ts(e,"base58btc")),l=t.slice(0,Math.min(this.disjointPaths,t.length)),u=Date.now(),h=new N_;try{if(c("query:start"),this.queries++,this.metrics?.runningQueries.update(this.queries),0===t.length)return void c.error("Running query with no peers");const a=new eD,d=l.map(((t,s)=>mO({key:e,startingPeer:t,ourPeerId:this.components.peerId,signal:A,query:r,pathIndex:s,numPaths:l.length,alpha:this.alpha,cleanUp:h,queryFuncTimeout:n.queryFuncTimeout,log:c,peersSeen:a})));for await(const e of Mh(...d))yield e,"QUERY_ERROR"===e.name&&c("error",e.error)}catch(e){if(this.running||"ERR_QUERY_ABORTED"!==e.code)throw e}finally{this.controllers.delete(o),null!=i&&i.clear(),this.queries--,this.metrics?.runningQueries.update(this.queries),null!=s&&s(),h.dispatchEvent(new F_("cleanup")),c("query:done in %dms",Date.now()-u)}}}const EO=se("libp2p:kad-dht:rpc:handlers:add-provider");class vO{constructor(e){const{providers:t}=e;this.providers=t}async handle(e,t){if(EO("start"),null==t.key||0===t.key.length)throw ie(new Error("Missing key"),"ERR_MISSING_KEY");let r;try{r=Ve.decode(t.key)}catch(e){throw ie(new Error("Invalid CID"),"ERR_INVALID_CID")}null!=t.providerPeers&&0!==t.providerPeers.length||EO.error("no providers found in message"),await Promise.all(t.providerPeers.map((async t=>{t.id.equals(e)?t.multiaddrs.length<1?EO("no valid addresses for provider %p. Ignore",e):(EO("received provider %p for %s (addrs %s)",e,r,t.multiaddrs.map((e=>e.toString()))),await this.providers.addProvider(r,t.id)):EO("invalid provider peer %p from %p",t.id,e)})))}}const BO=se("libp2p:kad-dht:rpc:handlers:find-node");class _O{constructor(e,t){const{peerRouting:r,lan:n}=t;this.components=e,this.peerRouting=r,this.lan=Boolean(n)}async handle(e,t){BO("incoming request from %p for peers closer to %b",e,t.key);let r=[];r=ii(this.components.peerId.toBytes(),t.key)?[{id:this.components.peerId,multiaddrs:this.components.addressManager.getAddresses().map((e=>e.decapsulateCode(Ns("p2p").code))),protocols:[]}]:await this.peerRouting.getCloserPeersOffline(t.key,e),r=r.map(this.lan?NN:LN).filter((({multiaddrs:e})=>e.length));const n=new WN(t.type,new Uint8Array(0),t.clusterLevel);return r.length>0?n.closerPeers=r:BO("could not find any peers closer to %b than %p",t.key,e),n}}const CO=se("libp2p:kad-dht:rpc:handlers:get-providers");class SO{constructor(e,t){const{peerRouting:r,providers:n,lan:s}=t;this.components=e,this.peerRouting=r,this.providers=n,this.lan=Boolean(s)}async handle(e,t){let r;try{r=Ve.decode(t.key)}catch(e){throw ie(new Error("Invalid CID"),"ERR_INVALID_CID")}CO("%p asking for providers for %s",e,r);const[n,s]=await Promise.all([this.providers.getProviders(r),this.peerRouting.getCloserPeersOffline(t.key,e)]),i=await this._getPeers(n),o=await this._getPeers(s.map((({id:e})=>e))),a=new WN(t.type,t.key,t.clusterLevel);return i.length>0&&(a.providerPeers=i),o.length>0&&(a.closerPeers=o),CO("got %s providers %s closerPeers",i.length,o.length),a}async _getAddresses(e){return(await this.components.peerStore.addressBook.get(e)).map((e=>e.multiaddr))}async _getPeers(e){const t=[],r=this.lan?NN:LN;for(const n of e){const e=r({id:n,multiaddrs:await this._getAddresses(n),protocols:[]});e.multiaddrs.length>0&&t.push(e)}return t}}const IO=se("libp2p:kad-dht:rpc:handlers:get-value");class TO{constructor(e,t){const{peerRouting:r}=t;this.components=e,this.peerRouting=r}async handle(e,t){const r=t.key;if(IO("%p asked for key %b",e,r),null==r||0===r.length)throw ie(new Error("Invalid key"),"ERR_INVALID_KEY");const n=new WN(GN.GET_VALUE,r,t.clusterLevel);if(function(e){return"/pk/"===Ts(e.subarray(0,4))}(r)){IO("is public key");const e=function(e){return Ra(e.subarray(4))}(r);let t;try{const r=await this.components.peerStore.keyBook.get(e);if(null==r)throw ie(new Error("No public key found in key book"),"ERR_NOT_FOUND");t=r}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}if(null!=t)return IO("returning found public key"),n.record=new ah(r,t,new Date),n}const[s,i]=await Promise.all([this._checkLocalDatastore(r),this.peerRouting.getCloserPeersOffline(t.key,e)]);return null!=s&&(IO("had record for %b in local datastore",r),n.record=s),i.length>0&&(IO("had %s closer peers in routing table",i.length),n.closerPeers=i),n}async _checkLocalDatastore(e){IO("checkLocalDatastore looking for %b",e);const t=QN(e);let r;try{r=await this.components.datastore.get(t)}catch(e){if("ERR_NOT_FOUND"===e.code)return;throw e}const n=ah.deserialize(r);if(null==n)throw ie(new Error("Invalid record"),"ERR_INVALID_RECORD");if(!(null==n.timeReceived||Date.now()-n.timeReceived.getTime()>1296e5))return n;await this.components.datastore.delete(t)}}const RO=se("libp2p:kad-dht:rpc:handlers:ping");class kO{async handle(e,t){return RO("ping from %p",e),t}}class UO{constructor(e,t){const{validators:r}=t;this.components=e,this.log=se("libp2p:kad-dht:rpc:handlers:put-value"),this.validators=r}async handle(e,t){const r=t.key;this.log("%p asked us to store value for key %b",e,r);const n=t.record;if(null==n){const t=`Empty record from: ${e.toString()}`;throw this.log.error(t),ie(new Error(t),"ERR_EMPTY_RECORD")}try{await oO(this.validators,n),n.timeReceived=new Date;const e=QN(n.key);await this.components.datastore.put(e,n.serialize().subarray()),this.log("put record for %b into datastore under key %k",r,e)}catch(e){this.log("did not put record for key %b into datastore %o",r,e)}return t}}class DO{constructor(e,t){const{providers:r,peerRouting:n,validators:s,lan:i}=t;this.log=se("libp2p:kad-dht:rpc"),this.routingTable=t.routingTable,this.handlers={[GN.GET_VALUE]:new TO(e,{peerRouting:n}),[GN.PUT_VALUE]:new UO(e,{validators:s}),[GN.FIND_NODE]:new _O(e,{peerRouting:n,lan:i}),[GN.ADD_PROVIDER]:new vO({providers:r}),[GN.GET_PROVIDERS]:new SO(e,{peerRouting:n,providers:r,lan:i}),[GN.PING]:new kO}}async handleMessage(e,t){try{await this.routingTable.add(e)}catch(e){this.log.error("Failed to update the kbucket store",e)}const r=this.handlers[t.type];if(null!=r)return await r.handle(e,t);this.log.error(`no handler found for message type: ${t.type}`)}onIncomingStream(e){Promise.resolve().then((async()=>{const{stream:t,connection:r}=e,n=r.remotePeer;try{await this.routingTable.add(n)}catch(e){this.log.error(e)}const s=this;await zh(t,MC(),(async function*(e){for await(const t of e){const e=WN.deserialize(t);s.log("incoming %s from %p",e.type,n);const r=await s.handleMessage(n,e);null!=r&&(yield r.serialize())}}),FC(),t)})).catch((e=>{this.log.error(e)}))}}class PO extends N_{constructor(e,t){super();const{protocol:r,lan:n}=t;this.components=e,this.log=se("libp2p:kad-dht:topology-listener:"+(n?"lan":"wan")),this.running=!1,this.protocol=r}isStarted(){return this.running}async start(){if(this.running)return;this.running=!0;const e=D_({onConnect:e=>{this.log("observed peer %p with protocol %s",e,this.protocol),this.dispatchEvent(new F_("peer",{detail:e}))}});this.registrarId=await this.components.registrar.register(this.protocol,e)}stop(){this.running=!1,null!=this.registrarId&&(this.components.registrar.unregister(this.registrarId),this.registrarId=void 0)}}class LO{constructor(e,t){const{peerRouting:r,lan:n,count:s,interval:i,queryTimeout:o}=t;this.components=e,this.log=se(`libp2p:kad-dht:${n?"lan":"wan"}:query-self`),this.running=!1,this.peerRouting=r,this.count=s??SN,this.interval=i??TN,this.queryTimeout=o??RN}isStarted(){return this.running}async start(){this.running||(this.running=!0,this._querySelf())}async stop(){this.running=!1,null!=this.timeoutId&&clearTimeout(this.timeoutId),null!=this.controller&&this.controller.abort()}_querySelf(){Promise.resolve().then((async()=>{const e=new Bs.TimeoutController(this.queryTimeout);try{this.controller=new AbortController;const t=(0,co.anySignal)([this.controller.signal,e.signal]);try{null!=xU.setMaxListeners&&(0,xU.setMaxListeners)(1/0,t)}catch{}const r=await zh(this.peerRouting.getClosestPeers(this.components.peerId.toBytes(),{signal:t}),(e=>Mu(e,this.count)),(async e=>await ME(e)));this.log("query ran successfully - found %d peers",r)}catch(e){this.log("query error",e)}finally{this.timeoutId=setTimeout(this._querySelf.bind(this),this.interval),e.clear()}})).catch((e=>{this.log("query error",e)}))}}class NO extends N_{constructor(e,t){super();const{kBucketSize:r,clientMode:n,validators:s,selectors:i,querySelfInterval:o,lan:a,protocolPrefix:A,pingTimeout:c,pingConcurrency:l,maxInboundStreams:u,maxOutboundStreams:h,providers:d}=t;this.running=!1,this.components=e,this.lan=Boolean(a),this.log=se("libp2p:kad-dht:"+(!0===a?"lan":"wan")),this.protocol=`${A??"/ipfs"}${!0===a?"/lan":""}/kad/1.0.0`,this.kBucketSize=r??20,this.clientMode=n??!0,this.maxInboundStreams=u??32,this.maxOutboundStreams=h??64,this.routingTable=new MN(e,{kBucketSize:r,lan:this.lan,pingTimeout:c,pingConcurrency:l,protocol:this.protocol}),this.providers=new fO(e,d??{}),this.validators={...aO,...s},this.selectors={...AO,...i},this.network=new iO(e,{protocol:this.protocol,lan:this.lan}),this.queryManager=new bO(e,{disjointPaths:Math.ceil(this.kBucketSize/2),lan:a}),this.peerRouting=new hO(e,{routingTable:this.routingTable,network:this.network,validators:this.validators,queryManager:this.queryManager,lan:this.lan}),this.contentFetching=new cO(e,{validators:this.validators,selectors:this.selectors,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,network:this.network,lan:this.lan}),this.contentRouting=new lO(e,{network:this.network,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,providers:this.providers,lan:this.lan}),this.routingTableRefresh=new VN({peerRouting:this.peerRouting,routingTable:this.routingTable,lan:this.lan}),this.rpc=new DO(e,{routingTable:this.routingTable,providers:this.providers,peerRouting:this.peerRouting,validators:this.validators,lan:this.lan}),this.topologyListener=new PO(e,{protocol:this.protocol,lan:this.lan}),this.querySelf=new LO(e,{peerRouting:this.peerRouting,interval:o,lan:this.lan}),this.network.addEventListener("peer",(e=>{const t=e.detail;this.onPeerConnect(t).catch((e=>{this.log.error("could not add %p to routing table",t.id,e)})),this.dispatchEvent(new F_("peer",{detail:t}))})),this.topologyListener.addEventListener("peer",(e=>{const t=e.detail;Promise.resolve().then((async()=>{const e=await this.components.peerStore.addressBook.get(t),r={id:t,multiaddrs:e.map((e=>e.multiaddr)),protocols:[]};await this.onPeerConnect(r)})).catch((e=>{this.log.error("could not add %p to routing table",t,e)}))}))}get[CU](){return!0}get[Symbol.toStringTag](){return"@libp2p/kad-dht"}async onPeerConnect(e){if(this.log("peer %p connected with protocols %s",e.id,e.protocols),0!==(e=this.lan?NN(e):LN(e)).multiaddrs.length)try{await this.routingTable.add(e.id)}catch(t){this.log.error("could not add %p to routing table",e.id,t)}else this.log("ignoring %p as they do not have any %s addresses in %s",e.id,this.lan?"private":"public",e.multiaddrs.map((e=>e.toString())))}isStarted(){return this.running}async getMode(){return this.clientMode?"client":"server"}async setMode(e){await this.components.registrar.unhandle(this.protocol),"client"===e?(this.log("enabling client mode"),this.clientMode=!0):(this.log("enabling server mode"),this.clientMode=!1,await this.components.registrar.handle(this.protocol,this.rpc.onIncomingStream.bind(this.rpc),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}))}async start(){this.running=!0,await this.setMode(this.clientMode?"client":"server"),await Promise.all([this.providers.start(),this.queryManager.start(),this.network.start(),this.routingTable.start(),this.topologyListener.start(),this.querySelf.start()]),await this.routingTableRefresh.start()}async stop(){this.running=!1,await Promise.all([this.providers.stop(),this.queryManager.stop(),this.network.stop(),this.routingTable.stop(),this.routingTableRefresh.stop(),this.topologyListener.stop(),this.querySelf.stop()])}async*put(e,t,r={}){yield*this.contentFetching.put(e,t,r)}async*get(e,t={}){yield*this.contentFetching.get(e,t)}async*provide(e,t={}){yield*this.contentRouting.provide(e,this.components.addressManager.getAddresses(),t)}async*findProviders(e,t={}){yield*this.contentRouting.findProviders(e,t)}async*findPeer(e,t={}){yield*this.peerRouting.findPeer(e,t)}async*getClosestPeers(e,t={}){yield*this.peerRouting.getClosestPeers(e,t)}async refreshRoutingTable(){await this.routingTableRefresh.refreshTable(!0)}}const OO=se("libp2p:kad-dht");class FO extends N_{constructor(e,t,r){super(),this.components=e,this.wan=t,this.lan=r,this.wan.addEventListener("peer",(e=>{this.dispatchEvent(new F_("peer",{detail:e.detail}))})),this.lan.addEventListener("peer",(e=>{this.dispatchEvent(new F_("peer",{detail:e.detail}))}))}get[CU](){return!0}get[Symbol.toStringTag](){return"@libp2p/dual-kad-dht"}isStarted(){return this.wan.isStarted()&&this.lan.isStarted()}async getMode(){return await this.wan.getMode()}async setMode(e){await this.wan.setMode(e)}async start(){await Promise.all([this.lan.start(),this.wan.start()])}async stop(){await Promise.all([this.lan.stop(),this.wan.stop()])}async*put(e,t,r={}){for await(const n of Mh(this.lan.put(e,t,r),this.wan.put(e,t,r)))yield n}async*get(e,t={}){let r=!1,n=!1;for await(const s of Mh(this.lan.get(e,t),this.wan.get(e,t)))yield s,"DIALING_PEER"===s.name&&(r=!0),"VALUE"===s.name&&(r=!0,null!=s.value&&(n=!0)),"SENDING_QUERY"===s.name&&(r=!0);if(!r)throw ie(new Error("No peers found in routing table!"),"ERR_NO_PEERS_IN_ROUTING_TABLE");n||(yield tO({from:this.components.peerId,error:ie(new Error("Not found"),"ERR_NOT_FOUND")}))}async*provide(e,t={}){let r=0,n=0;const s=[],i=[this.lan];"server"===await this.wan.getMode()&&i.push(this.wan);for await(const o of Mh(...i.map((r=>r.provide(e,t)))))yield o,"SENDING_QUERY"===o.name&&r++,"QUERY_ERROR"===o.name&&s.push(o.error),"PEER_RESPONSE"===o.name&&"ADD_PROVIDER"===o.messageName&&(OO("sent provider record for %s to %p",e,o.from),n++);if(0===n){if(s.length>0)throw ie(new Error(`Failed to provide to ${s.length} of ${r} peers`),"ERR_PROVIDES_FAILED",{errors:s});throw ie(new Error("Failed to provide - no peers found"),"ERR_PROVIDES_FAILED")}}async*findProviders(e,t={}){yield*Mh(this.lan.findProviders(e,t),this.wan.findProviders(e,t))}async*findPeer(e,t={}){let r=!1;for await(const n of Mh(this.lan.findPeer(e,t),this.wan.findPeer(e,t)))yield n,"SENDING_QUERY"!==n.name&&"FINAL_PEER"!==n.name||(r=!0);if(!r)throw ie(new Error("Peer lookup failed"),"ERR_LOOKUP_FAILED")}async*getClosestPeers(e,t={}){yield*Mh(this.lan.getClosestPeers(e,t),this.wan.getClosestPeers(e,t))}async refreshRoutingTable(){await Promise.all([this.lan.refreshRoutingTable(),this.wan.refreshRoutingTable()])}}class QO extends FO{constructor(e,t){super(e,new NO(e,{protocolPrefix:"/ipfs",...t,lan:!1}),new NO(e,{protocolPrefix:"/ipfs",...t,clientMode:!1,lan:!0}))}}const xO=se("libp2p:bootstrap");class MO extends N_{constructor(e,t={list:[]}){if(null==t.list||0===t.list.length)throw new Error("Bootstrap requires a list of peer addresses");super(),this.components=e,this.timeout=t.timeout??1e3,this.list=[];for(const e of t.list){if(!Ki.matches(e)){xO.error("Invalid multiaddr");continue}const t=mi(e),r=t.getPeerId();if(null==r){xO.error("Invalid bootstrap multiaddr without peer id");continue}const n={id:Ta(r),multiaddrs:[t],protocols:[]};this.list.push(n)}this._init=t}get[CU](){return!0}get[Symbol.toStringTag](){return"@libp2p/bootstrap"}isStarted(){return Boolean(this.timer)}start(){this.isStarted()||(xO("Starting bootstrap node discovery, discovering peers after %s ms",this.timeout),this.timer=setTimeout((()=>{this._discoverBootstrapPeers().catch((e=>{xO.error(e)}))}),this.timeout))}async _discoverBootstrapPeers(){if(null!=this.timer)for(const e of this.list){if(await this.components.peerStore.tagPeer(e.id,this._init.tagName??"bootstrap",{value:this._init.tagValue??50,ttl:this._init.tagTTL??12e4}),null==this.timer)return;this.dispatchEvent(new F_("peer",{detail:e}))}}stop(){null!=this.timer&&clearTimeout(this.timer),this.timer=void 0}}MO.tag="bootstrap";var HO=WebSocket,KO=r(90507);function VO(e){return e instanceof ArrayBuffer||"ArrayBuffer"===e?.constructor?.name&&"number"==typeof e?.byteLength}var zO=e=>{if(e.readyState>=2)throw new Error("socket closed");if(1!==e.readyState)return new Promise(((t,r)=>{function n(){e.removeEventListener("open",s),e.removeEventListener("error",i)}function s(){n(),t()}function i(t){n(),r(t.error??new Error(`connect ECONNREFUSED ${e.url}`))}e.addEventListener("open",s),e.addEventListener("error",i)}))},jO=(e,t)=>{(t=t??{}).closeOnEnd=!1!==t.closeOnEnd;return async r=>{for await(const t of r){try{await zO(e)}catch(e){if("socket closed"===e.message)break;throw e}e.send(t)}if(null!=t.closeOnEnd&&e.readyState<=1)return await new Promise(((t,r)=>{e.addEventListener("close",(e=>{if(e.wasClean||1006===e.code)t();else{const t=Object.assign(new Error("ws error"),{event:e});r(t)}})),setTimeout((()=>e.close()))}))}},GO=(e,t)=>{t=t??{};const r=(e=>{e.binaryType="arraybuffer";const t=async()=>await new Promise(((t,r)=>{if(s)return t();if(null!=n)return r(n);const i=t=>{e.removeEventListener("open",o),e.removeEventListener("error",a),t()},o=()=>i(t),a=t=>{i((()=>r(t.error??new Error(`connect ECONNREFUSED ${e.url}`))))};e.addEventListener("open",o),e.addEventListener("error",a)})),r=async function*(){const r=new KO.zN((({push:t,stop:r,fail:n})=>{const s=e=>{let r=null;"string"==typeof e.data&&(r=vs(e.data)),VO(e.data)&&(r=new Uint8Array(e.data)),e.data instanceof Uint8Array&&(r=e.data),null!=r&&t(r)},i=e=>n(e.error??new Error("Socket error"));return e.addEventListener("message",s),e.addEventListener("error",i),e.addEventListener("close",r),()=>{e.removeEventListener("message",s),e.removeEventListener("error",i),e.removeEventListener("close",r)}}),{highWaterMark:1/0});await t();for await(const e of r)yield VO(e)?new Uint8Array(e):e}();let n,s=1===e.readyState;return e.addEventListener("open",(()=>{s=!0,n=null})),e.addEventListener("close",(()=>{s=!1,n=null})),e.addEventListener("error",(t=>{s||(n=t.error??new Error(`connect ECONNREFUSED ${e.url}`))})),Object.assign(r,{connected:t})})(e);let n=t.remoteAddress,s=t.remotePort;if(null!=e.url)try{const t=new URL(e.url);n=t.hostname,s=parseInt(t.port,10)}catch{}if(null==n||null==s)throw new Error("Remote connection did not have address and/or port");const i={sink:jO(e,t),source:r,connected:async()=>await r.connected(),close:async()=>{e.readyState!==e.CONNECTING&&e.readyState!==e.OPEN||await new Promise((t=>{e.addEventListener("close",(()=>{t()})),e.close()}))},destroy:()=>{null!=e.terminate?e.terminate():e.close()},remoteAddress:n,remotePort:s,socket:e};return i};const $O={http:"ws",https:"wss"};function qO(e,t){t=t??{};const r=((e,t)=>(0,qi.relative)(e,t,$O,"ws"))(e,("undefined"==typeof window?"":window.location).toString()),n=new HO(r,t.websocket);return GO(n,t)}const WO=se("libp2p:websockets:socket");const YO=se("libp2p:websockets");class XO{constructor(e){this.init=e}get[Symbol.toStringTag](){return"@libp2p/websockets"}get[BU](){return!0}async dial(e,t){YO("dialing %s",e),t=t??{};const r=function(e,t,r){const n={async sink(t){null!=r?.signal&&(t=PC(t,r.signal));try{await e.sink(t)}catch(e){"aborted"!==e.type&&WO.error(e)}},source:null!=(r=r??{}).signal?PC(e.source,r.signal):e.source,remoteAddr:t,timeline:{open:Date.now()},async close(){const t=Date.now();try{await Cm(e.close(),{milliseconds:2e3})}catch(r){const{host:s,port:i}=n.remoteAddr.toOptions();WO("timeout closing stream to %s:%s after %dms, destroying it manually",s,i,Date.now()-t),e.destroy()}finally{n.timeline.close=Date.now()}}};return e.socket.addEventListener("close",(()=>{null==n.timeline.close&&(n.timeline.close=Date.now())}),{once:!0}),n}(await this._connect(e,t),e);YO("new outbound connection %s",r.remoteAddr);const n=await t.upgrader.upgradeOutbound(r);return YO("outbound connection %s upgraded",r.remoteAddr),n}async _connect(e,t){if(!0===t?.signal?.aborted)throw new ya;const r=e.toOptions();YO("dialing %s:%s",r.host,r.port);const n=Oh(),s=e=>{YO.error("connection error:",e),n.reject(e)},i=qO(fm(e),this.init);if(null!=i.socket.on?i.socket.on("error",s):i.socket.onerror=s,null==t.signal)return await Promise.race([i.connected(),n.promise]),YO("connected %s",e),i;let o;const a=new Promise(((e,r)=>{if(o=()=>{r(new ya),i.close().catch((e=>{YO.error("error closing raw socket",e)}))},!0===t?.signal?.aborted)return o();t?.signal?.addEventListener("abort",o)}));try{await Promise.race([a,n.promise,i.connected()])}finally{null!=o&&t?.signal?.removeEventListener("abort",o)}return YO("connected %s",e),i}createListener(e){return function(){throw new Error("WebSocket Servers can not be created in the browser!")}(this.init)}filter(e){return e=Array.isArray(e)?e:[e],null!=this.init?.filter?this.init?.filter(e):nL||aL?function(e){return e.filter((e=>{if(e.protoCodes().includes(290))return!1;const t=e.decapsulateCode(421);return ki.matches(t)}))}(e):function(e){return e.filter((e=>{if(e.protoCodes().includes(290))return!1;const t=e.decapsulateCode(421);return Ri.matches(t)||ki.matches(t)}))}(e)}}function JO(e){return new Uint8Array(e)}var ZO;!function(e){e[e.NEW_STREAM=0]="NEW_STREAM",e[e.MESSAGE_RECEIVER=1]="MESSAGE_RECEIVER",e[e.MESSAGE_INITIATOR=2]="MESSAGE_INITIATOR",e[e.CLOSE_RECEIVER=3]="CLOSE_RECEIVER",e[e.CLOSE_INITIATOR=4]="CLOSE_INITIATOR",e[e.RESET_RECEIVER=5]="RESET_RECEIVER",e[e.RESET_INITIATOR=6]="RESET_INITIATOR"}(ZO||(ZO={}));const eF=Object.freeze({0:"NEW_STREAM",1:"MESSAGE_RECEIVER",2:"MESSAGE_INITIATOR",3:"CLOSE_RECEIVER",4:"CLOSE_INITIATOR",5:"RESET_RECEIVER",6:"RESET_INITIATOR"}),tF=Object.freeze({NEW_STREAM:ZO.NEW_STREAM,MESSAGE:ZO.MESSAGE_INITIATOR,CLOSE:ZO.CLOSE_INITIATOR,RESET:ZO.RESET_INITIATOR}),rF=Object.freeze({MESSAGE:ZO.MESSAGE_RECEIVER,CLOSE:ZO.CLOSE_RECEIVER,RESET:ZO.RESET_RECEIVER}),nF=1048576,sF=(e,t)=>{t.append(e)};var iF=async function*(e,t={}){let r=new Bd,n=!1,s=Oh(),i=Number(t.size??nF);(isNaN(i)||0===i||i<0)&&(i=nF);const o=t.yieldAfter??0,a=t.serialize??sF;for(Promise.resolve().then((async()=>{try{let t;for await(const n of e)a(n,r),r.byteLength>=i?(clearTimeout(t),s.resolve()):t=setTimeout((()=>{s.resolve()}),o);clearTimeout(t),s.resolve()}catch(e){s.reject(e)}finally{n=!0}}));!n;)if(await s.promise,s=Oh(),r.byteLength>0){const e=r;r=new Bd,yield e.subarray()}};const oF=10240;const aF=new class{constructor(){this._pool=JO(oF),this._poolOffset=0}write(e,t){const r=this._pool;let n=this._poolOffset;Os.encode(e.id<<3|e.type,r,n),n+=Os.encode.bytes??0,e.type!==ZO.NEW_STREAM&&e.type!==ZO.MESSAGE_INITIATOR&&e.type!==ZO.MESSAGE_RECEIVER||null==e.data?Os.encode(0,r,n):Os.encode(e.data.length,r,n),n+=Os.encode.bytes??0;const s=r.subarray(this._poolOffset,n);oF-n<100?(this._pool=JO(oF),this._poolOffset=0):this._poolOffset=n,t.append(s),e.type!==ZO.NEW_STREAM&&e.type!==ZO.MESSAGE_INITIATOR&&e.type!==ZO.MESSAGE_RECEIVER||null==e.data||t.append(e.data)}};const AF=1<<20;class cF{constructor(e=AF,t=4194304){this._buffer=new Bd,this._headerInfo=null,this._maxMessageSize=e,this._maxUnprocessedMessageQueueSize=t}write(e){if(null==e||0===e.length)return[];if(this._buffer.append(e),this._buffer.byteLength>this._maxUnprocessedMessageQueueSize)throw Object.assign(new Error("unprocessed message queue size too large!"),{code:"ERR_MSG_QUEUE_TOO_BIG"});const t=[];for(;0!==this._buffer.length;){if(null==this._headerInfo)try{this._headerInfo=this._decodeHeader(this._buffer)}catch(e){if("ERR_MSG_TOO_BIG"===e.code)throw e;break}const{id:e,type:r,length:n,offset:s}=this._headerInfo;if(this._buffer.length-s<n)break;const i={id:e,type:r};r!==ZO.NEW_STREAM&&r!==ZO.MESSAGE_INITIATOR&&r!==ZO.MESSAGE_RECEIVER||(i.data=this._buffer.sublist(s,s+n)),t.push(i),this._buffer.consume(s+n),this._headerInfo=null}return t}_decodeHeader(e){const{value:t,offset:r}=lF(e),{value:n,offset:s}=lF(e,r),i=7&t;if(null==eF[i])throw new Error(`Invalid type received: ${i}`);if(n>this._maxMessageSize)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"});return{id:t>>3,type:i,offset:r+s,length:n}}}function lF(e,t=0){let r,n=0,s=0,i=t;const o=e.length;do{if(i>=o||s>49)throw t=0,new RangeError("Could not decode varint");r=e.get(i++),n+=s<28?(127&r)<<s:(127&r)*Math.pow(2,s),s+=7}while(r>=128);return{value:n,offset:t=i-t}}const uF=se("libp2p:mplex:stream"),hF="ERR_STREAM_RESET";const dF=se("libp2p:mplex");function fF(e){const t={...e,type:`${eF[e.type]} (${e.type})`};return e.type===ZO.NEW_STREAM&&(t.data=Ts(e.data instanceof Uint8Array?e.data:e.data.subarray())),e.type!==ZO.MESSAGE_INITIATOR&&e.type!==ZO.MESSAGE_RECEIVER||(t.data=Ts(e.data instanceof Uint8Array?e.data:e.data.subarray(),"base16")),t}class pF{constructor(e){this.protocol="/mplex/6.7.0",e=e??{},this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._init=e,this.sink=this._createSink();const t=this._createSource();this._source=t,this.source=t,this.closeController=new AbortController,this.rateLimiter=new rD.RateLimiterMemory({points:e.disconnectThreshold??5,duration:1})}get streams(){const e=[];for(const t of this._streams.initiators.values())e.push(t);for(const t of this._streams.receivers.values())e.push(t);return e}newStream(e){if(this.closeController.signal.aborted)throw new Error("Muxer already closed");const t=this._streamId++;e=null==e?t.toString():e.toString();const r=this._streams.initiators;return this._newStream({id:t,name:e,type:"initiator",registry:r})}close(e){this.closeController.signal.aborted||(null!=e?this.streams.forEach((t=>t.abort(e))):this.streams.forEach((e=>e.close())),this.closeController.abort())}_newReceiverStream(e){const{id:t,name:r}=e,n=this._streams.receivers;return this._newStream({id:t,name:r,type:"receiver",registry:n})}_newStream(e){const{id:t,name:r,type:n,registry:s}=e;if(dF("new %s stream %s",n,t),"initiator"===n&&this._streams.initiators.size===(this._init.maxOutboundStreams??1024))throw ie(new Error("Too many outbound streams open"),"ERR_TOO_MANY_OUTBOUND_STREAMS");if(s.has(t))throw new Error(`${n} stream ${t} already exists!`);const i=function(e){const{id:t,name:r,send:n,onEnd:s,type:i="initiator",maxMsgSize:o=AF}=e,a=new AbortController,A=new AbortController,c=new AbortController,l="initiator"===i?tF:rF,u="initiator"===i?`i${t}`:`r${t}`,h=`${null==r?t:r}`;let d,f=!1,p=!1,g=!1;const y={open:Date.now()},w=e=>{p||(p=!0,uF.trace("%s stream %s sink end - err: %o",i,h,e),null!=e&&null==d&&(d=e),f&&(y.close=Date.now(),null!=s&&s(d)))},m=zu({onEnd:e=>{f||(f=!0,uF.trace("%s stream %s source end - err: %o",i,h,e),null!=e&&null==d&&(d=e),p&&(b.stat.timeline.close=Date.now(),null!=s&&s(d)))}}),b={close:()=>{uF.trace("%s stream %s close",i,h),b.closeRead(),b.closeWrite()},closeRead:()=>{uF.trace("%s stream %s closeRead",i,h),f||m.end()},closeWrite:()=>{if(uF.trace("%s stream %s closeWrite",i,h),!p){c.abort();try{n({id:t,type:l.CLOSE})}catch(e){uF.trace("%s stream %s error sending close",i,r,e)}w()}},abort:e=>{uF.trace("%s stream %s abort",i,h,e),m.end(e),a.abort(),w(e)},reset:()=>{const e=ie(new Error("stream reset"),hF);A.abort(),m.end(e),w(e)},sink:async e=>{if(g)throw ie(new Error("sink already called on stream"),"ERR_DOUBLE_SINK");if(g=!0,p)throw ie(new Error("stream closed for writing"),"ERR_SINK_ENDED");e=PC(e,(0,co.anySignal)([a.signal,A.signal,c.signal]));try{"initiator"===i&&n({id:t,type:tF.NEW_STREAM,data:new Bd(vs(h))});for await(let r of e)for(;r.length>0;){if(r.length<=o){n({id:t,type:l.MESSAGE,data:r instanceof Uint8Array?new Bd(r):r});break}r=r instanceof Uint8Array?new Bd(r):r,n({id:t,type:l.MESSAGE,data:r.sublist(0,o)}),r.consume(o)}}catch(e){if("aborted"===e.type&&"The operation was aborted"===e.message){if(c.signal.aborted)return;A.signal.aborted&&(e.message="stream reset",e.code=hF),a.signal.aborted&&(e.message="stream aborted",e.code="ERR_STREAM_ABORT")}if(e.code===hF)uF.trace("%s stream %s reset",i,r);else{uF.trace("%s stream %s error",i,r,e);try{n({id:t,type:l.RESET})}catch(e){uF.trace("%s stream %s error sending reset",i,r,e)}}return m.end(e),void w(e)}try{n({id:t,type:l.CLOSE})}catch(e){uF.trace("%s stream %s error sending close",i,r,e)}w()},source:m,sourcePush:e=>{m.push(e)},sourceReadableLength(){return m.readableLength},stat:{direction:"initiator"===i?"outbound":"inbound",timeline:y},metadata:{},id:u};return b}({id:t,name:r,send:e=>{dF.enabled&&dF.trace("%s stream %s send",n,t,fF(e)),this._source.push(e)},type:n,onEnd:()=>{dF("%s stream with id %s and protocol %s ended",n,t,i.stat.protocol),s.delete(t),null!=this._init.onStreamEnd&&this._init.onStreamEnd(i)},maxMsgSize:this._init.maxMsgSize});return s.set(t,i),i}_createSink(){return async e=>{const t=[this.closeController.signal];null!=this._init.signal&&t.push(this._init.signal),e=PC(e,co(t));try{const t=new cF(this._init.maxMsgSize,this._init.maxUnprocessedMessageQueueSize);for await(const r of e)for(const e of t.write(r))await this._handleIncoming(e);this._source.end()}catch(e){dF("error in sink",e),this._source.end(e)}}}_createSource(){const e=function(e={}){return ju((e=>{let t;const r=[];for(;!e.isEmpty()&&(t=e.shift(),null!=t);){if(null!=t.error)throw t.error;!1===t.done&&r.push(t.value)}return null==t?{done:!0}:{done:!0===t.done,value:r}}),e)}({objectMode:!0,onEnd:e=>{this.close(e)}});return Object.assign(async function*(e,t=0){if(null!=t&&0!==t)yield*iF(e,{size:t,serialize:(e,t)=>{for(const r of e)aF.write(r,t)}});else for await(const t of e){const e=new Bd;for(const r of t)aF.write(r,e);yield e.subarray()}}(e,this._init.minSendBytes),{push:e.push,end:e.end,return:e.return})}async _handleIncoming(e){const{id:t,type:r}=e;if(dF.enabled&&dF.trace("incoming message",fF(e)),e.type===ZO.NEW_STREAM){if(this._streams.receivers.size===(this._init.maxInboundStreams??1024)){dF("too many inbound streams open"),this._source.push({id:t,type:ZO.RESET_RECEIVER});try{await this.rateLimiter.consume("new-stream",1)}catch{return dF("rate limit hit when opening too many new streams over the inbound stream limit - closing remote connection"),void this._source.end(new Error("Too many open streams"))}return}const r=this._newReceiverStream({id:t,name:Ts(e.data instanceof Uint8Array?e.data:e.data.subarray())});return void(null!=this._init.onIncomingStream&&this._init.onIncomingStream(r))}const n=(1==(1&r)?this._streams.initiators:this._streams.receivers).get(t);if(null==n)return void dF("missing stream %s for message type %s",t,eF[r]);const s=this._init.maxStreamBufferSize??4194304;switch(r){case ZO.MESSAGE_INITIATOR:case ZO.MESSAGE_RECEIVER:if(n.sourceReadableLength()>s){this._source.push({id:e.id,type:r===ZO.MESSAGE_INITIATOR?ZO.RESET_RECEIVER:ZO.RESET_INITIATOR});const t=ie(new Error("Input buffer full - increase Mplex maxBufferSize to accommodate slow consumers"),"ERR_STREAM_INPUT_BUFFER_FULL");return void n.abort(t)}n.sourcePush(e.data);break;case ZO.CLOSE_INITIATOR:case ZO.CLOSE_RECEIVER:n.closeRead();break;case ZO.RESET_INITIATOR:case ZO.RESET_RECEIVER:n.reset();break;default:dF("unknown message type %s",r)}}}class gF{constructor(e={}){this.protocol="/mplex/6.7.0",this._init=e}createStreamMuxer(e={}){return new pF({...e,...this._init})}}function yF(e={}){return()=>new gF(e)}function wF(e,t={}){const r=yD(e),n=MC.fromReader(r.reader,t),s={read:async e=>{const{value:t}=await r.reader.next(e);if(null==t)throw new Error("Value is null");return t},readLP:async()=>{const{value:e}=await n.next();if(null==e)throw new Error("Value is null");return e},readPB:async e=>{const t=await s.readLP();if(null==t)throw new Error("Value is null");const r=t instanceof Uint8Array?t:t.subarray();return e.decode(r)},write:e=>{e instanceof Uint8Array?r.writer.push(e):r.writer.push(e.subarray())},writeLP:e=>{s.write(FC.single(e,t))},writePB:(e,t)=>{s.writeLP(t.encode(e))},pb:e=>({read:async()=>await s.readPB(e),write:t=>{s.writePB(t,e)}}),unwrap:()=>(r.rest(),r.stream)};return s}function mF(){const e=Oh();let t=!1;return{sink:async r=>{if(t)throw new Error("already piped");t=!0,e.resolve(r)},source:async function*(){const t=await e.promise;yield*t}()}}const bF=65535,EF=Boolean(globalThis.process?.env?.DUMP_SESSION_KEYS);var vF=r(512),BF=r(57664),_F=r(73294),CF=r(15501);const SF={hashSHA256(e){return(0,_F.vp)(e)},getHKDF(e,t){const r=new vF.t(_F.mE,t,e).expand(96);return[r.subarray(0,32),r.subarray(32,64),r.subarray(64,96)]},generateX25519KeyPair(){const e=BF.Au();return{publicKey:e.publicKey,privateKey:e.secretKey}},generateX25519KeyPairFromSeed(e){const t=BF._w(e);return{publicKey:t.publicKey,privateKey:t.secretKey}},generateX25519SharedKey(e,t){return BF.gi(e,t)},chaCha20Poly1305Encrypt(e,t,r,n){return new CF.OK(n).seal(t,e,r)},chaCha20Poly1305Decrypt(e,t,r,n,s){return new CF.OK(n).open(t,e,r,s)}},IF=e=>{const t=(r=2,globalThis.Buffer?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r));var r;return new DataView(t.buffer,t.byteOffset,t.byteLength).setUint16(0,e,!1),t};IF.bytes=2;const TF=e=>{if(e.length<2)throw RangeError("Could not decode int16BE");return e instanceof Uint8Array?new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1):e.getUint16(0)};TF.bytes=2;class RF extends Error{constructor(e="Unexpected Peer"){super(e),this.code=RF.code}static get code(){return"ERR_UNEXPECTED_PEER"}}class kF extends Error{constructor(e="Invalid crypto exchange"){super(e),this.code=kF.code}static get code(){return"ERR_INVALID_CRYPTO_EXCHANGE"}}class UF extends Error{constructor(e="Invalid crypto transmission"){super(e),this.code=UF.code}static get code(){return"ERR_INVALID_CRYPTO_TRANSMISSION"}}var DF,PF;async function LF(e,t,r){const n=await async function(e,t){if(null==e.privateKey)throw new Error("PrivateKey was missing from PeerId");const r=await ru(e.privateKey);return await r.sign(t)}(e,FF(t));if(null==e.publicKey)throw new Error("PublicKey was missing from local PeerId");return function(e,t,r){return PF.encode({identityKey:e,identitySig:t,extensions:r??{webtransportCerthashes:[]}}).subarray()}(e.publicKey,n,r)}async function NF(e){return await ka(e.identityKey)}function OF(e){return PF.decode(e)}function FF(e){const t=vs("noise-libp2p-static-key:");return Fs([t,e],t.length+e.length)}async function QF(e,t,r){const n=await ka(t.identityKey);if(!n.equals(r))throw new Error(`Payload identity key ${n.toString()} does not match expected remote peer ${r.toString()}`);const s=FF(e);if(null==n.publicKey)throw new Error("PublicKey was missing from PeerId");if(null==t.identitySig)throw new Error("Signature was missing from message");const i=eu(n.publicKey);if(!await i.verify(s,t.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return n}function xF(e){return e instanceof Uint8Array&&32===e.length}!function(e){let t;e.codec=()=>(null==t&&(t=aA(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),null!=e.webtransportCerthashes)for(const r of e.webtransportCerthashes)t.uint32(10),t.bytes(r);!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={webtransportCerthashes:[]},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();if(t>>>3==1)r.webtransportCerthashes.push(e.bytes());else e.skipType(7&t)}return r}))),t),e.encode=t=>Za(t,e.codec()),e.decode=t=>Ja(t,e.codec())}(DF||(DF={})),function(e){let t;e.codec=()=>(null==t&&(t=aA(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),(!0===r.writeDefaults||null!=e.identityKey&&e.identityKey.byteLength>0)&&(t.uint32(10),t.bytes(e.identityKey)),(!0===r.writeDefaults||null!=e.identitySig&&e.identitySig.byteLength>0)&&(t.uint32(18),t.bytes(e.identitySig)),null!=e.extensions&&(t.uint32(34),DF.codec().encode(e.extensions,t,{writeDefaults:!1})),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={identityKey:new Uint8Array(0),identitySig:new Uint8Array(0)},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.identityKey=e.bytes();break;case 2:r.identitySig=e.bytes();break;case 4:r.extensions=DF.codec().decode(e,e.uint32());break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>Za(t,e.codec()),e.decode=t=>Ja(t,e.codec())}(PF||(PF={}));const MF=se("libp2p:noise");let HF;function KF(e){e?(HF(`LOCAL_PUBLIC_EPHEMERAL_KEY ${Ts(e.publicKey,"hex")}`),HF(`LOCAL_PRIVATE_EPHEMERAL_KEY ${Ts(e.privateKey,"hex")}`)):HF("Missing local ephemeral keys.")}function VF(e){HF(`REMOTE_EPHEMERAL_PUBLIC_KEY ${Ts(e,"hex")}`)}HF=EF?MF:Object.assign((()=>{}),{enabled:!1,trace:()=>{},error:()=>{}});class zF{constructor(e=0){this.n=e,this.bytes=new Uint8Array(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,e,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>4294967295)throw new Error("Cipherstate has reached maximum n, a new handshake must be performed")}}class jF{constructor(e){this.crypto=e}encryptWithAd(e,t,r){const n=this.encrypt(e.k,e.n,t,r);return e.n.increment(),n}decryptWithAd(e,t,r,n){const{plaintext:s,valid:i}=this.decrypt(e.k,e.n,t,r,n);return i&&e.n.increment(),{plaintext:s,valid:i}}hasKey(e){return!this.isEmptyKey(e.k)}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(e){return ii(this.createEmptyKey(),e)}encrypt(e,t,r,n){return t.assertValue(),this.crypto.chaCha20Poly1305Encrypt(n,t.getBytes(),r,e)}encryptAndHash(e,t){let r;return r=this.hasKey(e.cs)?this.encryptWithAd(e.cs,e.h,t):t,this.mixHash(e,r),r}decrypt(e,t,r,n,s){t.assertValue();const i=this.crypto.chaCha20Poly1305Decrypt(n,t.getBytes(),r,e,s);return i?{plaintext:i,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(e,t){let r,n=!0;return this.hasKey(e.cs)?({plaintext:r,valid:n}=this.decryptWithAd(e.cs,e.h,t)):r=t,this.mixHash(e,t),{plaintext:r,valid:n}}dh(e,t){try{const r=this.crypto.generateX25519SharedKey(e,t);return 32===r.length?r:r.subarray(0,32)}catch(e){return MF(e.message),new Uint8Array(32)}}mixHash(e,t){e.h=this.getHash(e.h,t)}getHash(e,t){return this.crypto.hashSHA256(Fs([e,t],e.length+t.length))}mixKey(e,t){const[r,n]=this.crypto.getHKDF(e.ck,t);e.cs=this.initializeKey(n),e.ck=r}initializeKey(e){return{k:e,n:new zF}}initializeSymmetric(e){const t=vs(e,"utf-8"),r=this.hashProtocolName(t),n=r,s=this.createEmptyKey();return{cs:this.initializeKey(s),ck:n,h:r}}hashProtocolName(e){if(e.length<=32){const t=new Uint8Array(32);return t.set(e),t}return this.getHash(e,new Uint8Array(0))}split(e){const[t,r]=this.crypto.getHKDF(e.ck,new Uint8Array(0));return{cs1:this.initializeKey(t),cs2:this.initializeKey(r)}}writeMessageRegular(e,t){const r=this.encryptWithAd(e,new Uint8Array(0),t);return{ne:this.createEmptyKey(),ns:new Uint8Array(0),ciphertext:r}}readMessageRegular(e,t){return this.decryptWithAd(e,new Uint8Array(0),t.ciphertext)}}class GF extends jF{initializeInitiator(e,t,r,n){const s=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");this.mixHash(s,e);return{ss:s,s:t,rs:r,psk:n,re:new Uint8Array(32)}}initializeResponder(e,t,r,n){const s=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");this.mixHash(s,e);return{ss:s,s:t,rs:r,psk:n,re:new Uint8Array(32)}}writeMessageA(e,t,r){const n=new Uint8Array(0);e.e=void 0!==r?r:this.crypto.generateX25519KeyPair();const s=e.e.publicKey;this.mixHash(e.ss,s);return{ne:s,ns:n,ciphertext:this.encryptAndHash(e.ss,t)}}writeMessageB(e,t){e.e=this.crypto.generateX25519KeyPair();const r=e.e.publicKey;this.mixHash(e.ss,r),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const n=e.s.publicKey,s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));return{ne:r,ns:s,ciphertext:this.encryptAndHash(e.ss,t)}}writeMessageC(e,t){const r=e.s.publicKey,n=this.encryptAndHash(e.ss,r);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));const s=this.encryptAndHash(e.ss,t),i={ne:this.createEmptyKey(),ns:n,ciphertext:s},{cs1:o,cs2:a}=this.split(e.ss);return{h:e.ss.h,messageBuffer:i,cs1:o,cs2:a}}readMessageA(e,t){return xF(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,t.ciphertext)}readMessageB(e,t){if(xF(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const{plaintext:r,valid:n}=this.decryptAndHash(e.ss,t.ns);n&&xF(r)&&(e.rs=r),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:s,valid:i}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:s,valid:n&&i}}readMessageC(e,t){const{plaintext:r,valid:n}=this.decryptAndHash(e.ss,t.ns);if(n&&xF(r)&&(e.rs=r),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:s,valid:i}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:o,cs2:a}=this.split(e.ss);return{h:e.ss.h,plaintext:s,valid:n&&i,cs1:o,cs2:a}}initSession(e,t,r){const n=this.createEmptyKey(),s=new Uint8Array(32);let i;return i=e?this.initializeInitiator(t,r,s,n):this.initializeResponder(t,r,s,n),{hs:i,i:e,mc:0}}sendMessage(e,t,r){let n;if(0===e.mc)n=this.writeMessageA(e.hs,t,r);else if(1===e.mc)n=this.writeMessageB(e.hs,t);else if(2===e.mc){const{h:r,messageBuffer:s,cs1:i,cs2:o}=this.writeMessageC(e.hs,t);n=s,e.h=r,e.cs1=i,e.cs2=o}else{if(!(e.mc>2))throw new Error("Session invalid.");if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");n=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");n=this.writeMessageRegular(e.cs2,t)}}return e.mc++,n}recvMessage(e,t){let r=new Uint8Array(0),n=!1;if(0===e.mc)({plaintext:r,valid:n}=this.readMessageA(e.hs,t));else if(1===e.mc)({plaintext:r,valid:n}=this.readMessageB(e.hs,t));else if(2===e.mc){const{h:s,plaintext:i,valid:o,cs1:a,cs2:A}=this.readMessageC(e.hs,t);r=i,n=o,e.h=s,e.cs1=a,e.cs2=A}return e.mc++,{plaintext:r,valid:n}}}class $F{constructor(e,t,r,n,s,i,o,a){this.remoteExtensions={webtransportCerthashes:[]},this.isInitiator=e,this.payload=t,this.prologue=r,this.staticKeypair=s,this.connection=i,o&&(this.remotePeer=o),this.xx=a??new GF(n),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){var e;if(e=this.session.hs.s,HF(`LOCAL_STATIC_PUBLIC_KEY ${Ts(e.publicKey,"hex")}`),HF(`LOCAL_STATIC_PRIVATE_KEY ${Ts(e.privateKey,"hex")}`),this.isInitiator){MF("Stage 0 - Initiator starting to send first message.");const e=this.xx.sendMessage(this.session,new Uint8Array(0));this.connection.writeLP(function(e){return Fs([e.ne,e.ciphertext],e.ne.length+e.ciphertext.length)}(e)),MF("Stage 0 - Initiator finished sending first message."),KF(this.session.hs.e)}else{MF("Stage 0 - Responder waiting to receive first message...");const e=function(e){if(e.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:e.subarray(0,32),ciphertext:e.subarray(32,e.length),ns:new Uint8Array(0)}}((await this.connection.readLP()).subarray()),{valid:t}=this.xx.recvMessage(this.session,e);if(!t)throw new kF("xx handshake stage 0 validation fail");MF("Stage 0 - Responder received first message."),VF(this.session.hs.re)}}async exchange(){if(this.isInitiator){MF("Stage 1 - Initiator waiting to receive first message from responder...");const t=function(e){if(e.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:e.subarray(0,32),ns:e.subarray(32,80),ciphertext:e.subarray(80,e.length)}}((await this.connection.readLP()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,t);if(!n)throw new kF("xx handshake stage 1 validation fail");MF("Stage 1 - Initiator received the message."),VF(this.session.hs.re),e=this.session.hs.rs,HF(`REMOTE_STATIC_PUBLIC_KEY ${Ts(e,"hex")}`),MF("Initiator going to check remote's signature...");try{const e=OF(r);this.remotePeer=this.remotePeer||await NF(e),await QF(this.session.hs.rs,e,this.remotePeer),this.setRemoteNoiseExtension(e.extensions)}catch(e){throw new RF(`Error occurred while verifying signed payload: ${e.message}`)}MF("All good with the signature!")}else{MF("Stage 1 - Responder sending out first message with signed payload and static key.");const e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(function(e){return Fs([e.ne,e.ns,e.ciphertext],e.ne.length+e.ns.length+e.ciphertext.length)}(e)),MF("Stage 1 - Responder sent the second handshake message with signed payload."),KF(this.session.hs.e)}var e}async finish(){if(this.isInitiator){MF("Stage 2 - Initiator sending third handshake message.");const e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(function(e){return Fs([e.ns,e.ciphertext],e.ns.length+e.ciphertext.length)}(e)),MF("Stage 2 - Initiator sent message with signed payload.")}else{MF("Stage 2 - Responder waiting for third handshake message...");const e=function(e){if(e.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:e.subarray(0,48),ciphertext:e.subarray(48,e.length)}}((await this.connection.readLP()).subarray()),{plaintext:t,valid:r}=this.xx.recvMessage(this.session,e);if(!r)throw new kF("xx handshake stage 2 validation fail");MF("Stage 2 - Responder received the message, finished handshake.");try{const e=OF(t);this.remotePeer=this.remotePeer||await NF(e),await QF(this.session.hs.rs,e,this.remotePeer),this.setRemoteNoiseExtension(e.extensions)}catch(e){throw new RF(`Error occurred while verifying signed payload: ${e.message}`)}}var e;(e=this.session).cs1&&e.cs2?(HF(`CIPHER_STATE_1 ${e.cs1.n.getUint64()} ${Ts(e.cs1.k,"hex")}`),HF(`CIPHER_STATE_2 ${e.cs2.n.getUint64()} ${Ts(e.cs2.k,"hex")}`)):HF("Missing cipher state.")}encrypt(e,t){const r=this.getCS(t);return this.xx.encryptWithAd(r,new Uint8Array(0),e)}decrypt(e,t,r){const n=this.getCS(t,!1);return this.xx.decryptWithAd(n,new Uint8Array(0),e,r)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new kF("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteNoiseExtension(e){e&&(this.remoteExtensions=e)}}class qF{constructor(e={}){this.protocol="/noise";const{staticNoiseKey:t,extensions:r,crypto:n,prologueBytes:s,metrics:i}=e;this.crypto=n??SF,this.extensions=r,this.metrics=i?function(e){return{xxHandshakeSuccesses:e.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:e.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:e.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:e.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:e.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}(i):void 0,this.staticKeys=t?this.crypto.generateX25519KeyPairFromSeed(t):this.crypto.generateX25519KeyPair(),this.prologue=s??new Uint8Array(0)}async secureOutbound(e,t,r){const n=wF(t,{lengthEncoder:IF,lengthDecoder:TF,maxDataLength:bF}),s=await this.performHandshake({connection:n,isInitiator:!0,localPeer:e,remotePeer:r});return{conn:await this.createSecureConnection(n,s),remoteExtensions:s.remoteExtensions,remotePeer:s.remotePeer}}async secureInbound(e,t,r){const n=wF(t,{lengthEncoder:IF,lengthDecoder:TF,maxDataLength:bF}),s=await this.performHandshake({connection:n,isInitiator:!1,localPeer:e,remotePeer:r});return{conn:await this.createSecureConnection(n,s),remotePeer:s.remotePeer,remoteExtensions:s.remoteExtensions}}async performHandshake(e){const t=await LF(e.localPeer,this.staticKeys.publicKey,this.extensions);return await this.performXXHandshake(e,t)}async performXXHandshake(e,t){const{isInitiator:r,remotePeer:n,connection:s}=e,i=new $F(r,t,this.prologue,this.crypto,this.staticKeys,s,n);try{await i.propose(),await i.exchange(),await i.finish(),this.metrics?.xxHandshakeSuccesses.increment()}catch(e){if(this.metrics?.xxHandshakeErrors.increment(),e instanceof Error)throw e.message=`Error occurred during XX handshake: ${e.message}`,e}return i}async createSecureConnection(e,t){const[r,n]=function(){const e=mF(),t=mF();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}(),s=e.unwrap();return await zh(r,function(e,t){return async function*(r){for await(const n of r)for(let r=0;r<n.length;r+=65519){let s=r+65519;s>n.length&&(s=n.length);const i=e.encrypt(n.subarray(r,s),e.session);t?.encryptedPackets.increment(),yield IF(i.byteLength),yield i}}}(t,this.metrics),s,MC({lengthDecoder:TF}),function(e,t){return async function*(r){for await(const n of r)for(let r=0;r<n.length;r+=bF){let s=r+bF;if(s>n.length&&(s=n.length),s-CF.pg<r)throw new Error("Invalid chunk");const i=n.subarray(r,s),o=n.subarray(r,s-CF.pg),{plaintext:a,valid:A}=e.decrypt(i,e.session,o);if(!A)throw t?.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");t?.decryptedPackets.increment(),yield a}}}(t,this.metrics),r),n}}function WF(e={}){return()=>new qF(e)}const YF=I.bind({ignoreUndefined:!0,concatArrays:!0});function XF({options:e={},peerId:t,multiaddrs:r=[],repo:n,keychainConfig:s={},config:i={}}){const{datastore:l}=n,u=function({options:e,config:t,datastore:r,keychainConfig:n,peerId:s,multiaddrs:i}){const l=()=>{const e=qu(t,"Pubsub.Router")||"gossipsub",r={gossipsub:nS({fallbackToFloodsub:!0,emitSelf:!0,maxInboundStreams:64,maxOutboundStreams:128})};if(!r[e])throw ie(new Error(`Router unavailable. Configure libp2p.modules.pubsub to use the ${e} router.`),"ERR_NOT_SUPPORTED");return r[e]},u={datastore:r,peerId:s},h={addresses:{listen:i.map((e=>e.toString())),announce:qu(e,"addresses.announce",qu(t,"Addresses.Announce",[])),noAnnounce:qu(e,"addresses.noAnnounce",qu(t,"Addresses.NoAnnounce",[]))},connectionManager:qu(e,"connectionManager",{maxConnections:qu(e,"config.Swarm.ConnMgr.HighWater",qu(t,"Swarm.ConnMgr.HighWater")),minConnections:qu(e,"config.Swarm.ConnMgr.LowWater",qu(t,"Swarm.ConnMgr.LowWater"))}),keychain:n,identify:{host:{agentVersion:`js-ipfs/${yw}`}},contentRouters:[],peerRouters:[],peerDiscovery:[],transports:[],streamMuxers:[yF({maxInboundStreams:256,maxOutboundStreams:1024})],connectionEncryption:[WF()],relay:{enabled:qu(e,"relay.enabled",qu(t,"relay.enabled",!0)),hop:{enabled:qu(e,"relay.hop.enabled",qu(t,"relay.hop.enabled",!1)),active:qu(e,"relay.hop.active",qu(t,"relay.hop.active",!1))}},nat:{enabled:!qu(t,"Swarm.DisableNatPortMap",!1)}};qu(e,"config.Pubsub.Enabled",qu(t,"Pubsub.Enabled",!0))&&(h.pubsub=l());"none"!==qu(t,"Routing.Type","dhtclient")&&(h.dht=(d={clientMode:"dhtserver"!==qu(t,"Routing.Type","dht"),kBucketSize:qu(e,"dht.kBucketSize",20),validators:{ipns:Ru},selectors:{ipns:Wu}},e=>new QO(e,d)));var d;const f=qu(e,"config.Bootstrap",qu(t,"Bootstrap",[]));f.length>0&&h.peerDiscovery?.push(function(e){return t=>new MO(t,e)}({list:f}));let p=qu(e,"libp2p",void 0);"function"==typeof p&&(p=void 0);const g=YF(u,UU(),h,p),y=qu(e,"config.Addresses.Delegates",qu(t,"Addresses.Delegates",[]));if(y.length>0){const e=mi(y[Math.floor(Math.random()*y.length)]).toOptions(),t=function(e={}){const t={name:Pn.name,code:Pn.code,encode:e=>e,decode:e=>e},r=Object.values(is);(e.ipld&&e.ipld.bases?e.ipld.bases:[]).forEach((e=>r.push(e)));const n=new fS({bases:r,loadBase:e.ipld&&e.ipld.loadBase}),s=Object.values(as);[o,a,A,c,t].concat(e.ipld&&e.ipld.codecs||[]).forEach((e=>s.push(e)));const i=new gS({codecs:s,loadCodec:e.ipld&&e.ipld.loadCodec}),l=Object.values(os);(e.ipld&&e.ipld.hashers?e.ipld.hashers:[]).forEach((e=>l.push(e)));const u=new wS({hashers:l,loadHasher:e.ipld&&e.ipld.loadHasher});return{add:BR(e),addAll:mR(e),bitswap:QS(e),block:WS(e),bootstrap:tI(e),cat:_R(e),commands:CR(e),config:uI(e),dag:wI(i,e),dht:SI(e),diag:kI(e),dns:SR(e),files:jI(e),get:TR(e),getEndpointConfig:IR(e),id:RR(e),isOnline:kR(e),key:ZI(e),log:nT(e),ls:UR(e),mount:PR(e),name:lT(e),object:vT(i,e),pin:GT(e),ping:LR(e),pubsub:sR(e),refs:oR(e),repo:lR(e),resolve:NR(e),start:OR(e),stats:hR(e),stop:FR(e),swarm:wR(e),version:QR(e),bases:n,codecs:i,hashers:u}}({host:e.host,protocol:443===parseInt(e.port)?"https":"http",port:e.port});g.contentRouters?.push((w=t,()=>new hS(w))),g.peerRouters?.push(function(e){return()=>new aS(e)}(t))}var w;qu(e,"config.Discovery.MDNS.Enabled",qu(t,"Discovery.MDNS.Enabled",!0))||(g.peerDiscovery=g.peerDiscovery?.filter((e=>{try{if("function"==typeof e)return"@libp2p/mdns"!==e({})[Symbol.toStringTag]}catch{}return!0})));null==g.transports&&(g.transports=[]);null==g.transports.find((e=>{try{if("function"==typeof e)return"@libp2p/websockets"===e({})[Symbol.toStringTag]}catch{}return!1}))&&g.transports.push(function(e={}){return()=>new XO(e)}());return g}({options:e,config:i,datastore:l,keychainConfig:s,peerId:t,multiaddrs:r});return"function"==typeof e.libp2p?e.libp2p({libp2pOptions:u,options:e,config:i,datastore:l,peerId:t}):(u.start=!1,async function(e){const t=await BN(e);return!1!==e.start&&await t.start(),t}(u))}const JF=I.bind({ignoreUndefined:!0}),ZF=se("ipfs:components:peer:storage");class eQ{constructor(e,t,r,n,s){this.print=n,this.peerId=e,this.keychain=t,this.repo=r,this.print=n,this.isNew=s}static async start(e,t,r){const{repoAutoMigrate:n,repo:s,onMigrationProgress:i}=r,o="string"==typeof s||null==s?A_(e,t,{path:s,autoMigrate:n,onMigrationProgress:i}):s,{peerId:a,keychain:A,isNew:c}=await tQ(e,o,r);return new eQ(a,A,o,e,c)}}const tQ=async(e,t,r)=>{if(!t.closed)return{...await oQ(t,r),isNew:!1};try{return await t.open(),{...await oQ(t,r),isNew:!1}}catch(n){if(n.code!==gB)throw n;if(r.init&&!1===r.init.allowNew)throw new fs("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...await rQ(e,t,r),isNew:!0}}},rQ=async(e,t,r)=>{const n=r.init||{},s=await t.exists();if(ZF("repo exists?",s),!0===s)throw new Error("repo already exists");const i=n.privateKey?await nQ(n.privateKey):await sQ(e,n),o=iQ(i);ZF("peer identity: %s",o.PeerID);const a={...JF(AQ({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:5,HighWater:20},DisableNatPortMap:!0},Routing:{Type:"dhtclient"}},n.profiles),r.config),Identity:o};await t.init(a),await t.open(),ZF("repo opened");const A={pass:r.pass};try{A.dek=await t.config.get("Keychain.DEK")}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}const c=await XF({options:void 0,multiaddrs:void 0,peerId:i,repo:t,config:a,keychainConfig:A});return await t.datastore.has(new Ao("/info/self"))||await c.keychain.importPeer("self",i),await t.config.set("Keychain",{DEK:c.keychain.init.dek}),{peerId:i,keychain:c.keychain}},nQ=async e=>{if(ZF("using user-supplied private-key"),ba(e))return e;const t=vs(e,"base64pad"),r=await ru(t);return await ka(r.public.bytes,r.bytes)},sQ=(e,{algorithm:t="Ed25519",bits:r=2048})=>{if(e("generating %s keypair...",t),"Ed25519"===t)return lN();if("RSA"===t)return(async e=>{const t=await Zl("RSA",e?.bits??2048),r=await uN(t);if("RSA"===r.type)return r;throw new Error(`Generated unexpected PeerId type "${r.type}"`)})({bits:r});throw ie(new Error("Unknown PeerId algorithm"),"ERR_UNKNOWN_PEER_ID_ALGORITHM")},iQ=e=>{if(null==e.privateKey)throw ie(new Error("Private key missing"),"ERR_MISSING_PRIVATE_KEY");return{PeerID:e.toString(),PrivKey:Ts(e.privateKey,"base64pad")}},oQ=async(e,t)=>{const r=t.config,n=t.init&&t.init.profiles||[],s=t.pass,i=await e.config.getAll(),o=aQ(AQ(i,n),r);if(i!==o&&await e.config.replace(o),!o.Identity||!o.Identity.PrivKey)throw new As("No private key was found in the config, please intialize the repo");const a=vs(o.Identity.PrivKey,"base64pad"),A=await ru(a),c=await ka(A.public.bytes,A.bytes);return{peerId:c,keychain:(await XF({options:void 0,multiaddrs:void 0,peerId:c,repo:e,config:o,keychainConfig:{pass:s,...o.Keychain}})).keychain}},aQ=(e,t)=>t?JF(e,t):e,AQ=(e,t)=>(t||[]).reduce(((e,t)=>{const r=vw[t];if(!r)throw new Error(`Could not find profile with name '${t}'`);return ZF("applying profile %s",t),r.transform(e)}),e);var cQ=r(82838);var lQ=function(e){let t=new Uint8Array(e.reduce(((e,t)=>e+Os.encodingLength(t)),0)),r=0;for(const n of e)t=Os.encode(n,t,r),r+=Os.encodingLength(n);return t};class uQ{constructor(e,t,r){this._refCounter=1,this.cid=e,this.priority=t||1,this.wantType=r}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(V)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}}const hQ=oe.Reader,dQ=oe.Writer,fQ=oe.util,pQ=oe.roots["ipfs-bitswap"]||(oe.roots["ipfs-bitswap"]={}),gQ=pQ.Message=(()=>{function e(e){if(this.blocks=[],this.payload=[],this.blockPresences=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.wantlist=null,e.prototype.blocks=fQ.emptyArray,e.prototype.payload=fQ.emptyArray,e.prototype.blockPresences=fQ.emptyArray,e.prototype.pendingBytes=0,e.encode=function(e,t){if(t||(t=dQ.create()),null!=e.wantlist&&Object.hasOwnProperty.call(e,"wantlist")&&pQ.Message.Wantlist.encode(e.wantlist,t.uint32(10).fork()).ldelim(),null!=e.blocks&&e.blocks.length)for(var r=0;r<e.blocks.length;++r)t.uint32(18).bytes(e.blocks[r]);if(null!=e.payload&&e.payload.length)for(r=0;r<e.payload.length;++r)pQ.Message.Block.encode(e.payload[r],t.uint32(26).fork()).ldelim();if(null!=e.blockPresences&&e.blockPresences.length)for(r=0;r<e.blockPresences.length;++r)pQ.Message.BlockPresence.encode(e.blockPresences[r],t.uint32(34).fork()).ldelim();return null!=e.pendingBytes&&Object.hasOwnProperty.call(e,"pendingBytes")&&t.uint32(40).int32(e.pendingBytes),t},e.decode=function(e,t){e instanceof hQ||(e=hQ.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new pQ.Message;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.wantlist=pQ.Message.Wantlist.decode(e,e.uint32());break;case 2:n.blocks&&n.blocks.length||(n.blocks=[]),n.blocks.push(e.bytes());break;case 3:n.payload&&n.payload.length||(n.payload=[]),n.payload.push(pQ.Message.Block.decode(e,e.uint32()));break;case 4:n.blockPresences&&n.blockPresences.length||(n.blockPresences=[]),n.blockPresences.push(pQ.Message.BlockPresence.decode(e,e.uint32()));break;case 5:n.pendingBytes=e.int32();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof pQ.Message)return e;var t=new pQ.Message;if(null!=e.wantlist){if("object"!=typeof e.wantlist)throw TypeError(".Message.wantlist: object expected");t.wantlist=pQ.Message.Wantlist.fromObject(e.wantlist)}if(e.blocks){if(!Array.isArray(e.blocks))throw TypeError(".Message.blocks: array expected");t.blocks=[];for(var r=0;r<e.blocks.length;++r)"string"==typeof e.blocks[r]?fQ.base64.decode(e.blocks[r],t.blocks[r]=fQ.newBuffer(fQ.base64.length(e.blocks[r])),0):e.blocks[r].length>=0&&(t.blocks[r]=e.blocks[r])}if(e.payload){if(!Array.isArray(e.payload))throw TypeError(".Message.payload: array expected");t.payload=[];for(r=0;r<e.payload.length;++r){if("object"!=typeof e.payload[r])throw TypeError(".Message.payload: object expected");t.payload[r]=pQ.Message.Block.fromObject(e.payload[r])}}if(e.blockPresences){if(!Array.isArray(e.blockPresences))throw TypeError(".Message.blockPresences: array expected");t.blockPresences=[];for(r=0;r<e.blockPresences.length;++r){if("object"!=typeof e.blockPresences[r])throw TypeError(".Message.blockPresences: object expected");t.blockPresences[r]=pQ.Message.BlockPresence.fromObject(e.blockPresences[r])}}return null!=e.pendingBytes&&(t.pendingBytes=0|e.pendingBytes),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.blocks=[],r.payload=[],r.blockPresences=[]),t.defaults&&(r.wantlist=null,r.pendingBytes=0),null!=e.wantlist&&e.hasOwnProperty("wantlist")&&(r.wantlist=pQ.Message.Wantlist.toObject(e.wantlist,t)),e.blocks&&e.blocks.length){r.blocks=[];for(var n=0;n<e.blocks.length;++n)r.blocks[n]=t.bytes===String?fQ.base64.encode(e.blocks[n],0,e.blocks[n].length):t.bytes===Array?Array.prototype.slice.call(e.blocks[n]):e.blocks[n]}if(e.payload&&e.payload.length){r.payload=[];for(n=0;n<e.payload.length;++n)r.payload[n]=pQ.Message.Block.toObject(e.payload[n],t)}if(e.blockPresences&&e.blockPresences.length){r.blockPresences=[];for(n=0;n<e.blockPresences.length;++n)r.blockPresences[n]=pQ.Message.BlockPresence.toObject(e.blockPresences[n],t)}return null!=e.pendingBytes&&e.hasOwnProperty("pendingBytes")&&(r.pendingBytes=e.pendingBytes),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,oe.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message"},e.Wantlist=function(){function e(e){if(this.entries=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.entries=fQ.emptyArray,e.prototype.full=!1,e.encode=function(e,t){if(t||(t=dQ.create()),null!=e.entries&&e.entries.length)for(var r=0;r<e.entries.length;++r)pQ.Message.Wantlist.Entry.encode(e.entries[r],t.uint32(10).fork()).ldelim();return null!=e.full&&Object.hasOwnProperty.call(e,"full")&&t.uint32(16).bool(e.full),t},e.decode=function(e,t){e instanceof hQ||(e=hQ.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new pQ.Message.Wantlist;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.entries&&n.entries.length||(n.entries=[]),n.entries.push(pQ.Message.Wantlist.Entry.decode(e,e.uint32()));break;case 2:n.full=e.bool();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof pQ.Message.Wantlist)return e;var t=new pQ.Message.Wantlist;if(e.entries){if(!Array.isArray(e.entries))throw TypeError(".Message.Wantlist.entries: array expected");t.entries=[];for(var r=0;r<e.entries.length;++r){if("object"!=typeof e.entries[r])throw TypeError(".Message.Wantlist.entries: object expected");t.entries[r]=pQ.Message.Wantlist.Entry.fromObject(e.entries[r])}}return null!=e.full&&(t.full=Boolean(e.full)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.entries=[]),t.defaults&&(r.full=!1),e.entries&&e.entries.length){r.entries=[];for(var n=0;n<e.entries.length;++n)r.entries[n]=pQ.Message.Wantlist.Entry.toObject(e.entries[n],t)}return null!=e.full&&e.hasOwnProperty("full")&&(r.full=e.full),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,oe.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message.Wantlist"},e.WantType=function(){const e={},t=Object.create(e);return t[e[0]="Block"]=0,t[e[1]="Have"]=1,t}(),e.Entry=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.block=fQ.newBuffer([]),e.prototype.priority=0,e.prototype.cancel=!1,e.prototype.wantType=0,e.prototype.sendDontHave=!1,e.encode=function(e,t){return t||(t=dQ.create()),null!=e.block&&Object.hasOwnProperty.call(e,"block")&&t.uint32(10).bytes(e.block),null!=e.priority&&Object.hasOwnProperty.call(e,"priority")&&t.uint32(16).int32(e.priority),null!=e.cancel&&Object.hasOwnProperty.call(e,"cancel")&&t.uint32(24).bool(e.cancel),null!=e.wantType&&Object.hasOwnProperty.call(e,"wantType")&&t.uint32(32).int32(e.wantType),null!=e.sendDontHave&&Object.hasOwnProperty.call(e,"sendDontHave")&&t.uint32(40).bool(e.sendDontHave),t},e.decode=function(e,t){e instanceof hQ||(e=hQ.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new pQ.Message.Wantlist.Entry;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.block=e.bytes();break;case 2:n.priority=e.int32();break;case 3:n.cancel=e.bool();break;case 4:n.wantType=e.int32();break;case 5:n.sendDontHave=e.bool();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof pQ.Message.Wantlist.Entry)return e;var t=new pQ.Message.Wantlist.Entry;switch(null!=e.block&&("string"==typeof e.block?fQ.base64.decode(e.block,t.block=fQ.newBuffer(fQ.base64.length(e.block)),0):e.block.length>=0&&(t.block=e.block)),null!=e.priority&&(t.priority=0|e.priority),null!=e.cancel&&(t.cancel=Boolean(e.cancel)),e.wantType){case"Block":case 0:t.wantType=0;break;case"Have":case 1:t.wantType=1}return null!=e.sendDontHave&&(t.sendDontHave=Boolean(e.sendDontHave)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.block="":(r.block=[],t.bytes!==Array&&(r.block=fQ.newBuffer(r.block))),r.priority=0,r.cancel=!1,r.wantType=t.enums===String?"Block":0,r.sendDontHave=!1),null!=e.block&&e.hasOwnProperty("block")&&(r.block=t.bytes===String?fQ.base64.encode(e.block,0,e.block.length):t.bytes===Array?Array.prototype.slice.call(e.block):e.block),null!=e.priority&&e.hasOwnProperty("priority")&&(r.priority=e.priority),null!=e.cancel&&e.hasOwnProperty("cancel")&&(r.cancel=e.cancel),null!=e.wantType&&e.hasOwnProperty("wantType")&&(r.wantType=t.enums===String?pQ.Message.Wantlist.WantType[e.wantType]:e.wantType),null!=e.sendDontHave&&e.hasOwnProperty("sendDontHave")&&(r.sendDontHave=e.sendDontHave),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,oe.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message.Wantlist.Entry"},e}(),e}(),e.Block=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.prefix=fQ.newBuffer([]),e.prototype.data=fQ.newBuffer([]),e.encode=function(e,t){return t||(t=dQ.create()),null!=e.prefix&&Object.hasOwnProperty.call(e,"prefix")&&t.uint32(10).bytes(e.prefix),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),t},e.decode=function(e,t){e instanceof hQ||(e=hQ.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new pQ.Message.Block;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.prefix=e.bytes();break;case 2:n.data=e.bytes();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof pQ.Message.Block)return e;var t=new pQ.Message.Block;return null!=e.prefix&&("string"==typeof e.prefix?fQ.base64.decode(e.prefix,t.prefix=fQ.newBuffer(fQ.base64.length(e.prefix)),0):e.prefix.length>=0&&(t.prefix=e.prefix)),null!=e.data&&("string"==typeof e.data?fQ.base64.decode(e.data,t.data=fQ.newBuffer(fQ.base64.length(e.data)),0):e.data.length>=0&&(t.data=e.data)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.prefix="":(r.prefix=[],t.bytes!==Array&&(r.prefix=fQ.newBuffer(r.prefix))),t.bytes===String?r.data="":(r.data=[],t.bytes!==Array&&(r.data=fQ.newBuffer(r.data)))),null!=e.prefix&&e.hasOwnProperty("prefix")&&(r.prefix=t.bytes===String?fQ.base64.encode(e.prefix,0,e.prefix.length):t.bytes===Array?Array.prototype.slice.call(e.prefix):e.prefix),null!=e.data&&e.hasOwnProperty("data")&&(r.data=t.bytes===String?fQ.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,oe.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message.Block"},e}(),e.BlockPresenceType=function(){const e={},t=Object.create(e);return t[e[0]="Have"]=0,t[e[1]="DontHave"]=1,t}(),e.BlockPresence=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.cid=fQ.newBuffer([]),e.prototype.type=0,e.encode=function(e,t){return t||(t=dQ.create()),null!=e.cid&&Object.hasOwnProperty.call(e,"cid")&&t.uint32(10).bytes(e.cid),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(16).int32(e.type),t},e.decode=function(e,t){e instanceof hQ||(e=hQ.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new pQ.Message.BlockPresence;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.cid=e.bytes();break;case 2:n.type=e.int32();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof pQ.Message.BlockPresence)return e;var t=new pQ.Message.BlockPresence;switch(null!=e.cid&&("string"==typeof e.cid?fQ.base64.decode(e.cid,t.cid=fQ.newBuffer(fQ.base64.length(e.cid)),0):e.cid.length>=0&&(t.cid=e.cid)),e.type){case"Have":case 0:t.type=0;break;case"DontHave":case 1:t.type=1}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.cid="":(r.cid=[],t.bytes!==Array&&(r.cid=fQ.newBuffer(r.cid))),r.type=t.enums===String?"Have":0),null!=e.cid&&e.hasOwnProperty("cid")&&(r.cid=t.bytes===String?fQ.base64.encode(e.cid,0,e.cid.length):t.bytes===Array?Array.prototype.slice.call(e.cid):e.cid),null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?pQ.Message.BlockPresenceType[e.type]:e.type),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,oe.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message.BlockPresence"},e}(),e})(),yQ=gQ.Wantlist.WantType.Block,wQ=gQ.Wantlist.WantType.Have;class mQ{constructor(e,t){this.set=t?vP({name:"ipfs_bitswap_wantlist",metrics:t.metrics}):new Map,this._stats=e}get length(){return this.set.size}add(e,t,r){const n=e.toString(V),s=this.set.get(n);s?(s.inc(),s.priority=t,s.wantType===wQ&&r===yQ&&(s.wantType=r)):(this.set.set(n,new uQ(e,t,r)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(e){const t=e.toString(V),r=this.set.get(t);r&&(r.dec(),r.hasRefs()||(this.set.delete(t),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){return this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map((e=e=>e[1].key,t=Array.from(this.set.entries()),Array.prototype.slice.call(t,0).sort(((t,r)=>{const n=e(t),s=e(r);return n<s?-1:n>s?1:0}))));var e,t}contains(e){const t=e.toString(V);return this.set.has(t)}get(e){const t=e.toString(V);return this.set.get(t)}}mQ.Entry=uQ;const bQ=mQ.Entry;class EQ{constructor(e,t,r,n,s){this.entry=new bQ(e,t,r),this.cancel=Boolean(n),this.sendDontHave=Boolean(s)}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(V)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}}const vQ=(e,t)=>{const r=["bitswap"];return t&&r.push(t),e&&r.push(`${e.toString().slice(0,8)}`),se(r.join(":"))},BQ=(e,t)=>{if(e.size!==t.size)return!1;for(const[r,n]of e){const e=t.get(r);if(void 0===e)return!1;if(n instanceof Uint8Array&&e instanceof Uint8Array&&!ii(n,e))return!1;if(n instanceof EQ&&e instanceof EQ&&!n.equals(e))return!1}return!0};class _Q{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return 0===this.blocks.size&&0===this.wantlist.size&&0===this.blockPresences.size}addEntry(e,t,r,n,s){null==r&&(r=_Q.WantType.Block);const i=e.toString(V),o=this.wantlist.get(i);o?(o.wantType===r&&(o.priority=t),n&&(o.cancel=Boolean(n)),s&&(o.sendDontHave=Boolean(s)),r===_Q.WantType.Block&&o.wantType===_Q.WantType.Have&&(o.wantType=r)):this.wantlist.set(i,new EQ(e,t,r,n,s))}addBlock(e,t){const r=e.toString(V);this.blocks.set(r,t)}addHave(e){const t=e.toString(V);this.blockPresences.has(t)||this.blockPresences.set(t,_Q.BlockPresenceType.Have)}addDontHave(e){const t=e.toString(V);this.blockPresences.has(t)||this.blockPresences.set(t,_Q.BlockPresenceType.DontHave)}cancel(e){const t=e.toString(V);this.wantlist.delete(t),this.addEntry(e,0,_Q.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){const e={wantlist:{entries:Array.from(this.wantlist.values()).map((e=>({block:e.cid.bytes,priority:Number(e.priority),cancel:Boolean(e.cancel)}))),full:!!this.full||void 0},blocks:Array.from(this.blocks.values())};return gQ.encode(e).finish()}serializeToBitswap110(){const e={wantlist:{entries:Array.from(this.wantlist.values()).map((e=>({block:e.cid.bytes,priority:Number(e.priority),wantType:e.wantType,cancel:Boolean(e.cancel),sendDontHave:Boolean(e.sendDontHave)}))),full:!!this.full||void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};for(const[t,r]of this.blocks.entries()){const n=Ve.parse(t),s=n.version,i=n.code,o=n.multihash.code,a=n.multihash.digest.length,A=lQ([s,i,o,a]);e.payload.push(new gQ.Block({prefix:A,data:r}))}for(const[t,r]of this.blockPresences)e.blockPresences.push(new gQ.BlockPresence({cid:Ve.parse(t).bytes,type:r}));return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),gQ.encode(e).finish()}equals(e){return!!(this.full===e.full&&this.pendingBytes===e.pendingBytes&&BQ(this.wantlist,e.wantlist)&&BQ(this.blocks,e.blocks)&&BQ(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){const e=Array.from(this.wantlist.keys()),t=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${t}>`}}_Q.deserialize=async(e,t)=>{const r=gQ.decode(e),n=r.wantlist&&r.wantlist.full||!1,s=new _Q(n);return r.wantlist&&r.wantlist.entries&&r.wantlist.entries.forEach((e=>{if(!e.block)return;const t=Ve.decode(e.block);s.addEntry(t,e.priority||0,e.wantType,Boolean(e.cancel),Boolean(e.sendDontHave))})),r.blockPresences&&r.blockPresences.forEach((e=>{if(!e.cid)return;const t=Ve.decode(e.cid);e.type===_Q.BlockPresenceType.Have?s.addHave(t):s.addDontHave(t)})),r.blocks.length>0?(await Promise.all(r.blocks.map((async e=>{const t=await $n.digest(e),r=Ve.createV0(t);s.addBlock(r,e)}))),s):r.payload.length>0?(await Promise.all(r.payload.map((async e=>{if(!e.prefix||!e.data)return;const r=cQ(e.prefix),n=r[0],i=r[1],o=r[2],a=o===$n.code?$n:t&&await t.getHasher(o);if(!a)throw new wa("Unknown hash algorithm","ERR_UNKNOWN_HASH_ALG");const A=await a.digest(e.data),c=Ve.create(n,i,A);s.addBlock(c,e.data)}))),s.setPendingBytes(r.pendingBytes),s):s},_Q.blockPresenceSize=e=>e.bytes.length+1,_Q.Entry=EQ,_Q.WantType={Block:gQ.Wantlist.WantType.Block,Have:gQ.Wantlist.WantType.Have},_Q.BlockPresenceType={Have:gQ.BlockPresenceType.Have,DontHave:gQ.BlockPresenceType.DontHave};const CQ=Math.pow(2,31)-1;var SQ=function(e,t,r){var n=null,s=null,i=function(){n&&(clearTimeout(n),s=null,n=null)},o=function(){if(!t)return e.apply(this,arguments);var o=this,a=arguments,A=r&&!n;return i(),s=function(){e.apply(o,a)},n=setTimeout((function(){if(n=null,!A){var e=s;return s=null,e()}}),t),A?s():void 0};return o.cancel=i,o.flush=function(){var e=s;i(),e&&e()},o};class IQ{constructor(e,t,r){this.peerId=t,this.network=r,this.refcnt=1,this._entries=[],this._log=vQ(e,"msgqueue"),this.sendEntries=SQ(this._sendEntries.bind(this),1)}addMessage(e){e.empty||this.send(e)}addEntries(e){this._entries=this._entries.concat(e),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;const e=new _Q(!1);this._entries.forEach((t=>{t.cancel?e.cancel(t.cid):e.addEntry(t.cid,t.priority)})),this._entries=[],this.addMessage(e)}async send(e){try{await this.network.connectTo(this.peerId)}catch(e){return void this._log.error("cant connect to peer %s: %s",this.peerId.toString(),e.message)}this._log("sending message to peer %s",this.peerId.toString()),this.network.sendMessage(this.peerId,e).catch((e=>{this._log.error("send error: %s",e.message)}))}}class TQ{constructor(e,t,r,n){this.peers=vP({name:"ipfs_bitswap_want_manager_peers",metrics:n.metrics}),this.wantlist=new mQ(r,n),this.network=t,this._stats=r,this._peerId=e,this._log=vQ(e,"want")}_addEntries(e,t,r){const n=e.map(((e,r)=>new _Q.Entry(e,CQ-r,_Q.WantType.Block,t)));n.forEach((e=>{e.cancel?r?this.wantlist.removeForce(e.cid.toString(V)):this.wantlist.remove(e.cid):(this._log("adding to wl"),this.wantlist.add(e.cid,e.priority))}));for(const e of this.peers.values())e.addEntries(n)}_startPeerHandler(e){let t=this.peers.get(e.toString());if(t)return void t.refcnt++;t=new IQ(this._peerId,e,this.network);const r=new _Q(!0);for(const e of this.wantlist.entries())r.addEntry(e[1].cid,e[1].priority);return t.addMessage(r),this.peers.set(e.toString(),t),t}_stopPeerHandler(e){const t=this.peers.get(e.toString());t&&(t.refcnt--,t.refcnt>0||this.peers.delete(e.toString()))}wantBlocks(e,t={}){this._addEntries(e,!1),t&&t.signal&&t.signal.addEventListener("abort",(()=>{this.cancelWants(e)}))}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach((e=>this.disconnected(e.peerId)))}}const RQ="/ipfs/bitswap/1.0.0",kQ="/ipfs/bitswap/1.1.0",UQ="/ipfs/bitswap/1.2.0";class DQ{constructor(e,t,r,n={}){this._log=vQ(e.peerId,"network"),this._libp2p=e,this._bitswap=t,this._protocols=[RQ],n.b100Only||(this._protocols.unshift(kQ),this._protocols.unshift(UQ)),this._stats=r,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashLoader=n.hashLoader,this._maxInboundStreams=n.maxInboundStreams??32,this._maxOutboundStreams=n.maxOutboundStreams??128,this._incomingStreamTimeout=n.incomingStreamTimeout??3e4}async start(){this._running=!0,await this._libp2p.handle(this._protocols,this._onConnection,{maxInboundStreams:this._maxInboundStreams,maxOutboundStreams:this._maxOutboundStreams});const e=D_({onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect});this._registrarIds=[];for(const t of this._protocols)this._registrarIds.push(await this._libp2p.register(t,e));this._libp2p.getConnections().forEach((e=>{this._onPeerConnect(e.remotePeer)}))}async stop(){if(this._running=!1,await this._libp2p.unhandle(this._protocols),null!=this._registrarIds){for(const e of this._registrarIds)this._libp2p.unregister(e);this._registrarIds=[]}}_onConnection({stream:e,connection:t}){if(!this._running)return;const r=new Bs.TimeoutController(this._incomingStreamTimeout);Promise.resolve().then((async()=>{this._log("incoming new bitswap %s connection from %p",e.stat.protocol,t.remotePeer),await zh(PC(e.source,r.signal),MC(),(async e=>{for await(const n of e){try{const e=await _Q.deserialize(n.subarray(),this._hashLoader);await this._bitswap._receiveMessage(t.remotePeer,e)}catch(e){this._bitswap._receiveError(e);break}r.reset()}}))})).catch((t=>{this._log(t),e.abort(t)})).finally((()=>{r.clear(),e.close()}))}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,t={}){return this._libp2p.contentRouting.findProviders(e,t)}async findAndConnect(e,t){const r=[];let n=0;for await(const s of this.findProviders(e,t))if(this._log(`connecting to provider ${s.id}`),r.push(this.connectTo(s.id,t).catch((e=>{this._log.error(e)}))),n++,3===n)break;await Promise.all(r)}async provide(e,t){await this._libp2p.contentRouting.provide(e,t)}async sendMessage(e,t){if(!this._running)throw new Error("network isn't running");const r=e.toString();this._log("sendMessage to %s",r,t);const n=await this._libp2p.dial(e),s=await n.newStream([UQ,kQ,RQ]);await async function(e,t,r){try{let r;switch(e.stat.protocol){case RQ:r=t.serializeToBitswap100();break;case kQ:case UQ:r=t.serializeToBitswap110();break;default:throw new Error("Unknown protocol: "+e.stat.protocol)}await zh([r],FC(),e)}catch(e){r(e)}finally{e.close()}}(s,t,this._log),this._updateSentStats(e,t.blocks)}async connectTo(e,t){if(!this._running)throw new Error("network isn't running");return this._libp2p.dial(e,t)}_updateSentStats(e,t){const r=e.toString();if(this._stats){for(const e of t.values())this._stats.push(r,"dataSent",e.length);this._stats.push(r,"blocksSent",t.size)}}}class PQ{constructor(e){this.partner=e,this.wantlist=new mQ,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.accounting.bytesRecv+=e}wants(e,t,r){this.wantlist.add(e,t,r)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.get(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}}class LQ extends Map{constructor(e,t){super(),this._cmp=t||this._defaultSort,this._keys=[];for(const[t,r]of e||[])this.set(t,r)}update(e){if(e<0||e>=this._keys.length)return;const t=this._keys[e];this._keys.splice(e,1);const r=this._find(t);this._keys.splice(r,0,t)}set(e,t){if(this.has(e)){const t=this.indexOf(e);this._keys.splice(t,1)}super.set(e,t);const r=this._find(e);return this._keys.splice(r,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;const t=this.indexOf(e);return this._keys.splice(t,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;const t=this._find(e);if(this._keys[t]===e)return t;for(let r=1;r<this._keys.length;r++){if(this._keys[t+r]===e)return t+r;if(this._keys[t-r]===e)return t-r}return-1}_find(e){let t=0,r=this._keys.length;for(;t<r;){const n=t+r>>>1,s=this._kCmp(this._keys[n],e);if(s<0)t=n+1;else{if(!(s>0))return n;r=n}}return t}*keys(){for(const e of this._keys)yield e}*values(){for(const e of this._keys)yield this.get(e)}*entries(){for(const e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,t){if(e)for(const r of this._keys)e.apply(t,[[r,this.get(r)]])}_defaultSort(e,t){return e[0]<t[0]?-1:t[0]<e[0]?1:0}_kCmp(e,t){return this._cmp([e,this.get(e)],[t,this.get(t)])}}const NQ={hasNewInfo(){return!1},merge(){}};class OQ{constructor(e=NQ){this._taskMerger=e,this._byPeer=new LQ([],FQ.compare)}pushTasks(e,t){let r=this._byPeer.get(e.toString());r||(r=new FQ(e,this._taskMerger)),r.pushTasks(t),this._byPeer.set(e.toString(),r)}popTasks(e){const t=this._head();if(void 0===t)return{tasks:[],pendingSize:0};const{tasks:r,pendingSize:n}=t.popTasks(e);if(0===r.length)return{tasks:r,pendingSize:n};const s=t.peerId;return t.isIdle()?this._byPeer.delete(s.toString()):this._byPeer.update(0),{peerId:s,tasks:r,pendingSize:n}}_head(){if(0!==this._byPeer.size)for(const[,e]of this._byPeer)return e}remove(e,t){const r=this._byPeer.get(t.toString());r&&r.remove(e)}tasksDone(e,t){const r=this._byPeer.get(e.toString());if(!r)return;const n=this._byPeer.indexOf(e.toString());for(const e of t)r.taskDone(e);this._byPeer.update(n)}}class FQ{constructor(e,t){this.peerId=e,this._taskMerger=t,this._activeTotalSize=0,this._pending=new QQ,this._active=new Set}pushTasks(e){for(const t of e)this._pushTask(t)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;const t=this._pending.get(e.topic);if(t)return e.priority>t.priority&&this._pending.updatePriority(e.topic,e.priority),void this._taskMerger.merge(e,t);this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){const t=[];for(const r of this._active)r.topic===e.topic&&t.push(r);return 0===t.length||this._taskMerger.hasNewInfo(e,t)}popTasks(e){let t=0;const r=[],n=this._pending.tasks();for(let s=0;s<n.length&&t<e;s++){const e=n[s];r.push(e),t+=e.size,this._pending.delete(e.topic),this._activeTotalSize+=e.size,this._active.add(e)}return{tasks:r,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return 0===this._pending.length&&0===this._active.size}static compare(e,t){return 0===e[1]._pending.length?1:0===t[1]._pending.length?-1:e[1]._activeTotalSize===t[1]._activeTotalSize?t[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-t[1]._activeTotalSize}}class QQ{constructor(){this._tasks=new LQ([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce(((e,t)=>e+t.task.size),0)}get(e){return(this._tasks.get(e)||{}).task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map((e=>e.task))}updatePriority(e,t){const r=this._tasks.get(e);if(!r)return;const n=this._tasks.indexOf(e);r.task.priority=t,this._tasks.update(n)}_compare(e,t){return e[1].task.priority===t[1].task.priority?e[1].created-t[1].created:t[1].task.priority-e[1].task.priority}}const xQ={hasNewInfo(e,t){let r=!1,n=!1;for(const e of t)e.data.haveBlock&&(r=!0),e.data.isWantBlock&&(n=!0);return!(n||!e.data.isWantBlock)||!(r||!e.data.haveBlock)},merge(e,t){const r=e.data,n=t.data;!n.haveBlock&&r.haveBlock&&(n.haveBlock=r.haveBlock,n.blockSize=r.blockSize),!n.isWantBlock&&r.isWantBlock&&(n.isWantBlock=!0,n.haveBlock&&!r.haveBlock||(n.haveBlock=r.haveBlock,t.size=e.size)),n.isWantBlock&&n.haveBlock&&(t.size=n.blockSize)}},MQ=_Q.WantType;class HQ{constructor(e,t,r,n,s,i={}){this._log=vQ(e,"engine"),this.blockstore=t,this.network=r,this._stats=n,this._opts=this._processOpts(i),this.ledgerMap=vP({name:"ipfs_bitswap_ledger_map",metrics:s.metrics}),this._running=!1,this._requestQueue=new OQ(xQ)}_processOpts(e){return{maxSizeReplaceHasWithBlock:1024,targetMessageSize:16384,...e}}_scheduleProcessTasks(){setTimeout((()=>{this._processTasks()}))}async _processTasks(){if(!this._running)return;const{peerId:e,tasks:t,pendingSize:r}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(0===t.length)return;const n=new _Q(!1);n.setPendingBytes(r);const s=[],i=new Map;for(const e of t){const t=Ve.parse(e.topic);e.data.haveBlock?e.data.isWantBlock?(s.push(t),i.set(e.topic,e.data)):n.addHave(t):n.addDontHave(t)}const o=await this._getBlocks(s);for(const[e,t]of i){const r=Ve.parse(e),s=o.get(e);s?n.addBlock(r,s):t.sendDontHave&&n.addDontHave(r)}if(n.empty)return e&&this._requestQueue.tasksDone(e,t),void this._scheduleProcessTasks();try{e&&await this.network.sendMessage(e,n);for(const[t,r]of o.entries())e&&this.messageSent(e,Ve.parse(t),r)}catch(e){this._log.error(e)}e&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks()}wantlistForPeer(e){const t=e.toString(),r=this.ledgerMap.get(t);return r?r.wantlist.sortedEntries():new Map}ledgerForPeer(e){const t=e.toString(),r=this.ledgerMap.get(t);return r?{peer:r.partner,value:r.debtRatio(),sent:r.accounting.bytesSent,recv:r.accounting.bytesRecv,exchanged:r.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map((e=>e.partner))}receivedBlocks(e){if(e.length){for(const t of this.ledgerMap.values())for(const r of e){const e=t.wantlistContains(r.cid);if(!e)continue;const n=r.data.length,s=this._sendAsBlock(e.wantType,n);let i=n;s||(i=_Q.blockPresenceSize(e.cid)),this._requestQueue.pushTasks(t.partner,[{topic:e.cid.toString(V),priority:e.priority,size:i,data:{blockSize:n,isWantBlock:s,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(e,t){const r=this._findOrCreate(e);if(t.empty)return;if(t.full&&(r.wantlist=new mQ),this._updateBlockAccounting(t.blocks,r),0===t.wantlist.size)return void this._scheduleProcessTasks();const n=[],s=[];t.wantlist.forEach((e=>{e.cancel?(r.cancelWant(e.cid),n.push(e.cid)):(r.wants(e.cid,e.priority,e.wantType),s.push(e))})),this._cancelWants(e,n),await this._addWants(e,s),this._scheduleProcessTasks()}_cancelWants(e,t){for(const r of t)this._requestQueue.remove(r.toString(V),e)}async _addWants(e,t){const r=await this._getBlockSizes(t.map((e=>e.cid))),n=[];for(const s of t){const t=s.cid.toString(V),i=r.get(t);if(null==i)s.sendDontHave&&n.push({topic:t,priority:s.priority,size:_Q.blockPresenceSize(s.cid),data:{isWantBlock:s.wantType===MQ.Block,blockSize:0,haveBlock:!1,sendDontHave:s.sendDontHave}});else{const e=this._sendAsBlock(s.wantType,i);let r=i;e||(r=_Q.blockPresenceSize(s.cid)),n.push({topic:t,priority:s.priority,size:r,data:{isWantBlock:e,blockSize:i,haveBlock:!0,sendDontHave:s.sendDontHave}})}this._requestQueue.pushTasks(e,n)}}_sendAsBlock(e,t){return e===MQ.Block||t<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){const t=await this._getBlocks(e);return new Map([...t].map((([e,t])=>[e,t.length])))}async _getBlocks(e){const t=new Map;return await Promise.all(e.map((async e=>{try{const r=await this.blockstore.get(e);t.set(e.toString(V),r)}catch(t){"ERR_NOT_FOUND"!==t.code&&this._log.error("failed to query blockstore for %s: %s",e,t)}}))),t}_updateBlockAccounting(e,t){for(const r of e.values())this._log("got block (%s bytes)",r.length),t.receivedBytes(r.length)}messageSent(e,t,r){const n=this._findOrCreate(e);n.sentBytes(r.length),n.wantlist.remove(t)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){this.ledgerMap.delete(e.toString())}_findOrCreate(e){const t=e.toString(),r=this.ledgerMap.get(t);if(r)return r;const n=new PQ(e);return this.ledgerMap.set(t,n),this._stats&&this._stats.push(t,"peerCount",1),n}start(){this._running=!0}stop(){this._running=!1}}const KQ=e=>`unwant:${Ts(e.multihash.bytes,"base64")}`,VQ=e=>`block:${Ts(e.multihash.bytes,"base64")}`;class zQ extends xU.EventEmitter{constructor(e){super(),this.setMaxListeners(1e3),this._log=vQ(e,"notif")}hasBlock(e,t){const r=VQ(e);this._log(r),this.emit(r,t)}wantBlock(e,t={}){if(!e)throw new Error("Not a valid cid");const r=VQ(e),n=KQ(e);return this._log(`wantBlock:${e}`),new Promise(((s,i)=>{const o=()=>{this.removeListener(r,a),i(new Error(`Block for ${e} unwanted`))},a=e=>{this.removeListener(n,o),s(e)};this.once(n,o),this.once(r,a),t&&t.signal&&t.signal.addEventListener("abort",(()=>{this.removeListener(r,a),this.removeListener(n,o),i(new Error(`Want for ${e} aborted`))}))}))}unwantBlock(e){const t=KQ(e);this._log(t),this.emit(t)}}var jQ=r(63573);class GQ extends xU.EventEmitter{constructor(e,t){super(),this._options=t,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach((e=>{this._stats[e]=BigInt(0),this._movingAverages[e]={},this._options.movingAverageIntervals.forEach((t=>{(this._movingAverages[e][t]=jQ(t)).push(this._frequencyLastTime,0)}))})),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,t){this._enabled&&(this._queue.push([e,t,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){const e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(;this._queue.length;){const t=e=this._queue.shift();t&&this._applyOp(t)}e&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){const t=e-this._frequencyLastTime;t&&Object.keys(this._stats).forEach((r=>{this._updateFrequencyFor(r,t,e)})),this._frequencyLastTime=e}_updateFrequencyFor(e,t,r){const n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;const s=n/t*1e3;let i=this._movingAverages[e];i||(i=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach((e=>{let t=i[e];t||(t=i[e]=jQ(e)),t.push(r,s)}))}_applyOp(e){const t=e[0],r=e[1];if("number"!=typeof r)throw new Error(`invalid increment number: ${r}`);Object.prototype.hasOwnProperty.call(this._stats,t)||(this._stats[t]=BigInt(0)),this._stats[t]=BigInt(this._stats[t])+BigInt(r),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=r}}const $Q={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[6e4,3e5,9e5]};class qQ extends xU.EventEmitter{constructor(e,t=[],r=$Q){super();const n=Object.assign({},$Q,r);if("number"!=typeof n.computeThrottleTimeout)throw new Error("need computeThrottleTimeout");if("number"!=typeof n.computeThrottleMaxQueueSize)throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=t,this._options=n,this._enabled=this._options.enabled,this._global=new GQ(t,n),this._global.on("update",(e=>this.emit("update",e))),this._peers=vP({name:"ipfs_bitswap_stats_peers",metrics:e.metrics})}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(const e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){const t="string"!=typeof e&&e.toString?e.toString():`${e}`;return this._peers.get(t)}push(e,t,r){if(this._enabled&&(this._global.push(t,r),e)){let n=this._peers.get(e);n||(n=new GQ(this._initialCounters,this._options),this._peers.set(e,n)),n.push(t,r)}}disconnected(e){const t=e.toString(),r=this._peers.get(t);r&&(r.stop(),this._peers.delete(t))}}const WQ={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},YQ=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"];class XQ extends n_{constructor(e,t,r={}){super(),this._libp2p=e,this._log=vQ(this.peerId),this._options=Object.assign({},WQ,r),this._stats=new qQ(e,YQ,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new DQ(e,this,this._stats,{hashLoader:r.hashLoader,maxInboundStreams:r.maxInboundStreams,maxOutboundStreams:r.maxOutboundStreams,incomingStreamTimeout:r.incomingStreamTimeout}),this.blockstore=t,this.engine=new HQ(this.peerId,t,this.network,this._stats,e),this.wm=new TQ(this.peerId,this.network,this._stats,e),this.notifications=new zQ(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,t){try{await this.engine.messageReceived(e,t)}catch(e){this._log("failed to receive message",t)}if(0===t.blocks.size)return;const r=[];for(const[e,n]of t.blocks.entries()){const t=Ve.parse(e);r.push({wasWanted:this.wm.wantlist.contains(t),cid:t,data:n})}this.wm.cancelWants(r.filter((({wasWanted:e})=>e)).map((({cid:e})=>e))),await Promise.all(r.map((({cid:t,wasWanted:r,data:n})=>this._handleReceivedBlock(e,t,n,r))))}async _handleReceivedBlock(e,t,r,n){this._log("received block");const s=await this.blockstore.has(t);this._updateReceiveCounters(e.toString(),t,r,s),n&&await this.put(t,r)}_updateReceiveCounters(e,t,r,n){this._stats.push(e,"blocksReceived",1),this._stats.push(e,"dataReceived",r.length),n&&(this._stats.push(e,"dupBlksReceived",1),this._stats.push(e,"dupDataReceived",r.length))}_receiveError(e){this._log.error("ReceiveError: %s",e.message)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this._stats.disconnected(e)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(e,t){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async get(e,t={}){const r=(e,t)=>(this.wm.wantBlocks([e],t),this.notifications.wantBlock(e,t));let n=!1;const s=async(e,t)=>{try{return await this.blockstore.get(e,t)}catch(s){if("ERR_NOT_FOUND"!==s.code)throw s;return n||(n=!0,this.network.findAndConnect(e,t).catch((e=>this._log.error(e)))),r(e,t)}},i=new AbortController,o=t.signal?(0,co.anySignal)([t.signal,i.signal]):i.signal;try{return await Promise.race([this.notifications.wantBlock(e,{signal:o}),s(e,{signal:o})])}finally{i.abort()}}async*getMany(e,t={}){for await(const r of e)yield this.get(r,t)}unwant(e){const t=Array.isArray(e)?e:[e];this.wm.unwantBlocks(t),t.forEach((e=>this.notifications.unwantBlock(e)))}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,t,r){await this.blockstore.put(e,t),this._sendHaveBlockNotifications(e,t)}async*putMany(e,t){for await(const{key:r,value:n}of this.blockstore.putMany(e,t))this._sendHaveBlockNotifications(r,n),yield{key:r,value:n}}_sendHaveBlockNotifications(e,t){this.notifications.hasBlock(e,t),this.engine.receivedBlocks([{cid:e,data:t}]),this.network.provide(e).catch((e=>{this._log.error("Failed to provide: %s",e.message)}))}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}async start(){this.wm.start(),await this.network.start(),this.engine.start(),this.started=!0}async stop(){this._stats.stop(),this.wm.stop(),await this.network.stop(),this.engine.stop(),this.started=!1}unwrap(){return this.blockstore}has(e){return this.blockstore.has(e)}}function JQ(e){return e=e||new Error("Not Found"),ie(e,"ERR_NOT_FOUND")}function ZQ(e){return e=e||new Error("Aborted"),ie(e,"ERR_ABORTED")}class ex extends n_{constructor(e,t){super(),this.child=e,this.bitswap=t}open(){return this.child.open()}close(){return this.child.close()}unwrap(){return this.child}async put(e,t,r={}){await this.has(e)||(this.bitswap.isStarted()?await this.bitswap.put(e,t,r):await this.child.put(e,t,r))}async*putMany(e,t={}){const r=xu(e,(async({key:e})=>!await this.has(e)));this.bitswap.isStarted()?yield*this.bitswap.putMany(r,t):yield*this.child.putMany(r,t)}async get(e,t={}){return!await this.has(e)&&this.bitswap.isStarted()?this.bitswap.get(e,t):this.child.get(e,t)}async*getMany(e,t={}){const r=zu({objectMode:!0}),n=zu({objectMode:!0});Promise.resolve().then((async()=>{for await(const t of e)!await this.has(t)&&this.bitswap.isStarted()?r.push(t):n.push(t);r.end(),n.end()})),yield*Mh(this.bitswap.getMany(r,t),this.child.getMany(n,t))}async delete(e,t){await this.child.delete(e,t)}async*deleteMany(e,t){yield*this.child.deleteMany(e,t)}async has(e,t={}){return this.child.has(e,t)}async*query(e,t={}){yield*this.child.query(e,t)}async*queryKeys(e,t={}){yield*this.child.queryKeys(e,t)}}class tx{constructor(e,t,r,n,s){this.peerId=e,this.libp2p=t,this.bitswap=r,this.repo=n,this.blockstore=s}static async start({peerId:e,repo:t,print:r,hashers:n,options:s}){t.closed&&await t.open();const i=await t.config.getAll(),o=await XF({options:s,repo:t,peerId:e,multiaddrs:rx(e,i),config:i,keychainConfig:void 0});await o.start();for(const e of o.getMultiaddrs())r(`Swarm listening on ${e.toString()}`);const a=((e,t,r={})=>new XQ(e,t,r))(o,t.blocks,{statsEnabled:!0,hashLoader:n,maxInboundStreams:1024,maxOutboundStreams:1024});await a.start();const A=new ex(t.blocks,a);return t.blocks=A,t.pins.blockstore=A,new tx(e,o,a,t,A)}static async stop(e){e.repo.blocks=e.blockstore.unwrap(),e.repo.pins.blockstore=e.blockstore.unwrap(),await e.bitswap.stop(),await e.libp2p.stop()}}const rx=(e,t)=>{const r=e.toString(),n=[],s=t.Addresses&&t.Addresses.Swarm||[];for(const e of s){let t=mi(e);if(t.protoCodes().includes(nx))throw ie(new Error("websocket-star swarm addresses are not supported. See https://github.com/ipfs/js-ipfs/issues/2779"),"ERR_WEBSOCKET_STAR_SWARM_ADDR_NOT_SUPPORTED");const s=t.getPeerId();s&&s!==r&&(t=t.encapsulate(`/p2p/${r}`)),n.push(t)}return n},nx=479;class sx{constructor({network:e}){this.addrs=function({network:e}){return go((async function(t={}){const r=[],{libp2p:n}=await e.use(t);return await n.peerStore.forEach((e=>{r.push({id:e.id,addrs:e.addresses.map((e=>e.multiaddr))})})),r}))}({network:e}),this.connect=function({network:e}){return go((async function(t,r={}){const{libp2p:n}=await e.use(r);await n.dial(t,r)}))}({network:e}),this.disconnect=function({network:e}){return go((async function(t,r={}){const{libp2p:n}=await e.use(r);await n.hangUp(t)}))}({network:e}),this.localAddrs=function({network:e}){return go((async function(t={}){const{libp2p:r}=await e.use(t);return r.getMultiaddrs()}))}({network:e}),this.peers=function({network:e}){return go((async function(t={}){const{libp2p:r}=await e.use(t);if(t.verbose){const e=[];for(const n of r.getConnections()){const r={addr:n.remoteAddr,peer:n.remotePeer};(t.verbose||t.direction)&&(r.direction=n.stat.direction),t.verbose&&(r.muxer=n.stat.multiplexer,r.latency="n/a",r.streams=[]),e.push(r)}return e}const n=new Map;for(const e of r.getConnections()){const t={addr:e.remoteAddr,peer:e.remotePeer};n.set(e.remotePeer.toString(),t)}return Array.from(n.values())}))}({network:e})}}const ix={success:!0,time:0,text:""};const ox="/ipns/";function ax(e){let t;if(e.startsWith(ox)&&(e=e.substring(ox.length)),"1"!==e[0]&&"Q"!==e[0]||(e=`z${e}`),"z"===e[0]&&(t=V.decode(e)),"k"===e[0]&&(t=Mn.decode(e)),!t)throw new Error("Could not parse string");if(1!==t[0]&&114!==t[1]&&(t=Fs([[1,114],t])),40!==t.length)throw new Error("Incorrect length "+t.length);return Fs([vs(ox),t.subarray(2)])}const Ax=async(e,t,r)=>{const n=await e.use(r);if(null!=n.libp2p.dht)return n;{const e=async function*(){yield{from:t,name:"QUERY_ERROR",type:3,error:new fs("dht not enabled")}};return{libp2p:{dht:{get:e,put:e,findProviders:e,findPeer:e,provide:e,getClosestPeers:e}}}}};const cx=async()=>{throw new fs("pubsub not enabled")},lx=I.bind({ignoreUndefined:!0}),ux=se("ipfs");class hx{constructor({print:e,storage:t,codecs:r,options:n}){const{peerId:s,repo:i,keychain:o}=t,a=So.create(tx),A=mm(n.preload),c=ga(),l=function({network:e}){return()=>{const t=e.try();return null!=t&&Boolean(t.libp2p.isStarted())}}({network:a}),u=new dh(n),h=Object.values(os);(n.ipld&&n.ipld.hashers?n.ipld.hashers:[]).forEach((e=>h.push(e))),this.hashers=new wS({hashers:h,loadHasher:n.ipld&&n.ipld.loadHasher});const d=Object.values(is);(n.ipld&&n.ipld.bases?n.ipld.bases:[]).forEach((e=>d.push(e))),this.bases=new fS({bases:d,loadBase:n.ipld&&n.ipld.loadBase});const f=new Qa({repo:i,codecs:r}),p=new Gh({codecs:r,hashers:this.hashers,preload:A,repo:i}),g=new Bh({dns:c,ipns:u,repo:i,codecs:r,peerId:s,isOnline:l,keychain:o,options:n}),y=Ua({repo:i,codecs:r,bases:this.bases,name:g}),w=new um({repo:i,codecs:r,hashers:this.hashers,preload:A}),m=Object.assign(Ih({repo:i,codecs:r,resolve:y,preload:A}),{local:Uh({repo:t.repo})}),{add:b,addAll:E,cat:v,get:B,ls:_}=new gw({preload:A,repo:i,options:n.EXPERIMENTAL,hashers:this.hashers}),C=CE({repo:i,preload:A,hashers:this.hashers,options:n}),S=function({preload:e,files:t,options:r={}}){if(r.interval=r.interval||3e4,!r.enabled){bm("MFS preload disabled");const e=async()=>{};return{start:e,stop:e}}let n,s="";const i=async()=>{try{const o=await t.stat("/"),a=o.cid.toString();s!==a&&(bm(`preloading updated MFS root ${s} -> ${o.cid}`),await e(o.cid),s=a)}catch(e){bm.error("failed to preload MFS root",e)}finally{n=setTimeout(i,r.interval)}};return{async start(){const e=await t.stat("/");s=e.cid.toString(),bm(`monitoring MFS root ${e.cid}`),n=setTimeout(i,r.interval)},stop(){clearTimeout(n)}}}({files:C,preload:A,options:n.preload});this.preload=A,this.name=g,this.ipns=u,this.pin=f,this.resolve=y,this.block=p,this.refs=m,this.start=function({network:e,preload:t,peerId:r,keychain:n,repo:s,ipns:i,mfsPreload:o,print:a,hashers:A,options:c}){return async()=>{const{libp2p:l}=await So.start(e,{peerId:r,repo:s,print:a,hashers:A,options:c});await Promise.all([i.startOnline({keychain:n,libp2p:l,peerId:r,repo:s}),t.start(),o.start()])}}({network:a,peerId:s,repo:i,preload:A,ipns:u,mfsPreload:S,print:e,keychain:o,hashers:this.hashers,options:n}),this.stop=function({network:e,preload:t,ipns:r,repo:n,mfsPreload:s}){return async()=>{await Promise.all([t.stop(),r.stop(),s.stop()]),await So.stop(e),await n.close()}}({network:a,preload:A,mfsPreload:S,ipns:u,repo:i}),this.dht=function({network:e,repo:t,peerId:r}){const{get:n,put:s,findProvs:i,findPeer:o,provide:a,query:A}={async*get(t,n={}){const{libp2p:s}=await Ax(e,r,n),i=t instanceof Uint8Array?t:ax(t);if(null==s.dht)throw ie(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*s.dht.get(i,n)},async*put(t,n,s){const{libp2p:i}=await Ax(e,r,s),o=t instanceof Uint8Array?t:ax(t);if(null==i.dht)throw ie(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*i.dht.put(o,n,s)},async*findProvs(t,n={}){const{libp2p:s}=await Ax(e,r,n);if(null==s.dht)throw ie(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*s.dht.findProviders(t,{signal:n.signal})},async*findPeer(t,n={}){const{libp2p:s}=await Ax(e,r,n);if(null==s.dht)throw ie(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*s.dht.findPeer(t,{signal:n.signal})},async*provide(n,s={recursive:!1}){const{libp2p:i}=await Ax(e,r,s);if(!await t.blocks.has(n))throw ie(new Error("block(s) not found locally, cannot provide"),"ERR_BLOCK_NOT_FOUND");if(s.recursive)throw ie(new Error("not implemented yet"),"ERR_NOT_IMPLEMENTED_YET");if(null==i.dht)throw ie(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*i.dht.provide(n)},async*query(t,n={}){const{libp2p:s}=await Ax(e,r,n);let i;const o=Ve.asCID(t);if(i=null!=o?o.multihash.bytes:Ta(t.toString()).toBytes(),null==s.dht)throw ie(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*s.dht.getClosestPeers(i,n)}};return{get:go(n),put:go(s),findProvs:go(i),findPeer:go(o),provide:go(a),query:go(A)}}({network:a,repo:i,peerId:s}),this.pubsub=function({network:e,config:t}){const r=qu(t||{},"Pubsub.Enabled",!0),n={};let s;return{subscribe:r?go((async function(t,r,i={}){const{libp2p:o}=await e.use(i);o.pubsub.subscribe(t),null==s&&(s=e=>{const t=e.detail;n[t.topic]&&n[t.topic].forEach((e=>{"function"!=typeof e?null!=e&&null!=e.handleEvent&&e.handleEvent(t):e(t)}))},o.pubsub.addEventListener("message",s)),null!=r&&(null==n[t]&&(n[t]=[]),n[t].push(r))})):cx,unsubscribe:r?go((async function(t,r,i={}){const{libp2p:o}=await e.use(i);null!=r&&null!=n[t]&&(n[t]=n[t].filter((e=>e!==r)),0===n[t].length&&delete n[t]),"function"!=typeof r&&delete n[t],null==n[t]&&o.pubsub.unsubscribe(t),0===Object.keys(n).length&&(o.pubsub.removeEventListener("message",s),s=void 0)})):cx,publish:r?go((async function(t,r,n={}){const{libp2p:s}=await e.use(n);if(!r)throw ie(new Error('argument "data" is required'),"ERR_ARG_REQUIRED");await s.pubsub.publish(t,r)})):cx,ls:r?go((async function(t={}){const{libp2p:r}=await e.use(t);return r.pubsub.getTopics()})):cx,peers:r?go((async function(t,r={}){const{libp2p:n}=await e.use(r);return n.pubsub.getSubscribers(t)})):cx}}({network:a,config:n.config}),this.dns=c,this.isOnline=l,this.id=mw({network:a,peerId:s}),this.version=function({repo:e}){return go((async function(t={}){const r=await e.version.get();return{version:yw,commit:"",repo:`${r}`,"ipfs-core":yw,"interface-ipfs-core":"^0.158.0"}}))}({repo:i}),this.bitswap=new Ph({network:a}),this.bootstrap=new Nh({repo:i}),this.config=function({repo:e}){return{getAll:go((async function(t={}){return e.config.getAll(t)})),get:go((async function(t,r){return t?e.config.get(t,r):Promise.reject(new Error("key argument is required"))})),set:go((async function(t,r,n){return e.config.set(t,r,n)})),replace:go((async function(t,r){return e.config.replace(t,r)})),profiles:{apply:go((async function(t,r={dryRun:!1}){const{dryRun:n}=r,s=vw[t];if(!s)throw new Error(`No profile with name '${t}' exists`);try{const t=await e.config.getAll(r);let i=JSON.parse(JSON.stringify(t));return i=s.transform(i),n||await e.config.replace(i,r),delete t.Identity.PrivKey,delete i.Identity.PrivKey,{original:t,updated:i}}catch(e){throw Bw(e),new Error(`Could not apply profile '${t}' to config: ${e.message}`)}})),list:go(_w)}}}({repo:i}),this.ping=function({network:e}){return go((async function*(t,r={}){const{libp2p:n}=await e.use();r.count=r.count||10;const s=await n.peerStore.get(t);let i=s&&s.id;if(!i){yield{...ix,text:`Looking up peer ${t}`};const e=await n.peerRouting.findPeer(t);i=e&&e.id}if(!i)throw new Error("Peer was not found");yield{...ix,text:`PING ${i.toString()}`};let o=0,a=0;for(let e=0;e<r.count;e++)try{const e=await n.ping(i);a+=e,o++,yield{...ix,time:e}}catch(e){yield{...ix,success:!1,text:e.toString()}}if(o){const e=a/o;yield{...ix,text:`Average latency: ${e}ms`}}}))}({network:a}),this.add=b,this.addAll=E,this.cat=v,this.get=B,this.ls=_,this.dag=w,this.files=C,this.key=new IE({keychain:o}),this.object=new PE({preload:A,codecs:r,repo:i}),this.repo=new OE({repo:i,hashers:this.hashers}),this.stats=new QE({repo:i,network:a}),this.swarm=new sx({network:a}),Object.defineProperty(this,"libp2p",{get(){const e=a.try();return e?e.libp2p:void 0}});const I=()=>Promise.reject(ie(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED"));this.commands=I,this.diag={cmds:I,net:I,sys:I},this.log={level:I,ls:I,tail:async function*(){throw ie(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}},this.mount=I,this.codecs=r}async init(){throw new ls}}r(52596);const dx=async function(e={}){const t=(e=lx({start:!0,EXPERIMENTAL:{},preload:{enabled:!T.isTest,addresses:["/dns4/node0.preload.ipfs.io/https","/dns4/node1.preload.ipfs.io/https","/dns4/node2.preload.ipfs.io/https","/dns4/node3.preload.ipfs.io/https"]}},e)).init||{},r={name:Pn.name,code:Pn.code,encode:e=>e,decode:e=>e},n=Object.values(as);[o,a,A,c,r].concat(e.ipld&&e.ipld.codecs||[]).forEach((e=>n.push(e)));const s=new gS({codecs:n,loadCodec:e.ipld&&e.ipld.loadCodec}),i=e.silent?ux:console.log;ux("creating repo");const l=await eQ.start(i,s,e);ux("getting repo config");const u=await l.repo.config.getAll(),h=new hx({storage:l,print:i,codecs:s,options:{...e,config:u}});if(ux("starting preload"),await h.preload.start(),ux("starting storage"),h.ipns.startOffline(l),l.isNew&&!t.emptyRepo){const e=await(async e=>{const t=vt({Data:new me({type:"directory"}).marshal(),Links:[]}),r=await e.block.put(t,{mhtype:"sha2-256",format:"dag-pb"});return await e.pin.add(r),r})(h);if(ux("adding default assets"),await void h.addAll,ux("initializing IPNS keyspace"),null==l.peerId.publicKey)throw ie(new Error("Public key missing"),"ERR_MISSING_PUBLIC_KEY");const t=new Bs.TimeoutController(3e4);try{await h.ipns.initializeKeyspace(l.peerId,vs(`/ipfs/${e}`),{signal:t.signal})}finally{t.clear()}}return!1!==e.start&&(ux("starting node"),await h.start()),h}}}]);